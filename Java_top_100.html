<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Java_top_100.md – Java &lt;- StackOverflow top 71</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        background-color: #232629;
        color: #7a7c7d;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #7a7c7d;  padding-left: 4px; }
    div.sourceCode
      { color: #cfcfc2; background-color: #232629; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #cfcfc2; } /* Normal */
    code span.al { color: #95da4c; background-color: #4d1f24; font-weight: bold; } /* Alert */
    code span.an { color: #3f8058; } /* Annotation */
    code span.at { color: #2980b9; } /* Attribute */
    code span.bn { color: #f67400; } /* BaseN */
    code span.bu { color: #7f8c8d; } /* BuiltIn */
    code span.cf { color: #fdbc4b; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #3daee9; } /* Char */
    code span.cn { color: #27aeae; font-weight: bold; } /* Constant */
    code span.co { color: #7a7c7d; } /* Comment */
    code span.cv { color: #7f8c8d; } /* CommentVar */
    code span.do { color: #a43340; } /* Documentation */
    code span.dt { color: #2980b9; } /* DataType */
    code span.dv { color: #f67400; } /* DecVal */
    code span.er { color: #da4453; text-decoration: underline; } /* Error */
    code span.ex { color: #0099ff; font-weight: bold; } /* Extension */
    code span.fl { color: #f67400; } /* Float */
    code span.fu { color: #8e44ad; } /* Function */
    code span.im { color: #27ae60; } /* Import */
    code span.in { color: #c45b00; } /* Information */
    code span.kw { color: #cfcfc2; font-weight: bold; } /* Keyword */
    code span.op { color: #cfcfc2; } /* Operator */
    code span.ot { color: #27ae60; } /* Other */
    code span.pp { color: #27ae60; } /* Preprocessor */
    code span.re { color: #2980b9; background-color: #153042; } /* RegionMarker */
    code span.sc { color: #3daee9; } /* SpecialChar */
    code span.ss { color: #da4453; } /* SpecialString */
    code span.st { color: #f44f4f; } /* String */
    code span.va { color: #27aeae; } /* Variable */
    code span.vs { color: #da4453; } /* VerbatimString */
    code span.wa { color: #da4453; } /* Warning */
  </style>
  <link rel="stylesheet" href=" ../Css/color_dark_solarized.css -c  ../Css/layout_toc.css" />
  <script type="text/javascript" src="../Css/js_masonry_desandro.js"></script>
</head>
<body>
<header id="title-block-header">
<h1 class="title">Java &lt;- StackOverflow top 71</h1>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#how-do-i-convert-a-string-to-an-int-in-java-score-5767039-in-2018">1: How do I convert a String to an int in Java? (score <span>5767039</span> in 2018)</a></li>
<li><a href="#how-do-i-declare-and-initialize-an-array-in-java-score-4290819-in-2017">2: How do I declare and initialize an array in Java? (score <span>4290819</span> in 2017)</a></li>
<li><a href="#how-do-i-generate-random-integers-within-a-specific-range-in-java-score-3879757-in-2019">3: How do I generate random integers within a specific range in Java? (score <span>3879757</span> in 2019)</a></li>
<li><a href="#how-to-split-a-string-in-java-score-3688160-in-2018">4: How to split a string in Java (score <span>3688160</span> in 2018)</a></li>
<li><a href="#iterate-through-a-hashmap-score-3596326-in-2019">5: Iterate through a HashMap (score <span>3596326</span> in 2019)</a></li>
<li><a href="#initialization-of-an-arraylist-in-one-line-score-2834764-in-2014">6: Initialization of an ArrayList in one line (score <span>2834764</span> in 2014)</a></li>
<li><a href="#how-do-i-create-a-file-and-write-to-it-in-java-score-2755644-in-2017">7: How do I create a file and write to it in Java? (score <span>2755644</span> in 2017)</a></li>
<li><a href="#how-does-the-java-for-each-loop-work-score-2503583-in-2018">8: How does the Java ‘for each’ loop work? (score <span>2503583</span> in 2018)</a></li>
<li><a href="#what-does-could-not-find-or-load-main-class-mean-score-2477019-in-2018">9: What does “Could not find or load main class” mean? (score <span>2477019</span> in 2018)</a></li>
<li><a href="#how-do-i-efficiently-iterate-over-each-entry-in-a-java-map-score-2356995-in-2019">10: How do I efficiently iterate over each entry in a Java Map? (score <span>2356995</span> in 2019)</a></li>
<li><a href="#whats-the-simplest-way-to-print-a-java-array-score-2123014-in-2019">11: What’s the simplest way to print a Java array? (score <span>2123014</span> in 2019)</a></li>
<li><a href="#how-do-i-read-convert-an-inputstream-into-a-string-in-java-score-2007290-in-2019">12: How do I read / convert an InputStream into a String in Java? (score <span>2007290</span> in 2019)</a></li>
<li><a href="#what-is-the-difference-between-public-protected-package-private-and-private-in-java-score-1981495-in-2018">13: What is the difference between public, protected, package-private and private in Java? (score <span>1981495</span> in 2018)</a></li>
<li><a href="#how-do-i-determine-whether-an-array-contains-a-particular-value-in-java-score-1869332-in-2019">14: How do I determine whether an array contains a particular value in Java? (score <span>1869332</span> in 2019)</a></li>
<li><a href="#is-java-pass-by-reference-or-pass-by-value-score-1865334-in-2018">15: Is Java “pass-by-reference” or “pass-by-value”? (score <span>1865334</span> in 2018)</a></li>
<li><a href="#how-to-fix-java.lang.unsupportedclassversionerror-unsupported-major.minor-version-score-1810449-in-2019">16: How to fix java.lang.UnsupportedClassVersionError: Unsupported major.minor version (score <span>1810449</span> in 2019)</a></li>
<li><a href="#how-to-round-a-number-to-n-decimal-places-in-java-score-1530287-in-2017">17: How to round a number to n decimal places in Java (score <span>1530287</span> in 2017)</a></li>
<li><a href="#convert-arraylist-to-string-array-score-1474844-in-2018">18: Convert ArrayList<String> to String[] array (score <span>1474844</span> in 2018)</a></li>
<li><a href="#differences-between-hashmap-and-hashtable-score-1473992-in-2019">19: Differences between HashMap and Hashtable? (score <span>1473992</span> in 2019)</a></li>
<li><a href="#create-arraylist-from-array-score-1422325-in-2016">20: Create ArrayList from array (score <span>1422325</span> in 2016)</a></li>
<li><a href="#why-is-processing-a-sorted-array-faster-than-processing-an-unsorted-array-score-1410048-in-2019">21: Why is processing a sorted array faster than processing an unsorted array? (score <span>1410048</span> in 2019)</a></li>
<li><a href="#how-to-generate-a-random-alpha-numeric-string-score-1334589-in-2019">22: How to generate a random alpha-numeric string? (score <span>1334589</span> in 2019)</a></li>
<li><a href="#sort-a-mapkey-value-by-values-score-1327878-in-2018">23: Sort a Map&lt;Key, Value&gt; by values (score <span>1327878</span> in 2018)</a></li>
<li><a href="#how-do-i-create-a-java-string-from-the-contents-of-a-file-score-1307219-in-2018">24: How do I create a Java string from the contents of a file? (score <span>1307219</span> in 2018)</a></li>
<li><a href="#how-can-i-create-an-executable-jar-with-dependencies-using-maven-score-1210754-in-2018">25: How can I create an executable JAR with dependencies using Maven? (score <span>1210754</span> in 2018)</a></li>
<li><a href="#how-do-you-assert-that-a-certain-exception-is-thrown-in-junit-4-tests-score-1186587-in-2013">26: How do you assert that a certain exception is thrown in JUnit 4 tests? (score <span>1186587</span> in 2013)</a></li>
<li><a href="#avoiding-null-statements-score-1182090-in-2018">27: Avoiding != null statements (score <span>1182090</span> in 2018)</a></li>
<li><a href="#how-do-i-fix-android.os.networkonmainthreadexception-score-1139887-in-2019">28: How do I fix ‘android.os.NetworkOnMainThreadException’? (score <span>1139887</span> in 2019)</a></li>
<li><a href="#does-java-support-default-parameter-values-score-1111010-in-2019">29: Does Java support default parameter values? (score <span>1111010</span> in 2019)</a></li>
<li><a href="#how-to-get-an-enum-value-from-a-string-value-in-java-score-1045192-in-2018">31: How to get an enum value from a string value in Java? (score <span>1045192</span> in 2018)</a></li>
<li><a href="#sort-arraylist-of-custom-objects-by-property-score-1033206-in-2016">32: Sort ArrayList of custom Objects by property (score <span>1033206</span> in 2016)</a></li>
<li><a href="#how-can-i-concatenate-two-arrays-in-java-score-1023252-in-2018">33: How can I concatenate two arrays in Java? (score <span>1023252</span> in 2018)</a></li>
<li><a href="#when-to-use-linkedlist-over-arraylist-in-java-score-1008299-in-2018">34: When to use LinkedList over ArrayList in Java? (score <span>1008299</span> in 2018)</a></li>
<li><a href="#how-to-use-java.net.urlconnection-to-fire-and-handle-http-requests-score-989794-in-2018">35: How to use java.net.URLConnection to fire and handle HTTP requests (score <span>989794</span> in 2018)</a></li>
<li><a href="#what-are-the-possible-values-of-the-hibernate-hbm2ddl.auto-configuration-and-what-do-they-do-score-955696-in-2019">36: What are the possible values of the Hibernate hbm2ddl.auto configuration and what do they do (score <span>955696</span> in 2019)</a></li>
<li><a href="#difference-between-wait-and-sleep-score-864573-in-2017">37: Difference between wait() and sleep() (score <span>864573</span> in 2017)</a></li>
<li><a href="#whats-the-difference-between-component-repository-service-annotations-in-spring-score-852949-in-2017">38: What’s the difference between <span class="citation" data-cites="Component">@Component</span>, <span class="citation" data-cites="Repository">@Repository</span> &amp; <span class="citation" data-cites="Service">@Service</span> annotations in Spring? (score <span>852949</span> in 2017)</a></li>
<li><a href="#what-is-reflection-and-why-is-it-useful-score-846678-in-2015">39: What is reflection and why is it useful? (score <span>846678</span> in 2015)</a></li>
<li><a href="#what-is-a-serialversionuid-and-why-should-i-use-it-score-845205-in-2015">40: What is a serialVersionUID and why should I use it? (score <span>845205</span> in 2015)</a></li>
<li><a href="#how-can-i-initialise-a-static-map-score-808780-in-2018">41: How can I initialise a static Map? (score <span>808780</span> in 2018)</a></li>
<li><a href="#how-do-i-test-a-private-function-or-a-class-that-has-private-methods-fields-or-inner-classes-score-804279-in-2019">42: How do I test a private function or a class that has private methods, fields or inner classes? (score <span>804279</span> in 2019)</a></li>
<li><a href="#how-do-i-call-one-constructor-from-another-in-java-score-798292-in-2008">43: How do I call one constructor from another in Java? (score <span>798292</span> in 2008)</a></li>
<li><a href="#how-to-add-local-jar-files-to-a-maven-project-score-786969-in-2018">44: How to add local jar files to a Maven project? (score <span>786969</span> in 2018)</a></li>
<li><a href="#difference-between-stringbuilder-and-stringbuffer-score-761903-in-2016">45: Difference between StringBuilder and StringBuffer (score <span>761903</span> in 2016)</a></li>
<li><a href="#how-to-create-a-generic-array-in-java-score-727576-in-2017">46: How to create a generic array in Java? (score <span>727576</span> in 2017)</a></li>
<li><a href="#java-inner-class-and-static-nested-class-score-695972-in-2019">47: Java inner class and static nested class (score <span>695972</span> in 2019)</a></li>
<li><a href="#implements-runnable-vs-extends-thread-in-java-score-663876-in-2018">48: “implements Runnable” vs “extends Thread” in Java (score <span>663876</span> in 2018)</a></li>
<li><a href="#why-does-java-have-transient-fields-score-663871-in-2016">49: Why does Java have transient fields? (score <span>663871</span> in 2016)</a></li>
<li><a href="#why-is-subtracting-these-two-times-in-1927-giving-a-strange-result-score-620541-in-2018">50: Why is subtracting these two times (in 1927) giving a strange result? (score <span>620541</span> in 2018)</a></li>
<li><a href="#comparing-java-enum-members-or-equals-score-614360-in-2017">51: Comparing Java enum members: == or equals()? (score <span>614360</span> in 2017)</a></li>
<li><a href="#creating-a-memory-leak-with-java-score-610179-in-2019">52: Creating a memory leak with Java (score <span>610179</span> in 2019)</a></li>
<li><a href="#how-can-i-convert-a-stack-trace-to-a-string-score-568558-in-2016">53: How can I convert a stack trace to a string? (score <span>568558</span> in 2016)</a></li>
<li><a href="#what-exactly-is-apache-camel-score-533978-in-2016">54: What exactly is Apache Camel? (score <span>533978</span> in 2016)</a></li>
<li><a href="#what-is-a-javabean-exactly-score-528745-in-2019">55: What is a JavaBean exactly? (score <span>528745</span> in 2019)</a></li>
<li><a href="#download-a-file-with-android-and-showing-the-progress-in-a-progressdialog-score-518763-in-2014">56: Download a file with Android, and showing the progress in a ProgressDialog (score <span>518763</span> in 2014)</a></li>
<li><a href="#does-a-finally-block-always-get-executed-in-java-score-471713-in-2019">57: Does a finally block always get executed in Java? (score <span>471713</span> in 2019)</a></li>
<li><a href="#iterating-through-a-collection-avoiding-concurrentmodificationexception-when-removing-objects-in-a-loop-score-461129-in-2019">58: Iterating through a Collection, avoiding ConcurrentModificationException when removing objects in a loop (score <span>461129</span> in 2019)</a></li>
<li><a href="#android-sdk-installation-doesnt-find-jdk-score-435935-in-2018">59: Android SDK installation doesn’t find JDK (score <span>435935</span> in 2018)</a></li>
<li><a href="#why-is-char-preferred-over-string-for-passwords-score-373132-in-2017">60: Why is char[] preferred over String for passwords? (score <span>373132</span> in 2017)</a></li>
<li><a href="#why-use-getters-and-settersaccessors-score-367892-in-2017">61: Why use getters and setters/accessors? (score <span>367892</span> in 2017)</a></li>
<li><a href="#proper-use-cases-for-android-usermanager.isuseragoat-score-301207-in-2018">62: Proper use cases for Android UserManager.isUserAGoat()? (score <span>301207</span> in 2018)</a></li>
<li><a href="#how-do-servlets-work-instantiation-sessions-shared-variables-and-multithreading-score-282529-in-2017">63: How do servlets work? Instantiation, sessions, shared variables and multithreading (score <span>282529</span> in 2017)</a></li>
<li><a href="#why-dont-javas---compound-assignment-operators-require-casting-score-275111-in-2018">64: Why don’t Java’s +=, -=, *=, /= compound assignment operators require casting? (score <span>275111</span> in 2018)</a></li>
<li><a href="#how-to-avoid-java-code-in-jsp-files-score-274966-in-2015">65: How to avoid Java code in JSP files? (score <span>274966</span> in 2015)</a></li>
<li><a href="#fastest-way-to-determine-if-an-integers-square-root-is-an-integer-score-262060-in-2018">66: Fastest way to determine if an integer’s square root is an integer (score <span>262060</span> in 2018)</a></li>
<li><a href="#must-override-a-superclass-method-errors-after-importing-a-project-into-eclipse-score-250927-in-2019">67: ‘Must Override a Superclass Method’ Errors after importing a project into Eclipse (score <span>250927</span> in 2019)</a></li>
<li><a href="#why-is-printing-b-dramatically-slower-than-printing-score-228782-in-2018">68: Why is printing “B” dramatically slower than printing “#”? (score <span>228782</span> in 2018)</a></li>
<li><a href="#is-null-check-needed-before-calling-instanceof-score-219704-in-2017">69: Is null check needed before calling instanceof? (score <span>219704</span> in 2017)</a></li>
<li><a href="#why-does-this-code-using-random-strings-print-hello-world-score-193430-in-2015">70: Why does this code using random strings print “hello world”? (score <span>193430</span> in 2015)</a></li>
<li><a href="#why-is-executing-java-code-in-comments-with-certain-unicode-characters-allowed-score-73395-in-2015">71: Why is executing Java code in comments with certain Unicode characters allowed? (score <span>73395</span> in 2015)</a></li>
</ul>
</nav>
<section class="level2">
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
<section id="how-do-i-convert-a-string-to-an-int-in-java-score-5767039-in-2018" class="level3">
<h3>1: How do I convert a String to an int in Java? (score <a href="https://stackoverflow.com/q/5585779.html">5767039</a> in 2018)</h3>
<section id="question" class="level4">
<h4>Question</h4>
<p>How can I convert a <code>String</code> to an <code>int</code> in Java?</p>
<p>My String contains only numbers, and I want to return the number it represents.</p>
<p>For example, given the string <code>"1234"</code> the result should be the number <code>1234</code>.</p>
</section>
<section id="answer-accepted-score-3924" class="level4">
<h4>Answer accepted (score 3924)</h4>
<div class="sourceCode" id="cb1"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a><span class="bu">String</span> myString = <span class="st">&quot;1234&quot;</span>;</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a><span class="dt">int</span> foo = <span class="bu">Integer</span>.<span class="fu">parseInt</span>(myString);</span></code></pre></div>
<p>If you look at the <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/Integer.html
#parseInt(java.lang.String)" rel="noreferrer">Java Documentation</a> you’ll notice the “catch” is that this function can throw a <code>NumberFormatException</code>, which of course you have to handle:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a><span class="dt">int</span> foo;</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a><span class="kw">try</span> {</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true"></a>   foo = <span class="bu">Integer</span>.<span class="fu">parseInt</span>(myString);</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true"></a>}</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true"></a><span class="kw">catch</span> (<span class="bu">NumberFormatException</span> e)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true"></a>{</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true"></a>   foo = <span class="dv">0</span>;</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true"></a>}</span></code></pre></div>
<p>(This treatment defaults a malformed number to <code>0</code>, but you can do something else if you like.)</p>
<p>Alternatively, you can use an <code>Ints</code> method from the Guava library, which in combination with Java 8’s <code>Optional</code>, makes for a powerful and concise way to convert a string into an int:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="kw">import</span><span class="im"> com.google.common.primitives.Ints;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true"></a><span class="dt">int</span> foo = Optional.<span class="fu">ofNullable</span>(myString)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true"></a> .<span class="fu">map</span>(Ints::tryParse)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true"></a> .<span class="fu">orElse</span>(<span class="dv">0</span>)</span></code></pre></div>
</section>
<section id="answer-2-score-647" class="level4">
<h4>Answer 2 (score 647)</h4>
<p>For example, here are two ways:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a><span class="bu">Integer</span> x = <span class="bu">Integer</span>.<span class="fu">valueOf</span>(str);</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a><span class="co">// or</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a><span class="dt">int</span> y = <span class="bu">Integer</span>.<span class="fu">parseInt</span>(str);</span></code></pre></div>
<p>There is a slight difference between these methods:</p>
<ul>
<li>
<code>valueOf</code> returns a new or cached instance of <code>java.lang.Integer</code>
</li>
<li>
<code>parseInt</code> returns primitive <code>int</code>.
</li>
</ul>
<p>The same is for all cases: <code>Short.valueOf</code>/<code>parseShort</code>, <code>Long.valueOf</code>/<code>parseLong</code>, etc.</p>
</section>
<section id="answer-3-score-233" class="level4">
<h4>Answer 3 (score 233)</h4>
<p>Well, a very important point to consider is that the Integer parser throws NumberFormatException as stated in <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Integer.html
#parseInt%28java.lang.String%29" rel="noreferrer">Javadoc</a>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a><span class="dt">int</span> foo;</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true"></a><span class="bu">String</span> StringThatCouldBeANumberOrNot = <span class="st">&quot;26263Hello&quot;</span>; <span class="co">//will throw exception</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true"></a><span class="bu">String</span> StringThatCouldBeANumberOrNot2 = <span class="st">&quot;26263&quot;</span>; <span class="co">//will not throw exception</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true"></a><span class="kw">try</span> {</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true"></a>      foo = <span class="bu">Integer</span>.<span class="fu">parseInt</span>(StringThatCouldBeANumberOrNot);</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true"></a>} <span class="kw">catch</span> (<span class="bu">NumberFormatException</span> e) {</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true"></a>      <span class="co">//Will Throw exception!</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true"></a>      <span class="co">//do something! anything to handle the exception.</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true"></a>}</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true"></a><span class="kw">try</span> {</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true"></a>      foo = <span class="bu">Integer</span>.<span class="fu">parseInt</span>(StringThatCouldBeANumberOrNot2);</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true"></a>} <span class="kw">catch</span> (<span class="bu">NumberFormatException</span> e) {</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true"></a>      <span class="co">//No problem this time, but still it is good practice to care about exceptions.</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true"></a>      <span class="co">//Never trust user input :)</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true"></a>      <span class="co">//Do something! Anything to handle the exception.</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true"></a>}</span></code></pre></div>
<p>It is important to handle this exception when trying to get integer values from split arguments or dynamically parsing something.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-do-i-declare-and-initialize-an-array-in-java-score-4290819-in-2017" class="level3">
<h3>2: How do I declare and initialize an array in Java? (score <a href="https://stackoverflow.com/q/1200621.html">4290819</a> in 2017)</h3>
<section id="question-1" class="level4">
<h4>Question</h4>
<p>How do I declare and initialize an array in Java?</p>
</section>
<section id="answer-accepted-score-2539" class="level4">
<h4>Answer accepted (score 2539)</h4>
<p>You can either use array declaration or array literal (but only when you declare and affect the variable right away, array literals cannot be used for re-assigning an array).</p>
<p>For primitive types:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="dt">int</span>[] myIntArray = <span class="kw">new</span> <span class="dt">int</span>[<span class="dv">3</span>];</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a><span class="dt">int</span>[] myIntArray = {<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>};</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true"></a><span class="dt">int</span>[] myIntArray = <span class="kw">new</span> <span class="dt">int</span>[]{<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>};</span></code></pre></div>
<p>For classes, for example <code>String</code>, it’s the same:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a><span class="bu">String</span>[] myStringArray = <span class="kw">new</span> <span class="bu">String</span>[<span class="dv">3</span>];</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true"></a><span class="bu">String</span>[] myStringArray = {<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>};</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true"></a><span class="bu">String</span>[] myStringArray = <span class="kw">new</span> <span class="bu">String</span>[]{<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>};</span></code></pre></div>
<p>The third way of initializing is useful when you declare the array first and then initialize it. The cast is necessary here.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a><span class="bu">String</span>[] myStringArray;</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true"></a>myStringArray = <span class="kw">new</span> <span class="bu">String</span>[]{<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>};</span></code></pre></div>
</section>
<section id="answer-2-score-259" class="level4">
<h4>Answer 2 (score 259)</h4>
<p>There are two types of array.<br/></p>
<h5>
One Dimensional Array
</h2>
<p>Syntax for default values:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a><span class="dt">int</span>[] num = <span class="kw">new</span> <span class="dt">int</span>[<span class="dv">5</span>];</span></code></pre></div>
<p>Or (less preferred)</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true"></a><span class="dt">int</span> num[] = <span class="kw">new</span> <span class="dt">int</span>[<span class="dv">5</span>];</span></code></pre></div>
<p>Syntax with values given (variable/field initialization):</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true"></a><span class="dt">int</span>[] num = {<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>};</span></code></pre></div>
<p>Or (less preferred)</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true"></a><span class="dt">int</span> num[] = {<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>};</span></code></pre></div>
<p>Note: For convenience int[] num is preferable because it clearly tells that you are talking here about array. Otherwise no difference. Not at all.<br/></p>
<h5>
Multidimensional array
</h2>
<h5>
Declaration
</h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true"></a><span class="dt">int</span>[][] num = <span class="kw">new</span> <span class="dt">int</span>[<span class="dv">5</span>][<span class="dv">2</span>];</span></code></pre></div>
<p>Or</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true"></a><span class="dt">int</span> num[][] = <span class="kw">new</span> <span class="dt">int</span>[<span class="dv">5</span>][<span class="dv">2</span>];</span></code></pre></div>
<p>Or</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true"></a><span class="dt">int</span>[] num[] = <span class="kw">new</span> <span class="dt">int</span>[<span class="dv">5</span>][<span class="dv">2</span>];</span></code></pre></div>
<h5>
Initialization
</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true"></a> num[<span class="dv">0</span>][<span class="dv">0</span>]=<span class="dv">1</span>;</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true"></a> num[<span class="dv">0</span>][<span class="dv">1</span>]=<span class="dv">2</span>;</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true"></a> num[<span class="dv">1</span>][<span class="dv">0</span>]=<span class="dv">1</span>;</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true"></a> num[<span class="dv">1</span>][<span class="dv">1</span>]=<span class="dv">2</span>;</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true"></a> num[<span class="dv">2</span>][<span class="dv">0</span>]=<span class="dv">1</span>;</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true"></a> num[<span class="dv">2</span>][<span class="dv">1</span>]=<span class="dv">2</span>;</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true"></a> num[<span class="dv">3</span>][<span class="dv">0</span>]=<span class="dv">1</span>;</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true"></a> num[<span class="dv">3</span>][<span class="dv">1</span>]=<span class="dv">2</span>;</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true"></a> num[<span class="dv">4</span>][<span class="dv">0</span>]=<span class="dv">1</span>;</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true"></a> num[<span class="dv">4</span>][<span class="dv">1</span>]=<span class="dv">2</span>;</span></code></pre></div>
<p>Or</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true"></a> <span class="dt">int</span>[][] num={ {<span class="dv">1</span>,<span class="dv">2</span>}, {<span class="dv">1</span>,<span class="dv">2</span>}, {<span class="dv">1</span>,<span class="dv">2</span>}, {<span class="dv">1</span>,<span class="dv">2</span>}, {<span class="dv">1</span>,<span class="dv">2</span>} };</span></code></pre></div>
<h5>
Ragged Array (or Non-rectangular Array)
</h3>
<div class="sourceCode" id="cb18"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true"></a> <span class="dt">int</span>[][] num = <span class="kw">new</span> <span class="dt">int</span>[<span class="dv">5</span>][];</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true"></a> num[<span class="dv">0</span>] = <span class="kw">new</span> <span class="dt">int</span>[<span class="dv">1</span>];</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true"></a> num[<span class="dv">1</span>] = <span class="kw">new</span> <span class="dt">int</span>[<span class="dv">5</span>];</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true"></a> num[<span class="dv">2</span>] = <span class="kw">new</span> <span class="dt">int</span>[<span class="dv">2</span>];</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true"></a> num[<span class="dv">3</span>] = <span class="kw">new</span> <span class="dt">int</span>[<span class="dv">3</span>];</span></code></pre></div>
<p>
So here we are defining columns explicitly.<br/> <b>Another Way:</b>
</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true"></a><span class="dt">int</span>[][] num={ {<span class="dv">1</span>}, {<span class="dv">1</span>,<span class="dv">2</span>}, {<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>}, {<span class="dv">1</span>,<span class="dv">2</span>}, {<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>} };</span></code></pre></div>
<h5>
For Accessing:
</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true"></a><span class="kw">for</span> (<span class="dt">int</span> i=<span class="dv">0</span>; i&lt;(num.<span class="fu">length</span>); i++ ) {</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true"></a>    <span class="kw">for</span> (<span class="dt">int</span> j=<span class="dv">0</span>;j&lt;num[i].<span class="fu">length</span>;j++)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true"></a>        <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(num[i][j]);</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true"></a>}</span></code></pre></div>
<p>Alternatively:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true"></a><span class="kw">for</span> (<span class="dt">int</span>[] a : num) {</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true"></a>  <span class="kw">for</span> (<span class="dt">int</span> i : a) {</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true"></a>    <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(i);</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true"></a>  }</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true"></a>}</span></code></pre></div>
<p>
Ragged arrays are multidimensional arrays.<br/> For explanation see multidimensional array detail at <a href="http://docs.oracle.com/javase/tutorial/java/nutsandbolts/arrays.html" rel="noreferrer">the official java tutorials</a>
</p>
</section>
<section id="answer-3-score-122" class="level4">
<h4>Answer 3 (score 122)</h4>
<div class="sourceCode" id="cb22"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true"></a><span class="bu">Type</span>[] variableName = <span class="kw">new</span> <span class="bu">Type</span>[capacity];</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true"></a><span class="bu">Type</span>[] variableName = {comma-delimited values};</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true"></a><span class="bu">Type</span> variableName[] = <span class="kw">new</span> <span class="bu">Type</span>[capacity]; </span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true"></a><span class="bu">Type</span> variableName[] = {comma-delimited values};</span></code></pre></div>
<p>is also valid, but I prefer the brackets after the type, because it’s easier to see that the variable’s type is actually an array.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-do-i-generate-random-integers-within-a-specific-range-in-java-score-3879757-in-2019" class="level3">
<h3>3: How do I generate random integers within a specific range in Java? (score <a href="https://stackoverflow.com/q/363681.html">3879757</a> in 2019)</h3>
<section id="question-2" class="level4">
<h4>Question</h4>
<p>How do I generate a random <code>int</code> value in a specific range?</p>
<p>I have tried the following, but those do not work:</p>
<p><strong>Attempt 1:</strong></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true"></a>randomNum = minimum + (<span class="dt">int</span>)(<span class="bu">Math</span>.<span class="fu">random</span>() * maximum);</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true"></a><span class="co">// Bug: `randomNum` can be bigger than `maximum`.</span></span></code></pre></div>
<p><strong>Attempt 2:</strong></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true"></a><span class="bu">Random</span> rn = <span class="kw">new</span> <span class="bu">Random</span>();</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true"></a><span class="dt">int</span> n = maximum - minimum + <span class="dv">1</span>;</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true"></a><span class="dt">int</span> i = rn.<span class="fu">nextInt</span>() % n;</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true"></a>randomNum =  minimum + i;</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true"></a><span class="co">// Bug: `randomNum` can be smaller than `minimum`.</span></span></code></pre></div>
</section>
<section id="answer-2-score-3665" class="level4">
<h4>Answer 2 (score 3665)</h4>
<p>In <strong>Java 1.7 or later</strong>, the standard way to do this is as follows:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true"></a><span class="kw">import</span><span class="im"> java.util.concurrent.ThreadLocalRandom;</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true"></a><span class="co">// nextInt is normally exclusive of the top value,</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true"></a><span class="co">// so add 1 to make it inclusive</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true"></a><span class="dt">int</span> randomNum = ThreadLocalRandom.<span class="fu">current</span>().<span class="fu">nextInt</span>(min, max + <span class="dv">1</span>);</span></code></pre></div>
<p>See <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/ThreadLocalRandom.html
#nextInt(int,int)" rel="noreferrer">the relevant JavaDoc</a>. This approach has the advantage of not needing to explicitly initialize a <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Random.html" rel="noreferrer">java.util.Random</a> instance, which can be a source of confusion and error if used inappropriately.</p>
<p>However, conversely there is no way to explicitly set the seed so it can be difficult to reproduce results in situations where that is useful such as testing or saving game states or similar. In those situations, the pre-Java 1.7 technique shown below can be used.</p>
<p><strong>Before Java 1.7</strong>, the standard way to do this is as follows:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true"></a><span class="kw">import</span><span class="im"> java.util.Random;</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true"></a><span class="co">/**</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true"></a> <span class="co">*</span> Returns a pseudo<span class="co">-</span>random number between min and max<span class="co">,</span> inclusive<span class="co">.</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true"></a> <span class="co">*</span> The difference between min and max can be at most</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true"></a> <span class="co">*</span> <span class="kw">&lt;code&gt;</span>Integer<span class="co">.</span>MAX_VALUE <span class="co">-</span> <span class="co">1</span><span class="kw">&lt;/code&gt;</span><span class="co">.</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true"></a> <span class="co">*</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true"></a> <span class="co">*</span> <span class="an">@param min </span>Minimum value</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true"></a> <span class="co">*</span> <span class="an">@param max </span>Maximum value<span class="co">.</span>  Must be greater than min<span class="co">.</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true"></a> <span class="co">*</span> <span class="an">@return </span>Integer between min and max<span class="co">,</span> inclusive<span class="co">.</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true"></a> <span class="co">*</span> <span class="an">@see </span>java<span class="an">.</span>util<span class="an">.</span>Random</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true"></a><span class="co">#</span>nextInt<span class="co">(</span>int<span class="co">)</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true"></a> <span class="co">*/</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true"></a><span class="kw">public</span> <span class="dt">static</span> <span class="dt">int</span> <span class="fu">randInt</span>(<span class="dt">int</span> min, <span class="dt">int</span> max) {</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true"></a></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true"></a>    <span class="co">// </span><span class="al">NOTE</span><span class="co">: This will (intentionally) not run as written so that folks</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true"></a>    <span class="co">// copy-pasting have to think about how to initialize their</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true"></a>    <span class="co">// Random instance.  Initialization of the Random instance is outside</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true"></a>    <span class="co">// the main scope of the question, but some decent options are to have</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true"></a>    <span class="co">// a field that is initialized once and then re-used as needed or to</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true"></a>    <span class="co">// use ThreadLocalRandom (if using at least Java 1.7).</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true"></a>    <span class="co">// </span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true"></a>    <span class="co">// In particular, do NOT do &#39;Random rand = new Random()&#39; here or you</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true"></a>    <span class="co">// will get not very good / not very random results.</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true"></a>    <span class="bu">Random</span> rand;</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true"></a></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true"></a>    <span class="co">// nextInt is normally exclusive of the top value,</span></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true"></a>    <span class="co">// so add 1 to make it inclusive</span></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true"></a>    <span class="dt">int</span> randomNum = rand.<span class="fu">nextInt</span>((max - min) + <span class="dv">1</span>) + min;</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true"></a></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true"></a>    <span class="kw">return</span> randomNum;</span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true"></a>}</span></code></pre></div>
<p>See <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Random.html
#nextInt(int)" rel="noreferrer">the relevant JavaDoc</a>. In practice, the <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Random.html" rel="noreferrer">java.util.Random</a> class is often preferable to <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Math.html#random()" rel="noreferrer">java.lang.Math.random()</a>.</p>
<p>In particular, there is no need to reinvent the random integer generation wheel when there is a straightforward API within the standard library to accomplish the task.</p>
</section>
<section id="answer-3-score-1393" class="level4">
<h4>Answer 3 (score 1393)</h4>
<p>Note that this approach is more biased and less efficient than a <code>nextInt</code> approach, <a href="https://stackoverflow.com/a/738651/360211">https://stackoverflow.com/a/738651/360211</a></p>
<p>One standard pattern for accomplishing this is:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true"></a>Min + (<span class="dt">int</span>)(<span class="bu">Math</span>.<span class="fu">random</span>() * ((Max - Min) + <span class="dv">1</span>))</span></code></pre></div>
<p>The <a href="http://en.wikipedia.org/wiki/Java_%28programming_language%29" rel="noreferrer">Java</a> Math library function Math.random() generates a double value in the range <code>[0,1)</code>. Notice this range does not include the 1.</p>
<p>In order to get a specific range of values first, you need to multiply by the magnitude of the range of values you want covered.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true"></a><span class="bu">Math</span>.<span class="fu">random</span>() * ( Max - Min )</span></code></pre></div>
<p>This returns a value in the range <code>[0,Max-Min)</code>, where ‘Max-Min’ is not included.</p>
<p>For example, if you want <code>[5,10)</code>, you need to cover five integer values so you use</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true"></a><span class="bu">Math</span>.<span class="fu">random</span>() * <span class="dv">5</span></span></code></pre></div>
<p>This would return a value in the range <code>[0,5)</code>, where 5 is not included.</p>
<p>Now you need to shift this range up to the range that you are targeting. You do this by adding the Min value.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true"></a>Min + (<span class="bu">Math</span>.<span class="fu">random</span>() * (Max - Min))</span></code></pre></div>
<p>You now will get a value in the range <code>[Min,Max)</code>. Following our example, that means <code>[5,10)</code>:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true"></a><span class="dv">5</span> + (<span class="bu">Math</span>.<span class="fu">random</span>() * (<span class="dv">10</span> - <span class="dv">5</span>))</span></code></pre></div>
<p>But, this still doesn’t include <code>Max</code> and you are getting a double value. In order to get the <code>Max</code> value included, you need to add 1 to your range parameter <code>(Max - Min)</code> and then truncate the decimal part by casting to an int. This is accomplished via:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true"></a>Min + (<span class="dt">int</span>)(<span class="bu">Math</span>.<span class="fu">random</span>() * ((Max - Min) + <span class="dv">1</span>))</span></code></pre></div>
<p>And there you have it. A random integer value in the range <code>[Min,Max]</code>, or per the example <code>[5,10]</code>:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true"></a><span class="dv">5</span> + (<span class="dt">int</span>)(<span class="bu">Math</span>.<span class="fu">random</span>() * ((<span class="dv">10</span> - <span class="dv">5</span>) + <span class="dv">1</span>))</span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-to-split-a-string-in-java-score-3688160-in-2018" class="level3">
<h3>4: How to split a string in Java (score <a href="https://stackoverflow.com/q/3481828.html">3688160</a> in 2018)</h3>
<section id="question-3" class="level4">
<h4>Question</h4>
<p>I have a string, <code>"004-034556"</code>, that I want to split into two strings:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true"></a>string1=<span class="st">&quot;004&quot;</span>;</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true"></a>string2=<span class="st">&quot;034556&quot;</span>;</span></code></pre></div>
<p>That means the first string will contain the characters before <code>'-'</code>, and the second string will contain the characters after <code>'-'</code>. I also want to check if the string has <code>'-'</code> in it. If not, I will throw an exception. How can I do this?</p>
</section>
<section id="answer-accepted-score-2767" class="level4">
<h4>Answer accepted (score 2767)</h4>
<p>Just use the appropriate method: <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html
#split-java.lang.String-" rel="noreferrer"><code>String#split()</code></a>.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true"></a><span class="bu">String</span> string = <span class="st">&quot;004-034556&quot;</span>;</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true"></a><span class="bu">String</span>[] parts = string.<span class="fu">split</span>(<span class="st">&quot;-&quot;</span>);</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true"></a><span class="bu">String</span> part1 = parts[<span class="dv">0</span>]; <span class="co">// 004</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true"></a><span class="bu">String</span> part2 = parts[<span class="dv">1</span>]; <span class="co">// 034556</span></span></code></pre></div>
<p>Note that this takes a <a href="http://docs.oracle.com/javase/8/docs/api/java/util/regex/Pattern.html
#sum" rel="noreferrer">regular expression</a>, so remember to escape <a href="http://www.regular-expressions.info/characters.html" rel="noreferrer">special characters</a> if necessary.</p>
<blockquote>
<a href="http://www.regular-expressions.info/characters.html" rel="noreferrer">there</a> are 12 characters with special meanings: the backslash <code>\</code>, the caret <code>^</code>, the dollar sign <code>$</code>, the period or dot <code>.</code>, the vertical bar or pipe symbol <code>|</code>, the question mark <code>?</code>, the asterisk or star <code>*</code>, the plus sign <code>+</code>, the opening parenthesis <code>(</code>, the closing parenthesis <code>)</code>, and the opening square bracket <code>[</code>, the opening curly brace <code>{</code>, These special characters are often called “metacharacters”.
</blockquote>
<p>So, if you want to split on e.g. period/dot <code>.</code> which means “<a href="http://www.regular-expressions.info/dot.html" rel="noreferrer">any character</a>” in regex, use either <a href="http://www.regular-expressions.info/characters.html" rel="noreferrer">backslash <code>\</code></a> to escape the individual special character like so <code>split("\\.")</code>, or use <a href="http://www.regular-expressions.info/charclass.html" rel="noreferrer">character class <code>[]</code></a> to represent literal character(s) like so <code>split("[.]")</code>, or use <a href="http://docs.oracle.com/javase/8/docs/api/java/util/regex/Pattern.html
#quote-java.lang.String-" rel="noreferrer"><code>Pattern#quote()</code></a> to escape the entire string like so <code>split(Pattern.quote("."))</code>.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true"></a><span class="bu">String</span>[] parts = string.<span class="fu">split</span>(<span class="bu">Pattern</span>.<span class="fu">quote</span>(<span class="st">&quot;.&quot;</span>)); <span class="co">// Split on period.</span></span></code></pre></div>
<p>To test beforehand if the string contains certain character(s), just use <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html
#contains-java.lang.CharSequence-" rel="noreferrer"><code>String#contains()</code></a>.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true"></a><span class="kw">if</span> (string.<span class="fu">contains</span>(<span class="st">&quot;-&quot;</span>)) {</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true"></a>    <span class="co">// Split it.</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true"></a>} <span class="kw">else</span> {</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true"></a>    <span class="kw">throw</span> <span class="kw">new</span> <span class="bu">IllegalArgumentException</span>(<span class="st">&quot;String &quot;</span> + string + <span class="st">&quot; does not contain -&quot;</span>);</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true"></a>}</span></code></pre></div>
<p>Note, this does not take a regular expression. For that, use <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html
#matches-java.lang.String-" rel="noreferrer"><code>String#matches()</code></a> instead.</p>
<p>If you’d like to retain the split character in the resulting parts, then make use of <a href="http://www.regular-expressions.info/lookaround.html" rel="noreferrer">positive lookaround</a>. In case you want to have the split character to end up in left hand side, use positive lookbehind by prefixing <code>?&amp;lt;=</code> group on the pattern.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true"></a><span class="bu">String</span> string = <span class="st">&quot;004-034556&quot;</span>;</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true"></a><span class="bu">String</span>[] parts = string.<span class="fu">split</span>(<span class="st">&quot;(?&lt;=-)&quot;</span>);</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true"></a><span class="bu">String</span> part1 = parts[<span class="dv">0</span>]; <span class="co">// 004-</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true"></a><span class="bu">String</span> part2 = parts[<span class="dv">1</span>]; <span class="co">// 034556</span></span></code></pre></div>
<p>In case you want to have the split character to end up in right hand side, use positive lookahead by prefixing <code>?=</code> group on the pattern.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true"></a><span class="bu">String</span> string = <span class="st">&quot;004-034556&quot;</span>;</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true"></a><span class="bu">String</span>[] parts = string.<span class="fu">split</span>(<span class="st">&quot;(?=-)&quot;</span>);</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true"></a><span class="bu">String</span> part1 = parts[<span class="dv">0</span>]; <span class="co">// 004</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true"></a><span class="bu">String</span> part2 = parts[<span class="dv">1</span>]; <span class="co">// -034556</span></span></code></pre></div>
<p>If you’d like to limit the number of resulting parts, then you can supply the desired number as 2nd argument of <code>split()</code> method.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true"></a><span class="bu">String</span> string = <span class="st">&quot;004-034556-42&quot;</span>;</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true"></a><span class="bu">String</span>[] parts = string.<span class="fu">split</span>(<span class="st">&quot;-&quot;</span>, <span class="dv">2</span>);</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true"></a><span class="bu">String</span> part1 = parts[<span class="dv">0</span>]; <span class="co">// 004</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true"></a><span class="bu">String</span> part2 = parts[<span class="dv">1</span>]; <span class="co">// 034556-42</span></span></code></pre></div>
</section>
<section id="answer-2-score-72" class="level4">
<h4>Answer 2 (score 72)</h4>
<p>An alternative to processing the string directly would be to use a regular expression with capturing groups. This has the advantage that it makes it straightforward to imply more sophisticated constraints on the input. For example, the following splits the string into two parts, and ensures that both consist only of digits:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true"></a><span class="kw">import</span><span class="im"> java.util.regex.Pattern;</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true"></a><span class="kw">import</span><span class="im"> java.util.regex.Matcher;</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true"></a><span class="kw">class</span> SplitExample</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true"></a>{</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true"></a>    <span class="kw">private</span> <span class="dt">static</span> <span class="bu">Pattern</span> twopart = <span class="bu">Pattern</span>.<span class="fu">compile</span>(<span class="st">&quot;(</span><span class="sc">\\</span><span class="st">d+)-(</span><span class="sc">\\</span><span class="st">d+)&quot;</span>);</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true"></a></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">checkString</span>(<span class="bu">String</span> s)</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true"></a>    {</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true"></a>        <span class="bu">Matcher</span> m = twopart.<span class="fu">matcher</span>(s);</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true"></a>        <span class="kw">if</span> (m.<span class="fu">matches</span>()) {</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true"></a>            <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(s + <span class="st">&quot; matches; first part is &quot;</span> + m.<span class="fu">group</span>(<span class="dv">1</span>) +</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true"></a>                               <span class="st">&quot;, second part is &quot;</span> + m.<span class="fu">group</span>(<span class="dv">2</span>) + <span class="st">&quot;.&quot;</span>);</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true"></a>        } <span class="kw">else</span> {</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true"></a>            <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(s + <span class="st">&quot; does not match.&quot;</span>);</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true"></a>        }</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true"></a>    }</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true"></a></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span>(<span class="bu">String</span>[] args) {</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true"></a>        <span class="fu">checkString</span>(<span class="st">&quot;123-4567&quot;</span>);</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true"></a>        <span class="fu">checkString</span>(<span class="st">&quot;foo-bar&quot;</span>);</span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true"></a>        <span class="fu">checkString</span>(<span class="st">&quot;123-&quot;</span>);</span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true"></a>        <span class="fu">checkString</span>(<span class="st">&quot;-4567&quot;</span>);</span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true"></a>        <span class="fu">checkString</span>(<span class="st">&quot;123-4567-890&quot;</span>);</span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true"></a>    }</span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true"></a>}</span></code></pre></div>
<p>As the pattern is fixed in this instance, it can be compiled in advance and stored as a static member (initialised at class load time in the example). The regular expression is:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true"></a>(\d+)-(\d+)</span></code></pre></div>
<p>The parentheses denote the capturing groups; the string that matched that part of the regexp can be accessed by the Match.group() method, as shown. The  and single decimal digit, and the + means "match one or more of the previous expression). The - has no special meaning, so just matches that character in the input. Note that you need to double-escape the backslashes when writing this as a Java string. Some other examples:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true"></a>([A-Z]+)-([A-Z]+)          <span class="co">// Each part consists of only capital letters </span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true"></a>([^-]+)-([^-]+)            <span class="co">// Each part consists of characters other than -</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true"></a>([A-Z]{<span class="dv">2</span>})-(\d+)           <span class="co">// The first part is exactly two capital letters,</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true"></a>                           <span class="co">// the second consists of digits</span></span></code></pre></div>
</section>
<section id="answer-3-score-41" class="level4">
<h4>Answer 3 (score 41)</h4>
<div class="sourceCode" id="cb44"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true"></a><span class="bu">String</span>[] result = yourString.<span class="fu">split</span>(<span class="st">&quot;-&quot;</span>);</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true"></a><span class="kw">if</span> (result.<span class="fu">length</span> != <span class="dv">2</span>) </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true"></a>     <span class="kw">throw</span> <span class="kw">new</span> <span class="bu">IllegalArgumentException</span>(<span class="st">&quot;String not in correct format&quot;</span>);</span></code></pre></div>
<p>This will split your string into 2 parts. The first element in the array will be the part containing the stuff before the <code>-</code>, and the 2nd element in the array will contain the part of your string after the <code>-</code>.</p>
<p>If the array length is not 2, then the string was not in the format: <code>string-string</code>.</p>
<p>Check out the <code>split()</code> method in the <code>String</code> class.</p>
<blockquote>
<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html
#split-java.lang.String-int-" rel="noreferrer">https://docs.oracle.com/javase/8/docs/api/java/lang/String.html#split-java.lang.String-int-</a>
</blockquote>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="iterate-through-a-hashmap-score-3596326-in-2019" class="level3">
<h3>5: Iterate through a HashMap (score <a href="https://stackoverflow.com/q/1066589.html">3596326</a> in 2019)</h3>
<section id="question-4" class="level4">
<h4>Question</h4>
<blockquote>
<p>
<strong>Possible Duplicate:</strong> <br/> <a href="https://stackoverflow.com/questions/46898">How to efficiently iterate over each entry in a ‘Map’?</a>
</p>
</blockquote>
<p>What’s the best way to iterate over the items in a <a href="https://docs.oracle.com/javase/10/docs/api/java/util/HashMap.html" rel="nofollow noreferrer"><code>HashMap</code></a>?</p>
</section>
<section id="answer-accepted-score-3147" class="level4">
<h4>Answer accepted (score 3147)</h4>
<p>Iterate through the <a href="http://www.java2s.com/Code/JavaAPI/java.util/HashtableentrySet.htm" rel="noreferrer"><code>entrySet()</code></a> like so:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true"></a><span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">printMap</span>(<span class="bu">Map</span> mp) {</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true"></a>    <span class="bu">Iterator</span> it = mp.<span class="fu">entrySet</span>().<span class="fu">iterator</span>();</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true"></a>    <span class="kw">while</span> (it.<span class="fu">hasNext</span>()) {</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true"></a>        <span class="bu">Map</span>.<span class="fu">Entry</span> pair = (<span class="bu">Map</span>.<span class="fu">Entry</span>)it.<span class="fu">next</span>();</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true"></a>        <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(pair.<span class="fu">getKey</span>() + <span class="st">&quot; = &quot;</span> + pair.<span class="fu">getValue</span>());</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true"></a>        it.<span class="fu">remove</span>(); <span class="co">// avoids a ConcurrentModificationException</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true"></a>    }</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true"></a>}</span></code></pre></div>
<p>Read more about <a href="http://docs.oracle.com/javase/7/docs/api/java/util/Map.html" rel="noreferrer"><code>Map</code></a>.</p>
</section>
<section id="answer-2-score-4558" class="level4">
<h4>Answer 2 (score 4558)</h4>
<p>If you’re only interested in the keys, you can iterate through the <a href="https://docs.oracle.com/javase/1.5.0/docs/api/java/util/Map.html
#keySet%28%29" rel="nofollow noreferrer"><code>keySet()</code></a> of the map:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true"></a><span class="bu">Map</span>&lt;<span class="bu">String</span>, <span class="bu">Object</span>&gt; map = ...;</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true"></a><span class="kw">for</span> (<span class="bu">String</span> key : map.<span class="fu">keySet</span>()) {</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true"></a>    <span class="co">// ...</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true"></a>}</span></code></pre></div>
<p>If you only need the values, use <a href="https://docs.oracle.com/javase/1.5.0/docs/api/java/util/Map.html
#values%28%29" rel="nofollow noreferrer"><code>values()</code></a>:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true"></a><span class="kw">for</span> (<span class="bu">Object</span> value : map.<span class="fu">values</span>()) {</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true"></a>    <span class="co">// ...</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true"></a>}</span></code></pre></div>
<p>Finally, if you want both the key and value, use <a href="https://docs.oracle.com/javase/1.5.0/docs/api/java/util/Map.html
#entrySet%28%29" rel="nofollow noreferrer"><code>entrySet()</code></a>:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true"></a><span class="kw">for</span> (<span class="bu">Map</span>.<span class="fu">Entry</span>&lt;<span class="bu">String</span>, <span class="bu">Object</span>&gt; entry : map.<span class="fu">entrySet</span>()) {</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true"></a>    <span class="bu">String</span> key = entry.<span class="fu">getKey</span>();</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true"></a>    <span class="bu">Object</span> value = entry.<span class="fu">getValue</span>();</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true"></a>    <span class="co">// ...</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true"></a>}</span></code></pre></div>
<p>One caveat: if you want to remove items mid-iteration, you’ll need to do so via an Iterator (see <a href="https://stackoverflow.com/questions/1066589/java-iterate-through-hashmap/1066603
#1066603">karim79’s answer</a>). However, changing item values is OK (see <a href="https://docs.oracle.com/javase/6/docs/api/java/util/Map.Entry.html" rel="nofollow noreferrer"><code>Map.Entry</code></a>).</p>
</section>
<section id="answer-3-score-818" class="level4">
<h4>Answer 3 (score 818)</h4>
<p>Extracted from the reference <em><a href="http://www.sergiy.ca/how-to-iterate-over-a-map-in-java">How to Iterate Over a Map in Java</a></em>:</p>
<p>There are several ways of iterating over a <code>Map</code> in Java. Let’s go over the most common methods and review their advantages and disadvantages. Since all maps in Java implement the Map interface, the following techniques will work for any map implementation (<code>HashMap</code>, <code>TreeMap</code>, <code>LinkedHashMap</code>, <code>Hashtable</code>, etc.)</p>
<p><strong>Method #1</strong>: Iterating over entries using a For-Each loop.</p>
<p>This is the most common method and is preferable in most cases. It should be used if you need both map keys and values in the loop.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true"></a><span class="bu">Map</span>&lt;<span class="bu">Integer</span>, <span class="bu">Integer</span>&gt; map = <span class="kw">new</span> <span class="bu">HashMap</span>&lt;<span class="bu">Integer</span>, <span class="bu">Integer</span>&gt;();</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true"></a><span class="kw">for</span> (<span class="bu">Map</span>.<span class="fu">Entry</span>&lt;<span class="bu">Integer</span>, <span class="bu">Integer</span>&gt; entry : map.<span class="fu">entrySet</span>()) {</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true"></a>    <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;Key = &quot;</span> + entry.<span class="fu">getKey</span>() + <span class="st">&quot;, Value = &quot;</span> + entry.<span class="fu">getValue</span>());</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true"></a>}</span></code></pre></div>
<p>Note that the For-Each loop was introduced in Java 5, so this method is working only in newer versions of the language. Also a For-Each loop will throw <code>NullPointerException</code> if you try to iterate over a map that is null, so before iterating you should always check for null references.</p>
<p><strong>Method #2</strong>: Iterating over keys or values using a For-Each loop.</p>
<p>If you need only keys or values from the map, you can iterate over keySet or values instead of entrySet.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true"></a><span class="bu">Map</span>&lt;<span class="bu">Integer</span>, <span class="bu">Integer</span>&gt; map = <span class="kw">new</span> <span class="bu">HashMap</span>&lt;<span class="bu">Integer</span>, <span class="bu">Integer</span>&gt;();</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true"></a><span class="co">// Iterating over keys only</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true"></a><span class="kw">for</span> (<span class="bu">Integer</span> key : map.<span class="fu">keySet</span>()) {</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true"></a>    <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;Key = &quot;</span> + key);</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true"></a>}</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true"></a></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true"></a><span class="co">// Iterating over values only</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true"></a><span class="kw">for</span> (<span class="bu">Integer</span> value : map.<span class="fu">values</span>()) {</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true"></a>    <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;Value = &quot;</span> + value);</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true"></a>}</span></code></pre></div>
<p>This method gives a slight performance advantage over <code>entrySet</code> iteration (about 10% faster) and is more clean.</p>
<p><strong>Method #3</strong>: Iterating using Iterator.</p>
<p>Using Generics:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true"></a><span class="bu">Map</span>&lt;<span class="bu">Integer</span>, <span class="bu">Integer</span>&gt; map = <span class="kw">new</span> <span class="bu">HashMap</span>&lt;<span class="bu">Integer</span>, <span class="bu">Integer</span>&gt;();</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true"></a><span class="bu">Iterator</span>&lt;<span class="bu">Map</span>.<span class="fu">Entry</span>&lt;<span class="bu">Integer</span>, <span class="bu">Integer</span>&gt;&gt; entries = map.<span class="fu">entrySet</span>().<span class="fu">iterator</span>();</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true"></a><span class="kw">while</span> (entries.<span class="fu">hasNext</span>()) {</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true"></a>    <span class="bu">Map</span>.<span class="fu">Entry</span>&lt;<span class="bu">Integer</span>, <span class="bu">Integer</span>&gt; entry = entries.<span class="fu">next</span>();</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true"></a>    <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;Key = &quot;</span> + entry.<span class="fu">getKey</span>() + <span class="st">&quot;, Value = &quot;</span> + entry.<span class="fu">getValue</span>());</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true"></a>}</span></code></pre></div>
<p>Without Generics:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true"></a><span class="bu">Map</span> map = <span class="kw">new</span> <span class="bu">HashMap</span>();</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true"></a><span class="bu">Iterator</span> entries = map.<span class="fu">entrySet</span>().<span class="fu">iterator</span>();</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true"></a><span class="kw">while</span> (entries.<span class="fu">hasNext</span>()) {</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true"></a>    <span class="bu">Map</span>.<span class="fu">Entry</span> entry = (<span class="bu">Map</span>.<span class="fu">Entry</span>) entries.<span class="fu">next</span>();</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true"></a>    <span class="bu">Integer</span> key = (<span class="bu">Integer</span>)entry.<span class="fu">getKey</span>();</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true"></a>    <span class="bu">Integer</span> value = (<span class="bu">Integer</span>)entry.<span class="fu">getValue</span>();</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true"></a>    <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;Key = &quot;</span> + key + <span class="st">&quot;, Value = &quot;</span> + value);</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true"></a>}</span></code></pre></div>
<p>You can also use same technique to iterate over <code>keySet</code> or values.</p>
<p>This method might look redundant, but it has its own advantages. First of all, it is the only way to iterate over a map in older versions of Java. The other important feature is that it is the only method that allows you to remove entries from the map during iteration by calling <code>iterator.remove()</code>. If you try to do this during For-Each iteration you will get “unpredictable results” according to <a href="https://en.wikipedia.org/wiki/Javadoc">Javadoc</a>.</p>
<p>From a performance point of view this method is equal to a For-Each iteration.</p>
<p><strong>Method #4</strong>: Iterating over keys and searching for values (inefficient).</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true"></a><span class="bu">Map</span>&lt;<span class="bu">Integer</span>, <span class="bu">Integer</span>&gt; map = <span class="kw">new</span> <span class="bu">HashMap</span>&lt;<span class="bu">Integer</span>, <span class="bu">Integer</span>&gt;();</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true"></a><span class="kw">for</span> (<span class="bu">Integer</span> key : map.<span class="fu">keySet</span>()) {</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true"></a>    <span class="bu">Integer</span> value = map.<span class="fu">get</span>(key);</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true"></a>    <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;Key = &quot;</span> + key + <span class="st">&quot;, Value = &quot;</span> + value);</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true"></a>}</span></code></pre></div>
<p>This might look like a cleaner alternative for method #1, but in practice it is pretty slow and inefficient as getting values by a key might be time-consuming (this method in different Map implementations is 20%-200% slower than method #1). If you have FindBugs installed, it will detect this and warn you about inefficient iteration. This method should be avoided.</p>
<p><strong>Conclusion:</strong></p>
<p>If you need only keys or values from the map, use method #2. If you are stuck with older version of Java (less than 5) or planning to remove entries during iteration, you have to use method #3. Otherwise use method #1.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="initialization-of-an-arraylist-in-one-line-score-2834764-in-2014" class="level3">
<h3>6: Initialization of an ArrayList in one line (score <a href="https://stackoverflow.com/q/1005073.html">2834764</a> in 2014)</h3>
<section id="question-5" class="level4">
<h4>Question</h4>
<p>I want to create a list of options for testing purposes. At first, I did this:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true"></a><span class="bu">ArrayList</span>&lt;<span class="bu">String</span>&gt; places = <span class="kw">new</span> <span class="bu">ArrayList</span>&lt;<span class="bu">String</span>&gt;();</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true"></a>places.<span class="fu">add</span>(<span class="st">&quot;Buenos Aires&quot;</span>);</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true"></a>places.<span class="fu">add</span>(<span class="st">&quot;Córdoba&quot;</span>);</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true"></a>places.<span class="fu">add</span>(<span class="st">&quot;La Plata&quot;</span>);</span></code></pre></div>
<p>Then I refactored the code as follows:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true"></a><span class="bu">ArrayList</span>&lt;<span class="bu">String</span>&gt; places = <span class="kw">new</span> <span class="bu">ArrayList</span>&lt;<span class="bu">String</span>&gt;(</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true"></a>    <span class="bu">Arrays</span>.<span class="fu">asList</span>(<span class="st">&quot;Buenos Aires&quot;</span>, <span class="st">&quot;Córdoba&quot;</span>, <span class="st">&quot;La Plata&quot;</span>));</span></code></pre></div>
<p>Is there a better way to do this?</p>
</section>
<section id="answer-accepted-score-1911" class="level4">
<h4>Answer accepted (score 1911)</h4>
<p>Actually, probably the “best” way to initialize the <code>ArrayList</code> is the method you wrote, as it does not need to create a new <code>List</code> in any way:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true"></a><span class="bu">ArrayList</span>&lt;<span class="bu">String</span>&gt; list = <span class="kw">new</span> <span class="bu">ArrayList</span>&lt;<span class="bu">String</span>&gt;();</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true"></a>list.<span class="fu">add</span>(<span class="st">&quot;A&quot;</span>);</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true"></a>list.<span class="fu">add</span>(<span class="st">&quot;B&quot;</span>);</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true"></a>list.<span class="fu">add</span>(<span class="st">&quot;C&quot;</span>);</span></code></pre></div>
<p>The catch is that there is quite a bit of typing required to refer to that <code>list</code> instance.</p>
<p>There are alternatives, such as making an anonymous inner class with an instance initializer (also known as an “double brace initialization”):</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true"></a><span class="bu">ArrayList</span>&lt;<span class="bu">String</span>&gt; list = <span class="kw">new</span> <span class="bu">ArrayList</span>&lt;<span class="bu">String</span>&gt;() {{</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true"></a>    <span class="fu">add</span>(<span class="st">&quot;A&quot;</span>);</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true"></a>    <span class="fu">add</span>(<span class="st">&quot;B&quot;</span>);</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true"></a>    <span class="fu">add</span>(<span class="st">&quot;C&quot;</span>);</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true"></a>}};</span></code></pre></div>
<p>However, I’m not too fond of that method because what you end up with is a subclass of <code>ArrayList</code> which has an instance initializer, and that class is created just to create one object – that just seems like a little bit overkill to me.</p>
<p>What would have been nice was if the <a href="http://mail.openjdk.java.net/pipermail/coin-dev/2009-March/001193.html" rel="noreferrer">Collection Literals proposal</a> for <a href="http://openjdk.java.net/projects/coin" rel="noreferrer">Project Coin</a> was accepted (it was slated to be introduced in Java 7, but it’s not likely to be part of Java 8 either.):</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true"></a><span class="bu">List</span>&lt;<span class="bu">String</span>&gt; list = [<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>];</span></code></pre></div>
<p>Unfortunately it won’t help you here, as it will initialize an immutable <code>List</code> rather than an <code>ArrayList</code>, and furthermore, it’s not available yet, if it ever will be.</p>
</section>
<section id="answer-2-score-2033" class="level4">
<h4>Answer 2 (score 2033)</h4>
<p>It would be simpler if you were to just declare it as a <code>List</code> - does it have to be an ArrayList?</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true"></a><span class="bu">List</span>&lt;<span class="bu">String</span>&gt; places = <span class="bu">Arrays</span>.<span class="fu">asList</span>(<span class="st">&quot;Buenos Aires&quot;</span>, <span class="st">&quot;Córdoba&quot;</span>, <span class="st">&quot;La Plata&quot;</span>);</span></code></pre></div>
<p>Or if you have only one element:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true"></a><span class="bu">List</span>&lt;<span class="bu">String</span>&gt; places = <span class="bu">Collections</span>.<span class="fu">singletonList</span>(<span class="st">&quot;Buenos Aires&quot;</span>);</span></code></pre></div>
<p>This would mean that <code>places</code> is <strong>immutable</strong> (trying to change it will cause an <code>UnsupportedOperationException</code> exception to be thrown).</p>
<p>To make a mutable list that is a concrete <code>ArrayList</code> you can create an <code>ArrayList</code> from the immutable list:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true"></a><span class="bu">ArrayList</span>&lt;<span class="bu">String</span>&gt; places = <span class="kw">new</span> <span class="bu">ArrayList</span>&lt;&gt;(<span class="bu">Arrays</span>.<span class="fu">asList</span>(<span class="st">&quot;Buenos Aires&quot;</span>, <span class="st">&quot;Córdoba&quot;</span>, <span class="st">&quot;La Plata&quot;</span>));</span></code></pre></div>
</section>
<section id="answer-3-score-796" class="level4">
<h4>Answer 3 (score 796)</h4>
<h5>
The simple answer
</h1>
<p>In Java 10, 11, 12, or later:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true"></a>var strings = <span class="bu">List</span>.<span class="fu">of</span>(<span class="st">&quot;foo&quot;</span>, <span class="st">&quot;bar&quot;</span>, <span class="st">&quot;baz&quot;</span>);</span></code></pre></div>
<p>In Java 9 or later:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true"></a><span class="bu">List</span>&lt;<span class="bu">String</span>&gt; strings = <span class="bu">List</span>.<span class="fu">of</span>(<span class="st">&quot;foo&quot;</span>, <span class="st">&quot;bar&quot;</span>, <span class="st">&quot;baz&quot;</span>);</span></code></pre></div>
<p>
This will give you an immutable <code>List</code>, so it cannot be changed.<br> Which is what you want in most cases where you’re prepopulating it.
</p>
<hr>
<h5>
Java 8 or earlier:
</h1>
<div class="sourceCode" id="cb64"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true"></a><span class="bu">List</span>&lt;<span class="bu">String</span>&gt; strings = <span class="bu">Arrays</span>.<span class="fu">asList</span>(<span class="st">&quot;foo&quot;</span>, <span class="st">&quot;bar&quot;</span>, <span class="st">&quot;baz&quot;</span>);</span></code></pre></div>
<p>
This will give you a <code>List</code> backed by the array, so it cannot change length.<br> But you can call <code>List.set</code>, so it’s still mutable.
</p>
<hr>
<p>You can make <code>Arrays.asList</code> even shorter with a static import:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true"></a><span class="bu">List</span>&lt;<span class="bu">String</span>&gt; strings = <span class="fu">asList</span>(<span class="st">&quot;foo&quot;</span>, <span class="st">&quot;bar&quot;</span>, <span class="st">&quot;baz&quot;</span>);</span></code></pre></div>
<p>The static import:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true"></a><span class="kw">import static</span><span class="im"> java.util.Arrays.asList;</span>  </span></code></pre></div>
<p>
Which any modern IDE will suggest and automatically do for you.<br> For example in IntelliJ IDEA you press <code>Alt+Enter</code> and select <code>Static import method...</code>.
</p>
<hr>
<p>
However, i don’t recommend shortening the Java 9 <code>List.of</code> method, because having just <code>of</code> becomes confusing.<br> <code>List.of</code> is already short enough and reads well.
</p>
<hr>
<h5>
Using <code>Stream</code>s
</h1>
<p>
Why does it have to be a <code>List</code>?<br> With Java 8 or later you can use a <code>Stream</code> which is more flexible:
</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true"></a>Stream&lt;<span class="bu">String</span>&gt; strings = Stream.<span class="fu">of</span>(<span class="st">&quot;foo&quot;</span>, <span class="st">&quot;bar&quot;</span>, <span class="st">&quot;baz&quot;</span>);</span></code></pre></div>
<p>You can concatenate <code>Stream</code>s:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true"></a>Stream&lt;<span class="bu">String</span>&gt; strings = Stream.<span class="fu">concat</span>(Stream.<span class="fu">of</span>(<span class="st">&quot;foo&quot;</span>, <span class="st">&quot;bar&quot;</span>),</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true"></a>                                       Stream.<span class="fu">of</span>(<span class="st">&quot;baz&quot;</span>, <span class="st">&quot;qux&quot;</span>));</span></code></pre></div>
<p>Or you can go from a <code>Stream</code> to a <code>List</code>:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true"></a><span class="kw">import static</span><span class="im"> java.util.stream.Collectors.toList;</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true"></a></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true"></a><span class="bu">List</span>&lt;<span class="bu">String</span>&gt; strings = Stream.<span class="fu">of</span>(<span class="st">&quot;foo&quot;</span>, <span class="st">&quot;bar&quot;</span>, <span class="st">&quot;baz&quot;</span>).<span class="fu">collect</span>(<span class="fu">toList</span>());</span></code></pre></div>
<p>But preferably, just use the <code>Stream</code> without collecting it to a <code>List</code>.</p>
<hr>
<h5>
If you <em>really</em> specifically need a <code>java.util.ArrayList</code>
</h1>
<p>
(You probably don’t.)<br> To quote <a href="http://openjdk.java.net/jeps/269" rel="noreferrer">JEP 269</a> (emphasis mine):
</p>
<blockquote>
There is a <strong>small set</strong> of use cases for initializing a mutable collection instance with a predefined set of values. It’s usually preferable to have those predefined values be in an immutable collection, and then to initialize the mutable collection via a copy constructor.
</blockquote>
<hr>
<p>If you want to <em>both</em> prepopulate an <code>ArrayList</code> <em>and</em> add to it afterwards (why?), use</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true"></a><span class="bu">ArrayList</span>&lt;<span class="bu">String</span>&gt; strings = <span class="kw">new</span> <span class="bu">ArrayList</span>&lt;&gt;(<span class="bu">List</span>.<span class="fu">of</span>(<span class="st">&quot;foo&quot;</span>, <span class="st">&quot;bar&quot;</span>));</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true"></a>strings.<span class="fu">add</span>(<span class="st">&quot;baz&quot;</span>);</span></code></pre></div>
<p>or in Java 8 or earlier:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true"></a><span class="bu">ArrayList</span>&lt;<span class="bu">String</span>&gt; strings = <span class="kw">new</span> <span class="bu">ArrayList</span>&lt;&gt;(<span class="fu">asList</span>(<span class="st">&quot;foo&quot;</span>, <span class="st">&quot;bar&quot;</span>));</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true"></a>strings.<span class="fu">add</span>(<span class="st">&quot;baz&quot;</span>);</span></code></pre></div>
<p>or using <code>Stream</code>:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true"></a><span class="kw">import static</span><span class="im"> java.util.stream.Collectors.toCollection;</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true"></a></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true"></a><span class="bu">ArrayList</span>&lt;<span class="bu">String</span>&gt; strings = Stream.<span class="fu">of</span>(<span class="st">&quot;foo&quot;</span>, <span class="st">&quot;bar&quot;</span>)</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true"></a>                             .<span class="fu">collect</span>(<span class="fu">toCollection</span>(<span class="bu">ArrayList</span>::<span class="kw">new</span>));</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true"></a>strings.<span class="fu">add</span>(<span class="st">&quot;baz&quot;</span>);</span></code></pre></div>
<p>But again, it’s better to just use the <code>Stream</code> directly instead of collecting it to a <code>List</code>.</p>
<hr>
<h5>
Program to interfaces, not to implementations
</h1>
<p>You said you’ve declared the list as an <code>ArrayList</code> in your code, but you should only do that if you’re using some member of <code>ArrayList</code> that’s not in <code>List</code>.</p>
<p>Which you are most likely not doing.</p>
<p>Usually you should just declare variables by the most general interface that you are going to use (e.g. <code>Iterable</code>, <code>Collection</code>, or <code>List</code>), and initialize them with the specific implementation (e.g. <code>ArrayList</code>, <code>LinkedList</code> or <code>Arrays.asList()</code>).</p>
<p>Otherwise you’re limiting your code to that specific type, and it’ll be harder to change when you want to.</p>
<p>For example, if you’re passing an <code>ArrayList</code> to a <code>void method(...)</code>:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true"></a><span class="co">// Iterable if you just need iteration, for (String s : strings):</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true"></a><span class="dt">void</span> <span class="fu">method</span>(<span class="bu">Iterable</span>&lt;<span class="bu">String</span>&gt; strings) { </span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true"></a>    <span class="kw">for</span> (<span class="bu">String</span> s : strings) { <span class="kw">... </span>} </span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true"></a>}</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true"></a></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true"></a><span class="co">// Collection if you also need .size(), .isEmpty(), or .stream():</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true"></a><span class="dt">void</span> <span class="fu">method</span>(<span class="bu">Collection</span>&lt;<span class="bu">String</span>&gt; strings) {</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true"></a>    <span class="kw">if</span> (!strings.<span class="fu">isEmpty</span>()) { strings.<span class="fu">stream</span>()<span class="kw">... </span>}</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true"></a>}</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true"></a></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true"></a><span class="co">// List if you also need .get(index):</span></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true"></a><span class="dt">void</span> <span class="fu">method</span>(<span class="bu">List</span>&lt;<span class="bu">String</span>&gt; strings) {</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true"></a>    strings.<span class="fu">get</span>(...)</span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true"></a>}</span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true"></a></span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true"></a><span class="co">// Don&#39;t declare a specific list implementation</span></span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true"></a><span class="co">// unless you&#39;re sure you need it:</span></span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true"></a><span class="dt">void</span> <span class="fu">method</span>(<span class="bu">ArrayList</span>&lt;<span class="bu">String</span>&gt; strings) {</span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true"></a>    ??? <span class="co">// You don&#39;t want to limit yourself to just ArrayList</span></span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true"></a>}</span></code></pre></div>
<hr>
<p>Another example would be always declaring variable an <code>InputStream</code> even though it is usually a <code>FileInputStream</code> or a <code>BufferedInputStream</code>, because one day soon you or somebody else will want to use some other kind of <code>InputStream</code>.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-do-i-create-a-file-and-write-to-it-in-java-score-2755644-in-2017" class="level3">
<h3>7: How do I create a file and write to it in Java? (score <a href="https://stackoverflow.com/q/2885173.html">2755644</a> in 2017)</h3>
<section id="question-6" class="level4">
<h4>Question</h4>
<p>What’s the simplest way to create and write to a (text) file in Java?</p>
</section>
<section id="answer-accepted-score-1656" class="level4">
<h4>Answer accepted (score 1656)</h4>
<p><em>Note that each of the code samples below may throw <code>IOException</code>. Try/catch/finally blocks have been omitted for brevity. See <a href="https://docs.oracle.com/javase/tutorial/essential/exceptions/handling.html" rel="noreferrer">this tutorial</a> for information about exception handling.</em></p>
<p><em>Note that each of the code samples below will overwrite the file if it already exists</em></p>
<p>Creating a text file:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true"></a><span class="bu">PrintWriter</span> writer = <span class="kw">new</span> <span class="bu">PrintWriter</span>(<span class="st">&quot;the-file-name.txt&quot;</span>, <span class="st">&quot;UTF-8&quot;</span>);</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true"></a>writer.<span class="fu">println</span>(<span class="st">&quot;The first line&quot;</span>);</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true"></a>writer.<span class="fu">println</span>(<span class="st">&quot;The second line&quot;</span>);</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true"></a>writer.<span class="fu">close</span>();</span></code></pre></div>
<p>Creating a binary file:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true"></a><span class="dt">byte</span> data[] = ...</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true"></a><span class="bu">FileOutputStream</span> out = <span class="kw">new</span> <span class="bu">FileOutputStream</span>(<span class="st">&quot;the-file-name&quot;</span>);</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true"></a>out.<span class="fu">write</span>(data);</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true"></a>out.<span class="fu">close</span>();</span></code></pre></div>
<p><strong>Java 7+</strong> users can use the <a href="http://docs.oracle.com/javase/7/docs/api/index.html?java/nio/file/Files.html" rel="noreferrer"><code>Files</code></a> class to write to files:</p>
<p>Creating a text file:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true"></a><span class="bu">List</span>&lt;<span class="bu">String</span>&gt; lines = <span class="bu">Arrays</span>.<span class="fu">asList</span>(<span class="st">&quot;The first line&quot;</span>, <span class="st">&quot;The second line&quot;</span>);</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true"></a>Path file = Paths.<span class="fu">get</span>(<span class="st">&quot;the-file-name.txt&quot;</span>);</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true"></a>Files.<span class="fu">write</span>(file, lines, StandardCharsets.<span class="fu">UTF_8</span>);</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true"></a><span class="co">//Files.write(file, lines, StandardCharsets.UTF_8, StandardOpenOption.APPEND);</span></span></code></pre></div>
<p>Creating a binary file:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true"></a><span class="dt">byte</span> data[] = ...</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true"></a>Path file = Paths.<span class="fu">get</span>(<span class="st">&quot;the-file-name&quot;</span>);</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true"></a>Files.<span class="fu">write</span>(file, data);</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true"></a><span class="co">//Files.write(file, data, StandardOpenOption.APPEND);</span></span></code></pre></div>
</section>
<section id="answer-2-score-400" class="level4">
<h4>Answer 2 (score 400)</h4>
<p>In Java 7 and up:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true"></a><span class="kw">try</span> (<span class="bu">Writer</span> writer = <span class="kw">new</span> <span class="bu">BufferedWriter</span>(<span class="kw">new</span> <span class="bu">OutputStreamWriter</span>(</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true"></a>              <span class="kw">new</span> <span class="bu">FileOutputStream</span>(<span class="st">&quot;filename.txt&quot;</span>), <span class="st">&quot;utf-8&quot;</span>))) {</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true"></a>   writer.<span class="fu">write</span>(<span class="st">&quot;something&quot;</span>);</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true"></a>}</span></code></pre></div>
<p>There are useful utilities for that though:</p>
<ul>
<li>
<a href="https://commons.apache.org/proper/commons-io/javadocs/api-release/org/apache/commons/io/FileUtils.html
#writeStringToFile(java.io.File,%20java.lang.String,%20java.nio.charset.Charset)" rel="noreferrer">FileUtils.writeStringtoFile(..)</a> from commons-io
</li>
<li>
<a href="http://google.github.io/guava/releases/19.0/api/docs/com/google/common/io/Files.html
#write(java.lang.CharSequence,%20java.io.File,%20java.nio.charset.Charset)" rel="noreferrer">Files.write(..)</a> from guava
</li>
</ul>
<p>Note also that you <em>can</em> use a <code>FileWriter</code>, but it uses the default encoding, which is often a bad idea - it’s best to specify the encoding explicitly.</p>
<p>Below is the original, prior-to-Java 7 answer</p>
<hr>
<div class="sourceCode" id="cb79"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true"></a><span class="bu">Writer</span> writer = <span class="kw">null</span>;</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true"></a></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true"></a><span class="kw">try</span> {</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true"></a>    writer = <span class="kw">new</span> <span class="bu">BufferedWriter</span>(<span class="kw">new</span> <span class="bu">OutputStreamWriter</span>(</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true"></a>          <span class="kw">new</span> <span class="bu">FileOutputStream</span>(<span class="st">&quot;filename.txt&quot;</span>), <span class="st">&quot;utf-8&quot;</span>));</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true"></a>    writer.<span class="fu">write</span>(<span class="st">&quot;Something&quot;</span>);</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true"></a>} <span class="kw">catch</span> (<span class="bu">IOException</span> ex) {</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true"></a>    <span class="co">// Report</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true"></a>} <span class="kw">finally</span> {</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true"></a>   <span class="kw">try</span> {writer.<span class="fu">close</span>();} <span class="kw">catch</span> (<span class="bu">Exception</span> ex) {<span class="co">/*ignore*/</span>}</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true"></a>}</span></code></pre></div>
<p>See also: <a href="http://docs.oracle.com/javase/tutorial/essential/io/file.html" rel="noreferrer">Reading, Writing, and Creating Files</a> (includes NIO2).</p>
</section>
<section id="answer-3-score-127" class="level4">
<h4>Answer 3 (score 127)</h4>
<p>If you already have the content you want to write to the file (and not generated on the fly), the <a href="https://docs.oracle.com/javase/7/docs/api/java/nio/file/Files.html"><code>java.nio.file.Files</code></a> addition in Java 7 as part of native I/O provides the simplest and most efficient way to achieve your goals.</p>
<p>Basically creating and writing to a file is one line only, moreover <strong>one simple method call</strong>!</p>
<p>The following example creates and writes to 6 different files to showcase how it can be used:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true"></a><span class="bu">Charset</span> utf8 = StandardCharsets.<span class="fu">UTF_8</span>;</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true"></a><span class="bu">List</span>&lt;<span class="bu">String</span>&gt; lines = <span class="bu">Arrays</span>.<span class="fu">asList</span>(<span class="st">&quot;1st line&quot;</span>, <span class="st">&quot;2nd line&quot;</span>);</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true"></a><span class="dt">byte</span>[] data = {<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>};</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true"></a></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true"></a><span class="kw">try</span> {</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true"></a>    Files.<span class="fu">write</span>(Paths.<span class="fu">get</span>(<span class="st">&quot;file1.bin&quot;</span>), data);</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true"></a>    Files.<span class="fu">write</span>(Paths.<span class="fu">get</span>(<span class="st">&quot;file2.bin&quot;</span>), data,</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true"></a>            StandardOpenOption.<span class="fu">CREATE</span>, StandardOpenOption.<span class="fu">APPEND</span>);</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true"></a>    Files.<span class="fu">write</span>(Paths.<span class="fu">get</span>(<span class="st">&quot;file3.txt&quot;</span>), <span class="st">&quot;content&quot;</span>.<span class="fu">getBytes</span>());</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true"></a>    Files.<span class="fu">write</span>(Paths.<span class="fu">get</span>(<span class="st">&quot;file4.txt&quot;</span>), <span class="st">&quot;content&quot;</span>.<span class="fu">getBytes</span>(utf8));</span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true"></a>    Files.<span class="fu">write</span>(Paths.<span class="fu">get</span>(<span class="st">&quot;file5.txt&quot;</span>), lines, utf8);</span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true"></a>    Files.<span class="fu">write</span>(Paths.<span class="fu">get</span>(<span class="st">&quot;file6.txt&quot;</span>), lines, utf8,</span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true"></a>            StandardOpenOption.<span class="fu">CREATE</span>, StandardOpenOption.<span class="fu">APPEND</span>);</span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true"></a>} <span class="kw">catch</span> (<span class="bu">IOException</span> e) {</span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true"></a>    e.<span class="fu">printStackTrace</span>();</span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true"></a>}</span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-does-the-java-for-each-loop-work-score-2503583-in-2018" class="level3">
<h3>8: How does the Java ‘for each’ loop work? (score <a href="https://stackoverflow.com/q/85190.html">2503583</a> in 2018)</h3>
<section id="question-7" class="level4">
<h4>Question</h4>
<p>Consider:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true"></a><span class="bu">List</span>&lt;<span class="bu">String</span>&gt; someList = <span class="kw">new</span> <span class="bu">ArrayList</span>&lt;<span class="bu">String</span>&gt;();</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true"></a><span class="co">// add &quot;monkey&quot;, &quot;donkey&quot;, &quot;skeleton key&quot; to someList</span></span></code></pre></div>
<div class="sourceCode" id="cb82"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true"></a><span class="kw">for</span> (<span class="bu">String</span> item : someList) {</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true"></a>    <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(item);</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true"></a>}</span></code></pre></div>
<p>What would the equivalent <code>for</code> loop look like without using the <em>for each</em> syntax?</p>
</section>
<section id="answer-accepted-score-1123" class="level4">
<h4>Answer accepted (score 1123)</h4>
<div class="sourceCode" id="cb83"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true"></a><span class="kw">for</span> (<span class="bu">Iterator</span>&lt;<span class="bu">String</span>&gt; i = someIterable.<span class="fu">iterator</span>(); i.<span class="fu">hasNext</span>();) {</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true"></a>    <span class="bu">String</span> item = i.<span class="fu">next</span>();</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true"></a>    <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(item);</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true"></a>}</span></code></pre></div>
<p>Note that if you need to use <code>i.remove();</code> in your loop, or access the actual iterator in some way, you cannot use the <code>for ( : )</code> idiom, since the actual iterator is merely inferred.</p>
<p>As was noted by Denis Bueno, this code works for any object that implements the <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html" rel="noreferrer"><code>Iterable</code> interface</a>.</p>
<p>Also, if the right-hand side of the <code>for (:)</code> idiom is an <code>array</code> rather than an <code>Iterable</code> object, the internal code uses an int index counter and checks against <code>array.length</code> instead. See the <a href="http://docs.oracle.com/javase/specs/jls/se8/html/jls-14.html
#jls-14.14.2" rel="noreferrer">Java Language Specification</a>.</p>
</section>
<section id="answer-2-score-476" class="level4">
<h4>Answer 2 (score 476)</h4>
<p>The construct <em>for each</em> is also valid for arrays. e.g. </p>
<div class="sourceCode" id="cb84"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true"></a><span class="bu">String</span>[] fruits = <span class="kw">new</span> <span class="bu">String</span>[] { <span class="st">&quot;Orange&quot;</span>, <span class="st">&quot;Apple&quot;</span>, <span class="st">&quot;Pear&quot;</span>, <span class="st">&quot;Strawberry&quot;</span> };</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true"></a></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true"></a><span class="kw">for</span> (<span class="bu">String</span> fruit : fruits) {</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true"></a>    <span class="co">// fruit is an element of the `fruits` array.</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true"></a>}</span></code></pre></div>
<p>which is essentially equivalent of</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true"></a><span class="kw">for</span> (<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; fruits.<span class="fu">length</span>; i++) {</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true"></a>    <span class="bu">String</span> fruit = fruits[i];</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true"></a>    <span class="co">// fruit is an element of the `fruits` array.</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true"></a>}</span></code></pre></div>
<p>
So, overall summary: <br/> <a href="https://stackoverflow.com/questions/85190/how-does-the-java-for-each-loop-work/85206
#85206">[nsayer]</a> The following is the longer form of what is happening:
</p>
<blockquote>
<div class="sourceCode" id="cb86"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true"></a><span class="kw">for</span>(<span class="bu">Iterator</span>&lt;<span class="bu">String</span>&gt; i = someList.<span class="fu">iterator</span>(); i.<span class="fu">hasNext</span>(); ) {</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true"></a>  <span class="bu">String</span> item = i.<span class="fu">next</span>();</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true"></a>  <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(item);</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true"></a>}</span></code></pre></div>
<p>
Note that if you need to use i.remove(); in your loop, or access the actual iterator in some way, you cannot use the for( : ) idiom, since the actual Iterator is merely inferred.
</p>
</blockquote>
<p><a href="https://stackoverflow.com/questions/85190/how-does-the-java-for-each-loop-work/85242
#85242">[Denis Bueno]</a></p>
<blockquote>
<p>
It’s implied by nsayer’s answer, but it’s worth noting that the OP’s for(..) syntax will work when “someList” is anything that implements java.lang.Iterable – it doesn’t have to be a list, or some collection from java.util. Even your own types, therefore, can be used with this syntax.
</p>
</blockquote>
</section>
<section id="answer-3-score-150" class="level4">
<h4>Answer 3 (score 150)</h4>
<p>The <a href="http://docs.oracle.com/javase/1.5.0/docs/guide/language/foreach.html" rel="noreferrer"><code>foreach</code> loop</a>, added in <a href="http://docs.oracle.com/javase/1.5.0/docs/guide/language/index.html" rel="noreferrer">Java 5</a> (also called the “enhanced for loop”), is equivalent to using a <a href="http://docs.oracle.com/javase/7/docs/api/java/util/Iterator.html" rel="noreferrer"><code>java.util.Iterator</code></a>–it’s syntactic sugar for the same thing. Therefore, when reading each element, one by one and in order, a <code>foreach</code> should always be chosen over an iterator, as it is more convenient and concise.</p>
<h5>
foreach
</h3>
<div class="sourceCode" id="cb87"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true"></a><span class="kw">for</span>(<span class="dt">int</span> i : intList) {</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true"></a>   <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;An element in the list: &quot;</span> + i);</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true"></a>}</span></code></pre></div>
<h5>
Iterator
</h3>
<div class="sourceCode" id="cb88"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true"></a><span class="bu">Iterator</span>&lt;<span class="bu">Integer</span>&gt; intItr = intList.<span class="fu">iterator</span>();</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true"></a><span class="kw">while</span>(intItr.<span class="fu">hasNext</span>()) {</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true"></a>   <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;An element in the list: &quot;</span> + intItr.<span class="fu">next</span>());</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true"></a>}</span></code></pre></div>
<p>There are situations where you must use an <code>Iterator</code> directly. For example, attempting to delete an element while using a <code>foreach</code> can (will?) result in a <code>ConcurrentModificationException</code>.</p>
<h5>
<code>foreach</code> vs. <code>for</code>: Basic differences
</h2>
<p>The only practical difference between <code>for</code> and <code>foreach</code> is that, in the case of indexable objects, you do not have access to the index. An example when the basic <code>for</code> loop is required:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true"></a><span class="kw">for</span>(<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; array.<span class="fu">length</span>; i++) {</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true"></a>   <span class="kw">if</span>(i &lt; <span class="dv">5</span>) {</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true"></a>      <span class="co">// Do something special</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true"></a>   }  <span class="kw">else</span> {</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true"></a>      <span class="co">// Do other stuff</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true"></a>   }</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true"></a>}</span></code></pre></div>
<p>Although you could manually create a separate index int-variable with <code>foreach</code>,</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true"></a><span class="dt">int</span> idx = -<span class="dv">1</span>;</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true"></a><span class="kw">for</span>(<span class="dt">int</span> i : intArray) {</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true"></a>   idx++;</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true"></a>   ...</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true"></a>}</span></code></pre></div>
<p>it is not recommended, since <a href="http://www.java-made-easy.com/variable-scope.html" rel="noreferrer">variable-scope</a> is not ideal, and the basic <code>for</code> loop is simply the standard and expected format for this use case.</p>
<h5>
<code>foreach</code> vs. <code>for</code>: Performance
</H2>
<p>When accessing collections, a <code>foreach</code> is <a href="https://stackoverflow.com/questions/1879255/traditional-for-loop-vs-iterator-in-java">significantly faster</a> than the basic <code>for</code> loop’s array access. When accessing arrays, however–at least with primitive and wrapper-arrays–access via indexes is dramatically faster.</p>
<h5>
Timing the difference between iterator and index access for primitive int-arrays
</h3>
<p>Indexes are 23-<em>40</em> percent faster than iterators when accessing <code>int</code> or <code>Integer</code> arrays. Here is the output from the testing class at the bottom of this post, which sums the numbers in a 100-element primitive-int array (A is iterator, B is index):</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true"></a>[C:\java_code\]java TimeIteratorVsIndexIntArray <span class="dv">1000000</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true"></a>Test A: <span class="dv">358</span>,<span class="dv">597</span>,<span class="dv">622</span> nanoseconds</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true"></a>Test B: <span class="dv">269</span>,<span class="dv">167</span>,<span class="dv">681</span> nanoseconds</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true"></a>B faster by <span class="dv">89</span>,<span class="dv">429</span>,<span class="dv">941</span> <span class="fu">nanoseconds</span> (<span class="fl">24.</span><span class="dv">438799231635727</span>% faster)</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true"></a></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true"></a>[C:\java_code\]java TimeIteratorVsIndexIntArray <span class="dv">1000000</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true"></a>Test A: <span class="dv">377</span>,<span class="dv">461</span>,<span class="dv">823</span> nanoseconds</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true"></a>Test B: <span class="dv">278</span>,<span class="dv">694</span>,<span class="dv">271</span> nanoseconds</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true"></a>B faster by <span class="dv">98</span>,<span class="dv">767</span>,<span class="dv">552</span> <span class="fu">nanoseconds</span> (<span class="fl">25.</span><span class="dv">666236154695838</span>% faster)</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true"></a></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true"></a>[C:\java_code\]java TimeIteratorVsIndexIntArray <span class="dv">1000000</span></span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true"></a>Test A: <span class="dv">288</span>,<span class="dv">953</span>,<span class="dv">495</span> nanoseconds</span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true"></a>Test B: <span class="dv">207</span>,<span class="bn">050</span>,<span class="dv">523</span> nanoseconds</span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true"></a>B faster by <span class="dv">81</span>,<span class="dv">902</span>,<span class="dv">972</span> <span class="fu">nanoseconds</span> (<span class="fl">27.</span><span class="dv">844689860906513</span>% faster)</span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true"></a></span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true"></a>[C:\java_code\]java TimeIteratorVsIndexIntArray <span class="dv">1000000</span></span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true"></a>Test A: <span class="dv">375</span>,<span class="dv">373</span>,<span class="dv">765</span> nanoseconds</span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true"></a>Test B: <span class="dv">283</span>,<span class="dv">813</span>,<span class="dv">875</span> nanoseconds</span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true"></a>B faster by <span class="dv">91</span>,<span class="dv">559</span>,<span class="dv">890</span> <span class="fu">nanoseconds</span> (<span class="fl">23.</span><span class="dv">891659337194227</span>% faster)</span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true"></a></span>
<span id="cb91-21"><a href="#cb91-21" aria-hidden="true"></a>[C:\java_code\]java TimeIteratorVsIndexIntArray <span class="dv">1000000</span></span>
<span id="cb91-22"><a href="#cb91-22" aria-hidden="true"></a>Test A: <span class="dv">375</span>,<span class="dv">790</span>,<span class="dv">818</span> nanoseconds</span>
<span id="cb91-23"><a href="#cb91-23" aria-hidden="true"></a>Test B: <span class="dv">220</span>,<span class="dv">770</span>,<span class="dv">915</span> nanoseconds</span>
<span id="cb91-24"><a href="#cb91-24" aria-hidden="true"></a>B faster by <span class="dv">155</span>,019,<span class="dv">903</span> <span class="fu">nanoseconds</span> (<span class="fl">40.</span><span class="dv">75164734599769</span>% faster)</span>
<span id="cb91-25"><a href="#cb91-25" aria-hidden="true"></a></span>
<span id="cb91-26"><a href="#cb91-26" aria-hidden="true"></a>[C:\java_code\]java TimeIteratorVsIndexIntArray <span class="dv">1000000</span></span>
<span id="cb91-27"><a href="#cb91-27" aria-hidden="true"></a>Test A: <span class="dv">326</span>,<span class="dv">373</span>,<span class="dv">762</span> nanoseconds</span>
<span id="cb91-28"><a href="#cb91-28" aria-hidden="true"></a>Test B: <span class="dv">202</span>,<span class="dv">555</span>,<span class="dv">566</span> nanoseconds</span>
<span id="cb91-29"><a href="#cb91-29" aria-hidden="true"></a>B faster by <span class="dv">123</span>,<span class="dv">818</span>,<span class="dv">196</span> <span class="fu">nanoseconds</span> (<span class="fl">37.</span><span class="dv">437545972215744</span>% faster)</span></code></pre></div>
<p>I also ran this for an <code>Integer</code> array, and indexes are still the clear winner, but only between 18 and 25 percent faster.</p>
<h5>
For collections, iterators are faster than indexes
</h3>
<p>For a <code>List</code> of <code>Integers</code>, however, iterators are the clear winner. Just change the int-array in the test-class to:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true"></a><span class="bu">List</span>&lt;<span class="bu">Integer</span>&gt; intList = <span class="bu">Arrays</span>.<span class="fu">asList</span>(<span class="kw">new</span> <span class="bu">Integer</span>[] {<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">14</span>, <span class="dv">15</span>, <span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">18</span>, <span class="dv">19</span>, <span class="dv">20</span>, <span class="dv">21</span>, <span class="dv">22</span>, <span class="dv">23</span>, <span class="dv">24</span>, <span class="dv">25</span>, <span class="dv">26</span>, <span class="dv">27</span>, <span class="dv">28</span>, <span class="dv">29</span>, <span class="dv">30</span>, <span class="dv">31</span>, <span class="dv">32</span>, <span class="dv">33</span>, <span class="dv">34</span>, <span class="dv">35</span>, <span class="dv">36</span>, <span class="dv">37</span>, <span class="dv">38</span>, <span class="dv">39</span>, <span class="dv">40</span>, <span class="dv">41</span>, <span class="dv">42</span>, <span class="dv">43</span>, <span class="dv">44</span>, <span class="dv">45</span>, <span class="dv">46</span>, <span class="dv">47</span>, <span class="dv">48</span>, <span class="dv">49</span>, <span class="dv">50</span>, <span class="dv">51</span>, <span class="dv">52</span>, <span class="dv">53</span>, <span class="dv">54</span>, <span class="dv">55</span>, <span class="dv">56</span>, <span class="dv">57</span>, <span class="dv">58</span>, <span class="dv">59</span>, <span class="dv">60</span>, <span class="dv">61</span>, <span class="dv">62</span>, <span class="dv">63</span>, <span class="dv">64</span>, <span class="dv">65</span>, <span class="dv">66</span>, <span class="dv">67</span>, <span class="dv">68</span>, <span class="dv">69</span>, <span class="dv">70</span>, <span class="dv">71</span>, <span class="dv">72</span>, <span class="dv">73</span>, <span class="dv">74</span>, <span class="dv">75</span>, <span class="dv">76</span>, <span class="dv">77</span>, <span class="dv">78</span>, <span class="dv">79</span>, <span class="dv">80</span>, <span class="dv">81</span>, <span class="dv">82</span>, <span class="dv">83</span>, <span class="dv">84</span>, <span class="dv">85</span>, <span class="dv">86</span>, <span class="dv">87</span>, <span class="dv">88</span>, <span class="dv">89</span>, <span class="dv">90</span>, <span class="dv">91</span>, <span class="dv">92</span>, <span class="dv">93</span>, <span class="dv">94</span>, <span class="dv">95</span>, <span class="dv">96</span>, <span class="dv">97</span>, <span class="dv">98</span>, <span class="dv">99</span>, <span class="dv">100</span>});</span></code></pre></div>
<p>And make the necessary changes to the test-function (<code>int[]</code> to <code>List&amp;lt;Integer&amp;gt;</code>, <code>length</code> to <code>size()</code>, etc.):</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true"></a>[C:\java_code\]java TimeIteratorVsIndexIntegerList <span class="dv">1000000</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true"></a>Test A: <span class="dv">3</span>,<span class="dv">429</span>,<span class="dv">929</span>,<span class="dv">976</span> nanoseconds</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true"></a>Test B: <span class="dv">5</span>,<span class="dv">262</span>,<span class="dv">782</span>,<span class="dv">488</span> nanoseconds</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true"></a>A faster by <span class="dv">1</span>,<span class="dv">832</span>,<span class="dv">852</span>,<span class="dv">512</span> <span class="fu">nanoseconds</span> (<span class="fl">34.</span><span class="dv">326681820485675</span>% faster)</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true"></a></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true"></a>[C:\java_code\]java TimeIteratorVsIndexIntegerList <span class="dv">1000000</span></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true"></a>Test A: <span class="dv">2</span>,<span class="dv">907</span>,<span class="dv">391</span>,<span class="dv">427</span> nanoseconds</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true"></a>Test B: <span class="dv">3</span>,<span class="dv">957</span>,<span class="dv">718</span>,<span class="dv">459</span> nanoseconds</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true"></a>A faster by <span class="dv">1</span>,<span class="bn">050</span>,<span class="dv">327</span>,<span class="bn">032</span> <span class="fu">nanoseconds</span> (<span class="fl">26.</span>038700083921256% faster)</span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true"></a></span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true"></a>[C:\java_code\]java TimeIteratorVsIndexIntegerList <span class="dv">1000000</span></span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true"></a>Test A: <span class="dv">2</span>,<span class="dv">566</span>,<span class="bn">004</span>,<span class="dv">688</span> nanoseconds</span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true"></a>Test B: <span class="dv">4</span>,<span class="dv">221</span>,<span class="dv">746</span>,<span class="dv">521</span> nanoseconds</span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true"></a>A faster by <span class="dv">1</span>,<span class="dv">655</span>,<span class="dv">741</span>,<span class="dv">833</span> <span class="fu">nanoseconds</span> (<span class="fl">38.</span><span class="dv">71935684115413</span>% faster)</span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true"></a></span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true"></a>[C:\java_code\]java TimeIteratorVsIndexIntegerList <span class="dv">1000000</span></span>
<span id="cb93-17"><a href="#cb93-17" aria-hidden="true"></a>Test A: <span class="dv">2</span>,<span class="dv">770</span>,<span class="dv">945</span>,<span class="dv">276</span> nanoseconds</span>
<span id="cb93-18"><a href="#cb93-18" aria-hidden="true"></a>Test B: <span class="dv">3</span>,<span class="dv">829</span>,<span class="bn">077</span>,<span class="dv">158</span> nanoseconds</span>
<span id="cb93-19"><a href="#cb93-19" aria-hidden="true"></a>A faster by <span class="dv">1</span>,058,<span class="dv">131</span>,<span class="dv">882</span> <span class="fu">nanoseconds</span> (<span class="fl">27.</span><span class="dv">134122749113843</span>% faster)</span>
<span id="cb93-20"><a href="#cb93-20" aria-hidden="true"></a></span>
<span id="cb93-21"><a href="#cb93-21" aria-hidden="true"></a>[C:\java_code\]java TimeIteratorVsIndexIntegerList <span class="dv">1000000</span></span>
<span id="cb93-22"><a href="#cb93-22" aria-hidden="true"></a>Test A: <span class="dv">3</span>,<span class="dv">467</span>,<span class="dv">474</span>,<span class="bn">055</span> nanoseconds</span>
<span id="cb93-23"><a href="#cb93-23" aria-hidden="true"></a>Test B: <span class="dv">5</span>,<span class="dv">183</span>,<span class="dv">149</span>,<span class="dv">104</span> nanoseconds</span>
<span id="cb93-24"><a href="#cb93-24" aria-hidden="true"></a>A faster by <span class="dv">1</span>,<span class="dv">715</span>,<span class="dv">675</span>,049 <span class="fu">nanoseconds</span> (<span class="fl">32.</span><span class="dv">60101667104192</span>% faster)</span>
<span id="cb93-25"><a href="#cb93-25" aria-hidden="true"></a></span>
<span id="cb93-26"><a href="#cb93-26" aria-hidden="true"></a>[C:\java_code\]java TimeIteratorVsIndexIntList <span class="dv">1000000</span></span>
<span id="cb93-27"><a href="#cb93-27" aria-hidden="true"></a>Test A: <span class="dv">3</span>,<span class="dv">439</span>,<span class="dv">983</span>,<span class="dv">933</span> nanoseconds</span>
<span id="cb93-28"><a href="#cb93-28" aria-hidden="true"></a>Test B: <span class="dv">3</span>,<span class="dv">509</span>,<span class="dv">530</span>,<span class="dv">312</span> nanoseconds</span>
<span id="cb93-29"><a href="#cb93-29" aria-hidden="true"></a>A faster by <span class="dv">69</span>,<span class="dv">546</span>,<span class="dv">379</span> <span class="fu">nanoseconds</span> (<span class="fl">1.</span><span class="dv">4816434912159906</span>% faster)</span>
<span id="cb93-30"><a href="#cb93-30" aria-hidden="true"></a></span>
<span id="cb93-31"><a href="#cb93-31" aria-hidden="true"></a>[C:\java_code\]java TimeIteratorVsIndexIntList <span class="dv">1000000</span></span>
<span id="cb93-32"><a href="#cb93-32" aria-hidden="true"></a>Test A: <span class="dv">3</span>,<span class="dv">451</span>,<span class="dv">101</span>,<span class="dv">466</span> nanoseconds</span>
<span id="cb93-33"><a href="#cb93-33" aria-hidden="true"></a>Test B: <span class="dv">5</span>,<span class="bn">057</span>,<span class="dv">979</span>,<span class="dv">210</span> nanoseconds</span>
<span id="cb93-34"><a href="#cb93-34" aria-hidden="true"></a>A faster by <span class="dv">1</span>,<span class="dv">606</span>,<span class="dv">877</span>,<span class="dv">744</span> <span class="fu">nanoseconds</span> (<span class="fl">31.</span><span class="dv">269164666060377</span>% faster)</span></code></pre></div>
<p>In one test they’re almost equivalent, but with collections, iterator wins.</p>
<p>*This post is based on two answers I wrote on Stack Overflow:</p>
<ul>
<li>
<p>
<em><a href="https://stackoverflow.com/questions/22110482/uses-and-syntax-for-for-each-loop-in-java/22110517
#22110517">Uses and syntax for for-each loop in Java</a></em>
</p>
</li>
<li>
<p>
<em><a href="https://stackoverflow.com/questions/22540025/should-i-use-an-iterator-or-a-forloop-to-iterate/22540191
#22540191">Should I use an Iterator or a forloop to iterate?</a></em>
</p>
</li>
</ul>
<p>Some more information: <em><a href="https://stackoverflow.com/questions/2113216/which-is-more-efficient-a-for-each-loop-or-an-iterator">Which is more efficient, a for-each loop, or an iterator?</a></em></p>
<h5>
The full testing class
</h3>
<p>I created this compare-the-time-it-takes-to-do-any-two-things class after reading <a href="https://stackoverflow.com/questions/180158/how-do-i-time-a-methods-execution-in-java">this question</a> on Stack Overflow:</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true"></a><span class="kw">import</span><span class="im">  java.text.NumberFormat;</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true"></a><span class="kw">import</span><span class="im">  java.util.Locale;</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true"></a></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true"></a><span class="co">/**</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true"></a>   <span class="dv">&amp;lt;</span>P<span class="dv">&amp;gt;</span><span class="an">{@code java TimeIteratorVsIndexIntArray 1000000}</span><span class="dv">&amp;lt;</span><span class="co">/</span>P<span class="dv">&amp;gt;</span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true"></a></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true"></a>   <span class="co">@</span>see  <span class="dv">&amp;lt;</span>CODE<span class="dv">&amp;gt;&amp;lt;</span>A HREF<span class="co">=&quot;</span>https<span class="co">://</span>stackoverflow<span class="co">.</span>com<span class="co">/</span>questions<span class="co">/180158/</span>how<span class="co">-</span>do<span class="co">-</span>i<span class="co">-</span>time<span class="co">-</span>a<span class="co">-</span>methods<span class="co">-</span>execution<span class="co">-</span>in<span class="co">-</span>java<span class="co">&quot;</span><span class="dv">&amp;gt;</span>https<span class="co">://</span>stackoverflow<span class="co">.</span>com<span class="co">/</span>questions<span class="co">/180158/</span>how<span class="co">-</span>do<span class="co">-</span>i<span class="co">-</span>time<span class="co">-</span>a<span class="co">-</span>methods<span class="co">-</span>execution<span class="co">-</span>in<span class="co">-</span>java<span class="dv">&amp;lt;</span><span class="co">/</span>A<span class="dv">&amp;gt;&amp;lt;</span><span class="co">/</span>CODE<span class="dv">&amp;gt;</span></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true"></a> <span class="co">**/</span></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">class</span> TimeIteratorVsIndexIntArray {</span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true"></a></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">final</span> <span class="bu">NumberFormat</span> nf = <span class="bu">NumberFormat</span>.<span class="fu">getNumberInstance</span>(<span class="bu">Locale</span>.<span class="fu">US</span>);</span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true"></a></span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">final</span> <span class="dt">void</span> <span class="fu">main</span>(<span class="bu">String</span>[] tryCount_inParamIdx0) {</span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true"></a>        <span class="dt">int</span> testCount;</span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true"></a></span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true"></a>        <span class="co">// Get try-count from a command-line parameter</span></span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true"></a>        <span class="kw">try</span> {</span>
<span id="cb94-18"><a href="#cb94-18" aria-hidden="true"></a>           testCount = <span class="bu">Integer</span>.<span class="fu">parseInt</span>(tryCount_inParamIdx0[<span class="dv">0</span>]);</span>
<span id="cb94-19"><a href="#cb94-19" aria-hidden="true"></a>        }</span>
<span id="cb94-20"><a href="#cb94-20" aria-hidden="true"></a>        <span class="kw">catch</span>(<span class="bu">ArrayIndexOutOfBoundsException</span> | <span class="bu">NumberFormatException</span> x) {</span>
<span id="cb94-21"><a href="#cb94-21" aria-hidden="true"></a>           <span class="kw">throw</span>  <span class="kw">new</span> <span class="bu">IllegalArgumentException</span>(<span class="st">&quot;Missing or invalid command line parameter: The number of testCount for each test. &quot;</span> + x);</span>
<span id="cb94-22"><a href="#cb94-22" aria-hidden="true"></a>        }</span>
<span id="cb94-23"><a href="#cb94-23" aria-hidden="true"></a></span>
<span id="cb94-24"><a href="#cb94-24" aria-hidden="true"></a>        <span class="co">//Test proper...START</span></span>
<span id="cb94-25"><a href="#cb94-25" aria-hidden="true"></a>        <span class="dt">int</span>[] intArray = <span class="kw">new</span> <span class="dt">int</span>[] {<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">14</span>, <span class="dv">15</span>, <span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">18</span>, <span class="dv">19</span>, <span class="dv">20</span>, <span class="dv">21</span>, <span class="dv">22</span>, <span class="dv">23</span>, <span class="dv">24</span>, <span class="dv">25</span>, <span class="dv">26</span>, <span class="dv">27</span>, <span class="dv">28</span>, <span class="dv">29</span>, <span class="dv">30</span>, <span class="dv">31</span>, <span class="dv">32</span>, <span class="dv">33</span>, <span class="dv">34</span>, <span class="dv">35</span>, <span class="dv">36</span>, <span class="dv">37</span>, <span class="dv">38</span>, <span class="dv">39</span>, <span class="dv">40</span>, <span class="dv">41</span>, <span class="dv">42</span>, <span class="dv">43</span>, <span class="dv">44</span>, <span class="dv">45</span>, <span class="dv">46</span>, <span class="dv">47</span>, <span class="dv">48</span>, <span class="dv">49</span>, <span class="dv">50</span>, <span class="dv">51</span>, <span class="dv">52</span>, <span class="dv">53</span>, <span class="dv">54</span>, <span class="dv">55</span>, <span class="dv">56</span>, <span class="dv">57</span>, <span class="dv">58</span>, <span class="dv">59</span>, <span class="dv">60</span>, <span class="dv">61</span>, <span class="dv">62</span>, <span class="dv">63</span>, <span class="dv">64</span>, <span class="dv">65</span>, <span class="dv">66</span>, <span class="dv">67</span>, <span class="dv">68</span>, <span class="dv">69</span>, <span class="dv">70</span>, <span class="dv">71</span>, <span class="dv">72</span>, <span class="dv">73</span>, <span class="dv">74</span>, <span class="dv">75</span>, <span class="dv">76</span>, <span class="dv">77</span>, <span class="dv">78</span>, <span class="dv">79</span>, <span class="dv">80</span>, <span class="dv">81</span>, <span class="dv">82</span>, <span class="dv">83</span>, <span class="dv">84</span>, <span class="dv">85</span>, <span class="dv">86</span>, <span class="dv">87</span>, <span class="dv">88</span>, <span class="dv">89</span>, <span class="dv">90</span>, <span class="dv">91</span>, <span class="dv">92</span>, <span class="dv">93</span>, <span class="dv">94</span>, <span class="dv">95</span>, <span class="dv">96</span>, <span class="dv">97</span>, <span class="dv">98</span>, <span class="dv">99</span>, <span class="dv">100</span>};</span>
<span id="cb94-26"><a href="#cb94-26" aria-hidden="true"></a></span>
<span id="cb94-27"><a href="#cb94-27" aria-hidden="true"></a>        <span class="dt">long</span> lStart = <span class="bu">System</span>.<span class="fu">nanoTime</span>();</span>
<span id="cb94-28"><a href="#cb94-28" aria-hidden="true"></a>        <span class="kw">for</span>(<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; testCount; i++) {</span>
<span id="cb94-29"><a href="#cb94-29" aria-hidden="true"></a>           <span class="fu">testIterator</span>(intArray);</span>
<span id="cb94-30"><a href="#cb94-30" aria-hidden="true"></a>        }</span>
<span id="cb94-31"><a href="#cb94-31" aria-hidden="true"></a></span>
<span id="cb94-32"><a href="#cb94-32" aria-hidden="true"></a>        <span class="dt">long</span> lADuration = <span class="fu">outputGetNanoDuration</span>(<span class="st">&quot;A&quot;</span>, lStart);</span>
<span id="cb94-33"><a href="#cb94-33" aria-hidden="true"></a></span>
<span id="cb94-34"><a href="#cb94-34" aria-hidden="true"></a>        lStart = <span class="bu">System</span>.<span class="fu">nanoTime</span>();</span>
<span id="cb94-35"><a href="#cb94-35" aria-hidden="true"></a>        <span class="kw">for</span>(<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; testCount; i++) {</span>
<span id="cb94-36"><a href="#cb94-36" aria-hidden="true"></a>           <span class="fu">testFor</span>(intArray);</span>
<span id="cb94-37"><a href="#cb94-37" aria-hidden="true"></a>        }</span>
<span id="cb94-38"><a href="#cb94-38" aria-hidden="true"></a></span>
<span id="cb94-39"><a href="#cb94-39" aria-hidden="true"></a>        <span class="dt">long</span> lBDuration = <span class="fu">outputGetNanoDuration</span>(<span class="st">&quot;B&quot;</span>, lStart);</span>
<span id="cb94-40"><a href="#cb94-40" aria-hidden="true"></a></span>
<span id="cb94-41"><a href="#cb94-41" aria-hidden="true"></a>        <span class="fu">outputGetABTestNanoDifference</span>(lADuration, lBDuration, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>);</span>
<span id="cb94-42"><a href="#cb94-42" aria-hidden="true"></a>    }</span>
<span id="cb94-43"><a href="#cb94-43" aria-hidden="true"></a></span>
<span id="cb94-44"><a href="#cb94-44" aria-hidden="true"></a>    <span class="kw">private</span> <span class="dt">static</span> <span class="dt">final</span> <span class="dt">void</span> <span class="fu">testIterator</span>(<span class="dt">int</span>[] int_array) {</span>
<span id="cb94-45"><a href="#cb94-45" aria-hidden="true"></a>       <span class="dt">int</span> total = <span class="dv">0</span>;</span>
<span id="cb94-46"><a href="#cb94-46" aria-hidden="true"></a>       <span class="kw">for</span>(<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; int_array.<span class="fu">length</span>; i++) {</span>
<span id="cb94-47"><a href="#cb94-47" aria-hidden="true"></a>          total += int_array[i];</span>
<span id="cb94-48"><a href="#cb94-48" aria-hidden="true"></a>       }</span>
<span id="cb94-49"><a href="#cb94-49" aria-hidden="true"></a>    }</span>
<span id="cb94-50"><a href="#cb94-50" aria-hidden="true"></a></span>
<span id="cb94-51"><a href="#cb94-51" aria-hidden="true"></a>    <span class="kw">private</span> <span class="dt">static</span> <span class="dt">final</span> <span class="dt">void</span> <span class="fu">testFor</span>(<span class="dt">int</span>[] int_array) {</span>
<span id="cb94-52"><a href="#cb94-52" aria-hidden="true"></a>       <span class="dt">int</span> total = <span class="dv">0</span>;</span>
<span id="cb94-53"><a href="#cb94-53" aria-hidden="true"></a>       <span class="kw">for</span>(<span class="dt">int</span> i : int_array) {</span>
<span id="cb94-54"><a href="#cb94-54" aria-hidden="true"></a>          total += i;</span>
<span id="cb94-55"><a href="#cb94-55" aria-hidden="true"></a>       }</span>
<span id="cb94-56"><a href="#cb94-56" aria-hidden="true"></a>    }</span>
<span id="cb94-57"><a href="#cb94-57" aria-hidden="true"></a>    <span class="co">//Test proper...</span><span class="re">END</span></span>
<span id="cb94-58"><a href="#cb94-58" aria-hidden="true"></a></span>
<span id="cb94-59"><a href="#cb94-59" aria-hidden="true"></a>    <span class="co">//Timer testing utilities...START</span></span>
<span id="cb94-60"><a href="#cb94-60" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">final</span> <span class="dt">long</span> <span class="fu">outputGetNanoDuration</span>(<span class="bu">String</span> s_testName, <span class="dt">long</span> l_nanoStart) {</span>
<span id="cb94-61"><a href="#cb94-61" aria-hidden="true"></a>        <span class="dt">long</span> lDuration = <span class="bu">System</span>.<span class="fu">nanoTime</span>() - l_nanoStart;</span>
<span id="cb94-62"><a href="#cb94-62" aria-hidden="true"></a>        <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;Test &quot;</span> + s_testName + <span class="st">&quot;: &quot;</span> + nf<span class="fu">.format</span>(lDuration) + <span class="st">&quot; nanoseconds&quot;</span>);</span>
<span id="cb94-63"><a href="#cb94-63" aria-hidden="true"></a>        <span class="kw">return</span>  lDuration;</span>
<span id="cb94-64"><a href="#cb94-64" aria-hidden="true"></a>    }</span>
<span id="cb94-65"><a href="#cb94-65" aria-hidden="true"></a></span>
<span id="cb94-66"><a href="#cb94-66" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">final</span> <span class="dt">long</span> <span class="fu">outputGetABTestNanoDifference</span>(<span class="dt">long</span> l_aDuration, <span class="dt">long</span> l_bDuration, <span class="bu">String</span> s_aTestName, <span class="bu">String</span> s_bTestName) {</span>
<span id="cb94-67"><a href="#cb94-67" aria-hidden="true"></a>        <span class="dt">long</span> lDiff = -<span class="dv">1</span>;</span>
<span id="cb94-68"><a href="#cb94-68" aria-hidden="true"></a>        <span class="dt">double</span> dPct = -<span class="fl">1.</span><span class="dv">0</span>;</span>
<span id="cb94-69"><a href="#cb94-69" aria-hidden="true"></a>        <span class="bu">String</span> sFaster = <span class="kw">null</span>;</span>
<span id="cb94-70"><a href="#cb94-70" aria-hidden="true"></a>        <span class="kw">if</span>(l_aDuration &gt; l_bDuration) {</span>
<span id="cb94-71"><a href="#cb94-71" aria-hidden="true"></a>            lDiff = l_aDuration - l_bDuration;</span>
<span id="cb94-72"><a href="#cb94-72" aria-hidden="true"></a>            dPct = <span class="fl">100.</span><span class="bn">00</span> - (l_bDuration * <span class="fl">100.</span><span class="dv">0</span> / l_aDuration + <span class="fl">0.</span><span class="dv">5</span>);</span>
<span id="cb94-73"><a href="#cb94-73" aria-hidden="true"></a>            sFaster = <span class="st">&quot;B&quot;</span>;</span>
<span id="cb94-74"><a href="#cb94-74" aria-hidden="true"></a>        }</span>
<span id="cb94-75"><a href="#cb94-75" aria-hidden="true"></a>        <span class="kw">else</span> {</span>
<span id="cb94-76"><a href="#cb94-76" aria-hidden="true"></a>            lDiff = l_bDuration - l_aDuration;</span>
<span id="cb94-77"><a href="#cb94-77" aria-hidden="true"></a>            dPct = <span class="fl">100.</span><span class="bn">00</span> - (l_aDuration * <span class="fl">100.</span><span class="dv">0</span> / l_bDuration + <span class="fl">0.</span><span class="dv">5</span>);</span>
<span id="cb94-78"><a href="#cb94-78" aria-hidden="true"></a>            sFaster = <span class="st">&quot;A&quot;</span>;</span>
<span id="cb94-79"><a href="#cb94-79" aria-hidden="true"></a>        }</span>
<span id="cb94-80"><a href="#cb94-80" aria-hidden="true"></a>        <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(sFaster + <span class="st">&quot; faster by &quot;</span> + nf<span class="fu">.format</span>(lDiff) + <span class="st">&quot; nanoseconds (&quot;</span> + dPct + <span class="st">&quot;% faster)&quot;</span>);</span>
<span id="cb94-81"><a href="#cb94-81" aria-hidden="true"></a>        <span class="kw">return</span>  lDiff;</span>
<span id="cb94-82"><a href="#cb94-82" aria-hidden="true"></a>   }</span>
<span id="cb94-83"><a href="#cb94-83" aria-hidden="true"></a></span>
<span id="cb94-84"><a href="#cb94-84" aria-hidden="true"></a>   <span class="co">//Timer testing utilities...</span><span class="re">END</span></span>
<span id="cb94-85"><a href="#cb94-85" aria-hidden="true"></a></span>
<span id="cb94-86"><a href="#cb94-86" aria-hidden="true"></a>}</span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="what-does-could-not-find-or-load-main-class-mean-score-2477019-in-2018" class="level3">
<h3>9: What does “Could not find or load main class” mean? (score <a href="https://stackoverflow.com/q/18093928.html">2477019</a> in 2018)</h3>
<section id="question-8" class="level4">
<h4>Question</h4>
<p>A common problem that new Java developers experience is that their programs fail to run with the error message: <code>Could not find or load main class ...</code></p>
<p>What does this mean, what causes it, and how should you fix it?</p>
</section>
<section id="answer-accepted-score-1128" class="level4">
<h4>Answer accepted (score 1128)</h4>
<h5>
The <code>java &amp;lt;class-name&amp;gt;</code> command syntax
</h2>
<p>First of all, you need to understand the correct way to launch a program using the <code>java</code> (or <code>javaw</code>) command.</p>
<p>The normal syntax<sup>1</sup> is this:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true"></a>    java [ &lt;option&gt; <span class="kw">... </span>] &lt;<span class="kw">class</span>-name&gt; [&lt;argument&gt; ...]</span></code></pre></div>
<p>
where <code>&amp;lt;option&amp;gt;</code> is a command line option (starting with a “-” character), <code>&amp;lt;class-name&amp;gt;</code> is a fully qualified Java class name, and <code>&amp;lt;argument&amp;gt;</code> is an arbitrary command line argument that gets passed to your application.<br> <sup>1 - There is a second syntax for “executable” JAR files which I will describe at the bottom.</sup>
</p>
<p>The fully qualified name (FQN) for the class is conventionally written as you would in Java source code; e.g. </p>
<div class="sourceCode" id="cb96"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true"></a>    packagename.<span class="fu">packagename2</span>.<span class="fu">packagename3</span>.<span class="fu">ClassName</span></span></code></pre></div>
<p>However some versions of the <code>java</code> command allow you to use slashes instead of periods; e.g. </p>
<div class="sourceCode" id="cb97"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true"></a>    packagename/packagename2/packagename3/ClassName</span></code></pre></div>
<p>which (confusingly) looks like a file pathname, but isn’t one. Note that the term <em>fully qualified name</em> is standard Java terminology … not something I just made up to confuse you :-)</p>
<p>Here is an example of what a <code>java</code> command should look like:</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true"></a>    java -Xmx100m com.<span class="fu">acme</span>.<span class="fu">example</span>.<span class="fu">ListUsers</span> fred joe bert</span></code></pre></div>
<p>The above is going to cause the <code>java</code> command to do the following:</p>
<ol>
<li>
Search for the compiled version of the <code>com.acme.example.ListUsers</code> class.
</li>
<li>
Load the class.
</li>
<li>
Check that the class has a <code>main</code> method with <em>signature</em>, <em>return type</em> and <em>modifiers</em> given by <code>public static void main(String[])</code>. (Note, the method argument’s name is <strong>NOT</strong> part of the signature.)
</li>
<li>
Call that method passing it the command line arguments (“fred”, “joe”, “bert”) as a <code>String[]</code>.
</li>
</ol>
<h5>
Reasons why Java cannot find the class
</h2>
<p>When you get the message “Could not find or load main class …”, that means that the first step has failed. The <code>java</code> command was not able to find the class. And indeed, the “…” in the message will be the <em>fully qualified class name</em> that <code>java</code> is looking for.</p>
<p>So why might it be unable to find the class?</p>
<h5>
Reason #1 - you made a mistake with the classname argument
</h2>
<p>The first likely cause is that you may have provided the wrong class name. (Or … the right class name, but in the wrong form.) Considering the example above, here a variety of <strong>wrong ways</strong> to specify the class name:</p>
<ul>
<li>
<p>
Example #1 - a simple class name:
</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true"></a>java ListUser</span></code></pre></div>
<p>When the class is declared in a package such as <code>com.acme.example</code>, then you must use the full classname <em>including</em> the package name in the <code>java</code> command; e.g. </p>
<div class="sourceCode" id="cb100"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true"></a>java com.<span class="fu">acme</span>.<span class="fu">example</span>.<span class="fu">ListUser</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true"></a>&lt;li&gt;&lt;p&gt;Example</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true"></a>#<span class="dv">2</span> - a filename or pathname rather than a <span class="kw">class</span> name:&lt;/p&gt;</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true"></a></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true"></a>```java</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true"></a>java ListUser.<span class="fu">class</span></span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true"></a>java com/acme/example/ListUser.<span class="fu">class</span></span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true"></a>&lt;li&gt;&lt;p&gt;Example</span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true"></a>#<span class="dv">3</span> - a <span class="kw">class</span> name with the casing incorrect:&lt;/p&gt;</span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true"></a></span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true"></a>```java</span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true"></a>java com.<span class="fu">acme</span>.<span class="fu">example</span>.<span class="fu">listuser</span></span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true"></a>&lt;li&gt;&lt;p&gt;Example</span>
<span id="cb100-17"><a href="#cb100-17" aria-hidden="true"></a>#<span class="dv">4</span> - a typo&lt;/p&gt;</span>
<span id="cb100-18"><a href="#cb100-18" aria-hidden="true"></a></span>
<span id="cb100-19"><a href="#cb100-19" aria-hidden="true"></a>```java</span>
<span id="cb100-20"><a href="#cb100-20" aria-hidden="true"></a>java com.<span class="fu">acme</span>.<span class="fu">example</span>.<span class="fu">mistuser</span></span>
<span id="cb100-21"><a href="#cb100-21" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb100-22"><a href="#cb100-22" aria-hidden="true"></a>&lt;li&gt;&lt;p&gt;Example</span>
<span id="cb100-23"><a href="#cb100-23" aria-hidden="true"></a>#<span class="dv">5</span> - a source filename&lt;/p&gt;</span>
<span id="cb100-24"><a href="#cb100-24" aria-hidden="true"></a></span>
<span id="cb100-25"><a href="#cb100-25" aria-hidden="true"></a>```java</span>
<span id="cb100-26"><a href="#cb100-26" aria-hidden="true"></a>java ListUser.<span class="fu">java</span></span>
<span id="cb100-27"><a href="#cb100-27" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb100-28"><a href="#cb100-28" aria-hidden="true"></a>&lt;li&gt;&lt;p&gt;Example</span>
<span id="cb100-29"><a href="#cb100-29" aria-hidden="true"></a>#<span class="dv">6</span> - you forgot the <span class="kw">class</span> name entirely&lt;/p&gt;</span>
<span id="cb100-30"><a href="#cb100-30" aria-hidden="true"></a></span>
<span id="cb100-31"><a href="#cb100-31" aria-hidden="true"></a>```java</span>
<span id="cb100-32"><a href="#cb100-32" aria-hidden="true"></a>java lots of arguments</span>
<span id="cb100-33"><a href="#cb100-33" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb100-34"><a href="#cb100-34" aria-hidden="true"></a>&lt;/ul&gt;</span>
<span id="cb100-35"><a href="#cb100-35" aria-hidden="true"></a></span>
<span id="cb100-36"><a href="#cb100-36" aria-hidden="true"></a>&lt;h5&gt;Reason</span>
<span id="cb100-37"><a href="#cb100-37" aria-hidden="true"></a>#<span class="dv">2</span> - the application&#39;s classpath is incorrectly specified&lt;/h2&gt;</span>
<span id="cb100-38"><a href="#cb100-38" aria-hidden="true"></a></span>
<span id="cb100-39"><a href="#cb100-39" aria-hidden="true"></a>The second likely cause is that the <span class="kw">class</span> name is correct, but that the `java` command cannot find the <span class="kw">class</span>.  To understand <span class="kw">this</span>, you need to understand the concept of the <span class="st">&quot;classpath&quot;</span>.  This is explained &lt;em&gt;well&lt;/em&gt; by the Oracle documentation:  </span>
<span id="cb100-40"><a href="#cb100-40" aria-hidden="true"></a></span>
<span id="cb100-41"><a href="#cb100-41" aria-hidden="true"></a>&lt;ul&gt;</span>
<span id="cb100-42"><a href="#cb100-42" aria-hidden="true"></a>&lt;li&gt;&lt;a href=<span class="st">&quot;http://docs.oracle.com/javase/7/docs/technotes/tools/windows/java.html&quot;</span> rel=<span class="st">&quot;noreferrer&quot;</span>&gt;The `java` command documentation&lt;/a&gt;&lt;/li&gt;</span>
<span id="cb100-43"><a href="#cb100-43" aria-hidden="true"></a>&lt;li&gt;&lt;a href=<span class="st">&quot;http://docs.oracle.com/javase/7/docs/technotes/tools/windows/classpath.html&quot;</span> rel=<span class="st">&quot;noreferrer&quot;</span>&gt;Setting the Classpath&lt;/a&gt;. &lt;/li&gt;</span>
<span id="cb100-44"><a href="#cb100-44" aria-hidden="true"></a>&lt;li&gt;The Java Tutorial - &lt;a href=<span class="st">&quot;http://docs.oracle.com/javase/tutorial/essential/environment/paths.html&quot;</span> rel=<span class="st">&quot;noreferrer&quot;</span>&gt;PATH and CLASSPATH&lt;/a&gt;&lt;/li&gt;</span>
<span id="cb100-45"><a href="#cb100-45" aria-hidden="true"></a>&lt;/ul&gt;</span>
<span id="cb100-46"><a href="#cb100-46" aria-hidden="true"></a></span>
<span id="cb100-47"><a href="#cb100-47" aria-hidden="true"></a>So <span class="kw">... if</span> you have specified the <span class="kw">class</span> name correctly, the next thing to check is that you have specified the classpath correctly:  </span>
<span id="cb100-48"><a href="#cb100-48" aria-hidden="true"></a></span>
<span id="cb100-49"><a href="#cb100-49" aria-hidden="true"></a>&lt;ol&gt;</span>
<span id="cb100-50"><a href="#cb100-50" aria-hidden="true"></a>&lt;li&gt;Read the three documents linked above.  (Yes <span class="kw">... </span>READ them.  It is important that a Java programmer &lt;em&gt;understands&lt;/em&gt; at least the basics of how the Java classpath mechanisms works.)&lt;/li&gt;</span>
<span id="cb100-51"><a href="#cb100-51" aria-hidden="true"></a>&lt;li&gt;Look at command line and / or the CLASSPATH environment variable that is in effect when you run the `java` command.  Check that the directory names and JAR file names are correct.&lt;/li&gt;</span>
<span id="cb100-52"><a href="#cb100-52" aria-hidden="true"></a>&lt;li&gt;If there are &lt;em&gt;relative&lt;/em&gt; pathnames in the classpath, check that they resolve correctly <span class="kw">... </span>from the current directory that is in effect when you run the `java` command.&lt;/li&gt;</span>
<span id="cb100-53"><a href="#cb100-53" aria-hidden="true"></a>&lt;li&gt;Check that the <span class="kw">class</span> (mentioned in the error message) can be located on the &lt;em&gt;effective&lt;/em&gt; classpath.&lt;/li&gt;</span>
<span id="cb100-54"><a href="#cb100-54" aria-hidden="true"></a>&lt;li&gt;Note that the classpath syntax is &lt;em&gt;different&lt;/em&gt; <span class="kw">for</span> Windows versus Linux and <span class="bu">Mac</span> OS. (The classpath separator is `;` on Windows and `:` on the others.  If you use the wrong separator <span class="kw">for</span> your platform, you won&#39;t get an explicit error message.  Instead, you will get a nonexistent file or directory on the path that will be silently ignored.)&lt;/li&gt;</span>
<span id="cb100-55"><a href="#cb100-55" aria-hidden="true"></a>&lt;/ol&gt;</span>
<span id="cb100-56"><a href="#cb100-56" aria-hidden="true"></a></span>
<span id="cb100-57"><a href="#cb100-57" aria-hidden="true"></a>&lt;h5&gt;Reason</span>
<span id="cb100-58"><a href="#cb100-58" aria-hidden="true"></a>#2a - the wrong directory is on the classpath&lt;/h2&gt;</span>
<span id="cb100-59"><a href="#cb100-59" aria-hidden="true"></a></span>
<span id="cb100-60"><a href="#cb100-60" aria-hidden="true"></a>When you put a directory on the classpath, it notionally corresponds to the root of the qualified name space.  Classes are located in the directory structure beneath that root, &lt;em&gt;by mapping the fully qualified name to a pathname&lt;/em&gt;.  So <span class="kw">for</span> example, <span class="kw">if</span> <span class="st">&quot;/usr/local/acme/classes&quot;</span> is on the <span class="kw">class</span> path, then when the JVM looks <span class="kw">for</span> a <span class="kw">class</span> called `com.<span class="fu">acme</span>.<span class="fu">example</span>.<span class="fu">Foon</span>`, it will look <span class="kw">for</span> a <span class="st">&quot;.class&quot;</span> file with <span class="kw">this</span> pathname:  </span>
<span id="cb100-61"><a href="#cb100-61" aria-hidden="true"></a></span>
<span id="cb100-62"><a href="#cb100-62" aria-hidden="true"></a>```java</span>
<span id="cb100-63"><a href="#cb100-63" aria-hidden="true"></a>  /usr/local/acme/classes/com/acme/example/Foon.<span class="fu">class</span></span></code></pre></div>
<p>If you had put “/usr/local/acme/classes/com/acme/example” on the classpath, then the JVM wouldn’t be able to find the class.</p>
<h5>
Reason #2b - the subdirectory path doesn’t match the FQN
</h2>
<p>If your classes FQN is <code>com.acme.example.Foon</code>, then the JVM is going to look for “Foon.class” in the directory “com/acme/example”:</p>
<ul>
<li>
<p>
If your directory structure doesn’t match the package naming as per the pattern above, the JVM won’t find your class.
</p>
</li>
<li>
<p>
If you attempt <em>rename</em> a class by moving it, that will fail as well … but the exception stacktrace will be different. It is liable to say something like this:
</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true"></a>Caused by: java.<span class="fu">lang</span>.<span class="fu">NoClassDefFoundError</span>: &lt;path&gt; (wrong name: &lt;name&gt;)</span></code></pre></div>
because the FQN in the class file doesn’t match what the class loader is expecting to find.
</li>
</ul>
<p>To give a concrete example, supposing that:</p>
<ul>
<li>
you want to run <code>com.acme.example.Foon</code> class,
</li>
<li>
the full file path is <code>/usr/local/acme/classes/com/acme/example/Foon.class</code>,
</li>
<li>
your current working directory is <code>/usr/local/acme/classes/com/acme/example/</code>,
</li>
</ul>
<p>then:</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true"></a></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true"></a># wrong, FQN is needed</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true"></a>java Foon</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true"></a></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true"></a></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true"></a># wrong, there is no `com/acme/example` folder in the current working directory</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true"></a>java com.<span class="fu">acme</span>.<span class="fu">example</span>.<span class="fu">Foon</span></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true"></a></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true"></a></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true"></a># wrong, similar to above</span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true"></a>java -classpath . com.<span class="fu">acme</span>.<span class="fu">example</span>.<span class="fu">Foon</span></span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true"></a></span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true"></a></span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true"></a># fine; relative classpath set</span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true"></a>java -classpath ../../.. com.<span class="fu">acme</span>.<span class="fu">example</span>.<span class="fu">Foon</span></span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true"></a></span>
<span id="cb102-17"><a href="#cb102-17" aria-hidden="true"></a></span>
<span id="cb102-18"><a href="#cb102-18" aria-hidden="true"></a># fine; absolute classpath set</span>
<span id="cb102-19"><a href="#cb102-19" aria-hidden="true"></a>java -classpath /usr/local/acme/classes com.<span class="fu">acme</span>.<span class="fu">example</span>.<span class="fu">Foon</span></span></code></pre></div>
<p>Notes:</p>
<ul>
<li>
The <code>-classpath</code> option can be shortened to <code>-cp</code> in most Java releases. Check the respective manual entries for <code>java</code>, <code>javac</code> and so on.
</li>
<li>
Think carefully when choosing between absolute and relative pathnames in classpaths. Remember that a relative pathname may “break” if the current directory changes.
</li>
</ul>
<h5>
Reason #2c - dependencies missing from the classpath
</h2>
<p>The classpath needs to include all of the <em>other</em> (non-system) classes that your application depends on. (The system classes are located automatically, and you rarely need to concern yourself with this.) For the main class to load correctly, the JVM needs to find:</p>
<ul>
<li>
the class itself.
</li>
<li>
all classes and interfaces in the superclass hierarchy (e.g. see <a href="https://stackoverflow.com/questions/42880748">Java class is present in classpath but startup fails with Error: Could not find or load main class</a>)
</li>
<li>
all classes and interfaces that are referred to by means of variable or variable declarations, or method call or field access expressions.
</li>
</ul>
<p>(Note: the JLS and JVM specifications allow some scope for a JVM to load classes “lazily”, and this can affect when a classloader exception is thrown.)</p>
<h5>
Reason #3 - the class has been declared in the wrong package
</h2>
<p>
It occasionally happens that someone puts a source code file into the the wrong folder in their source code tree, or they leave out the <code>package</code> declaration. If you do this in an IDE, the IDE’s compiler will tell you about this immediately. Similarly if you use a decent Java build tool, the tool will run <code>javac</code> in a way that will detect the problem. However, if you build your Java code by hand, you can do it in such a way that the compiler doesn’t notice the problem, and the resulting “.class” file is not in the place that you expect it to be.
</p>
<h5>
Still can’t find the problem?
</h2>
<p>There lots of things to check, and it is easy to miss something. Try adding the <code>-Xdiag</code> option to the <code>java</code> command line (as the first thing after <code>java</code>). It will output various things about class loading, and this may offer you clues as to what the real problem is.</p>
<p>Also, consider possible problems caused by copying and pasting invisible or non-ASCII characters from websites, documents and so on. And consider “homoglyphs”, were two letters or symbols look the same … but aren’t.</p>
<hr>
<h5>
The <code>java -jar &amp;lt;jar file&amp;gt;</code> syntax
</h2>
<p>The alternative syntax used for “executable” JAR files is as follows:</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true"></a>  java [ &lt;option&gt; <span class="kw">... </span>] -jar &lt;jar-file-name&gt; [&lt;argument&gt; ...]</span></code></pre></div>
<p>e.g. </p>
<div class="sourceCode" id="cb104"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true"></a>  java -Xmx100m -jar /usr/local/acme-example/listuser.<span class="fu">jar</span> fred</span></code></pre></div>
<p>In this case the name of the entry-point class (i.e. <code>com.acme.example.ListUser</code>) and the classpath are specified in the MANIFEST of the JAR file.</p>
<hr>
<h5>
IDEs
</h2>
<p>A typical Java IDE has support for running Java applications in the IDE JVM itself or in a child JVM. These are <em>generally</em> immune from this particular exception, because the IDE uses its own mechanisms to construct the runtime classpath, identify the main class and create the <code>java</code> command line.</p>
<p>However it is still possible for this exception to occur, if you do things behind the back of the IDE. For example, if you have previously set up an Application Launcher for your Java app in Eclipse, and you then moved the JAR file containing the “main” class to a different place in the file system <em>without telling Eclipse</em>, Eclipse would unwittingly launch the JVM with an incorrect classpath.</p>
<p>In short, if you get this problem in an IDE, check for things like stale IDE state, broken project references or broken launcher configurations.</p>
<p>It is also possible for an IDE to simply get confused. IDE’s are hugely complicated pieces of software comprising many interacting parts. Many of these parts adopt various caching strategies in order to make the IDE as a whole responsive. These can sometimes go wrong, and one possible symptom is problems when launching applications. If you suspect this could be happening, it is worth restarting your IDE.</p>
<hr>
<h5>
Other References
</h2>
<ul>
<li>
From the Oracle Java Tutorials - <a href="http://docs.oracle.com/javase/tutorial/getStarted/problems/index.html" rel="noreferrer">Common Problems (and Their Solutions)</a>
</li>
</ul>
</section>
<section id="answer-2-score-228" class="level4">
<h4>Answer 2 (score 228)</h4>
<p>If your source code name is HelloWorld.java, your compiled code will be <code>HelloWorld.class</code>.</p>
<p>You will get that error if you call it using:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true"></a>java HelloWorld.<span class="fu">class</span></span></code></pre></div>
<p>Instead, use this:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true"></a>java HelloWorld</span></code></pre></div>
</section>
<section id="answer-3-score-128" class="level4">
<h4>Answer 3 (score 128)</h4>
<p><strong>If your classes are in packages</strong> then you have to <code>cd</code> to the root directory of your project and run using the fully qualified name of the class (packageName.MainClassName).</p>
<p>Example:</p>
<p>My classes are in here:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true"></a>D:\project\com\cse\</span></code></pre></div>
<p>The fully qualified name of my main class is:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true"></a>com.<span class="fu">cse</span>.<span class="fu">Main</span></span></code></pre></div>
<p>So I <code>cd</code> back to the root project directory:</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true"></a>D:\project</span></code></pre></div>
<p>Then issue the <code>java</code> command:</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true"></a>java com.<span class="fu">cse</span>.<span class="fu">Main</span></span></code></pre></div>
<p><em>This answer is for rescuing newbie java programmers from the frustration caused by a common mistake, I recommend you read the accepted answer for more in depth knowledge about the java classpath.</em></p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-do-i-efficiently-iterate-over-each-entry-in-a-java-map-score-2356995-in-2019" class="level3">
<h3>10: How do I efficiently iterate over each entry in a Java Map? (score <a href="https://stackoverflow.com/q/46898.html">2356995</a> in 2019)</h3>
<section id="question-9" class="level4">
<h4>Question</h4>
<p>If I have an object implementing the <code>Map</code> interface in Java and I wish to iterate over every pair contained within it, what is the most efficient way of going through the map?</p>
<p>Will the ordering of elements depend on the specific map implementation that I have for the interface?</p>
</section>
<section id="answer-accepted-score-4782" class="level4">
<h4>Answer accepted (score 4782)</h4>
<div class="sourceCode" id="cb111"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true"></a><span class="bu">Map</span>&lt;<span class="bu">String</span>, <span class="bu">String</span>&gt; map = ...</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true"></a><span class="kw">for</span> (<span class="bu">Map</span>.<span class="fu">Entry</span>&lt;<span class="bu">String</span>, <span class="bu">String</span>&gt; entry : map.<span class="fu">entrySet</span>()) {</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true"></a>    <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(entry.<span class="fu">getKey</span>() + <span class="st">&quot;/&quot;</span> + entry.<span class="fu">getValue</span>());</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true"></a>}</span></code></pre></div>
</section>
<section id="answer-2-score-1069" class="level4">
<h4>Answer 2 (score 1069)</h4>
<p>To summarize the other answers and combine them with what I know, I found 10 main ways to do this (see below). Also, I wrote some performance tests (see results below). For example, if we want to find the sum of all of the keys and values of a map, we can write:</p>
<ol>
<li>
<p>
Using <strong>iterator</strong> and <strong>Map.Entry</strong>
</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true"></a><span class="dt">long</span> i = <span class="dv">0</span>;</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true"></a><span class="bu">Iterator</span>&lt;<span class="bu">Map</span>.<span class="fu">Entry</span>&lt;<span class="bu">Integer</span>, <span class="bu">Integer</span>&gt;&gt; it = map.<span class="fu">entrySet</span>().<span class="fu">iterator</span>();</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true"></a><span class="kw">while</span> (it.<span class="fu">hasNext</span>()) {</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true"></a>    <span class="bu">Map</span>.<span class="fu">Entry</span>&lt;<span class="bu">Integer</span>, <span class="bu">Integer</span>&gt; pair = it.<span class="fu">next</span>();</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true"></a>    i += pair.<span class="fu">getKey</span>() + pair.<span class="fu">getValue</span>();</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true"></a>}</span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true"></a>&lt;li&gt;&lt;p&gt;Using &lt;strong&gt;foreach&lt;/strong&gt; and &lt;strong&gt;<span class="bu">Map</span>.<span class="fu">Entry</span>&lt;/strong&gt;&lt;/p&gt;</span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true"></a></span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true"></a>```java</span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true"></a><span class="dt">long</span> i = <span class="dv">0</span>;</span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true"></a><span class="kw">for</span> (<span class="bu">Map</span>.<span class="fu">Entry</span>&lt;<span class="bu">Integer</span>, <span class="bu">Integer</span>&gt; pair : map.<span class="fu">entrySet</span>()) {</span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true"></a>    i += pair.<span class="fu">getKey</span>() + pair.<span class="fu">getValue</span>();</span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true"></a>}</span>
<span id="cb112-15"><a href="#cb112-15" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb112-16"><a href="#cb112-16" aria-hidden="true"></a>&lt;li&gt;&lt;p&gt;Using &lt;strong&gt;forEach&lt;/strong&gt; from Java <span class="dv">8</span>&lt;/p&gt;</span>
<span id="cb112-17"><a href="#cb112-17" aria-hidden="true"></a></span>
<span id="cb112-18"><a href="#cb112-18" aria-hidden="true"></a>```java</span>
<span id="cb112-19"><a href="#cb112-19" aria-hidden="true"></a><span class="dt">final</span> <span class="dt">long</span>[] i = {<span class="dv">0</span>};</span>
<span id="cb112-20"><a href="#cb112-20" aria-hidden="true"></a>map.<span class="fu">forEach</span>((k, v) -&gt; i[<span class="dv">0</span>] += k + v);</span>
<span id="cb112-21"><a href="#cb112-21" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb112-22"><a href="#cb112-22" aria-hidden="true"></a>&lt;li&gt;&lt;p&gt;Using &lt;strong&gt;keySet&lt;/strong&gt; and &lt;strong&gt;foreach&lt;/strong&gt;&lt;/p&gt;</span>
<span id="cb112-23"><a href="#cb112-23" aria-hidden="true"></a></span>
<span id="cb112-24"><a href="#cb112-24" aria-hidden="true"></a>```java</span>
<span id="cb112-25"><a href="#cb112-25" aria-hidden="true"></a><span class="dt">long</span> i = <span class="dv">0</span>;</span>
<span id="cb112-26"><a href="#cb112-26" aria-hidden="true"></a><span class="kw">for</span> (<span class="bu">Integer</span> key : map.<span class="fu">keySet</span>()) {</span>
<span id="cb112-27"><a href="#cb112-27" aria-hidden="true"></a>    i += key + map.<span class="fu">get</span>(key);</span>
<span id="cb112-28"><a href="#cb112-28" aria-hidden="true"></a>}</span>
<span id="cb112-29"><a href="#cb112-29" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb112-30"><a href="#cb112-30" aria-hidden="true"></a>&lt;li&gt;&lt;p&gt;Using &lt;strong&gt;keySet&lt;/strong&gt; and &lt;strong&gt;iterator&lt;/strong&gt;&lt;/p&gt;</span>
<span id="cb112-31"><a href="#cb112-31" aria-hidden="true"></a></span>
<span id="cb112-32"><a href="#cb112-32" aria-hidden="true"></a>```java</span>
<span id="cb112-33"><a href="#cb112-33" aria-hidden="true"></a><span class="dt">long</span> i = <span class="dv">0</span>;</span>
<span id="cb112-34"><a href="#cb112-34" aria-hidden="true"></a><span class="bu">Iterator</span>&lt;<span class="bu">Integer</span>&gt; itr2 = map.<span class="fu">keySet</span>().<span class="fu">iterator</span>();</span>
<span id="cb112-35"><a href="#cb112-35" aria-hidden="true"></a><span class="kw">while</span> (itr2.<span class="fu">hasNext</span>()) {</span>
<span id="cb112-36"><a href="#cb112-36" aria-hidden="true"></a>    <span class="bu">Integer</span> key = itr2.<span class="fu">next</span>();</span>
<span id="cb112-37"><a href="#cb112-37" aria-hidden="true"></a>    i += key + map.<span class="fu">get</span>(key);</span>
<span id="cb112-38"><a href="#cb112-38" aria-hidden="true"></a>}</span>
<span id="cb112-39"><a href="#cb112-39" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb112-40"><a href="#cb112-40" aria-hidden="true"></a>&lt;li&gt;&lt;p&gt;Using &lt;strong&gt;<span class="kw">for</span>&lt;/strong&gt; and &lt;strong&gt;<span class="bu">Map</span>.<span class="fu">Entry</span>&lt;/strong&gt;&lt;/p&gt;</span>
<span id="cb112-41"><a href="#cb112-41" aria-hidden="true"></a></span>
<span id="cb112-42"><a href="#cb112-42" aria-hidden="true"></a>```java</span>
<span id="cb112-43"><a href="#cb112-43" aria-hidden="true"></a><span class="dt">long</span> i = <span class="dv">0</span>;</span>
<span id="cb112-44"><a href="#cb112-44" aria-hidden="true"></a><span class="kw">for</span> (<span class="bu">Iterator</span>&lt;<span class="bu">Map</span>.<span class="fu">Entry</span>&lt;<span class="bu">Integer</span>, <span class="bu">Integer</span>&gt;&gt; entries = map.<span class="fu">entrySet</span>().<span class="fu">iterator</span>(); entries.<span class="fu">hasNext</span>(); ) {</span>
<span id="cb112-45"><a href="#cb112-45" aria-hidden="true"></a>    <span class="bu">Map</span>.<span class="fu">Entry</span>&lt;<span class="bu">Integer</span>, <span class="bu">Integer</span>&gt; entry = entries.<span class="fu">next</span>();</span>
<span id="cb112-46"><a href="#cb112-46" aria-hidden="true"></a>    i += entry.<span class="fu">getKey</span>() + entry.<span class="fu">getValue</span>();</span>
<span id="cb112-47"><a href="#cb112-47" aria-hidden="true"></a>}</span>
<span id="cb112-48"><a href="#cb112-48" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb112-49"><a href="#cb112-49" aria-hidden="true"></a>&lt;li&gt;&lt;p&gt;Using the Java <span class="dv">8</span> &lt;strong&gt;Stream API&lt;/strong&gt;&lt;/p&gt;</span>
<span id="cb112-50"><a href="#cb112-50" aria-hidden="true"></a></span>
<span id="cb112-51"><a href="#cb112-51" aria-hidden="true"></a>```java</span>
<span id="cb112-52"><a href="#cb112-52" aria-hidden="true"></a><span class="dt">final</span> <span class="dt">long</span>[] i = {<span class="dv">0</span>};</span>
<span id="cb112-53"><a href="#cb112-53" aria-hidden="true"></a>map.<span class="fu">entrySet</span>().<span class="fu">stream</span>().<span class="fu">forEach</span>(e -&gt; i[<span class="dv">0</span>] += e.<span class="fu">getKey</span>() + e.<span class="fu">getValue</span>());</span>
<span id="cb112-54"><a href="#cb112-54" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb112-55"><a href="#cb112-55" aria-hidden="true"></a>&lt;li&gt;&lt;p&gt;Using the Java <span class="dv">8</span> &lt;strong&gt;Stream API parallel&lt;/strong&gt;&lt;/p&gt;</span>
<span id="cb112-56"><a href="#cb112-56" aria-hidden="true"></a></span>
<span id="cb112-57"><a href="#cb112-57" aria-hidden="true"></a>```java</span>
<span id="cb112-58"><a href="#cb112-58" aria-hidden="true"></a><span class="dt">final</span> <span class="dt">long</span>[] i = {<span class="dv">0</span>};</span>
<span id="cb112-59"><a href="#cb112-59" aria-hidden="true"></a>map.<span class="fu">entrySet</span>().<span class="fu">stream</span>().<span class="fu">parallel</span>().<span class="fu">forEach</span>(e -&gt; i[<span class="dv">0</span>] += e.<span class="fu">getKey</span>() + e.<span class="fu">getValue</span>());</span>
<span id="cb112-60"><a href="#cb112-60" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb112-61"><a href="#cb112-61" aria-hidden="true"></a>&lt;li&gt;&lt;p&gt;Using &lt;strong&gt;IterableMap&lt;/strong&gt; of `Apache Collections`&lt;/p&gt;</span>
<span id="cb112-62"><a href="#cb112-62" aria-hidden="true"></a></span>
<span id="cb112-63"><a href="#cb112-63" aria-hidden="true"></a>```java</span>
<span id="cb112-64"><a href="#cb112-64" aria-hidden="true"></a><span class="dt">long</span> i = <span class="dv">0</span>;</span>
<span id="cb112-65"><a href="#cb112-65" aria-hidden="true"></a>MapIterator&lt;<span class="bu">Integer</span>, <span class="bu">Integer</span>&gt; it = iterableMap.<span class="fu">mapIterator</span>();</span>
<span id="cb112-66"><a href="#cb112-66" aria-hidden="true"></a><span class="kw">while</span> (it.<span class="fu">hasNext</span>()) {</span>
<span id="cb112-67"><a href="#cb112-67" aria-hidden="true"></a>    i += it.<span class="fu">next</span>() + it.<span class="fu">getValue</span>();</span>
<span id="cb112-68"><a href="#cb112-68" aria-hidden="true"></a>}</span>
<span id="cb112-69"><a href="#cb112-69" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb112-70"><a href="#cb112-70" aria-hidden="true"></a>&lt;li&gt;&lt;p&gt;Using &lt;strong&gt;MutableMap&lt;/strong&gt; of <span class="fu">Eclipse</span> (CS) collections&lt;/p&gt;</span>
<span id="cb112-71"><a href="#cb112-71" aria-hidden="true"></a></span>
<span id="cb112-72"><a href="#cb112-72" aria-hidden="true"></a>```java</span>
<span id="cb112-73"><a href="#cb112-73" aria-hidden="true"></a><span class="dt">final</span> <span class="dt">long</span>[] i = {<span class="dv">0</span>};</span>
<span id="cb112-74"><a href="#cb112-74" aria-hidden="true"></a>mutableMap.<span class="fu">forEachKeyValue</span>((key, value) -&gt; {</span>
<span id="cb112-75"><a href="#cb112-75" aria-hidden="true"></a>    i[<span class="dv">0</span>] += key + value;</span>
<span id="cb112-76"><a href="#cb112-76" aria-hidden="true"></a>});</span>
<span id="cb112-77"><a href="#cb112-77" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb112-78"><a href="#cb112-78" aria-hidden="true"></a>&lt;/ol&gt;</span>
<span id="cb112-79"><a href="#cb112-79" aria-hidden="true"></a></span>
<span id="cb112-80"><a href="#cb112-80" aria-hidden="true"></a>&lt;strong&gt;Perfomance tests&lt;/strong&gt; (mode = AverageTime, system = Windows&amp;nbsp;<span class="fl">8.</span><span class="dv">1</span> <span class="dv">64</span>-bit, Intel i7-<span class="dv">4790</span> <span class="fl">3.</span><span class="dv">60</span> GHz, <span class="dv">16</span>&amp;nbsp;GB)  </span>
<span id="cb112-81"><a href="#cb112-81" aria-hidden="true"></a></span>
<span id="cb112-82"><a href="#cb112-82" aria-hidden="true"></a>&lt;ol&gt;</span>
<span id="cb112-83"><a href="#cb112-83" aria-hidden="true"></a>&lt;li&gt;&lt;p&gt;For a small <span class="fu">map</span> (<span class="dv">100</span> elements), score <span class="fl">0.</span><span class="dv">308</span> is the best&lt;/p&gt;</span>
<span id="cb112-84"><a href="#cb112-84" aria-hidden="true"></a></span>
<span id="cb112-85"><a href="#cb112-85" aria-hidden="true"></a>```java</span>
<span id="cb112-86"><a href="#cb112-86" aria-hidden="true"></a>Benchmark                          Mode  Cnt  Score    <span class="bu">Error</span>  Units</span>
<span id="cb112-87"><a href="#cb112-87" aria-hidden="true"></a>test3_UsingForEachAndJava8         avgt  <span class="dv">10</span>   <span class="fl">0.</span><span class="dv">308</span> ±  <span class="fl">0.</span><span class="bn">021</span>  µs/op</span>
<span id="cb112-88"><a href="#cb112-88" aria-hidden="true"></a>test10_UsingEclipseMap             avgt  <span class="dv">10</span>   <span class="fl">0.</span><span class="dv">309</span> ±  <span class="fl">0.</span>009  µs/op</span>
<span id="cb112-89"><a href="#cb112-89" aria-hidden="true"></a>test1_UsingWhileAndMapEntry        avgt  <span class="dv">10</span>   <span class="fl">0.</span><span class="dv">380</span> ±  <span class="fl">0.</span><span class="bn">014</span>  µs/op</span>
<span id="cb112-90"><a href="#cb112-90" aria-hidden="true"></a>test6_UsingForAndIterator          avgt  <span class="dv">10</span>   <span class="fl">0.</span><span class="dv">387</span> ±  <span class="fl">0.</span><span class="bn">016</span>  µs/op</span>
<span id="cb112-91"><a href="#cb112-91" aria-hidden="true"></a>test2_UsingForEachAndMapEntry      avgt  <span class="dv">10</span>   <span class="fl">0.</span><span class="dv">391</span> ±  <span class="fl">0.</span><span class="bn">023</span>  µs/op</span>
<span id="cb112-92"><a href="#cb112-92" aria-hidden="true"></a>test7_UsingJava8StreamApi          avgt  <span class="dv">10</span>   <span class="fl">0.</span><span class="dv">510</span> ±  <span class="fl">0.</span><span class="bn">014</span>  µs/op</span>
<span id="cb112-93"><a href="#cb112-93" aria-hidden="true"></a>test9_UsingApacheIterableMap       avgt  <span class="dv">10</span>   <span class="fl">0.</span><span class="dv">524</span> ±  <span class="fl">0.</span>008  µs/op</span>
<span id="cb112-94"><a href="#cb112-94" aria-hidden="true"></a>test4_UsingKeySetAndForEach        avgt  <span class="dv">10</span>   <span class="fl">0.</span><span class="dv">816</span> ±  <span class="fl">0.</span><span class="bn">026</span>  µs/op</span>
<span id="cb112-95"><a href="#cb112-95" aria-hidden="true"></a>test5_UsingKeySetAndIterator       avgt  <span class="dv">10</span>   <span class="fl">0.</span><span class="dv">863</span> ±  <span class="fl">0.</span><span class="bn">025</span>  µs/op</span>
<span id="cb112-96"><a href="#cb112-96" aria-hidden="true"></a>test8_UsingJava8StreamApiParallel  avgt  <span class="dv">10</span>   <span class="fl">5.</span><span class="dv">552</span> ±  <span class="fl">0.</span><span class="dv">185</span>  µs/op</span>
<span id="cb112-97"><a href="#cb112-97" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb112-98"><a href="#cb112-98" aria-hidden="true"></a>&lt;li&gt;&lt;p&gt;For a map with <span class="dv">10000</span> elements,  score <span class="fl">37.</span><span class="dv">606</span> is the best&lt;/p&gt;</span>
<span id="cb112-99"><a href="#cb112-99" aria-hidden="true"></a></span>
<span id="cb112-100"><a href="#cb112-100" aria-hidden="true"></a>```java</span>
<span id="cb112-101"><a href="#cb112-101" aria-hidden="true"></a>Benchmark                           Mode   Cnt  Score      <span class="bu">Error</span>   Units</span>
<span id="cb112-102"><a href="#cb112-102" aria-hidden="true"></a>test10_UsingEclipseMap              avgt   <span class="dv">10</span>    <span class="fl">37.</span><span class="dv">606</span> ±   <span class="fl">0.</span><span class="dv">790</span>  µs/op</span>
<span id="cb112-103"><a href="#cb112-103" aria-hidden="true"></a>test3_UsingForEachAndJava8          avgt   <span class="dv">10</span>    <span class="fl">50.</span><span class="dv">368</span> ±   <span class="fl">0.</span><span class="dv">887</span>  µs/op</span>
<span id="cb112-104"><a href="#cb112-104" aria-hidden="true"></a>test6_UsingForAndIterator           avgt   <span class="dv">10</span>    <span class="fl">50.</span><span class="dv">332</span> ±   <span class="fl">0.</span><span class="dv">507</span>  µs/op</span>
<span id="cb112-105"><a href="#cb112-105" aria-hidden="true"></a>test2_UsingForEachAndMapEntry       avgt   <span class="dv">10</span>    <span class="fl">51.</span><span class="dv">406</span> ±   <span class="fl">1.</span><span class="bn">032</span>  µs/op</span>
<span id="cb112-106"><a href="#cb112-106" aria-hidden="true"></a>test1_UsingWhileAndMapEntry         avgt   <span class="dv">10</span>    <span class="fl">52.</span><span class="dv">538</span> ±   <span class="fl">2.</span><span class="dv">431</span>  µs/op</span>
<span id="cb112-107"><a href="#cb112-107" aria-hidden="true"></a>test7_UsingJava8StreamApi           avgt   <span class="dv">10</span>    <span class="fl">54.</span><span class="dv">464</span> ±   <span class="fl">0.</span><span class="dv">712</span>  µs/op</span>
<span id="cb112-108"><a href="#cb112-108" aria-hidden="true"></a>test4_UsingKeySetAndForEach         avgt   <span class="dv">10</span>    <span class="fl">79.</span><span class="bn">016</span> ±  <span class="fl">25.</span><span class="dv">345</span>  µs/op</span>
<span id="cb112-109"><a href="#cb112-109" aria-hidden="true"></a>test5_UsingKeySetAndIterator        avgt   <span class="dv">10</span>    <span class="fl">91.</span><span class="dv">105</span> ±  <span class="fl">10.</span><span class="dv">220</span>  µs/op</span>
<span id="cb112-110"><a href="#cb112-110" aria-hidden="true"></a>test8_UsingJava8StreamApiParallel   avgt   <span class="dv">10</span>   <span class="fl">112.</span><span class="dv">511</span> ±   <span class="fl">0.</span><span class="dv">365</span>  µs/op</span>
<span id="cb112-111"><a href="#cb112-111" aria-hidden="true"></a>test9_UsingApacheIterableMap        avgt   <span class="dv">10</span>   <span class="fl">125.</span><span class="dv">714</span> ±   <span class="fl">1.</span><span class="dv">935</span>  µs/op</span>
<span id="cb112-112"><a href="#cb112-112" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb112-113"><a href="#cb112-113" aria-hidden="true"></a>&lt;li&gt;&lt;p&gt;For a map with <span class="dv">100000</span> elements,  score <span class="fl">1184.</span><span class="dv">767</span> is the best&lt;/p&gt;</span>
<span id="cb112-114"><a href="#cb112-114" aria-hidden="true"></a></span>
<span id="cb112-115"><a href="#cb112-115" aria-hidden="true"></a>```java</span>
<span id="cb112-116"><a href="#cb112-116" aria-hidden="true"></a>Benchmark                          Mode   Cnt  Score        <span class="bu">Error</span>    Units</span>
<span id="cb112-117"><a href="#cb112-117" aria-hidden="true"></a>test1_UsingWhileAndMapEntry        avgt   <span class="dv">10</span>   <span class="fl">1184.</span><span class="dv">767</span> ±   <span class="fl">332.</span><span class="dv">968</span>  µs/op</span>
<span id="cb112-118"><a href="#cb112-118" aria-hidden="true"></a>test10_UsingEclipseMap             avgt   <span class="dv">10</span>   <span class="fl">1191.</span><span class="dv">735</span> ±   <span class="fl">304.</span><span class="dv">273</span>  µs/op</span>
<span id="cb112-119"><a href="#cb112-119" aria-hidden="true"></a>test2_UsingForEachAndMapEntry      avgt   <span class="dv">10</span>   <span class="fl">1205.</span><span class="dv">815</span> ±   <span class="fl">366.</span><span class="bn">043</span>  µs/op</span>
<span id="cb112-120"><a href="#cb112-120" aria-hidden="true"></a>test6_UsingForAndIterator          avgt   <span class="dv">10</span>   <span class="fl">1206.</span><span class="dv">873</span> ±   <span class="fl">367.</span><span class="dv">272</span>  µs/op</span>
<span id="cb112-121"><a href="#cb112-121" aria-hidden="true"></a>test8_UsingJava8StreamApiParallel  avgt   <span class="dv">10</span>   <span class="fl">1485.</span><span class="dv">895</span> ±   <span class="fl">233.</span><span class="dv">143</span>  µs/op</span>
<span id="cb112-122"><a href="#cb112-122" aria-hidden="true"></a>test5_UsingKeySetAndIterator       avgt   <span class="dv">10</span>   <span class="fl">1540.</span><span class="dv">281</span> ±   <span class="fl">357.</span><span class="dv">497</span>  µs/op</span>
<span id="cb112-123"><a href="#cb112-123" aria-hidden="true"></a>test4_UsingKeySetAndForEach        avgt   <span class="dv">10</span>   <span class="fl">1593.</span><span class="dv">342</span> ±   <span class="fl">294.</span><span class="dv">417</span>  µs/op</span>
<span id="cb112-124"><a href="#cb112-124" aria-hidden="true"></a>test3_UsingForEachAndJava8         avgt   <span class="dv">10</span>   <span class="fl">1666.</span><span class="dv">296</span> ±   <span class="fl">126.</span><span class="dv">443</span>  µs/op</span>
<span id="cb112-125"><a href="#cb112-125" aria-hidden="true"></a>test7_UsingJava8StreamApi          avgt   <span class="dv">10</span>   <span class="fl">1706.</span><span class="dv">676</span> ±   <span class="fl">436.</span><span class="dv">867</span>  µs/op</span>
<span id="cb112-126"><a href="#cb112-126" aria-hidden="true"></a>test9_UsingApacheIterableMap       avgt   <span class="dv">10</span>   <span class="fl">3289.</span><span class="dv">866</span> ±  <span class="fl">1445.</span><span class="dv">564</span>  µs/op</span>
<span id="cb112-127"><a href="#cb112-127" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb112-128"><a href="#cb112-128" aria-hidden="true"></a>&lt;/ol&gt;</span>
<span id="cb112-129"><a href="#cb112-129" aria-hidden="true"></a></span>
<span id="cb112-130"><a href="#cb112-130" aria-hidden="true"></a><span class="fu">Graphs</span> (performance tests depending on map size)  </span>
<span id="cb112-131"><a href="#cb112-131" aria-hidden="true"></a></span>
<span id="cb112-132"><a href="#cb112-132" aria-hidden="true"></a>&lt;a href=<span class="st">&quot;https://i.stack.imgur.com/17VGh.png&quot;</span> rel=<span class="st">&quot;noreferrer&quot;</span>&gt;&lt;img src=<span class="st">&quot;https://i.stack.imgur.com/17VGh.png&quot;</span> alt=<span class="st">&quot;Enter image description here&quot;</span>&gt;&lt;/a&gt;  </span>
<span id="cb112-133"><a href="#cb112-133" aria-hidden="true"></a></span>
<span id="cb112-134"><a href="#cb112-134" aria-hidden="true"></a><span class="fu">Table</span> (perfomance tests depending on map size)  </span>
<span id="cb112-135"><a href="#cb112-135" aria-hidden="true"></a></span>
<span id="cb112-136"><a href="#cb112-136" aria-hidden="true"></a>```java</span>
<span id="cb112-137"><a href="#cb112-137" aria-hidden="true"></a>          <span class="dv">100</span>     <span class="dv">600</span>      <span class="dv">1100</span>     <span class="dv">1600</span>     <span class="dv">2100</span></span>
<span id="cb112-138"><a href="#cb112-138" aria-hidden="true"></a>test10    <span class="fl">0.</span><span class="dv">333</span>    <span class="fl">1.</span><span class="dv">631</span>    <span class="fl">2.</span><span class="dv">752</span>    <span class="fl">5.</span><span class="dv">937</span>    <span class="fl">8.</span><span class="bn">024</span></span>
<span id="cb112-139"><a href="#cb112-139" aria-hidden="true"></a>test3     <span class="fl">0.</span><span class="dv">309</span>    <span class="fl">1.</span><span class="dv">971</span>    <span class="fl">4.</span><span class="dv">147</span>    <span class="fl">8.</span><span class="dv">147</span>   <span class="fl">10.</span><span class="dv">473</span></span>
<span id="cb112-140"><a href="#cb112-140" aria-hidden="true"></a>test6     <span class="fl">0.</span><span class="dv">372</span>    <span class="fl">2.</span><span class="dv">190</span>    <span class="fl">4.</span><span class="dv">470</span>    <span class="fl">8.</span><span class="dv">322</span>   <span class="fl">10.</span><span class="dv">531</span></span>
<span id="cb112-141"><a href="#cb112-141" aria-hidden="true"></a>test1     <span class="fl">0.</span><span class="dv">405</span>    <span class="fl">2.</span><span class="dv">237</span>    <span class="fl">4.</span><span class="dv">616</span>    <span class="fl">8.</span><span class="dv">645</span>   <span class="fl">10.</span><span class="dv">707</span></span>
<span id="cb112-142"><a href="#cb112-142" aria-hidden="true"></a>test2     <span class="fl">0.</span><span class="dv">376</span>    <span class="fl">2.</span><span class="dv">267</span>    <span class="fl">4.</span><span class="dv">809</span>    <span class="fl">8.</span><span class="dv">403</span>   <span class="fl">10.</span><span class="dv">910</span></span>
<span id="cb112-143"><a href="#cb112-143" aria-hidden="true"></a>test7     <span class="fl">0.</span><span class="dv">473</span>    <span class="fl">2.</span><span class="dv">448</span>    <span class="fl">5.</span><span class="dv">668</span>    <span class="fl">9.</span><span class="dv">790</span>   <span class="fl">12.</span><span class="dv">125</span></span>
<span id="cb112-144"><a href="#cb112-144" aria-hidden="true"></a>test9     <span class="fl">0.</span><span class="dv">565</span>    <span class="fl">2.</span><span class="dv">830</span>    <span class="fl">5.</span><span class="dv">952</span>   <span class="fl">13.</span><span class="dv">220</span>   <span class="fl">16.</span><span class="dv">965</span></span>
<span id="cb112-145"><a href="#cb112-145" aria-hidden="true"></a>test4     <span class="fl">0.</span><span class="dv">808</span>    <span class="fl">5.</span><span class="bn">012</span>    <span class="fl">8.</span><span class="dv">813</span>   <span class="fl">13.</span><span class="dv">939</span>   <span class="fl">17.</span><span class="dv">407</span></span>
<span id="cb112-146"><a href="#cb112-146" aria-hidden="true"></a>test5     <span class="fl">0.</span><span class="dv">810</span>    <span class="fl">5.</span><span class="dv">104</span>    <span class="fl">8.</span><span class="dv">533</span>   <span class="fl">14.</span><span class="bn">064</span>   <span class="fl">17.</span><span class="dv">422</span></span>
<span id="cb112-147"><a href="#cb112-147" aria-hidden="true"></a>test8     <span class="fl">5.</span><span class="dv">173</span>   <span class="fl">12.</span><span class="dv">499</span>   <span class="fl">17.</span><span class="dv">351</span>   <span class="fl">24.</span><span class="dv">671</span>   <span class="fl">30.</span><span class="dv">403</span></span></code></pre></div>
<p>All tests are on <a href="https://github.com/Vedenin/useful-java-links/blob/master/helloworlds/5.0-other-examples/src/main/java/other_examples/IterateThroughHashMapTest.java" rel="noreferrer">GitHub</a>.</p>
</section>
<section id="answer-3-score-272" class="level4">
<h4>Answer 3 (score 272)</h4>
<p>In Java 8 you can do it clean and fast using the new lambdas features:</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true"></a> <span class="bu">Map</span>&lt;<span class="bu">String</span>,<span class="bu">String</span>&gt; map = <span class="kw">new</span> <span class="bu">HashMap</span>&lt;&gt;();</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true"></a> map.<span class="fu">put</span>(<span class="st">&quot;SomeKey&quot;</span>, <span class="st">&quot;SomeValue&quot;</span>);</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true"></a> map.<span class="fu">forEach</span>( (k,v) -&gt; [<span class="kw">do</span> something with key and value] );</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true"></a></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true"></a> <span class="co">// such as</span></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true"></a> map.<span class="fu">forEach</span>( (k,v) -&gt; <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;Key: &quot;</span> + k + <span class="st">&quot;: Value: &quot;</span> + v));</span></code></pre></div>
<p>The type of <code>k</code> and <code>v</code> will be inferred by the compiler and there is no need to use <code>Map.Entry</code> anymore.</p>
<p>Easy-peasy!</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="whats-the-simplest-way-to-print-a-java-array-score-2123014-in-2019" class="level3">
<h3>11: What’s the simplest way to print a Java array? (score <a href="https://stackoverflow.com/q/409784.html">2123014</a> in 2019)</h3>
<section id="question-10" class="level4">
<h4>Question</h4>
<p>In Java, arrays don’t override <code>toString()</code>, so if you try to print one directly, you get the <code>className</code> + ‘@’ + the hex of the <a href="https://en.wikipedia.org/wiki/Java_hashCode()" rel="noreferrer"><code>hashCode</code></a> of the array, as defined by <code>Object.toString()</code>:</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true"></a><span class="dt">int</span>[] intArray = <span class="kw">new</span> <span class="dt">int</span>[] {<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>};</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true"></a><span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(intArray);     <span class="co">// prints something like &#39;[I@3343c8b3&#39;</span></span></code></pre></div>
<p>But usually, we’d actually want something more like <code>[1, 2, 3, 4, 5]</code>. What’s the simplest way of doing that? Here are some example inputs and outputs:</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true"></a><span class="co">// Array of primitives:</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true"></a><span class="dt">int</span>[] intArray = <span class="kw">new</span> <span class="dt">int</span>[] {<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>};</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true"></a><span class="co">//output: [1, 2, 3, 4, 5]</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true"></a></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true"></a><span class="co">// Array of object references:</span></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true"></a><span class="bu">String</span>[] strArray = <span class="kw">new</span> <span class="bu">String</span>[] {<span class="st">&quot;John&quot;</span>, <span class="st">&quot;Mary&quot;</span>, <span class="st">&quot;Bob&quot;</span>};</span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true"></a><span class="co">//output: [John, Mary, Bob]</span></span></code></pre></div>
</section>
<section id="answer-accepted-score-2448" class="level4">
<h4>Answer accepted (score 2448)</h4>
<p>Since Java 5 you can use <a href="https://docs.oracle.com/javase/9/docs/api/java/util/Arrays.html
#toString-int:A-" rel="noreferrer"><code>Arrays.toString(arr)</code></a> or <a href="https://docs.oracle.com/javase/9/docs/api/java/util/Arrays.html#deepToString-java.lang.Object:A-" rel="noreferrer"><code>Arrays.deepToString(arr)</code></a> for arrays within arrays. Note that the <code>Object[]</code> version calls <code>.toString()</code> on each object in the array. The output is even decorated in the exact way you’re asking.</p>
<p>Examples:</p>
<ul>
<li>
<h5>
Simple Array:
</h3>
<div class="sourceCode" id="cb116"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true"></a><span class="bu">String</span>[] array = <span class="kw">new</span> <span class="bu">String</span>[] {<span class="st">&quot;John&quot;</span>, <span class="st">&quot;Mary&quot;</span>, <span class="st">&quot;Bob&quot;</span>};</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true"></a><span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="bu">Arrays</span>.<span class="fu">toString</span>(array));</span></code></pre></div>
<p>Output:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true"></a>[John, Mary, Bob]</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true"></a>&lt;li&gt;&lt;h5&gt;Nested <span class="bu">Array</span>:&lt;/h3&gt;</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true"></a></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true"></a>```java</span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true"></a><span class="bu">String</span>[][] deepArray = <span class="kw">new</span> <span class="bu">String</span>[][] {{<span class="st">&quot;John&quot;</span>, <span class="st">&quot;Mary&quot;</span>}, {<span class="st">&quot;Alice&quot;</span>, <span class="st">&quot;Bob&quot;</span>}};</span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true"></a><span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="bu">Arrays</span>.<span class="fu">toString</span>(deepArray));</span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true"></a><span class="co">//output: [[Ljava.lang.String;@106d69c, [Ljava.lang.String;@52e922]</span></span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true"></a><span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="bu">Arrays</span>.<span class="fu">deepToString</span>(deepArray));</span></code></pre></div>
<p>Output:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true"></a>[[John, Mary], [Alice, Bob]]</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true"></a>&lt;li&gt;&lt;h5&gt;`double` <span class="bu">Array</span>:&lt;/h3&gt;</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true"></a></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true"></a>```java</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true"></a><span class="dt">double</span>[] doubleArray = { <span class="fl">7.</span><span class="dv">0</span>, <span class="fl">9.</span><span class="dv">0</span>, <span class="fl">5.</span><span class="dv">0</span>, <span class="fl">1.</span><span class="dv">0</span>, <span class="fl">3.</span><span class="dv">0</span> };</span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true"></a><span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="bu">Arrays</span>.<span class="fu">toString</span>(doubleArray));</span></code></pre></div>
<p>Output:</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true"></a>[<span class="fl">7.</span><span class="dv">0</span>, <span class="fl">9.</span><span class="dv">0</span>, <span class="fl">5.</span><span class="dv">0</span>, <span class="fl">1.</span><span class="dv">0</span>, <span class="fl">3.</span><span class="dv">0</span> ]</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true"></a>&lt;li&gt;&lt;h5&gt;`int` <span class="bu">Array</span>:&lt;/h3&gt;</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true"></a></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true"></a>```java</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true"></a><span class="dt">int</span>[] intArray = { <span class="dv">7</span>, <span class="dv">9</span>, <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">3</span> };</span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true"></a><span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="bu">Arrays</span>.<span class="fu">toString</span>(intArray));</span></code></pre></div>
<p>Output:</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true"></a>[<span class="dv">7</span>, <span class="dv">9</span>, <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">3</span> ]</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true"></a>&lt;/ul&gt;</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true"></a></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true"></a></span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true"></a>#### Answer <span class="dv">2</span> (score <span class="dv">340</span>)</span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true"></a>Always check the standard libraries first.  Try:  </span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true"></a></span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true"></a>```java</span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true"></a><span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="bu">Arrays</span>.<span class="fu">toString</span>(array));</span></code></pre></div>
<p>or if your array contains other arrays as elements:</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true"></a><span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="bu">Arrays</span>.<span class="fu">deepToString</span>(array));</span></code></pre></div>
</section>
<section id="answer-3-score-102" class="level4">
<h4>Answer 3 (score 102)</h4>
<p>This is nice to know, however, as for “always check the standard libraries first” I’d never have stumbled upon the trick of <code>Arrays.toString( myarray )</code></p>
<p>–since I was concentrating on the type of myarray to see how to do this. I didn’t want to have to iterate through the thing: I wanted an easy call to make it come out similar to what I see in the Eclipse debugger and myarray.toString() just wasn’t doing it.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true"></a><span class="kw">import</span><span class="im"> java.util.Arrays;</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true"></a>.</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true"></a>.</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true"></a>.</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true"></a><span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>( <span class="bu">Arrays</span>.<span class="fu">toString</span>( myarray ) );</span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-do-i-read-convert-an-inputstream-into-a-string-in-java-score-2007290-in-2019" class="level3">
<h3>12: How do I read / convert an InputStream into a String in Java? (score <a href="https://stackoverflow.com/q/309424.html">2007290</a> in 2019)</h3>
<section id="question-11" class="level4">
<h4>Question</h4>
<p>If you have a <code>java.io.InputStream</code> object, how should you process that object and produce a <code>String</code>?</p>
<hr>
<p>Suppose I have an <code>InputStream</code> that contains text data, and I want to convert it to a <code>String</code>, so for example I can write that to a log file.</p>
<p>What is the easiest way to take the <code>InputStream</code> and convert it to a <code>String</code>?</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true"></a><span class="kw">public</span> <span class="bu">String</span> <span class="fu">convertStreamToString</span>(<span class="bu">InputStream</span> is) {</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true"></a>    <span class="co">// ???</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true"></a>}</span></code></pre></div>
</section>
<section id="answer-accepted-score-2401" class="level4">
<h4>Answer accepted (score 2401)</h4>
<p>A nice way to do this is using <a href="http://commons.apache.org/" rel="noreferrer">Apache commons</a> <code>&lt;a href="https://commons.apache.org/proper/commons-io/javadocs/api-release/org/apache/commons/io/IOUtils.html" rel="noreferrer"&gt;IOUtils&lt;/a&gt;</code> to copy the <code>InputStream</code> into a <code>StringWriter</code>… something like</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true"></a><span class="bu">StringWriter</span> writer = <span class="kw">new</span> <span class="bu">StringWriter</span>();</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true"></a>IOUtils.<span class="fu">copy</span>(inputStream, writer, encoding);</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true"></a><span class="bu">String</span> theString = writer.<span class="fu">toString</span>();</span></code></pre></div>
<p>or even</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true"></a><span class="co">// NB: does not close inputStream, you&#39;ll have to use try-with-resources for that</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true"></a><span class="bu">String</span> theString = IOUtils.<span class="fu">toString</span>(inputStream, encoding); </span></code></pre></div>
<p>Alternatively, you could use <code>ByteArrayOutputStream</code> if you don’t want to mix your Streams and Writers</p>
</section>
<section id="answer-2-score-2264" class="level4">
<h4>Answer 2 (score 2264)</h4>
<p>Here’s a way using only the standard Java library (note that the stream is not closed, your mileage may vary).</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true"></a><span class="dt">static</span> <span class="bu">String</span> <span class="fu">convertStreamToString</span>(java.<span class="fu">io</span>.<span class="fu">InputStream</span> is) {</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true"></a>    java.<span class="fu">util</span>.<span class="fu">Scanner</span> s = <span class="kw">new</span> java.<span class="fu">util</span>.<span class="fu">Scanner</span>(is).<span class="fu">useDelimiter</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">A&quot;</span>);</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true"></a>    <span class="kw">return</span> s.<span class="fu">hasNext</span>() ? s.<span class="fu">next</span>() : <span class="st">&quot;&quot;</span>;</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true"></a>}</span></code></pre></div>
<p>I learned this trick from <a href="https://community.oracle.com/blogs/pat/2004/10/23/stupid-scanner-tricks" rel="noreferrer">“Stupid Scanner tricks”</a> article. The reason it works is because <a href="http://download.oracle.com/javase/8/docs/api/java/util/Scanner.html" rel="noreferrer">Scanner</a> iterates over tokens in the stream, and in this case we separate tokens using “beginning of the input boundary” (), thus giving us only one token for the entire contents of the stream.</p>
<p><strong>Note, if you need to be specific about the input stream’s encoding, you can provide the second argument to <code>Scanner</code> constructor that indicates what character set to use (e.g. “UTF-8”).</strong></p>
<p>Hat tip goes also to <a href="https://stackoverflow.com/users/68127/jacob-gabrielson">Jacob</a>, who once pointed me to the said article.</p>
</section>
<section id="answer-3-score-2208" class="level4">
<h4>Answer 3 (score 2208)</h4>
<p>Summarize other answers I found 11 main ways to do this (see below). And I wrote some performance tests (see results below):</p>
<p><strong>Ways to convert an InputStream to a String:</strong></p>
<ol>
<li>
<p>
Using <code>IOUtils.toString</code> (Apache Utils)
</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true"></a><span class="bu">String</span> result = IOUtils.<span class="fu">toString</span>(inputStream, StandardCharsets.<span class="fu">UTF_8</span>);</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true"></a>&lt;li&gt;&lt;p&gt;Using `CharStreams` (Guava) &lt;/p&gt;</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true"></a></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true"></a>```java</span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true"></a><span class="bu">String</span> result = CharStreams.<span class="fu">toString</span>(<span class="kw">new</span> <span class="bu">InputStreamReader</span>(</span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true"></a>      inputStream, Charsets.<span class="fu">UTF_8</span>));</span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true"></a>&lt;li&gt;&lt;p&gt;Using `Scanner` (JDK) &lt;/p&gt;</span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true"></a></span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true"></a>```java</span>
<span id="cb127-12"><a href="#cb127-12" aria-hidden="true"></a><span class="bu">Scanner</span> s = <span class="kw">new</span> <span class="bu">Scanner</span>(inputStream).<span class="fu">useDelimiter</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">A&quot;</span>);</span>
<span id="cb127-13"><a href="#cb127-13" aria-hidden="true"></a><span class="bu">String</span> result = s.<span class="fu">hasNext</span>() ? s.<span class="fu">next</span>() : <span class="st">&quot;&quot;</span>;</span>
<span id="cb127-14"><a href="#cb127-14" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb127-15"><a href="#cb127-15" aria-hidden="true"></a>&lt;li&gt;&lt;p&gt;Using &lt;strong&gt;Stream API&lt;/strong&gt; (Java <span class="dv">8</span>). &lt;strong&gt;Warning&lt;/strong&gt;: This solution converts different line <span class="fu">breaks</span> (like `\r\n`) to `\n`.&lt;/p&gt;</span>
<span id="cb127-16"><a href="#cb127-16" aria-hidden="true"></a></span>
<span id="cb127-17"><a href="#cb127-17" aria-hidden="true"></a>```java</span>
<span id="cb127-18"><a href="#cb127-18" aria-hidden="true"></a><span class="bu">String</span> result = <span class="kw">new</span> <span class="bu">BufferedReader</span>(<span class="kw">new</span> <span class="bu">InputStreamReader</span>(inputStream))</span>
<span id="cb127-19"><a href="#cb127-19" aria-hidden="true"></a>  .<span class="fu">lines</span>().<span class="fu">collect</span>(Collectors.<span class="fu">joining</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>));</span>
<span id="cb127-20"><a href="#cb127-20" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb127-21"><a href="#cb127-21" aria-hidden="true"></a>&lt;li&gt;&lt;p&gt;Using &lt;strong&gt;parallel Stream API&lt;/strong&gt; (Java <span class="dv">8</span>). &lt;strong&gt;Warning&lt;/strong&gt;: This solution converts different line <span class="fu">breaks</span> (like `\r\n`) to `\n`.    &lt;/p&gt;</span>
<span id="cb127-22"><a href="#cb127-22" aria-hidden="true"></a></span>
<span id="cb127-23"><a href="#cb127-23" aria-hidden="true"></a>```java</span>
<span id="cb127-24"><a href="#cb127-24" aria-hidden="true"></a><span class="bu">String</span> result = <span class="kw">new</span> <span class="bu">BufferedReader</span>(<span class="kw">new</span> <span class="bu">InputStreamReader</span>(inputStream)).<span class="fu">lines</span>()</span>
<span id="cb127-25"><a href="#cb127-25" aria-hidden="true"></a>   .<span class="fu">parallel</span>().<span class="fu">collect</span>(Collectors.<span class="fu">joining</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>));</span>
<span id="cb127-26"><a href="#cb127-26" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb127-27"><a href="#cb127-27" aria-hidden="true"></a>&lt;li&gt;&lt;p&gt;Using `InputStreamReader` and `StringBuilder` (JDK) &lt;/p&gt;</span>
<span id="cb127-28"><a href="#cb127-28" aria-hidden="true"></a></span>
<span id="cb127-29"><a href="#cb127-29" aria-hidden="true"></a>```java</span>
<span id="cb127-30"><a href="#cb127-30" aria-hidden="true"></a><span class="dt">final</span> <span class="dt">int</span> bufferSize = <span class="dv">1024</span>;</span>
<span id="cb127-31"><a href="#cb127-31" aria-hidden="true"></a><span class="dt">final</span> <span class="dt">char</span>[] buffer = <span class="kw">new</span> <span class="dt">char</span>[bufferSize];</span>
<span id="cb127-32"><a href="#cb127-32" aria-hidden="true"></a><span class="dt">final</span> <span class="bu">StringBuilder</span> out = <span class="kw">new</span> <span class="bu">StringBuilder</span>();</span>
<span id="cb127-33"><a href="#cb127-33" aria-hidden="true"></a><span class="bu">Reader</span> in = <span class="kw">new</span> <span class="bu">InputStreamReader</span>(inputStream, <span class="st">&quot;UTF-8&quot;</span>);</span>
<span id="cb127-34"><a href="#cb127-34" aria-hidden="true"></a><span class="kw">for</span> (; ; ) {</span>
<span id="cb127-35"><a href="#cb127-35" aria-hidden="true"></a>    <span class="dt">int</span> rsz = in.<span class="fu">read</span>(buffer, <span class="dv">0</span>, buffer.<span class="fu">length</span>);</span>
<span id="cb127-36"><a href="#cb127-36" aria-hidden="true"></a>    <span class="kw">if</span> (rsz &lt; <span class="dv">0</span>)</span>
<span id="cb127-37"><a href="#cb127-37" aria-hidden="true"></a>        <span class="kw">break</span>;</span>
<span id="cb127-38"><a href="#cb127-38" aria-hidden="true"></a>    out.<span class="fu">append</span>(buffer, <span class="dv">0</span>, rsz);</span>
<span id="cb127-39"><a href="#cb127-39" aria-hidden="true"></a>}</span>
<span id="cb127-40"><a href="#cb127-40" aria-hidden="true"></a><span class="kw">return</span> out.<span class="fu">toString</span>();</span>
<span id="cb127-41"><a href="#cb127-41" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb127-42"><a href="#cb127-42" aria-hidden="true"></a>&lt;li&gt;&lt;p&gt;Using `StringWriter` and `IOUtils.<span class="fu">copy</span>` (Apache Commons)&lt;/p&gt;</span>
<span id="cb127-43"><a href="#cb127-43" aria-hidden="true"></a></span>
<span id="cb127-44"><a href="#cb127-44" aria-hidden="true"></a>```java</span>
<span id="cb127-45"><a href="#cb127-45" aria-hidden="true"></a><span class="bu">StringWriter</span> writer = <span class="kw">new</span> <span class="bu">StringWriter</span>();</span>
<span id="cb127-46"><a href="#cb127-46" aria-hidden="true"></a>IOUtils.<span class="fu">copy</span>(inputStream, writer, <span class="st">&quot;UTF-8&quot;</span>);</span>
<span id="cb127-47"><a href="#cb127-47" aria-hidden="true"></a><span class="kw">return</span> writer.<span class="fu">toString</span>();</span>
<span id="cb127-48"><a href="#cb127-48" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb127-49"><a href="#cb127-49" aria-hidden="true"></a>&lt;li&gt;&lt;p&gt;Using `ByteArrayOutputStream` and `inputStream.<span class="fu">read</span>` (JDK)  &lt;/p&gt;</span>
<span id="cb127-50"><a href="#cb127-50" aria-hidden="true"></a></span>
<span id="cb127-51"><a href="#cb127-51" aria-hidden="true"></a>```java</span>
<span id="cb127-52"><a href="#cb127-52" aria-hidden="true"></a><span class="bu">ByteArrayOutputStream</span> result = <span class="kw">new</span> <span class="bu">ByteArrayOutputStream</span>();</span>
<span id="cb127-53"><a href="#cb127-53" aria-hidden="true"></a><span class="dt">byte</span>[] buffer = <span class="kw">new</span> <span class="dt">byte</span>[<span class="dv">1024</span>];</span>
<span id="cb127-54"><a href="#cb127-54" aria-hidden="true"></a><span class="dt">int</span> length;</span>
<span id="cb127-55"><a href="#cb127-55" aria-hidden="true"></a><span class="kw">while</span> ((length = inputStream.<span class="fu">read</span>(buffer)) != -<span class="dv">1</span>) {</span>
<span id="cb127-56"><a href="#cb127-56" aria-hidden="true"></a>    result.<span class="fu">write</span>(buffer, <span class="dv">0</span>, length);</span>
<span id="cb127-57"><a href="#cb127-57" aria-hidden="true"></a>}</span>
<span id="cb127-58"><a href="#cb127-58" aria-hidden="true"></a><span class="co">// StandardCharsets.UTF_8.name() &gt; JDK 7</span></span>
<span id="cb127-59"><a href="#cb127-59" aria-hidden="true"></a><span class="kw">return</span> result.<span class="fu">toString</span>(<span class="st">&quot;UTF-8&quot;</span>);</span>
<span id="cb127-60"><a href="#cb127-60" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb127-61"><a href="#cb127-61" aria-hidden="true"></a>&lt;li&gt;&lt;p&gt;Using `BufferedReader` (JDK). &lt;strong&gt;Warning:&lt;/strong&gt; This solution converts different line <span class="fu">breaks</span> (like `\n\r`) to `line.<span class="fu">separator</span>` system <span class="fu">property</span> (<span class="kw">for</span> example, in Windows to <span class="st">&quot;</span><span class="sc">\r\n</span><span class="st">&quot;</span>).&lt;/p&gt;</span>
<span id="cb127-62"><a href="#cb127-62" aria-hidden="true"></a></span>
<span id="cb127-63"><a href="#cb127-63" aria-hidden="true"></a>```java</span>
<span id="cb127-64"><a href="#cb127-64" aria-hidden="true"></a><span class="bu">String</span> newLine = <span class="bu">System</span>.<span class="fu">getProperty</span>(<span class="st">&quot;line.separator&quot;</span>);</span>
<span id="cb127-65"><a href="#cb127-65" aria-hidden="true"></a><span class="bu">BufferedReader</span> reader = <span class="kw">new</span> <span class="bu">BufferedReader</span>(<span class="kw">new</span> <span class="bu">InputStreamReader</span>(inputStream));</span>
<span id="cb127-66"><a href="#cb127-66" aria-hidden="true"></a><span class="bu">StringBuilder</span> result = <span class="kw">new</span> <span class="bu">StringBuilder</span>();</span>
<span id="cb127-67"><a href="#cb127-67" aria-hidden="true"></a><span class="dt">boolean</span> flag = <span class="kw">false</span>;</span>
<span id="cb127-68"><a href="#cb127-68" aria-hidden="true"></a><span class="kw">for</span> (<span class="bu">String</span> line; (line = reader.<span class="fu">readLine</span>()) != <span class="kw">null</span>; ) {</span>
<span id="cb127-69"><a href="#cb127-69" aria-hidden="true"></a>    result.<span class="fu">append</span>(flag? newLine: <span class="st">&quot;&quot;</span>).<span class="fu">append</span>(line);</span>
<span id="cb127-70"><a href="#cb127-70" aria-hidden="true"></a>    flag = <span class="kw">true</span>;</span>
<span id="cb127-71"><a href="#cb127-71" aria-hidden="true"></a>}</span>
<span id="cb127-72"><a href="#cb127-72" aria-hidden="true"></a><span class="kw">return</span> result.<span class="fu">toString</span>();</span>
<span id="cb127-73"><a href="#cb127-73" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb127-74"><a href="#cb127-74" aria-hidden="true"></a>&lt;li&gt;&lt;p&gt;Using `BufferedInputStream` and `ByteArrayOutputStream` (JDK) &lt;/p&gt;</span>
<span id="cb127-75"><a href="#cb127-75" aria-hidden="true"></a></span>
<span id="cb127-76"><a href="#cb127-76" aria-hidden="true"></a>```java</span>
<span id="cb127-77"><a href="#cb127-77" aria-hidden="true"></a><span class="bu">BufferedInputStream</span> bis = <span class="kw">new</span> <span class="bu">BufferedInputStream</span>(inputStream);</span>
<span id="cb127-78"><a href="#cb127-78" aria-hidden="true"></a><span class="bu">ByteArrayOutputStream</span> buf = <span class="kw">new</span> <span class="bu">ByteArrayOutputStream</span>();</span>
<span id="cb127-79"><a href="#cb127-79" aria-hidden="true"></a><span class="dt">int</span> result = bis.<span class="fu">read</span>();</span>
<span id="cb127-80"><a href="#cb127-80" aria-hidden="true"></a><span class="kw">while</span>(result != -<span class="dv">1</span>) {</span>
<span id="cb127-81"><a href="#cb127-81" aria-hidden="true"></a>    buf.<span class="fu">write</span>((<span class="dt">byte</span>) result);</span>
<span id="cb127-82"><a href="#cb127-82" aria-hidden="true"></a>    result = bis.<span class="fu">read</span>();</span>
<span id="cb127-83"><a href="#cb127-83" aria-hidden="true"></a>}</span>
<span id="cb127-84"><a href="#cb127-84" aria-hidden="true"></a><span class="co">// StandardCharsets.UTF_8.name() &gt; JDK 7</span></span>
<span id="cb127-85"><a href="#cb127-85" aria-hidden="true"></a><span class="kw">return</span> buf.<span class="fu">toString</span>(<span class="st">&quot;UTF-8&quot;</span>);</span>
<span id="cb127-86"><a href="#cb127-86" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb127-87"><a href="#cb127-87" aria-hidden="true"></a>&lt;li&gt;&lt;p&gt;Using `inputStream.<span class="fu">read</span>()` and `StringBuilder` (JDK). &lt;strong&gt;Warning&lt;/strong&gt;: This solution has problems with Unicode, <span class="kw">for</span> example with Russian <span class="fu">text</span> (works correctly only with non-Unicode text)&lt;/p&gt;</span>
<span id="cb127-88"><a href="#cb127-88" aria-hidden="true"></a></span>
<span id="cb127-89"><a href="#cb127-89" aria-hidden="true"></a>```java</span>
<span id="cb127-90"><a href="#cb127-90" aria-hidden="true"></a><span class="dt">int</span> ch;</span>
<span id="cb127-91"><a href="#cb127-91" aria-hidden="true"></a><span class="bu">StringBuilder</span> sb = <span class="kw">new</span> <span class="bu">StringBuilder</span>();</span>
<span id="cb127-92"><a href="#cb127-92" aria-hidden="true"></a><span class="kw">while</span>((ch = inputStream.<span class="fu">read</span>()) != -<span class="dv">1</span>)</span>
<span id="cb127-93"><a href="#cb127-93" aria-hidden="true"></a>    sb.<span class="fu">append</span>((<span class="dt">char</span>)ch);</span>
<span id="cb127-94"><a href="#cb127-94" aria-hidden="true"></a><span class="fu">reset</span>();</span>
<span id="cb127-95"><a href="#cb127-95" aria-hidden="true"></a><span class="kw">return</span> sb.<span class="fu">toString</span>();</span>
<span id="cb127-96"><a href="#cb127-96" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb127-97"><a href="#cb127-97" aria-hidden="true"></a>&lt;/ol&gt;</span>
<span id="cb127-98"><a href="#cb127-98" aria-hidden="true"></a></span>
<span id="cb127-99"><a href="#cb127-99" aria-hidden="true"></a>&lt;strong&gt;Warning&lt;/strong&gt;:  </span>
<span id="cb127-100"><a href="#cb127-100" aria-hidden="true"></a></span>
<span id="cb127-101"><a href="#cb127-101" aria-hidden="true"></a>&lt;ol&gt;</span>
<span id="cb127-102"><a href="#cb127-102" aria-hidden="true"></a>&lt;li&gt;&lt;p&gt;Solutions <span class="dv">4</span>, <span class="dv">5</span> and <span class="dv">9</span> convert different line breaks to one.&lt;/p&gt;&lt;/li&gt;</span>
<span id="cb127-103"><a href="#cb127-103" aria-hidden="true"></a>&lt;li&gt;&lt;p&gt;Solution <span class="dv">11</span> can&#39;t work correctly with Unicode text&lt;/p&gt;&lt;/li&gt;</span>
<span id="cb127-104"><a href="#cb127-104" aria-hidden="true"></a>&lt;/ol&gt;</span>
<span id="cb127-105"><a href="#cb127-105" aria-hidden="true"></a></span>
<span id="cb127-106"><a href="#cb127-106" aria-hidden="true"></a>&lt;strong&gt;Performance tests&lt;/strong&gt;  </span>
<span id="cb127-107"><a href="#cb127-107" aria-hidden="true"></a></span>
<span id="cb127-108"><a href="#cb127-108" aria-hidden="true"></a>Performance tests <span class="kw">for</span> small `String` (length = <span class="dv">175</span>), url in &lt;a href=<span class="st">&quot;https://github.com/Vedenin/useful-java-links/blob/master/helloworlds/5.0-other-examples/src/main/java/other_examples/ConvertInputStreamToStringBenchmark.java&quot;</span> rel=<span class="st">&quot;noreferrer&quot;</span>&gt;github&lt;/a&gt; (mode = Average <span class="bu">Time</span>, system = Linux, score <span class="dv">1</span>,<span class="dv">343</span> is the best):  </span>
<span id="cb127-109"><a href="#cb127-109" aria-hidden="true"></a></span>
<span id="cb127-110"><a href="#cb127-110" aria-hidden="true"></a>```java</span>
<span id="cb127-111"><a href="#cb127-111" aria-hidden="true"></a>              Benchmark                         Mode  Cnt   Score   <span class="bu">Error</span>  Units</span>
<span id="cb127-112"><a href="#cb127-112" aria-hidden="true"></a> <span class="fl">8.</span> <span class="bu">ByteArrayOutputStream</span> and <span class="fu">read</span> (JDK)        avgt   <span class="dv">10</span>   <span class="dv">1</span>,<span class="dv">343</span> ± <span class="dv">0</span>,028  us/op</span>
<span id="cb127-113"><a href="#cb127-113" aria-hidden="true"></a> <span class="fl">6.</span> <span class="bu">InputStreamReader</span> and <span class="bu">StringBuilder</span> (JDK)   avgt   <span class="dv">10</span>   <span class="dv">6</span>,<span class="dv">980</span> ± <span class="dv">0</span>,<span class="dv">404</span>  us/op</span>
<span id="cb127-114"><a href="#cb127-114" aria-hidden="true"></a><span class="fl">10.</span> <span class="bu">BufferedInputStream</span>, <span class="bu">ByteArrayOutputStream</span>  avgt   <span class="dv">10</span>   <span class="dv">7</span>,<span class="dv">437</span> ± <span class="dv">0</span>,<span class="dv">735</span>  us/op</span>
<span id="cb127-115"><a href="#cb127-115" aria-hidden="true"></a><span class="fl">11.</span> <span class="bu">InputStream</span>.<span class="fu">read</span>() and <span class="bu">StringBuilder</span> (JDK)  avgt   <span class="dv">10</span>   <span class="dv">8</span>,<span class="dv">977</span> ± <span class="dv">0</span>,<span class="dv">328</span>  us/op</span>
<span id="cb127-116"><a href="#cb127-116" aria-hidden="true"></a> <span class="fl">7.</span> <span class="bu">StringWriter</span> and IOUtils.<span class="fu">copy</span> (Apache)      avgt   <span class="dv">10</span>  <span class="dv">10</span>,<span class="dv">613</span> ± <span class="dv">0</span>,<span class="dv">599</span>  us/op</span>
<span id="cb127-117"><a href="#cb127-117" aria-hidden="true"></a> <span class="fl">1.</span> IOUtils.<span class="fu">toString</span> (Apache Utils)             avgt   <span class="dv">10</span>  <span class="dv">10</span>,<span class="dv">605</span> ± <span class="dv">0</span>,<span class="dv">527</span>  us/op</span>
<span id="cb127-118"><a href="#cb127-118" aria-hidden="true"></a> <span class="fl">3.</span> <span class="bu">Scanner</span> (JDK)                               avgt   <span class="dv">10</span>  <span class="dv">12</span>,083 ± <span class="dv">0</span>,<span class="dv">293</span>  us/op</span>
<span id="cb127-119"><a href="#cb127-119" aria-hidden="true"></a> <span class="fl">2.</span> <span class="fu">CharStreams</span> (guava)                         avgt   <span class="dv">10</span>  <span class="dv">12</span>,<span class="dv">999</span> ± <span class="dv">0</span>,<span class="dv">514</span>  us/op</span>
<span id="cb127-120"><a href="#cb127-120" aria-hidden="true"></a> <span class="fl">4.</span> Stream <span class="fu">Api</span> (Java <span class="dv">8</span>)                         avgt   <span class="dv">10</span>  <span class="dv">15</span>,<span class="dv">811</span> ± <span class="dv">0</span>,<span class="dv">605</span>  us/op</span>
<span id="cb127-121"><a href="#cb127-121" aria-hidden="true"></a> <span class="fl">9.</span> <span class="bu">BufferedReader</span> (JDK)                        avgt   <span class="dv">10</span>  <span class="dv">16</span>,038 ± <span class="dv">0</span>,<span class="dv">711</span>  us/op</span>
<span id="cb127-122"><a href="#cb127-122" aria-hidden="true"></a> <span class="fl">5.</span> parallel Stream <span class="fu">Api</span> (Java <span class="dv">8</span>)                avgt   <span class="dv">10</span>  <span class="dv">21</span>,<span class="dv">544</span> ± <span class="dv">0</span>,<span class="dv">583</span>  us/op</span></code></pre></div>
<p>Performance tests for big <code>String</code> (length = 50100), url in <a href="https://github.com/Vedenin/useful-java-links/blob/master/helloworlds/5.0-other-examples/src/main/java/other_examples/ConvertBigStringToInputStreamBenchmark.java" rel="noreferrer">github</a> (mode = Average Time, system = Linux, score 200,715 is the best):</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true"></a>               Benchmark                        Mode  Cnt   Score        <span class="bu">Error</span>  Units</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true"></a> <span class="fl">8.</span> <span class="bu">ByteArrayOutputStream</span> and <span class="fu">read</span> (JDK)        avgt   <span class="dv">10</span>   <span class="dv">200</span>,<span class="dv">715</span> ±   <span class="dv">18</span>,<span class="dv">103</span>  us/op</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true"></a> <span class="fl">1.</span> IOUtils.<span class="fu">toString</span> (Apache Utils)             avgt   <span class="dv">10</span>   <span class="dv">300</span>,019 ±    <span class="dv">8</span>,<span class="dv">751</span>  us/op</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true"></a> <span class="fl">6.</span> <span class="bu">InputStreamReader</span> and <span class="bu">StringBuilder</span> (JDK)   avgt   <span class="dv">10</span>   <span class="dv">347</span>,<span class="dv">616</span> ±  <span class="dv">130</span>,<span class="dv">348</span>  us/op</span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true"></a> <span class="fl">7.</span> <span class="bu">StringWriter</span> and IOUtils.<span class="fu">copy</span> (Apache)      avgt   <span class="dv">10</span>   <span class="dv">352</span>,<span class="dv">791</span> ±  <span class="dv">105</span>,<span class="dv">337</span>  us/op</span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true"></a> <span class="fl">2.</span> <span class="fu">CharStreams</span> (guava)                         avgt   <span class="dv">10</span>   <span class="dv">420</span>,<span class="dv">137</span> ±   <span class="dv">59</span>,<span class="dv">877</span>  us/op</span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true"></a> <span class="fl">9.</span> <span class="bu">BufferedReader</span> (JDK)                        avgt   <span class="dv">10</span>   <span class="dv">632</span>,028 ±   <span class="dv">17</span>,<span class="bn">002</span>  us/op</span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true"></a> <span class="fl">5.</span> parallel Stream <span class="fu">Api</span> (Java <span class="dv">8</span>)                avgt   <span class="dv">10</span>   <span class="dv">662</span>,<span class="dv">999</span> ±   <span class="dv">46</span>,<span class="dv">199</span>  us/op</span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true"></a> <span class="fl">4.</span> Stream <span class="fu">Api</span> (Java <span class="dv">8</span>)                         avgt   <span class="dv">10</span>   <span class="dv">701</span>,<span class="dv">269</span> ±   <span class="dv">82</span>,<span class="dv">296</span>  us/op</span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true"></a><span class="fl">10.</span> <span class="bu">BufferedInputStream</span>, <span class="bu">ByteArrayOutputStream</span>  avgt   <span class="dv">10</span>   <span class="dv">740</span>,<span class="dv">837</span> ±    <span class="dv">5</span>,<span class="dv">613</span>  us/op</span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true"></a> <span class="fl">3.</span> <span class="bu">Scanner</span> (JDK)                               avgt   <span class="dv">10</span>   <span class="dv">751</span>,<span class="dv">417</span> ±   <span class="dv">62</span>,<span class="bn">026</span>  us/op</span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true"></a><span class="fl">11.</span> <span class="bu">InputStream</span>.<span class="fu">read</span>() and <span class="bu">StringBuilder</span> (JDK)  avgt   <span class="dv">10</span>  <span class="dv">2919</span>,<span class="dv">350</span> ± <span class="dv">1101</span>,<span class="dv">942</span>  us/op</span></code></pre></div>
<p>
Graphs (performance tests depending on Input Stream length in Windows 7 system)<br> <a href="https://i.stack.imgur.com/AYYhz.png" rel="noreferrer"><img src="https://i.stack.imgur.com/AYYhz.png" alt="enter image description here"></a>
</p>
<p>Performance test (Average Time) depending on Input Stream length in Windows 7 system:</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true"></a> length  <span class="dv">182</span>    <span class="dv">546</span>     <span class="dv">1092</span>    <span class="dv">3276</span>    <span class="dv">9828</span>    <span class="dv">29484</span>   <span class="dv">58968</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true"></a></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true"></a> test8  <span class="fl">0.</span><span class="dv">38</span>    <span class="fl">0.</span><span class="dv">938</span>   <span class="fl">1.</span><span class="dv">868</span>   <span class="fl">4.</span><span class="dv">448</span>   <span class="fl">13.</span><span class="dv">412</span>  <span class="fl">36.</span><span class="dv">459</span>  <span class="fl">72.</span><span class="dv">708</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true"></a> test4  <span class="fl">2.</span><span class="dv">362</span>   <span class="fl">3.</span><span class="dv">609</span>   <span class="fl">5.</span><span class="dv">573</span>   <span class="fl">12.</span><span class="dv">769</span>  <span class="fl">40.</span><span class="dv">74</span>   <span class="fl">81.</span><span class="dv">415</span>  <span class="fl">159.</span><span class="dv">864</span></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true"></a> test5  <span class="fl">3.</span><span class="dv">881</span>   <span class="fl">5.</span><span class="bn">075</span>   <span class="fl">6.</span><span class="dv">904</span>   <span class="fl">14.</span><span class="dv">123</span>  <span class="fl">50.</span><span class="dv">258</span>  <span class="fl">129.</span><span class="dv">937</span> <span class="fl">166.</span><span class="dv">162</span></span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true"></a> test9  <span class="fl">2.</span><span class="dv">237</span>   <span class="fl">3.</span><span class="dv">493</span>   <span class="fl">5.</span><span class="dv">422</span>   <span class="fl">11.</span><span class="dv">977</span>  <span class="fl">45.</span><span class="dv">98</span>   <span class="fl">89.</span><span class="dv">336</span>  <span class="fl">177.</span><span class="dv">39</span></span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true"></a> test6  <span class="fl">1.</span><span class="dv">261</span>   <span class="fl">2.</span><span class="dv">12</span>    <span class="fl">4.</span><span class="dv">38</span>    <span class="fl">10.</span><span class="dv">698</span>  <span class="fl">31.</span><span class="dv">821</span>  <span class="fl">86.</span><span class="dv">106</span>  <span class="fl">186.</span><span class="dv">636</span></span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true"></a> test7  <span class="fl">1.</span><span class="dv">601</span>   <span class="fl">2.</span><span class="dv">391</span>   <span class="fl">3.</span><span class="dv">646</span>   <span class="fl">8.</span><span class="dv">367</span>   <span class="fl">38.</span><span class="dv">196</span>  <span class="fl">110.</span><span class="dv">221</span> <span class="fl">211.</span><span class="bn">016</span></span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true"></a> test1  <span class="fl">1.</span><span class="dv">529</span>   <span class="fl">2.</span><span class="dv">381</span>   <span class="fl">3.</span><span class="dv">527</span>   <span class="fl">8.</span><span class="dv">411</span>   <span class="fl">40.</span><span class="dv">551</span>  <span class="fl">105.</span><span class="dv">16</span>  <span class="fl">212.</span><span class="dv">573</span></span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true"></a> test3  <span class="fl">3.</span><span class="bn">035</span>   <span class="fl">3.</span><span class="dv">934</span>   <span class="fl">8.</span><span class="dv">606</span>   <span class="fl">20.</span><span class="dv">858</span>  <span class="fl">61.</span><span class="dv">571</span>  <span class="fl">118.</span><span class="dv">744</span> <span class="fl">235.</span><span class="dv">428</span></span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true"></a> test2  <span class="fl">3.</span><span class="dv">136</span>   <span class="fl">6.</span><span class="dv">238</span>   <span class="fl">10.</span><span class="dv">508</span>  <span class="fl">33.</span><span class="dv">48</span>   <span class="fl">43.</span><span class="dv">532</span>  <span class="fl">118.</span><span class="bn">044</span> <span class="fl">239.</span><span class="dv">481</span></span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true"></a> test10 <span class="fl">1.</span><span class="dv">593</span>   <span class="fl">4.</span><span class="dv">736</span>   <span class="fl">7.</span><span class="dv">527</span>   <span class="fl">20.</span><span class="dv">557</span>  <span class="fl">59.</span><span class="dv">856</span>  <span class="fl">162.</span><span class="dv">907</span> <span class="fl">323.</span><span class="dv">147</span></span>
<span id="cb129-13"><a href="#cb129-13" aria-hidden="true"></a> test11 <span class="fl">3.</span><span class="dv">913</span>   <span class="fl">11.</span><span class="dv">506</span>  <span class="fl">23.</span><span class="dv">26</span>   <span class="fl">68.</span><span class="dv">644</span>  <span class="fl">207.</span><span class="dv">591</span> <span class="fl">600.</span><span class="dv">444</span> <span class="fl">1211.</span><span class="dv">545</span></span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="what-is-the-difference-between-public-protected-package-private-and-private-in-java-score-1981495-in-2018" class="level3">
<h3>13: What is the difference between public, protected, package-private and private in Java? (score <a href="https://stackoverflow.com/q/215497.html">1981495</a> in 2018)</h3>
<section id="question-12" class="level4">
<h4>Question</h4>
<p>In Java, are there clear rules on when to use each of access modifiers, namely the default (package private), <code>public</code>, <code>protected</code> and <code>private</code>, while making <code>class</code> and <code>interface</code> and dealing with inheritance?</p>
</section>
<section id="answer-accepted-score-5360" class="level4">
<h4>Answer accepted (score 5360)</h4>
<p><a href="http://docs.oracle.com/javase/tutorial/java/javaOO/accesscontrol.html" rel="noreferrer">The official tutorial</a> may be of some use to you.</p>
<pre>
______________________________________________________________
|           │ Class │ Package │ Subclass │ Subclass │ World  |
|           │       │         │(same pkg)│(diff pkg)│        |
|───────────┼───────┼─────────┼──────────┼──────────┼────────|
|public     │   +   │    +    │    +     │     +    │   +    | 
|───────────┼───────┼─────────┼──────────┼──────────┼────────|
|protected  │   +   │    +    │    +     │     +    │        | 
|───────────┼───────┼─────────┼──────────┼──────────┼────────|
|no modifier│   +   │    +    │    +     │          │        | 
|───────────┼───────┼─────────┼──────────┼──────────┼────────|
|private    │   +   │         │          │          │        |
|___________|_______|_________|__________|__________|________|
 + : accessible         blank : not accessible
</pre>
</section>
<section id="answer-2-score-442" class="level4">
<h4>Answer 2 (score 442)</h4>
<p>(Caveat: I am not a Java programmer, I am a Perl programmer. Perl has no formal protections which is perhaps why I understand the problem so well :) )</p>
<h5>
Private
</h2>
<p>Like you’d think, only the <strong>class</strong> in which it is declared can see it.</p>
<h5>
Package Private
</h2>
<p>Can only be seen and used by the <strong>package</strong> in which it was declared. This is the default in Java (which some see as a mistake).</p>
<h5>
Protected
</h2>
<p>Package Private + can be seen by subclasses or package member.</p>
<h5>
Public
</h2>
<p>Everyone can see it.</p>
<h5>
<a href="http://martinfowler.com/ieeeSoftware/published.pdf" rel="noreferrer">Published</a>
</h2>
<p>Visible outside the code I control. (While not Java syntax, it is important for this discussion).</p>
<p>C++ defines an additional level called “friend” and the less you know about that the better.</p>
<p>When should you use what? The whole idea is encapsulation to hide information. As much as possible you want to hide the detail of how something is done from your users. Why? Because then you can change them later and not break anybody’s code. This lets you optimize, refactor, redesign and fix bugs without worry that someone was using that code you just overhauled.</p>
<p>So, rule of thumb is to make things only as visible as they have to be. Start with private and only add more visibility as needed. Only make public that which is absolutely necessary for the user to know, every detail you make public cramps your ability to redesign the system.</p>
<p>If you want users to be able to customize behaviors, rather than making internals public so they can override them, it’s often a better idea to shove those guts into an object and make that interface public. That way they can simply plug in a new object. For example, if you were writing a CD player and wanted the “go find info about this CD” bit customizable, rather than make those methods public you’d put all that functionality into its own object and make just your object getter/setter public. In this way being stingy about exposing your guts encourages good composition and separation of concerns</p>
<p>Personally, I stick with just “private” and “public”. Many OO languages just have that. “Protected” can be handy, but it’s really a cheat. Once an interface is more than private it’s outside of your control and you have to go looking in other people’s code to find uses.</p>
<p>This is where the idea of “published” comes in. Changing an interface (refactoring it) requires that you find all the code which is using it and change that, too. If the interface is private, well no problem. If it’s protected you have to go find all your subclasses. If it’s public you have to go find all the code which uses your code. Sometimes this is possible, for example if you’re working on corporate code that’s for internal use only it doesn’t matter if an interface is public. You can grab all the code out of the corporate repository. But if an interface is “published”, if there is code using it outside your control, then you’re hosed. You must support that interface or risk breaking code. Even protected interfaces can be considered published (which is why I don’t bother with protected).</p>
<p>Many languages find the hierarchical nature of public/protected/private to be too limiting and not in line with reality. To that end there is the concept of a <a href="http://en.wikipedia.org/wiki/Trait_class" rel="noreferrer">trait class</a>, but that’s another show.</p>
</section>
<section id="answer-3-score-383" class="level4">
<h4>Answer 3 (score 383)</h4>
<p>
Here’s a better version of the table. (Future proof with a column for modules.) <br /><br />
</p>
<p><a href="https://i.stack.imgur.com/niONO.png" rel="noreferrer"><img src="https://i.stack.imgur.com/niONO.png" alt="Java Access Modifiers"></a></p>
<h5>
</h2>
<h5>
Explanations
</h2>
<ul>
<li>
<p>
A <strong>private</strong> member (<code>i</code>) is <em>only</em> accessible within the same class as it is declared.
</p>
</li>
<li>
<p>
A member with <strong>no access modifier</strong> (<code>j</code>) is only accessible within classes in the same package.
</p>
</li>
<li>
<p>
A <strong>protected</strong> member (<code>k</code>) is accessible within all classes in the same package <em>and</em> within subclasses in other packages.
</p>
</li>
<li>
<p>
A <strong>public</strong> member (<code>l</code>) is accessible to all classes (unless it resides in a <a href="http://openjdk.java.net/projects/jigsaw/spec/sotms/" rel="noreferrer">module</a> that does not export the package it is declared in).
</p>
</li>
</ul>
<hr>
<h5>
Which modifier to choose?
</h2>
<p>Access modifiers is a tool to help you to prevent accidentally breaking encapsulation<sup>(*)</sup>. Ask yourself if you intend the member to be something that’s internal to the class, package, class hierarchy or not internal at all, and choose access level accordingly.</p>
<p><strong>Examples:</strong></p>
<ul>
<li>
A field <code>long internalCounter</code> should probably be private since it’s mutable and an implementation detail.
</li>
<li>
A class that should only be instantiated in a factory class (in the same package) should have a package restricted constructor, since it shouldn’t be possible to call it directly from outside the package.
</li>
<li>
An internal <code>void beforeRender()</code> method called right before rendering and used as a hook in subclasses should be protected.
</li>
<li>
A <code>void saveGame(File dst)</code> method which is called from the GUI code should be public.
</li>
</ul>
<p><sup>(*) <a href="https://stackoverflow.com/questions/28612420/what-is-encapsulation-exactly">What is Encapsulation exactly?</a></sup></p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-do-i-determine-whether-an-array-contains-a-particular-value-in-java-score-1869332-in-2019" class="level3">
<h3>14: How do I determine whether an array contains a particular value in Java? (score <a href="https://stackoverflow.com/q/1128723.html">1869332</a> in 2019)</h3>
<section id="question-13" class="level4">
<h4>Question</h4>
<p>I have a <code>String[]</code> with values like so:</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true"></a><span class="kw">public</span> <span class="dt">static</span> <span class="dt">final</span> <span class="bu">String</span>[] VALUES = <span class="kw">new</span> <span class="bu">String</span>[] {<span class="st">&quot;AB&quot;</span>,<span class="st">&quot;BC&quot;</span>,<span class="st">&quot;CD&quot;</span>,<span class="st">&quot;AE&quot;</span>};</span></code></pre></div>
<p>Given <code>String s</code>, is there a good way of testing whether <code>VALUES</code> contains <code>s</code>?</p>
</section>
<section id="answer-accepted-score-2795" class="level4">
<h4>Answer accepted (score 2795)</h4>
<div class="sourceCode" id="cb131"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true"></a><span class="bu">Arrays</span>.<span class="fu">asList</span>(yourArray).<span class="fu">contains</span>(yourValue)</span></code></pre></div>
<p>Warning: this doesn’t work for arrays of primitives (see the comments).</p>
<hr>
<h5>
Since <a href="/questions/tagged/java-8" class="post-tag" title="show questions tagged &
#39;java-8&#39;" rel="tag">java-8</a> you can now use Streams.
</h2>
<div class="sourceCode" id="cb132"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true"></a><span class="bu">String</span>[] values = {<span class="st">&quot;AB&quot;</span>,<span class="st">&quot;BC&quot;</span>,<span class="st">&quot;CD&quot;</span>,<span class="st">&quot;AE&quot;</span>};</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true"></a><span class="dt">boolean</span> contains = <span class="bu">Arrays</span>.<span class="fu">stream</span>(values).<span class="fu">anyMatch</span>(<span class="st">&quot;s&quot;</span>::equals);</span></code></pre></div>
<p>To check whether an array of <code>int</code>, <code>double</code> or <code>long</code> contains a value use <code>IntStream</code>, <code>DoubleStream</code> or <code>LongStream</code> respectively.</p>
<h5>
Example
</h2>
<div class="sourceCode" id="cb133"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true"></a><span class="dt">int</span>[] a = {<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>};</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true"></a><span class="dt">boolean</span> contains = IntStream.<span class="fu">of</span>(a).<span class="fu">anyMatch</span>(x -&gt; x == <span class="dv">4</span>);</span></code></pre></div>
</section>
<section id="answer-2-score-344" class="level4">
<h4>Answer 2 (score 344)</h4>
<p>Just to clear the code up to start with. We have (corrected):</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true"></a><span class="kw">public</span> <span class="dt">static</span> <span class="dt">final</span> <span class="bu">String</span>[] VALUES = <span class="kw">new</span> <span class="bu">String</span>[] {<span class="st">&quot;AB&quot;</span>,<span class="st">&quot;BC&quot;</span>,<span class="st">&quot;CD&quot;</span>,<span class="st">&quot;AE&quot;</span>};</span></code></pre></div>
<p>This is a mutable static which FindBugs will tell you is very naughty. It should be private:</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true"></a><span class="kw">private</span> <span class="dt">static</span> <span class="dt">final</span> <span class="bu">String</span>[] VALUES = <span class="kw">new</span> <span class="bu">String</span>[] {<span class="st">&quot;AB&quot;</span>,<span class="st">&quot;BC&quot;</span>,<span class="st">&quot;CD&quot;</span>,<span class="st">&quot;AE&quot;</span>};</span></code></pre></div>
<p>(Note, you can actually drop the <code>new String[];</code> bit.)</p>
<p>So, reference arrays are bad, and in particular here we want a set:</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true"></a><span class="kw">private</span> <span class="dt">static</span> <span class="dt">final</span> <span class="bu">Set</span>&lt;<span class="bu">String</span>&gt; VALUES = <span class="kw">new</span> <span class="bu">HashSet</span>&lt;<span class="bu">String</span>&gt;(<span class="bu">Arrays</span>.<span class="fu">asList</span>(</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true"></a>     <span class="kw">new</span> <span class="bu">String</span>[] {<span class="st">&quot;AB&quot;</span>,<span class="st">&quot;BC&quot;</span>,<span class="st">&quot;CD&quot;</span>,<span class="st">&quot;AE&quot;</span>}</span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true"></a>));</span></code></pre></div>
<p>(Paranoid people, such as myself, may feel more at ease if this was wrapped in <code>Collections.unmodifiableSet</code> - it could even be made public.)</p>
<p>“Given String s, is there a good way of testing whether VALUES contains s?”</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true"></a>VALUES.<span class="fu">contains</span>(s)</span></code></pre></div>
<p>O(1).</p>
<p><strong>Update:</strong> Since Java SE 9 we have <code>Set.of</code>.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true"></a><span class="kw">private</span> <span class="dt">static</span> <span class="dt">final</span> <span class="bu">Set</span>&lt;<span class="bu">String</span>&gt; VALUES = <span class="bu">Set</span>.<span class="fu">of</span>(</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true"></a>    <span class="st">&quot;AB&quot;</span>,<span class="st">&quot;BC&quot;</span>,<span class="st">&quot;CD&quot;</span>,<span class="st">&quot;AE&quot;</span></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true"></a>);</span></code></pre></div>
<p>The <strong>right type</strong>, <strong>immutable</strong>, <strong>O(1)</strong> and <strong>concise</strong>. Beautiful.</p>
<p>(To be a little more on brand, the collections API is predictably still missing immutable collection types and the syntax is still far too verbose, for my tastes.)</p>
</section>
<section id="answer-3-score-194" class="level4">
<h4>Answer 3 (score 194)</h4>
<p>You can use <code>ArrayUtils.contains</code> from <a href="https://commons.apache.org/proper/commons-lang/" rel="noreferrer">Apache Commons Lang</a></p>
<p><a href="http://commons.apache.org/proper/commons-lang/javadocs/api-release/org/apache/commons/lang3/ArrayUtils.html
#contains(java.lang.Object[],%20java.lang.Object)" rel="noreferrer"><code>public static boolean contains(Object[] array, Object objectToFind)</code></a></p>
<p>Note that this method returns <code>false</code> if the passed array is <code>null</code>.</p>
<p>There are also methods available for primitive arrays of all kinds.</p>
<h5>
Example:
</h3>
<div class="sourceCode" id="cb139"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true"></a><span class="bu">String</span>[] fieldsToInclude = { <span class="st">&quot;id&quot;</span>, <span class="st">&quot;name&quot;</span>, <span class="st">&quot;location&quot;</span> };</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true"></a></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true"></a><span class="kw">if</span> ( ArrayUtils.<span class="fu">contains</span>( fieldsToInclude, <span class="st">&quot;id&quot;</span> ) ) {</span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true"></a>    <span class="co">// Do some stuff.</span></span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true"></a>}</span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="is-java-pass-by-reference-or-pass-by-value-score-1865334-in-2018" class="level3">
<h3>15: Is Java “pass-by-reference” or “pass-by-value”? (score <a href="https://stackoverflow.com/q/40480.html">1865334</a> in 2018)</h3>
<section id="question-14" class="level4">
<h4>Question</h4>
<p>I always thought Java was <strong>pass-by-reference</strong>.</p>
<p>However, I’ve seen a couple of blog posts (for example, <a href="http://javadude.com/articles/passbyvalue.htm" rel="noreferrer">this blog</a>) that claim that it isn’t.</p>
<p>I don’t think I understand the distinction they’re making.</p>
<p>What is the explanation?</p>
</section>
<section id="answer-2-score-5522" class="level4">
<h4>Answer 2 (score 5522)</h4>
<p>Java is always <strong>pass-by-value</strong>. Unfortunately, when we pass the value of an object, we are passing the <em>reference</em> to it. This is confusing to beginners.</p>
<p>It goes like this:</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true"></a><span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span>(<span class="bu">String</span>[] args) {</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true"></a>    Dog aDog = <span class="kw">new</span> <span class="fu">Dog</span>(<span class="st">&quot;Max&quot;</span>);</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true"></a>    Dog oldDog = aDog;</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true"></a></span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true"></a>    <span class="co">// we pass the object to foo</span></span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true"></a>    <span class="fu">foo</span>(aDog);</span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true"></a>    <span class="co">// aDog variable is still pointing to the &quot;Max&quot; dog when foo(...) returns</span></span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true"></a>    aDog.<span class="fu">getName</span>().<span class="fu">equals</span>(<span class="st">&quot;Max&quot;</span>); <span class="co">// true</span></span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true"></a>    aDog.<span class="fu">getName</span>().<span class="fu">equals</span>(<span class="st">&quot;Fifi&quot;</span>); <span class="co">// false</span></span>
<span id="cb140-10"><a href="#cb140-10" aria-hidden="true"></a>    aDog == oldDog; <span class="co">// true</span></span>
<span id="cb140-11"><a href="#cb140-11" aria-hidden="true"></a>}</span>
<span id="cb140-12"><a href="#cb140-12" aria-hidden="true"></a></span>
<span id="cb140-13"><a href="#cb140-13" aria-hidden="true"></a><span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">foo</span>(Dog d) {</span>
<span id="cb140-14"><a href="#cb140-14" aria-hidden="true"></a>    d.<span class="fu">getName</span>().<span class="fu">equals</span>(<span class="st">&quot;Max&quot;</span>); <span class="co">// true</span></span>
<span id="cb140-15"><a href="#cb140-15" aria-hidden="true"></a>    <span class="co">// change d inside of foo() to point to a new Dog instance &quot;Fifi&quot;</span></span>
<span id="cb140-16"><a href="#cb140-16" aria-hidden="true"></a>    d = <span class="kw">new</span> <span class="fu">Dog</span>(<span class="st">&quot;Fifi&quot;</span>);</span>
<span id="cb140-17"><a href="#cb140-17" aria-hidden="true"></a>    d.<span class="fu">getName</span>().<span class="fu">equals</span>(<span class="st">&quot;Fifi&quot;</span>); <span class="co">// true</span></span>
<span id="cb140-18"><a href="#cb140-18" aria-hidden="true"></a>}</span></code></pre></div>
<p>In the example above <code>aDog.getName()</code> will still return <code>"Max"</code>. The value <code>aDog</code> within <code>main</code> is not changed in the function <code>foo</code> with the <code>Dog</code> <code>"Fifi"</code> as the object reference is passed by value. If it were passed by reference, then the <code>aDog.getName()</code> in <code>main</code> would return <code>"Fifi"</code> after the call to <code>foo</code>.</p>
<p>Likewise:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true"></a><span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span>(<span class="bu">String</span>[] args) {</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true"></a>    Dog aDog = <span class="kw">new</span> <span class="fu">Dog</span>(<span class="st">&quot;Max&quot;</span>);</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true"></a>    Dog oldDog = aDog;</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true"></a></span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true"></a>    <span class="fu">foo</span>(aDog);</span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true"></a>    <span class="co">// when foo(...) returns, the name of the dog has been changed to &quot;Fifi&quot;</span></span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true"></a>    aDog.<span class="fu">getName</span>().<span class="fu">equals</span>(<span class="st">&quot;Fifi&quot;</span>); <span class="co">// true</span></span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true"></a>    <span class="co">// but it is still the same dog:</span></span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true"></a>    aDog == oldDog; <span class="co">// true</span></span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true"></a>}</span>
<span id="cb141-11"><a href="#cb141-11" aria-hidden="true"></a></span>
<span id="cb141-12"><a href="#cb141-12" aria-hidden="true"></a><span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">foo</span>(Dog d) {</span>
<span id="cb141-13"><a href="#cb141-13" aria-hidden="true"></a>    d.<span class="fu">getName</span>().<span class="fu">equals</span>(<span class="st">&quot;Max&quot;</span>); <span class="co">// true</span></span>
<span id="cb141-14"><a href="#cb141-14" aria-hidden="true"></a>    <span class="co">// this changes the name of d to be &quot;Fifi&quot;</span></span>
<span id="cb141-15"><a href="#cb141-15" aria-hidden="true"></a>    d.<span class="fu">setName</span>(<span class="st">&quot;Fifi&quot;</span>);</span>
<span id="cb141-16"><a href="#cb141-16" aria-hidden="true"></a>}</span></code></pre></div>
<p>In the above example, <code>Fifi</code> is the dog’s name after call to <code>foo(aDog)</code> because the object’s name was set inside of <code>foo(...)</code>. Any operations that <code>foo</code> performs on <code>d</code> are such that, for all practical purposes, they are performed on <code>aDog</code>, but it is <strong>not</strong> possible to change the value of the variable <code>aDog</code> itself.</p>
</section>
<section id="answer-3-score-2916" class="level4">
<h4>Answer 3 (score 2916)</h4>
<p>I just noticed you referenced <a href="http://javadude.com/articles/passbyvalue.htm" rel="noreferrer">my article</a>.</p>
<p>The Java Spec says that everything in Java is pass-by-value. There is no such thing as “pass-by-reference” in Java.</p>
<p>The key to understanding this is that something like</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true"></a>Dog myDog;</span></code></pre></div>
<p>is <em>not</em> a Dog; it’s actually a <em>pointer</em> to a Dog.</p>
<p>What that means, is when you have</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true"></a>Dog myDog = <span class="kw">new</span> <span class="fu">Dog</span>(<span class="st">&quot;Rover&quot;</span>);</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true"></a><span class="fu">foo</span>(myDog);</span></code></pre></div>
<p>you’re essentially passing the <em>address</em> of the created <code>Dog</code> object to the <code>foo</code> method.</p>
<p>(I say essentially because Java pointers aren’t direct addresses, but it’s easiest to think of them that way)</p>
<p>Suppose the <code>Dog</code> object resides at memory address 42. This means we pass 42 to the method.</p>
<p>if the Method were defined as</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true"></a><span class="kw">public</span> <span class="dt">void</span> <span class="fu">foo</span>(Dog someDog) {</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true"></a>    someDog.<span class="fu">setName</span>(<span class="st">&quot;Max&quot;</span>);     <span class="co">// AAA</span></span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true"></a>    someDog = <span class="kw">new</span> <span class="fu">Dog</span>(<span class="st">&quot;Fifi&quot;</span>);  <span class="co">// BBB</span></span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true"></a>    someDog.<span class="fu">setName</span>(<span class="st">&quot;Rowlf&quot;</span>);   <span class="co">// CCC</span></span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true"></a>}</span></code></pre></div>
<p>let’s look at what’s happening.</p>
<ul>
<li>
the parameter <code>someDog</code> is set to the value 42
</li>
<li>
<p>at line “AAA”</p>
<ul>
<li>
<code>someDog</code> is followed to the <code>Dog</code> it points to (the <code>Dog</code> object at address 42)
</li>
<li>
that <code>Dog</code> (the one at address 42) is asked to change his name to Max
</li>
</ul>
</li>
<li>
<p>at line “BBB”</p>
<ul>
<li>
a new <code>Dog</code> is created. Let’s say he’s at address 74
</li>
<li>
we assign the parameter <code>someDog</code> to 74
</li>
</ul>
</li>
<li>
<p>at line “CCC”</p>
<ul>
<li>
someDog is followed to the <code>Dog</code> it points to (the <code>Dog</code> object at address 74)
</li>
<li>
that <code>Dog</code> (the one at address 74) is asked to change his name to Rowlf
</li>
</ul>
</li>
<li>
then, we return
</li>
</ul>
<p>Now let’s think about what happens outside the method:</p>
<p><em>Did <code>myDog</code> change?</em></p>
<p>There’s the key.</p>
<p>Keeping in mind that <code>myDog</code> is a <em>pointer</em>, and not an actual <code>Dog</code>, the answer is NO. <code>myDog</code> still has the value 42; it’s still pointing to the original <code>Dog</code> (but note that because of line “AAA”, its name is now “Max” - still the same Dog; <code>myDog</code>’s value has not changed.)</p>
<p>It’s perfectly valid to <em>follow</em> an address and change what’s at the end of it; that does not change the variable, however.</p>
<p>Java works exactly like C. You can assign a pointer, pass the pointer to a method, follow the pointer in the method and change the data that was pointed to. However, you cannot change where that pointer points.</p>
<p>In C++, Ada, Pascal and other languages that support pass-by-reference, you can actually change the variable that was passed.</p>
<p>If Java had pass-by-reference semantics, the <code>foo</code> method we defined above would have changed where <code>myDog</code> was pointing when it assigned <code>someDog</code> on line BBB.</p>
<p>Think of reference parameters as being aliases for the variable passed in. When that alias is assigned, so is the variable that was passed in.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-to-fix-java.lang.unsupportedclassversionerror-unsupported-major.minor-version-score-1810449-in-2019" class="level3">
<h3>16: How to fix java.lang.UnsupportedClassVersionError: Unsupported major.minor version (score <a href="https://stackoverflow.com/q/10382929.html">1810449</a> in 2019)</h3>
<section id="question-15" class="level4">
<h4>Question</h4>
<p>I am trying to use <a href="http://en.wikipedia.org/wiki/Notepad%2B%2B" rel="noreferrer">Notepad++</a> as my all-in-one tool edit, run, compile, etc.</p>
<p>I have <a href="http://en.wikipedia.org/wiki/Java_Virtual_Machine
#Execution_environment" rel="noreferrer">JRE</a> installed, and I have setup my path variable to the <code>.../bin</code> directory.</p>
<p>When I run my “Hello world” in Notepad++, I get this message:</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true"></a>java.<span class="fu">lang</span>.<span class="fu">UnsupportedClassVersionError</span>: test_hello_world :</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true"></a> Unsupported major.<span class="fu">minor</span> version <span class="fl">51.</span><span class="dv">0</span></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true"></a>    at java.<span class="fu">lang</span>.<span class="fu">ClassLoader</span>.<span class="fu">defineClass1</span>(Native <span class="bu">Method</span>)</span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true"></a>    at java.<span class="fu">lang</span>.<span class="fu">ClassLoader</span>.<span class="fu">defineClassCond</span>(Unknown <span class="bu">Source</span>)</span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true"></a>       .........................................</span></code></pre></div>
<p>I think the problem here is about versions; some versions of Java may be old or too new.</p>
<ol>
<li>
How do I fix it?
</li>
<li>
Should I install the JDK, and setup my path variable to the JDK instead of JRE?
</li>
<li>
What is the difference between the <code>PATH</code> variable in JRE or JDK?
</li>
</ol>
</section>
<section id="answer-accepted-score-1903" class="level4">
<h4>Answer accepted (score 1903)</h4>
<p>The version number shown describes the version of the JRE the class file is compatible with.</p>
<p>The reported major numbers are:</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true"></a>Java SE <span class="dv">13</span> = <span class="dv">57</span>,</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true"></a>Java SE <span class="dv">12</span> = <span class="dv">56</span>,</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true"></a>Java SE <span class="dv">11</span> = <span class="dv">55</span>,</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true"></a>Java SE <span class="dv">10</span> = <span class="dv">54</span>,</span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true"></a>Java SE <span class="dv">9</span> = <span class="dv">53</span>,</span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true"></a>Java SE <span class="dv">8</span> = <span class="dv">52</span>,</span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true"></a>Java SE <span class="dv">7</span> = <span class="dv">51</span>,</span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true"></a>Java SE <span class="fl">6.</span><span class="dv">0</span> = <span class="dv">50</span>,</span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true"></a>Java SE <span class="fl">5.</span><span class="dv">0</span> = <span class="dv">49</span>,</span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true"></a>JDK <span class="fl">1.</span><span class="dv">4</span> = <span class="dv">48</span>,</span>
<span id="cb146-11"><a href="#cb146-11" aria-hidden="true"></a>JDK <span class="fl">1.</span><span class="dv">3</span> = <span class="dv">47</span>,</span>
<span id="cb146-12"><a href="#cb146-12" aria-hidden="true"></a>JDK <span class="fl">1.</span><span class="dv">2</span> = <span class="dv">46</span>,</span>
<span id="cb146-13"><a href="#cb146-13" aria-hidden="true"></a>JDK <span class="fl">1.</span><span class="dv">1</span> = <span class="dv">45</span></span></code></pre></div>
<p>(Source: <a href="https://en.wikipedia.org/wiki/Java_class_file
#General_layout" rel="noreferrer">Wikipedia</a>)</p>
<p>To fix the actual problem you should try to either run the Java code with a newer version of Java JRE or specify the target parameter to the Java compiler to instruct the compiler to create code compatible with earlier Java versions.</p>
<p>For example, in order to generate class files compatible with Java 1.4, use the following command line:</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true"></a>javac -target <span class="fl">1.</span><span class="dv">4</span> HelloWorld.<span class="fu">java</span></span></code></pre></div>
<p>With newer versions of the Java compiler you are likely to get a warning about the bootstrap class path not being set. More information about this error is available in a blog post <em><a href="https://blogs.oracle.com/darcy/entry/bootclasspath_older_source" rel="noreferrer">New javac warning for setting an older source without bootclasspath</a></em>.</p>
</section>
<section id="answer-2-score-356" class="level4">
<h4>Answer 2 (score 356)</h4>
<p><code>java.lang.UnsupportedClassVersionError</code> happens because of a higher JDK during compile time and lower JDK during runtime.</p>
</section>
<section id="answer-3-score-114" class="level4">
<h4>Answer 3 (score 114)</h4>
<p>In Eclipse, I just went to menu command <em>Window</em> -&gt; <em>Preferences</em> -&gt; <em>Java</em> -&gt; <em>Compiler</em> and then set “Compiler compliance level” to 1.6.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-to-round-a-number-to-n-decimal-places-in-java-score-1530287-in-2017" class="level3">
<h3>17: How to round a number to n decimal places in Java (score <a href="https://stackoverflow.com/q/153724.html">1530287</a> in 2017)</h3>
<section id="question-16" class="level4">
<h4>Question</h4>
<p>What I would like is a method to convert a double to a string which rounds using the half-up method - i.e. if the decimal to be rounded is 5, it always rounds up to the previous number. This is the standard method of rounding most people expect in most situations.</p>
<p>I also would like only significant digits to be displayed - i.e. there should not be any trailing zeroes.</p>
<p>I know one method of doing this is to use the <code>String.format</code> method:</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true"></a><span class="bu">String</span><span class="fu">.format</span>(<span class="st">&quot;</span><span class="sc">%.5g%n</span><span class="st">&quot;</span>, <span class="fl">0.</span><span class="dv">912385</span>);</span></code></pre></div>
<p>returns:</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true"></a><span class="fl">0.</span><span class="dv">91239</span></span></code></pre></div>
<p>which is great, however it always displays numbers with 5 decimal places even if they are not significant:</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true"></a><span class="bu">String</span><span class="fu">.format</span>(<span class="st">&quot;</span><span class="sc">%.5g%n</span><span class="st">&quot;</span>, <span class="fl">0.</span><span class="dv">912300</span>);</span></code></pre></div>
<p>returns:</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true"></a><span class="fl">0.</span><span class="dv">91230</span></span></code></pre></div>
<p>Another method is to use the <code>DecimalFormatter</code>:</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true"></a><span class="bu">DecimalFormat</span> df = <span class="kw">new</span> <span class="bu">DecimalFormat</span>(<span class="st">&quot;</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true"></a>#.#####<span class="st">&quot;);</span></span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true"></a>df<span class="fu">.format</span>(<span class="fl">0.</span><span class="dv">912385</span>);</span></code></pre></div>
<p>returns:</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true"></a><span class="fl">0.</span><span class="dv">91238</span></span></code></pre></div>
<p>However as you can see this uses half-even rounding. That is it will round down if the previous digit is even. What I’d like is this:</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true"></a><span class="fl">0.</span><span class="dv">912385</span> -&gt; <span class="fl">0.</span><span class="dv">91239</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true"></a><span class="fl">0.</span><span class="dv">912300</span> -&gt; <span class="fl">0.</span><span class="dv">9123</span></span></code></pre></div>
<p>What is the best way to achieve this in Java?</p>
</section>
<section id="answer-accepted-score-715" class="level4">
<h4>Answer accepted (score 715)</h4>
<p>Use <a href="http://docs.oracle.com/javase/8/docs/api/java/text/DecimalFormat.html
#setRoundingMode(java.math.RoundingMode)" rel="noreferrer"><code>setRoundingMode</code></a>, set the <a href="http://docs.oracle.com/javase/8/docs/api/java/math/RoundingMode.html" rel="noreferrer"><code>RoundingMode</code></a> explicitly to handle your issue with the half-even round, then use the format pattern for your required output.</p>
<p>Example:</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true"></a><span class="bu">DecimalFormat</span> df = <span class="kw">new</span> <span class="bu">DecimalFormat</span>(<span class="st">&quot;</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true"></a>#.####<span class="st">&quot;);</span></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true"></a>df.<span class="fu">setRoundingMode</span>(<span class="bu">RoundingMode</span>.<span class="fu">CEILING</span>);</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true"></a><span class="kw">for</span> (<span class="bu">Number</span> n : <span class="bu">Arrays</span>.<span class="fu">asList</span>(<span class="dv">12</span>, <span class="fl">123.</span><span class="dv">12345</span>, <span class="fl">0.</span><span class="dv">23</span>, <span class="fl">0.</span><span class="dv">1</span>, <span class="fl">2341234.</span><span class="dv">212431324</span>)) {</span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true"></a>    <span class="bu">Double</span> d = n.<span class="fu">doubleValue</span>();</span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true"></a>    <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(df<span class="fu">.format</span>(d));</span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true"></a>}</span></code></pre></div>
<p>gives the output:</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true"></a><span class="dv">12</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true"></a><span class="fl">123.</span><span class="dv">1235</span></span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true"></a><span class="fl">0.</span><span class="dv">23</span></span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true"></a><span class="fl">0.</span><span class="dv">1</span></span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true"></a><span class="fl">2341234.</span><span class="dv">2125</span></span></code></pre></div>
</section>
<section id="answer-2-score-452" class="level4">
<h4>Answer 2 (score 452)</h4>
<p>Assuming <code>value</code> is a <code>double</code>, you can do:</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true"></a>(<span class="dt">double</span>)<span class="bu">Math</span>.<span class="fu">round</span>(value * <span class="fl">100000d</span>) / <span class="fl">100000d</span></span></code></pre></div>
<p>That’s for 5 digits precision. The number of zeros indicate the number of decimals.</p>
</section>
<section id="answer-3-score-186" class="level4">
<h4>Answer 3 (score 186)</h4>
<div class="sourceCode" id="cb158"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true"></a><span class="kw">new</span> <span class="bu">BigDecimal</span>(<span class="bu">String</span>.<span class="fu">valueOf</span>(<span class="dt">double</span>)).<span class="fu">setScale</span>(yourScale, <span class="bu">BigDecimal</span>.<span class="fu">ROUND_HALF_UP</span>);</span></code></pre></div>
<p>will get you a <code>BigDecimal</code>. To get the string out of it, just call that <code>BigDecimal</code>’s <code>toString</code> method, or the <code>toPlainString</code> method for Java 5+ for a plain format string.</p>
<p>Sample program:</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true"></a><span class="kw">package</span><span class="im"> trials;</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true"></a><span class="kw">import</span><span class="im"> java.math.BigDecimal;</span></span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true"></a></span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">class</span> Trials {</span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true"></a></span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span>(<span class="bu">String</span>[] args) {</span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true"></a>        <span class="dt">int</span> yourScale = <span class="dv">10</span>;</span>
<span id="cb159-8"><a href="#cb159-8" aria-hidden="true"></a>        <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="bu">BigDecimal</span>.<span class="fu">valueOf</span>(<span class="fl">0.</span><span class="dv">42344534534553453453</span>-<span class="fl">0.</span><span class="dv">42324534524553453453</span>).<span class="fu">setScale</span>(yourScale, <span class="bu">BigDecimal</span>.<span class="fu">ROUND_HALF_UP</span>));</span>
<span id="cb159-9"><a href="#cb159-9" aria-hidden="true"></a>    }</span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="convert-arraylist-to-string-array-score-1474844-in-2018" class="level3">
<h3>18: Convert ArrayList<String> to String[] array (score <a href="https://stackoverflow.com/q/5374311.html">1474844</a> in 2018)</h3>
<section id="question-17" class="level4">
<h4>Question</h4>
<p>I’m working in the android environment and have tried the following code, but it doesn’t seem to be working.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true"></a><span class="bu">String</span> [] stockArr = (<span class="bu">String</span>[]) stock_list.<span class="fu">toArray</span>();</span></code></pre></div>
<p>If I define as follows:</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true"></a><span class="bu">String</span> [] stockArr = {<span class="st">&quot;hello&quot;</span>, <span class="st">&quot;world&quot;</span>};</span></code></pre></div>
<p>it works. Is there something that I’m missing?</p>
</section>
<section id="answer-accepted-score-1722" class="level4">
<h4>Answer accepted (score 1722)</h4>
<p>Use like this.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true"></a><span class="bu">List</span>&lt;<span class="bu">String</span>&gt; stockList = <span class="kw">new</span> <span class="bu">ArrayList</span>&lt;<span class="bu">String</span>&gt;();</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true"></a>stockList.<span class="fu">add</span>(<span class="st">&quot;stock1&quot;</span>);</span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true"></a>stockList.<span class="fu">add</span>(<span class="st">&quot;stock2&quot;</span>);</span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true"></a></span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true"></a><span class="bu">String</span>[] stockArr = <span class="kw">new</span> <span class="bu">String</span>[stockList.<span class="fu">size</span>()];</span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true"></a>stockArr = stockList.<span class="fu">toArray</span>(stockArr);</span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true"></a></span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true"></a><span class="kw">for</span>(<span class="bu">String</span> s : stockArr)</span>
<span id="cb162-9"><a href="#cb162-9" aria-hidden="true"></a>    <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(s);</span></code></pre></div>
</section>
<section id="answer-2-score-930" class="level4">
<h4>Answer 2 (score 930)</h4>
<p>Try this</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true"></a><span class="bu">String</span>[] arr = list.<span class="fu">toArray</span>(<span class="kw">new</span> <span class="bu">String</span>[list.<span class="fu">size</span>()]);</span></code></pre></div>
</section>
<section id="answer-3-score-300" class="level4">
<h4>Answer 3 (score 300)</h4>
<p>What is happening is that <code>stock_list.toArray()</code> is creating an <code>Object[]</code> rather than a <code>String[]</code> and hence the typecast is failing<sup>1</sup>.</p>
<p>The correct code would be:</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true"></a>  <span class="bu">String</span> [] stockArr = stockList.<span class="fu">toArray</span>(<span class="kw">new</span> <span class="bu">String</span>[stockList.<span class="fu">size</span>()]);</span></code></pre></div>
<p>or even</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true"></a>  <span class="bu">String</span> [] stockArr = stockList.<span class="fu">toArray</span>(<span class="kw">new</span> <span class="bu">String</span>[<span class="dv">0</span>]);</span></code></pre></div>
<p>For more details, refer to the javadocs for the two overloads of <code>List.toArray</code>.</p>
<p>The latter version uses the zero-length array to determine the type of the result array. (Surprisingly, it is faster to do this than to preallocate … at least, for recent Java releases. See <a href="https://stackoverflow.com/a/4042464/139985">https://stackoverflow.com/a/4042464/139985</a> for details.)</p>
<p>From a technical perspective, the reason for this API behavior / design is that an implementation of the <code>List&amp;lt;T&amp;gt;.toArray()</code> method has no information of what the <code>&amp;lt;T&amp;gt;</code> is at runtime. All it knows is that the raw element type is <code>Object</code>. By contrast, in the other case, the array parameter gives the base type of the array. (If the supplied array is big enough to hold the list elements, it is used. Otherwise a new array of the same type and a larger size is allocated and returned as the result.)</p>
<hr>
<p><sup>1 - In Java, an <code>Object[]</code> is not assignment compatible with a <code>String[]</code>. If it was, then you could do this:</sup></p>
<div class="sourceCode" id="cb166"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true"></a>    <span class="bu">Object</span>[] objects = <span class="kw">new</span> <span class="bu">Object</span>[]{<span class="kw">new</span> <span class="fu">Cat</span>(<span class="st">&quot;fluffy&quot;</span>)};</span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true"></a>    Dog[] dogs = (Dog[]) objects;</span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true"></a>    Dog d = dogs[<span class="dv">0</span>];     <span class="co">// Huh???</span></span></code></pre></div>
<p><sup>This is clearly nonsense, and that is why array types are not generally assignment compatible.</sup></p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="differences-between-hashmap-and-hashtable-score-1473992-in-2019" class="level3">
<h3>19: Differences between HashMap and Hashtable? (score <a href="https://stackoverflow.com/q/40471.html">1473992</a> in 2019)</h3>
<section id="question-18" class="level4">
<h4>Question</h4>
<p>What are the differences between a <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/HashMap.html" rel="noreferrer"><code>HashMap</code></a> and a <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Hashtable.html" rel="noreferrer"><code>Hashtable</code></a> in Java?</p>
<p>Which is more efficient for non-threaded applications?</p>
</section>
<section id="answer-accepted-score-3615" class="level4">
<h4>Answer accepted (score 3615)</h4>
<p>There are several differences between <a href="http://java.sun.com/javase/7/docs/api/java/util/HashMap.html" rel="noreferrer"><code>HashMap</code></a> and <a href="http://java.sun.com/javase/7/docs/api/java/util/Hashtable.html" rel="noreferrer"><code>Hashtable</code></a> in Java:</p>
<ol>
<li>
<p>
<code>Hashtable</code> is <a href="https://stackoverflow.com/questions/1085709/what-does-synchronized-mean">synchronized</a>, whereas <code>HashMap</code> is not. This makes <code>HashMap</code> better for non-threaded applications, as unsynchronized Objects typically perform better than synchronized ones.
</p>
</li>
<li>
<p>
<code>Hashtable</code> does not allow <code>null</code> keys or values. <code>HashMap</code> allows one <code>null</code> key and any number of <code>null</code> values.
</p>
</li>
<li>
<p>
One of HashMap’s subclasses is <a href="http://java.sun.com/javase/7/docs/api/java/util/LinkedHashMap.html" rel="noreferrer"><code>LinkedHashMap</code></a>, so in the event that you’d want predictable iteration order (which is insertion order by default), you could easily swap out the <code>HashMap</code> for a <code>LinkedHashMap</code>. This wouldn’t be as easy if you were using <code>Hashtable</code>.
</p>
</li>
</ol>
<p>Since synchronization is not an issue for you, I’d recommend <code>HashMap</code>. If synchronization becomes an issue, you may also look at <a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ConcurrentHashMap.html" rel="noreferrer"><code>ConcurrentHashMap</code></a>.</p>
</section>
<section id="answer-2-score-644" class="level4">
<h4>Answer 2 (score 644)</h4>
<p>Note, that a lot of the answers state that Hashtable is synchronised. <strong>In practice this buys you very little.</strong> The synchronization is on the accessor / mutator methods will stop two threads adding or removing from the map concurrently, but in the real world you will often need additional synchronisation.</p>
<p>A very common idiom is to “check then put” — i.e. look for an entry in the <code>Map</code>, and add it if it does not already exist. This is not in any way an atomic operation whether you use <code>Hashtable</code> or <code>HashMap</code>.</p>
<p>An equivalently synchronised <code>HashMap</code> can be obtained by:</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true"></a><span class="bu">Collections</span>.<span class="fu">synchronizedMap</span>(myMap);</span></code></pre></div>
<p>But to correctly implement this logic you need <strong>additional synchronisation</strong> of the form:</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true"></a><span class="kw">synchronized</span>(myMap) {</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true"></a>    <span class="kw">if</span> (!myMap.<span class="fu">containsKey</span>(<span class="st">&quot;tomato&quot;</span>))</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true"></a>        myMap.<span class="fu">put</span>(<span class="st">&quot;tomato&quot;</span>, <span class="st">&quot;red&quot;</span>);</span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true"></a>}</span></code></pre></div>
<p>Even iterating over a <code>Hashtable</code>’s entries (or a <code>HashMap</code> obtained by <code>Collections.synchronizedMap</code>) is not thread safe unless you also guard the <code>Map</code> from being modified through additional synchronization.</p>
<p>Implementations of the <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/ConcurrentMap.html" rel="noreferrer"><code>ConcurrentMap</code></a> interface (for example <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/ConcurrentHashMap.html" rel="noreferrer"><code>ConcurrentHashMap</code></a>) solve some of this by including <strong>thread safe check-then-act semantics</strong> such as:</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true"></a><span class="bu">ConcurrentMap</span>.<span class="fu">putIfAbsent</span>(key, value);</span></code></pre></div>
</section>
<section id="answer-3-score-338" class="level4">
<h4>Answer 3 (score 338)</h4>
<p><code>Hashtable</code> is considered legacy code. There’s nothing about <code>Hashtable</code> that can’t be done using <code>HashMap</code> or derivations of <code>HashMap</code>, so for new code, I don’t see any justification for going back to <code>Hashtable</code>.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="create-arraylist-from-array-score-1422325-in-2016" class="level3">
<h3>20: Create ArrayList from array (score <a href="https://stackoverflow.com/q/157944.html">1422325</a> in 2016)</h3>
<section id="question-19" class="level4">
<h4>Question</h4>
<p>I have an array that is initialized like:</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true"></a><span class="bu">Element</span>[] array = {<span class="kw">new</span> <span class="bu">Element</span>(<span class="dv">1</span>), <span class="kw">new</span> <span class="bu">Element</span>(<span class="dv">2</span>), <span class="kw">new</span> <span class="bu">Element</span>(<span class="dv">3</span>)};</span></code></pre></div>
<p>I would like to convert this array into an object of the ArrayList class.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true"></a><span class="bu">ArrayList</span>&lt;<span class="bu">Element</span>&gt; arraylist = ???;</span></code></pre></div>
</section>
<section id="answer-accepted-score-4407" class="level4">
<h4>Answer accepted (score 4407)</h4>
<div class="sourceCode" id="cb172"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true"></a><span class="kw">new</span> <span class="bu">ArrayList</span>&lt;&gt;(<span class="bu">Arrays</span>.<span class="fu">asList</span>(array))</span></code></pre></div>
</section>
<section id="answer-2-score-865" class="level4">
<h4>Answer 2 (score 865)</h4>
<p>Given:</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true"></a><span class="bu">Element</span>[] array = <span class="kw">new</span> <span class="bu">Element</span>[] { <span class="kw">new</span> <span class="bu">Element</span>(<span class="dv">1</span>), <span class="kw">new</span> <span class="bu">Element</span>(<span class="dv">2</span>), <span class="kw">new</span> <span class="bu">Element</span>(<span class="dv">3</span>) };</span></code></pre></div>
<p>The simplest answer is to do:</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true"></a><span class="bu">List</span>&lt;<span class="bu">Element</span>&gt; list = <span class="bu">Arrays</span>.<span class="fu">asList</span>(array);</span></code></pre></div>
<p>This will work fine. But some caveats:</p>
<ol>
<li>
The list returned from asList has <strong>fixed size</strong>. So, if you want to be able to add or remove elements from the returned list in your code, you’ll need to wrap it in a new <code>ArrayList</code>. Otherwise you’ll get an <code>UnsupportedOperationException</code>.
</li>
<li>
The list returned from <code>asList()</code> is backed by the original array. If you modify the original array, the list will be modified as well. This may be surprising.
</li>
</ol>
</section>
<section id="answer-3-score-332" class="level4">
<h4>Answer 3 (score 332)</h4>
<p><em><sup>(old thread, but just 2 cents as none mention Guava or other libs and some other details)</sup></em></p>
<h5>
If You Can, Use Guava
</h1>
<p>It’s worth pointing out the Guava way, which greatly simplifies these shenanigans:</p>
<h5>
Usage
</h2>
<h5>
For an Immutable List
</h3>
<p>Use the <a href="https://github.com/google/guava/blob/master/guava/src/com/google/common/collect/ImmutableList.java" rel="noreferrer"><code>ImmutableList</code></a> class and its <a href="https://github.com/google/guava/blob/master/guava/src/com/google/common/collect/ImmutableList.java
#L101" rel="noreferrer"><code>of()</code></a> and <a href="https://github.com/google/guava/blob/master/guava/src/com/google/common/collect/ImmutableList.java#L225" rel="noreferrer"><code>copyOf()</code></a> factory methods <sup>(elements can’t be null)</sup>:</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true"></a><span class="bu">List</span>&lt;<span class="bu">String</span>&gt; il = ImmutableList.<span class="fu">of</span>(<span class="st">&quot;string&quot;</span>, <span class="st">&quot;elements&quot;</span>);  <span class="co">// from varargs</span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true"></a><span class="bu">List</span>&lt;<span class="bu">String</span>&gt; il = ImmutableList.<span class="fu">copyOf</span>(aStringArray);      <span class="co">// from array</span></span></code></pre></div>
<h5>
For A Mutable List
</h3>
<p>Use the <a href="https://github.com/google/guava/blob/master/guava/src/com/google/common/collect/Lists.java" rel="noreferrer"><code>Lists</code></a> class and its <a href="https://github.com/google/guava/blob/master/guava/src/com/google/common/collect/Lists.java
#L87" rel="noreferrer"><code>newArrayList()</code></a> factory methods:</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true"></a><span class="bu">List</span>&lt;<span class="bu">String</span>&gt; l1 = Lists.<span class="fu">newArrayList</span>(anotherListOrCollection);    <span class="co">// from collection</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true"></a><span class="bu">List</span>&lt;<span class="bu">String</span>&gt; l2 = Lists.<span class="fu">newArrayList</span>(aStringArray);               <span class="co">// from array</span></span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true"></a><span class="bu">List</span>&lt;<span class="bu">String</span>&gt; l3 = Lists.<span class="fu">newArrayList</span>(<span class="st">&quot;or&quot;</span>, <span class="st">&quot;string&quot;</span>, <span class="st">&quot;elements&quot;</span>); <span class="co">// from varargs</span></span></code></pre></div>
<p>Please also note the similar methods for other data structures in other classes, for instance in <a href="https://github.com/google/guava/blob/master/guava/src/com/google/common/collect/Sets.java" rel="noreferrer"><code>Sets</code></a>.</p>
<h5>
<a href="http://code.google.com/p/guava-libraries/wiki/GuavaExplained" rel="noreferrer">Why Guava?</a>
</h2>
<p>The main attraction could be to reduce the clutter due to generics for type-safety, as the use of the Guava <a href="http://code.google.com/p/guava-libraries/wiki/CollectionUtilitiesExplained
#Static_constructors" rel="noreferrer">factory methods</a> allow the types to be inferred most of the time. However, this argument holds less water since Java 7 arrived with the new diamond operator.</p>
<p>But it’s not the only reason (and Java 7 isn’t everywhere yet): the shorthand syntax is also very handy, and the methods initializers, as seen above, allow to write more expressive code. You do in one Guava call what takes 2 with the current Java Collections.</p>
<hr>
<h5>
If You Can’t…
</h1>
<h5>
For an Immutable List
</h2>
<p>Use the JDK’s <a href="http://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html" rel="noreferrer"><code>Arrays</code></a> class and its <a href="http://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html
#asList%28T...%29" rel="noreferrer"><code>asList()</code></a> factory method, wrapped with a <a href="http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#unmodifiableList%28java.util.List%29" rel="noreferrer"><code>Collections.unmodifiableList()</code></a>:</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true"></a><span class="bu">List</span>&lt;<span class="bu">String</span>&gt; l1 = <span class="bu">Collections</span>.<span class="fu">unmodifiableList</span>(<span class="bu">Arrays</span>.<span class="fu">asList</span>(anArrayOfElements));</span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true"></a><span class="bu">List</span>&lt;<span class="bu">String</span>&gt; l2 = <span class="bu">Collections</span>.<span class="fu">unmodifiableList</span>(<span class="bu">Arrays</span>.<span class="fu">asList</span>(<span class="st">&quot;element1&quot;</span>, <span class="st">&quot;element2&quot;</span>));</span></code></pre></div>
<p>Note that the returned type for <code>asList()</code> is a <code>List</code> using a concrete <code>ArrayList</code> implementation, but <strong>it is NOT</strong> <code>java.util.ArrayList</code>. It’s an inner type, which emulates an <code>ArrayList</code> but actually directly references the passed array and makes it “write through” (modifications are reflected in the array).</p>
<p>It forbids modifications through some of the <code>List</code> API’s methods by way of simply extending an <code>AbstractList</code> (so, adding or removing elements is unsupported), however it allows calls to <code>set()</code> to override elements. Thus this list isn’t truly immutable and a call to <code>asList()</code> should be wrapped with <code>Collections.unmodifiableList()</code>.</p>
<p>See the next step if you need a mutable list.</p>
<h5>
For a Mutable List
</h2>
<p>Same as above, but wrapped with an actual <code>java.util.ArrayList</code>:</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true"></a><span class="bu">List</span>&lt;<span class="bu">String</span>&gt; l1  = <span class="kw">new</span> <span class="bu">ArrayList</span>&lt;<span class="bu">String</span>&gt;(<span class="bu">Arrays</span>.<span class="fu">asList</span>(array));    <span class="co">// Java 1.5 to 1.6</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true"></a><span class="bu">List</span>&lt;<span class="bu">String</span>&gt; l1b = <span class="kw">new</span> <span class="bu">ArrayList</span>&lt;&gt;(<span class="bu">Arrays</span>.<span class="fu">asList</span>(array));          <span class="co">// Java 1.7+</span></span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true"></a><span class="bu">List</span>&lt;<span class="bu">String</span>&gt; l2  = <span class="kw">new</span> <span class="bu">ArrayList</span>&lt;<span class="bu">String</span>&gt;(<span class="bu">Arrays</span>.<span class="fu">asList</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>)); <span class="co">// Java 1.5 to 1.6</span></span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true"></a><span class="bu">List</span>&lt;<span class="bu">String</span>&gt; l2b = <span class="kw">new</span> <span class="bu">ArrayList</span>&lt;&gt;(<span class="bu">Arrays</span>.<span class="fu">asList</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>));       <span class="co">// Java 1.7+</span></span></code></pre></div>
<hr>
<h5>
For Educational Purposes: The Good ol’ Manual Way
</h1>
<div class="sourceCode" id="cb179"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true"></a><span class="co">// for Java 1.5+</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true"></a><span class="dt">static</span> &lt;T&gt; <span class="bu">List</span>&lt;T&gt; <span class="fu">arrayToList</span>(<span class="dt">final</span> T[] array) {</span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true"></a>  <span class="dt">final</span> <span class="bu">List</span>&lt;T&gt; l = <span class="kw">new</span> <span class="bu">ArrayList</span>&lt;T&gt;(array.<span class="fu">length</span>);</span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true"></a></span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true"></a>  <span class="kw">for</span> (<span class="dt">final</span> T s : array) {</span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true"></a>    l.<span class="fu">add</span>(s);</span>
<span id="cb179-7"><a href="#cb179-7" aria-hidden="true"></a>  }</span>
<span id="cb179-8"><a href="#cb179-8" aria-hidden="true"></a>  <span class="kw">return</span> (l);</span>
<span id="cb179-9"><a href="#cb179-9" aria-hidden="true"></a>}</span>
<span id="cb179-10"><a href="#cb179-10" aria-hidden="true"></a></span>
<span id="cb179-11"><a href="#cb179-11" aria-hidden="true"></a><span class="co">// for Java &lt; 1.5 (no generics, no compile-time type-safety, boo!)</span></span>
<span id="cb179-12"><a href="#cb179-12" aria-hidden="true"></a><span class="dt">static</span> <span class="bu">List</span> <span class="fu">arrayToList</span>(<span class="dt">final</span> <span class="bu">Object</span>[] array) {</span>
<span id="cb179-13"><a href="#cb179-13" aria-hidden="true"></a>  <span class="dt">final</span> <span class="bu">List</span> l = <span class="kw">new</span> <span class="bu">ArrayList</span>(array.<span class="fu">length</span>);</span>
<span id="cb179-14"><a href="#cb179-14" aria-hidden="true"></a></span>
<span id="cb179-15"><a href="#cb179-15" aria-hidden="true"></a>  <span class="kw">for</span> (<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; array.<span class="fu">length</span>; i++) {</span>
<span id="cb179-16"><a href="#cb179-16" aria-hidden="true"></a>    l.<span class="fu">add</span>(array[i]);</span>
<span id="cb179-17"><a href="#cb179-17" aria-hidden="true"></a>  }</span>
<span id="cb179-18"><a href="#cb179-18" aria-hidden="true"></a>  <span class="kw">return</span> (l);</span>
<span id="cb179-19"><a href="#cb179-19" aria-hidden="true"></a>}</span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="why-is-processing-a-sorted-array-faster-than-processing-an-unsorted-array-score-1410048-in-2019" class="level3">
<h3>21: Why is processing a sorted array faster than processing an unsorted array? (score <a href="https://stackoverflow.com/q/11227809.html">1410048</a> in 2019)</h3>
<section id="question-20" class="level4">
<h4>Question</h4>
<p>Here is a piece of C++ code that shows some very peculiar behavior. For some strange reason, sorting the data miraculously makes the code almost six times faster:</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true"></a></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true"></a>#include &lt;algorithm&gt;</span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true"></a></span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true"></a>#include &lt;ctime&gt;</span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true"></a></span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true"></a>#include &lt;iostream&gt;</span>
<span id="cb180-7"><a href="#cb180-7" aria-hidden="true"></a></span>
<span id="cb180-8"><a href="#cb180-8" aria-hidden="true"></a><span class="dt">int</span> <span class="fu">main</span>()</span>
<span id="cb180-9"><a href="#cb180-9" aria-hidden="true"></a>{</span>
<span id="cb180-10"><a href="#cb180-10" aria-hidden="true"></a>    <span class="co">// Generate data</span></span>
<span id="cb180-11"><a href="#cb180-11" aria-hidden="true"></a>    <span class="dt">const</span> unsigned arraySize = <span class="dv">32768</span>;</span>
<span id="cb180-12"><a href="#cb180-12" aria-hidden="true"></a>    <span class="dt">int</span> data[arraySize];</span>
<span id="cb180-13"><a href="#cb180-13" aria-hidden="true"></a></span>
<span id="cb180-14"><a href="#cb180-14" aria-hidden="true"></a>    <span class="kw">for</span> (unsigned c = <span class="dv">0</span>; c &lt; arraySize; ++c)</span>
<span id="cb180-15"><a href="#cb180-15" aria-hidden="true"></a>        data[c] = std::<span class="fu">rand</span>() % <span class="dv">256</span>;</span>
<span id="cb180-16"><a href="#cb180-16" aria-hidden="true"></a></span>
<span id="cb180-17"><a href="#cb180-17" aria-hidden="true"></a>    <span class="co">// !!! With this, the next loop runs faster.</span></span>
<span id="cb180-18"><a href="#cb180-18" aria-hidden="true"></a>    std::<span class="fu">sort</span>(data, data + arraySize);</span>
<span id="cb180-19"><a href="#cb180-19" aria-hidden="true"></a></span>
<span id="cb180-20"><a href="#cb180-20" aria-hidden="true"></a>    <span class="co">// Test</span></span>
<span id="cb180-21"><a href="#cb180-21" aria-hidden="true"></a>    clock_t start = <span class="fu">clock</span>();</span>
<span id="cb180-22"><a href="#cb180-22" aria-hidden="true"></a>    <span class="dt">long</span> <span class="dt">long</span> sum = <span class="dv">0</span>;</span>
<span id="cb180-23"><a href="#cb180-23" aria-hidden="true"></a></span>
<span id="cb180-24"><a href="#cb180-24" aria-hidden="true"></a>    <span class="kw">for</span> (unsigned i = <span class="dv">0</span>; i &lt; <span class="dv">100000</span>; ++i)</span>
<span id="cb180-25"><a href="#cb180-25" aria-hidden="true"></a>    {</span>
<span id="cb180-26"><a href="#cb180-26" aria-hidden="true"></a>        <span class="co">// Primary loop</span></span>
<span id="cb180-27"><a href="#cb180-27" aria-hidden="true"></a>        <span class="kw">for</span> (unsigned c = <span class="dv">0</span>; c &lt; arraySize; ++c)</span>
<span id="cb180-28"><a href="#cb180-28" aria-hidden="true"></a>        {</span>
<span id="cb180-29"><a href="#cb180-29" aria-hidden="true"></a>            <span class="kw">if</span> (data[c] &gt;= <span class="dv">128</span>)</span>
<span id="cb180-30"><a href="#cb180-30" aria-hidden="true"></a>                sum += data[c];</span>
<span id="cb180-31"><a href="#cb180-31" aria-hidden="true"></a>        }</span>
<span id="cb180-32"><a href="#cb180-32" aria-hidden="true"></a>    }</span>
<span id="cb180-33"><a href="#cb180-33" aria-hidden="true"></a></span>
<span id="cb180-34"><a href="#cb180-34" aria-hidden="true"></a>    <span class="dt">double</span> elapsedTime = static_cast&lt;<span class="dt">double</span>&gt;(<span class="fu">clock</span>() - start) / CLOCKS_PER_SEC;</span>
<span id="cb180-35"><a href="#cb180-35" aria-hidden="true"></a></span>
<span id="cb180-36"><a href="#cb180-36" aria-hidden="true"></a>    std::cout &lt;&lt; elapsedTime &lt;&lt; std::endl;</span>
<span id="cb180-37"><a href="#cb180-37" aria-hidden="true"></a>    std::cout &lt;&lt; <span class="st">&quot;sum = &quot;</span> &lt;&lt; sum &lt;&lt; std::endl;</span>
<span id="cb180-38"><a href="#cb180-38" aria-hidden="true"></a>}</span></code></pre></div>
<ul>
<li>
Without <code>std::sort(data, data + arraySize);</code>, the code runs in 11.54 seconds.
</li>
<li>
With the sorted data, the code runs in 1.93 seconds.
</li>
</ul>
<hr>
<p>Initially, I thought this might be just a language or compiler anomaly, so I tried Java:</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true"></a><span class="kw">import</span><span class="im"> java.util.Arrays;</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true"></a><span class="kw">import</span><span class="im"> java.util.Random;</span></span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true"></a></span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">class</span> Main</span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true"></a>{</span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span>(<span class="bu">String</span>[] args)</span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true"></a>    {</span>
<span id="cb181-8"><a href="#cb181-8" aria-hidden="true"></a>        <span class="co">// Generate data</span></span>
<span id="cb181-9"><a href="#cb181-9" aria-hidden="true"></a>        <span class="dt">int</span> arraySize = <span class="dv">32768</span>;</span>
<span id="cb181-10"><a href="#cb181-10" aria-hidden="true"></a>        <span class="dt">int</span> data[] = <span class="kw">new</span> <span class="dt">int</span>[arraySize];</span>
<span id="cb181-11"><a href="#cb181-11" aria-hidden="true"></a></span>
<span id="cb181-12"><a href="#cb181-12" aria-hidden="true"></a>        <span class="bu">Random</span> rnd = <span class="kw">new</span> <span class="bu">Random</span>(<span class="dv">0</span>);</span>
<span id="cb181-13"><a href="#cb181-13" aria-hidden="true"></a>        <span class="kw">for</span> (<span class="dt">int</span> c = <span class="dv">0</span>; c &lt; arraySize; ++c)</span>
<span id="cb181-14"><a href="#cb181-14" aria-hidden="true"></a>            data[c] = rnd.<span class="fu">nextInt</span>() % <span class="dv">256</span>;</span>
<span id="cb181-15"><a href="#cb181-15" aria-hidden="true"></a></span>
<span id="cb181-16"><a href="#cb181-16" aria-hidden="true"></a>        <span class="co">// !!! With this, the next loop runs faster</span></span>
<span id="cb181-17"><a href="#cb181-17" aria-hidden="true"></a>        <span class="bu">Arrays</span>.<span class="fu">sort</span>(data);</span>
<span id="cb181-18"><a href="#cb181-18" aria-hidden="true"></a></span>
<span id="cb181-19"><a href="#cb181-19" aria-hidden="true"></a>        <span class="co">// Test</span></span>
<span id="cb181-20"><a href="#cb181-20" aria-hidden="true"></a>        <span class="dt">long</span> start = <span class="bu">System</span>.<span class="fu">nanoTime</span>();</span>
<span id="cb181-21"><a href="#cb181-21" aria-hidden="true"></a>        <span class="dt">long</span> sum = <span class="dv">0</span>;</span>
<span id="cb181-22"><a href="#cb181-22" aria-hidden="true"></a></span>
<span id="cb181-23"><a href="#cb181-23" aria-hidden="true"></a>        <span class="kw">for</span> (<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; <span class="dv">100000</span>; ++i)</span>
<span id="cb181-24"><a href="#cb181-24" aria-hidden="true"></a>        {</span>
<span id="cb181-25"><a href="#cb181-25" aria-hidden="true"></a>            <span class="co">// Primary loop</span></span>
<span id="cb181-26"><a href="#cb181-26" aria-hidden="true"></a>            <span class="kw">for</span> (<span class="dt">int</span> c = <span class="dv">0</span>; c &lt; arraySize; ++c)</span>
<span id="cb181-27"><a href="#cb181-27" aria-hidden="true"></a>            {</span>
<span id="cb181-28"><a href="#cb181-28" aria-hidden="true"></a>                <span class="kw">if</span> (data[c] &gt;= <span class="dv">128</span>)</span>
<span id="cb181-29"><a href="#cb181-29" aria-hidden="true"></a>                    sum += data[c];</span>
<span id="cb181-30"><a href="#cb181-30" aria-hidden="true"></a>            }</span>
<span id="cb181-31"><a href="#cb181-31" aria-hidden="true"></a>        }</span>
<span id="cb181-32"><a href="#cb181-32" aria-hidden="true"></a></span>
<span id="cb181-33"><a href="#cb181-33" aria-hidden="true"></a>        <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>((<span class="bu">System</span>.<span class="fu">nanoTime</span>() - start) / <span class="fl">1000000000.</span><span class="dv">0</span>);</span>
<span id="cb181-34"><a href="#cb181-34" aria-hidden="true"></a>        <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;sum = &quot;</span> + sum);</span>
<span id="cb181-35"><a href="#cb181-35" aria-hidden="true"></a>    }</span>
<span id="cb181-36"><a href="#cb181-36" aria-hidden="true"></a>}</span></code></pre></div>
<p>With a similar but less extreme result.</p>
<hr>
<p>My first thought was that sorting brings the data into the cache, but then I thought how silly that was because the array was just generated.</p>
<ul>
<li>
What is going on?
</li>
<li>
Why is processing a sorted array faster than processing an unsorted array?
</li>
</ul>
<p>The code is summing up some independent terms, so the order should not matter.</p>
</section>
<section id="answer-accepted-score-30765" class="level4">
<h4>Answer accepted (score 30765)</h4>
<p><strong>You are a victim of <a href="//en.wikipedia.org/wiki/Branch_predictor" rel="noreferrer">branch prediction</a> fail.</strong></p>
<hr>
<h5>
What is Branch Prediction?
</h2>
<p>Consider a railroad junction:</p>
<p>
<a href="//commons.wikimedia.org/wiki/File:Entroncamento_do_Transpraia.JPG" rel="noreferrer"><img src="https://i.stack.imgur.com/muxnt.jpg" alt="Image showing a railroad junction"></a> <sub><a href="//commons.wikimedia.org/wiki/File:Entroncamento_do_Transpraia.JPG" rel="noreferrer">Image</a> by Mecanismo, via Wikimedia Commons. Used under the <a href="//creativecommons.org/licenses/by-sa/3.0/deed.en" rel="noreferrer">CC-By-SA 3.0</a> license.</sub>
</p>
<p>Now for the sake of argument, suppose this is back in the 1800s - before long distance or radio communication.</p>
<p>You are the operator of a junction and you hear a train coming. You have no idea which way it is supposed to go. You stop the train to ask the driver which direction they want. And then you set the switch appropriately.</p>
<p><em>Trains are heavy and have a lot of inertia. So they take forever to start up and slow down.</em></p>
<p>Is there a better way? You guess which direction the train will go!</p>
<ul>
<li>
If you guessed right, it continues on.
</li>
<li>
If you guessed wrong, the captain will stop, back up, and yell at you to flip the switch. Then it can restart down the other path.
</li>
</ul>
<p>
<strong>If you guess right every time</strong>, the train will never have to stop. <br/> <strong>If you guess wrong too often</strong>, the train will spend a lot of time stopping, backing up, and restarting.
</p>
<hr>
<p><strong>Consider an if-statement:</strong> At the processor level, it is a branch instruction:</p>
<p><img src="https://i.stack.imgur.com/pyfwC.png" alt="Screenshot of compiled code containing an if statement"></p>
<p>You are a processor and you see a branch. You have no idea which way it will go. What do you do? You halt execution and wait until the previous instructions are complete. Then you continue down the correct path.</p>
<p><em>Modern processors are complicated and have long pipelines. So they take forever to “warm up” and “slow down”.</em></p>
<p>Is there a better way? You guess which direction the branch will go!</p>
<ul>
<li>
If you guessed right, you continue executing.
</li>
<li>
If you guessed wrong, you need to flush the pipeline and roll back to the branch. Then you can restart down the other path.
</li>
</ul>
<p>
<strong>If you guess right every time</strong>, the execution will never have to stop. <br/> <strong>If you guess wrong too often</strong>, you spend a lot of time stalling, rolling back, and restarting.
</p>
<hr>
<p>This is branch prediction. I admit it’s not the best analogy since the train could just signal the direction with a flag. But in computers, the processor doesn’t know which direction a branch will go until the last moment.</p>
<p>So how would you strategically guess to minimize the number of times that the train must back up and go down the other path? You look at the past history! If the train goes left 99% of the time, then you guess left. If it alternates, then you alternate your guesses. If it goes one way every three times, you guess the same…</p>
<p><strong><em>In other words, you try to identify a pattern and follow it.</em></strong> This is more or less how branch predictors work.</p>
<p>Most applications have well-behaved branches. So modern branch predictors will typically achieve &gt;90% hit rates. But when faced with unpredictable branches with no recognizable patterns, branch predictors are virtually useless.</p>
<p>Further reading: <a href="//en.wikipedia.org/wiki/Branch_predictor" rel="noreferrer">“Branch predictor” article on Wikipedia</a>.</p>
<hr>
<h5>
As hinted from above, the culprit is this if-statement:
</h2>
<div class="sourceCode" id="cb182"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true"></a><span class="kw">if</span> (data[c] &gt;= <span class="dv">128</span>)</span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true"></a>    sum += data[c];</span></code></pre></div>
<p>Notice that the data is evenly distributed between 0 and 255. When the data is sorted, roughly the first half of the iterations will not enter the if-statement. After that, they will all enter the if-statement.</p>
<p>This is very friendly to the branch predictor since the branch consecutively goes the same direction many times. Even a simple saturating counter will correctly predict the branch except for the few iterations after it switches direction.</p>
<p><strong>Quick visualization:</strong></p>
<div class="sourceCode" id="cb183"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true"></a>T = branch taken</span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true"></a>N = branch not taken</span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true"></a></span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true"></a>data[] = <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="kw">... </span><span class="dv">126</span>, <span class="dv">127</span>, <span class="dv">128</span>, <span class="dv">129</span>, <span class="dv">130</span>, <span class="kw">... </span><span class="dv">250</span>, <span class="dv">251</span>, <span class="dv">252</span>, ...</span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true"></a>branch = N  N  N  N  N  <span class="kw">...   </span>N    N    T    T    T  <span class="kw">...   </span>T    T    T  ...</span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true"></a></span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true"></a>       = NNNNNNNNNNNN <span class="kw">... </span>NNNNNNNTTTTTTTTT <span class="kw">... </span><span class="fu">TTTTTTTTTT</span>  (easy to predict)</span></code></pre></div>
<p>However, when the data is completely random, the branch predictor is rendered useless, because it can’t predict random data. Thus there will probably be around 50% misprediction (no better than random guessing).</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true"></a>data[] = <span class="dv">226</span>, <span class="dv">185</span>, <span class="dv">125</span>, <span class="dv">158</span>, <span class="dv">198</span>, <span class="dv">144</span>, <span class="dv">217</span>, <span class="dv">79</span>, <span class="dv">202</span>, <span class="dv">118</span>,  <span class="dv">14</span>, <span class="dv">150</span>, <span class="dv">177</span>, <span class="dv">182</span>, <span class="dv">133</span>, ...</span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true"></a>branch =   T,   T,   N,   T,   T,   T,   T,  N,   T,   N,   N,   T,   T,   T,   N  ...</span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true"></a></span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true"></a>       = TTNTTTTNTNNTTTN <span class="kw">...   </span>(completely random - hard to predict)</span></code></pre></div>
<hr>
<p><strong>So what can be done?</strong></p>
<p>If the compiler isn’t able to optimize the branch into a conditional move, you can try some hacks if you are willing to sacrifice readability for performance.</p>
<p>Replace:</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true"></a><span class="kw">if</span> (data[c] &gt;= <span class="dv">128</span>)</span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true"></a>    sum += data[c];</span></code></pre></div>
<p>with:</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true"></a><span class="dt">int</span> t = (data[c] - <span class="dv">128</span>) &gt;&gt; <span class="dv">31</span>;</span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true"></a>sum += ~t &amp; data[c];</span></code></pre></div>
<p>This eliminates the branch and replaces it with some bitwise operations.</p>
<p><sub>(Note that this hack is not strictly equivalent to the original if-statement. But in this case, it’s valid for all the input values of <code>data[]</code>.)</sub></p>
<p><strong>Benchmarks: Core i7 920 @ 3.5 GHz</strong></p>
<p>C++ - Visual Studio 2010 - x64 Release</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true"></a><span class="co">//  Branch - Random</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true"></a>seconds = <span class="fl">11.</span><span class="dv">777</span></span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true"></a></span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true"></a><span class="co">//  Branch - Sorted</span></span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true"></a>seconds = <span class="fl">2.</span><span class="dv">352</span></span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true"></a></span>
<span id="cb187-7"><a href="#cb187-7" aria-hidden="true"></a><span class="co">//  Branchless - Random</span></span>
<span id="cb187-8"><a href="#cb187-8" aria-hidden="true"></a>seconds = <span class="fl">2.</span><span class="dv">564</span></span>
<span id="cb187-9"><a href="#cb187-9" aria-hidden="true"></a></span>
<span id="cb187-10"><a href="#cb187-10" aria-hidden="true"></a><span class="co">//  Branchless - Sorted</span></span>
<span id="cb187-11"><a href="#cb187-11" aria-hidden="true"></a>seconds = <span class="fl">2.</span><span class="dv">587</span></span></code></pre></div>
<p>Java - NetBeans 7.1.1 JDK 7 - x64</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true"></a><span class="co">//  Branch - Random</span></span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true"></a>seconds = <span class="fl">10.</span><span class="dv">93293813</span></span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true"></a></span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true"></a><span class="co">//  Branch - Sorted</span></span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true"></a>seconds = <span class="fl">5.</span><span class="dv">643797077</span></span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true"></a></span>
<span id="cb188-7"><a href="#cb188-7" aria-hidden="true"></a><span class="co">//  Branchless - Random</span></span>
<span id="cb188-8"><a href="#cb188-8" aria-hidden="true"></a>seconds = <span class="fl">3.</span><span class="dv">113581453</span></span>
<span id="cb188-9"><a href="#cb188-9" aria-hidden="true"></a></span>
<span id="cb188-10"><a href="#cb188-10" aria-hidden="true"></a><span class="co">//  Branchless - Sorted</span></span>
<span id="cb188-11"><a href="#cb188-11" aria-hidden="true"></a>seconds = <span class="fl">3.</span><span class="dv">186068823</span></span></code></pre></div>
<p>Observations:</p>
<ul>
<li>
<strong>With the Branch:</strong> There is a huge difference between the sorted and unsorted data.
</li>
<li>
<strong>With the Hack:</strong> There is no difference between sorted and unsorted data.
</li>
<li>
In the C++ case, the hack is actually a tad slower than with the branch when the data is sorted.
</li>
</ul>
<p>A general rule of thumb is to avoid data-dependent branching in critical loops (such as in this example).</p>
<hr>
<p><strong>Update:</strong></p>
<ul>
<li>
<p>
GCC 4.6.1 with <code>-O3</code> or <code>-ftree-vectorize</code> on x64 is able to generate a conditional move. So there is no difference between the sorted and unsorted data - both are fast.
</p>
</li>
<li>
<p>
VC++ 2010 is unable to generate conditional moves for this branch even under <code>/Ox</code>.
</p>
</li>
<li>
<p>
<a href="https://en.wikipedia.org/wiki/Intel_C%2B%2B_Compiler" rel="noreferrer">Intel C++ Compiler</a> (ICC) 11 does something miraculous. It <a href="https://en.wikipedia.org/wiki/Loop_interchange" rel="noreferrer">interchanges the two loops</a>, thereby hoisting the unpredictable branch to the outer loop. So not only is it immune the mispredictions, it is also twice as fast as whatever VC++ and GCC can generate! In other words, ICC took advantage of the test-loop to defeat the benchmark…
</p>
</li>
<li>
<p>
If you give the Intel compiler the branchless code, it just out-right vectorizes it… and is just as fast as with the branch (with the loop interchange).
</p>
</li>
</ul>
<p>This goes to show that even mature modern compilers can vary wildly in their ability to optimize code…</p>
</section>
<section id="answer-2-score-3958" class="level4">
<h4>Answer 2 (score 3958)</h4>
<p><strong>Branch prediction.</strong></p>
<p>With a sorted array, the condition <code>data[c] &amp;gt;= 128</code> is first <code>false</code> for a streak of values, then becomes <code>true</code> for all later values. That’s easy to predict. With an unsorted array, you pay for the branching cost.</p>
</section>
<section id="answer-3-score-3198" class="level4">
<h4>Answer 3 (score 3198)</h4>
<p>The reason why performance improves drastically when the data is sorted is that the branch prediction penalty is removed, as explained beautifully in <a href="https://stackoverflow.com/questions/11227809/why-is-it-faster-to-process-a-sorted-array-than-an-unsorted-array/11227902
#11227902">Mysticial’s answer</a>.</p>
<p>Now, if we look at the code</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true"></a><span class="kw">if</span> (data[c] &gt;= <span class="dv">128</span>)</span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true"></a>    sum += data[c];</span></code></pre></div>
<p>we can find that the meaning of this particular <code>if... else...</code> branch is to add something when a condition is satisfied. This type of branch can be easily transformed into a <strong>conditional move</strong> statement, which would be compiled into a conditional move instruction: <code>cmovl</code>, in an <code>x86</code> system. The branch and thus the potential branch prediction penalty is removed.</p>
<p>In <code>C</code>, thus <code>C++</code>, the statement, which would compile directly (without any optimization) into the conditional move instruction in <code>x86</code>, is the ternary operator <code>... ? ... : ...</code>. So we rewrite the above statement into an equivalent one:</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true"></a>sum += data[c] &gt;=<span class="dv">128</span> ? data[c] : <span class="dv">0</span>;</span></code></pre></div>
<p>While maintaining readability, we can check the speedup factor.</p>
<p>On an Intel <a href="http://en.wikipedia.org/wiki/Intel_Core
#Core_i7" rel="noreferrer">Core i7</a>-2600K @ 3.4 GHz and Visual Studio 2010 Release Mode, the benchmark is (format copied from Mysticial):</p>
<p><strong>x86</strong></p>
<div class="sourceCode" id="cb191"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true"></a><span class="co">//  Branch - Random</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true"></a>seconds = <span class="fl">8.</span><span class="dv">885</span></span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true"></a></span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true"></a><span class="co">//  Branch - Sorted</span></span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true"></a>seconds = <span class="fl">1.</span><span class="dv">528</span></span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true"></a></span>
<span id="cb191-7"><a href="#cb191-7" aria-hidden="true"></a><span class="co">//  Branchless - Random</span></span>
<span id="cb191-8"><a href="#cb191-8" aria-hidden="true"></a>seconds = <span class="fl">3.</span><span class="dv">716</span></span>
<span id="cb191-9"><a href="#cb191-9" aria-hidden="true"></a></span>
<span id="cb191-10"><a href="#cb191-10" aria-hidden="true"></a><span class="co">//  Branchless - Sorted</span></span>
<span id="cb191-11"><a href="#cb191-11" aria-hidden="true"></a>seconds = <span class="fl">3.</span><span class="dv">71</span></span></code></pre></div>
<p><strong>x64</strong></p>
<div class="sourceCode" id="cb192"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true"></a><span class="co">//  Branch - Random</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true"></a>seconds = <span class="fl">11.</span><span class="dv">302</span></span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true"></a></span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true"></a><span class="co">//  Branch - Sorted</span></span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true"></a> seconds = <span class="fl">1.</span><span class="dv">830</span></span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true"></a></span>
<span id="cb192-7"><a href="#cb192-7" aria-hidden="true"></a><span class="co">//  Branchless - Random</span></span>
<span id="cb192-8"><a href="#cb192-8" aria-hidden="true"></a>seconds = <span class="fl">2.</span><span class="dv">736</span></span>
<span id="cb192-9"><a href="#cb192-9" aria-hidden="true"></a></span>
<span id="cb192-10"><a href="#cb192-10" aria-hidden="true"></a><span class="co">//  Branchless - Sorted</span></span>
<span id="cb192-11"><a href="#cb192-11" aria-hidden="true"></a>seconds = <span class="fl">2.</span><span class="dv">737</span></span></code></pre></div>
<p>The result is robust in multiple tests. We get a great speedup when the branch result is unpredictable, but we suffer a little bit when it is predictable. In fact, when using a conditional move, the performance is the same regardless of the data pattern.</p>
<p>Now let’s look more closely by investigating the <code>x86</code> assembly they generate. For simplicity, we use two functions <code>max1</code> and <code>max2</code>.</p>
<p><code>max1</code> uses the conditional branch <code>if... else ...</code>:</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true"></a><span class="dt">int</span> <span class="fu">max1</span>(<span class="dt">int</span> a, <span class="dt">int</span> b) {</span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true"></a>    <span class="kw">if</span> (a &gt; b)</span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true"></a>        <span class="kw">return</span> a;</span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true"></a>    <span class="kw">else</span></span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true"></a>        <span class="kw">return</span> b;</span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true"></a>}</span></code></pre></div>
<p><code>max2</code> uses the ternary operator <code>... ? ... : ...</code>:</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true"></a><span class="dt">int</span> <span class="fu">max2</span>(<span class="dt">int</span> a, <span class="dt">int</span> b) {</span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true"></a>    <span class="kw">return</span> a &gt; b ? a : b;</span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true"></a>}</span></code></pre></div>
<p>On a x86-64 machine, <code>GCC -S</code> generates the assembly below.</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true"></a>:max1</span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true"></a>    movl    %edi, -<span class="dv">4</span>(%rbp)</span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true"></a>    movl    %esi, -<span class="dv">8</span>(%rbp)</span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true"></a>    movl    -<span class="dv">4</span>(%rbp), %eax</span>
<span id="cb195-5"><a href="#cb195-5" aria-hidden="true"></a>    cmpl    -<span class="dv">8</span>(%rbp), %eax</span>
<span id="cb195-6"><a href="#cb195-6" aria-hidden="true"></a>    jle     .<span class="fu">L2</span></span>
<span id="cb195-7"><a href="#cb195-7" aria-hidden="true"></a>    movl    -<span class="dv">4</span>(%rbp), %eax</span>
<span id="cb195-8"><a href="#cb195-8" aria-hidden="true"></a>    movl    %eax, -<span class="dv">12</span>(%rbp)</span>
<span id="cb195-9"><a href="#cb195-9" aria-hidden="true"></a>    jmp     .<span class="fu">L4</span></span>
<span id="cb195-10"><a href="#cb195-10" aria-hidden="true"></a>.<span class="fu">L2</span>:</span>
<span id="cb195-11"><a href="#cb195-11" aria-hidden="true"></a>    movl    -<span class="dv">8</span>(%rbp), %eax</span>
<span id="cb195-12"><a href="#cb195-12" aria-hidden="true"></a>    movl    %eax, -<span class="dv">12</span>(%rbp)</span>
<span id="cb195-13"><a href="#cb195-13" aria-hidden="true"></a>.<span class="fu">L4</span>:</span>
<span id="cb195-14"><a href="#cb195-14" aria-hidden="true"></a>    movl    -<span class="dv">12</span>(%rbp), %eax</span>
<span id="cb195-15"><a href="#cb195-15" aria-hidden="true"></a>    leave</span>
<span id="cb195-16"><a href="#cb195-16" aria-hidden="true"></a>    ret</span>
<span id="cb195-17"><a href="#cb195-17" aria-hidden="true"></a></span>
<span id="cb195-18"><a href="#cb195-18" aria-hidden="true"></a>:max2</span>
<span id="cb195-19"><a href="#cb195-19" aria-hidden="true"></a>    movl    %edi, -<span class="dv">4</span>(%rbp)</span>
<span id="cb195-20"><a href="#cb195-20" aria-hidden="true"></a>    movl    %esi, -<span class="dv">8</span>(%rbp)</span>
<span id="cb195-21"><a href="#cb195-21" aria-hidden="true"></a>    movl    -<span class="dv">4</span>(%rbp), %eax</span>
<span id="cb195-22"><a href="#cb195-22" aria-hidden="true"></a>    cmpl    %eax, -<span class="dv">8</span>(%rbp)</span>
<span id="cb195-23"><a href="#cb195-23" aria-hidden="true"></a>    cmovge  -<span class="dv">8</span>(%rbp), %eax</span>
<span id="cb195-24"><a href="#cb195-24" aria-hidden="true"></a>    leave</span>
<span id="cb195-25"><a href="#cb195-25" aria-hidden="true"></a>    ret</span></code></pre></div>
<p><code>max2</code> uses much less code due to the usage of instruction <code>cmovge</code>. But the real gain is that <code>max2</code> does not involve branch jumps, <code>jmp</code>, which would have a significant performance penalty if the predicted result is not right.</p>
<p>So why does a conditional move perform better?</p>
<p>In a typical <code>x86</code> processor, the execution of an instruction is divided into several stages. Roughly, we have different hardware to deal with different stages. So we do not have to wait for one instruction to finish to start a new one. This is called <strong><a href="http://en.wikipedia.org/wiki/Pipeline_%28computing%29" rel="noreferrer">pipelining</a></strong>.</p>
<p>In a branch case, the following instruction is determined by the preceding one, so we cannot do pipelining. We have to either wait or predict.</p>
<p>In a conditional move case, the execution conditional move instruction is divided into several stages, but the earlier stages like <code>Fetch</code> and <code>Decode</code> does not depend on the result of the previous instruction; only latter stages need the result. Thus, we wait a fraction of one instruction’s execution time. This is why the conditional move version is slower than the branch when prediction is easy.</p>
<p>The book <em><a href="https://rads.stackoverflow.com/amzn/click/com/0136108040" rel="noreferrer" rel="nofollow noreferrer">Computer Systems: A Programmer’s Perspective, second edition</a></em> explains this in detail. You can check Section 3.6.6 for <em>Conditional Move Instructions</em>, entire Chapter 4 for <em>Processor Architecture</em>, and Section 5.11.2 for a special treatment for <em>Branch Prediction and Misprediction Penalties</em>.</p>
<p>Sometimes, some modern compilers can optimize our code to assembly with better performance, sometimes some compilers can’t (the code in question is using Visual Studio’s native compiler). Knowing the performance difference between branch and conditional move when unpredictable can help us write code with better performance when the scenario gets so complex that the compiler can not optimize them automatically.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-to-generate-a-random-alpha-numeric-string-score-1334589-in-2019" class="level3">
<h3>22: How to generate a random alpha-numeric string? (score <a href="https://stackoverflow.com/q/41107.html">1334589</a> in 2019)</h3>
<section id="question-21" class="level4">
<h4>Question</h4>
<p>I’ve been looking for a <em>simple</em> Java algorithm to generate a pseudo-random alpha-numeric string. In my situation it would be used as a unique session/key identifier that would “likely” be unique over <code>500K+</code> generation (my needs don’t really require anything much more sophisticated).</p>
<p>Ideally, I would be able to specify a length depending on my uniqueness needs. For example, a generated string of length 12 might look something like <code>"AEYGF7K0DM1X"</code>.</p>
</section>
<section id="answer-accepted-score-1507" class="level4">
<h4>Answer accepted (score 1507)</h4>
<h5>
Algorithm
</h2>
<p>To generate a random string, concatenate characters drawn randomly from the set of acceptable symbols until the string reaches the desired length.</p>
<h5>
Implementation
</h2>
<p>Here’s some fairly simple and very flexible code for generating random identifiers. <em>Read the information that follows</em> for important application notes.</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true"></a><span class="kw">import</span><span class="im"> java.security.SecureRandom;</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true"></a><span class="kw">import</span><span class="im"> java.util.Locale;</span></span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true"></a><span class="kw">import</span><span class="im"> java.util.Objects;</span></span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true"></a><span class="kw">import</span><span class="im"> java.util.Random;</span></span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true"></a></span>
<span id="cb196-6"><a href="#cb196-6" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">class</span> RandomString {</span>
<span id="cb196-7"><a href="#cb196-7" aria-hidden="true"></a></span>
<span id="cb196-8"><a href="#cb196-8" aria-hidden="true"></a>    <span class="co">/**</span></span>
<span id="cb196-9"><a href="#cb196-9" aria-hidden="true"></a>     <span class="co">*</span> Generate a random string<span class="co">.</span></span>
<span id="cb196-10"><a href="#cb196-10" aria-hidden="true"></a>     <span class="co">*/</span></span>
<span id="cb196-11"><a href="#cb196-11" aria-hidden="true"></a>    <span class="kw">public</span> <span class="bu">String</span> <span class="fu">nextString</span>() {</span>
<span id="cb196-12"><a href="#cb196-12" aria-hidden="true"></a>        <span class="kw">for</span> (<span class="dt">int</span> idx = <span class="dv">0</span>; idx &lt; buf.<span class="fu">length</span>; ++idx)</span>
<span id="cb196-13"><a href="#cb196-13" aria-hidden="true"></a>            buf[idx] = symbols[random.<span class="fu">nextInt</span>(symbols.<span class="fu">length</span>)];</span>
<span id="cb196-14"><a href="#cb196-14" aria-hidden="true"></a>        <span class="kw">return</span> <span class="kw">new</span> <span class="bu">String</span>(buf);</span>
<span id="cb196-15"><a href="#cb196-15" aria-hidden="true"></a>    }</span>
<span id="cb196-16"><a href="#cb196-16" aria-hidden="true"></a></span>
<span id="cb196-17"><a href="#cb196-17" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">final</span> <span class="bu">String</span> upper = <span class="st">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span>;</span>
<span id="cb196-18"><a href="#cb196-18" aria-hidden="true"></a></span>
<span id="cb196-19"><a href="#cb196-19" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">final</span> <span class="bu">String</span> lower = upper.<span class="fu">toLowerCase</span>(<span class="bu">Locale</span>.<span class="fu">ROOT</span>);</span>
<span id="cb196-20"><a href="#cb196-20" aria-hidden="true"></a></span>
<span id="cb196-21"><a href="#cb196-21" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">final</span> <span class="bu">String</span> digits = <span class="st">&quot;0123456789&quot;</span>;</span>
<span id="cb196-22"><a href="#cb196-22" aria-hidden="true"></a></span>
<span id="cb196-23"><a href="#cb196-23" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">final</span> <span class="bu">String</span> alphanum = upper + lower + digits;</span>
<span id="cb196-24"><a href="#cb196-24" aria-hidden="true"></a></span>
<span id="cb196-25"><a href="#cb196-25" aria-hidden="true"></a>    <span class="kw">private</span> <span class="dt">final</span> <span class="bu">Random</span> random;</span>
<span id="cb196-26"><a href="#cb196-26" aria-hidden="true"></a></span>
<span id="cb196-27"><a href="#cb196-27" aria-hidden="true"></a>    <span class="kw">private</span> <span class="dt">final</span> <span class="dt">char</span>[] symbols;</span>
<span id="cb196-28"><a href="#cb196-28" aria-hidden="true"></a></span>
<span id="cb196-29"><a href="#cb196-29" aria-hidden="true"></a>    <span class="kw">private</span> <span class="dt">final</span> <span class="dt">char</span>[] buf;</span>
<span id="cb196-30"><a href="#cb196-30" aria-hidden="true"></a></span>
<span id="cb196-31"><a href="#cb196-31" aria-hidden="true"></a>    <span class="kw">public</span> <span class="fu">RandomString</span>(<span class="dt">int</span> length, <span class="bu">Random</span> random, <span class="bu">String</span> symbols) {</span>
<span id="cb196-32"><a href="#cb196-32" aria-hidden="true"></a>        <span class="kw">if</span> (length &lt; <span class="dv">1</span>) <span class="kw">throw</span> <span class="kw">new</span> <span class="bu">IllegalArgumentException</span>();</span>
<span id="cb196-33"><a href="#cb196-33" aria-hidden="true"></a>        <span class="kw">if</span> (symbols.<span class="fu">length</span>() &lt; <span class="dv">2</span>) <span class="kw">throw</span> <span class="kw">new</span> <span class="bu">IllegalArgumentException</span>();</span>
<span id="cb196-34"><a href="#cb196-34" aria-hidden="true"></a>        <span class="kw">this</span>.<span class="fu">random</span> = Objects.<span class="fu">requireNonNull</span>(random);</span>
<span id="cb196-35"><a href="#cb196-35" aria-hidden="true"></a>        <span class="kw">this</span>.<span class="fu">symbols</span> = symbols.<span class="fu">toCharArray</span>();</span>
<span id="cb196-36"><a href="#cb196-36" aria-hidden="true"></a>        <span class="kw">this</span>.<span class="fu">buf</span> = <span class="kw">new</span> <span class="dt">char</span>[length];</span>
<span id="cb196-37"><a href="#cb196-37" aria-hidden="true"></a>    }</span>
<span id="cb196-38"><a href="#cb196-38" aria-hidden="true"></a></span>
<span id="cb196-39"><a href="#cb196-39" aria-hidden="true"></a>    <span class="co">/**</span></span>
<span id="cb196-40"><a href="#cb196-40" aria-hidden="true"></a>     <span class="co">*</span> Create an alphanumeric string generator<span class="co">.</span></span>
<span id="cb196-41"><a href="#cb196-41" aria-hidden="true"></a>     <span class="co">*/</span></span>
<span id="cb196-42"><a href="#cb196-42" aria-hidden="true"></a>    <span class="kw">public</span> <span class="fu">RandomString</span>(<span class="dt">int</span> length, <span class="bu">Random</span> random) {</span>
<span id="cb196-43"><a href="#cb196-43" aria-hidden="true"></a>        <span class="kw">this</span>(length, random, alphanum);</span>
<span id="cb196-44"><a href="#cb196-44" aria-hidden="true"></a>    }</span>
<span id="cb196-45"><a href="#cb196-45" aria-hidden="true"></a></span>
<span id="cb196-46"><a href="#cb196-46" aria-hidden="true"></a>    <span class="co">/**</span></span>
<span id="cb196-47"><a href="#cb196-47" aria-hidden="true"></a>     <span class="co">*</span> Create an alphanumeric strings from a secure generator<span class="co">.</span></span>
<span id="cb196-48"><a href="#cb196-48" aria-hidden="true"></a>     <span class="co">*/</span></span>
<span id="cb196-49"><a href="#cb196-49" aria-hidden="true"></a>    <span class="kw">public</span> <span class="fu">RandomString</span>(<span class="dt">int</span> length) {</span>
<span id="cb196-50"><a href="#cb196-50" aria-hidden="true"></a>        <span class="kw">this</span>(length, <span class="kw">new</span> <span class="bu">SecureRandom</span>());</span>
<span id="cb196-51"><a href="#cb196-51" aria-hidden="true"></a>    }</span>
<span id="cb196-52"><a href="#cb196-52" aria-hidden="true"></a></span>
<span id="cb196-53"><a href="#cb196-53" aria-hidden="true"></a>    <span class="co">/**</span></span>
<span id="cb196-54"><a href="#cb196-54" aria-hidden="true"></a>     <span class="co">*</span> Create session identifiers<span class="co">.</span></span>
<span id="cb196-55"><a href="#cb196-55" aria-hidden="true"></a>     <span class="co">*/</span></span>
<span id="cb196-56"><a href="#cb196-56" aria-hidden="true"></a>    <span class="kw">public</span> <span class="fu">RandomString</span>() {</span>
<span id="cb196-57"><a href="#cb196-57" aria-hidden="true"></a>        <span class="kw">this</span>(<span class="dv">21</span>);</span>
<span id="cb196-58"><a href="#cb196-58" aria-hidden="true"></a>    }</span>
<span id="cb196-59"><a href="#cb196-59" aria-hidden="true"></a></span>
<span id="cb196-60"><a href="#cb196-60" aria-hidden="true"></a>}</span></code></pre></div>
<h5>
Usage examples
</h2>
<p>Create an insecure generator for 8-character identifiers:</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true"></a>RandomString gen = <span class="kw">new</span> <span class="fu">RandomString</span>(<span class="dv">8</span>, ThreadLocalRandom.<span class="fu">current</span>());</span></code></pre></div>
<p>Create a secure generator for session identifiers:</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true"></a>RandomString session = <span class="kw">new</span> <span class="fu">RandomString</span>();</span></code></pre></div>
<p>Create a generator with easy-to-read codes for printing. The strings are longer than full alphanumeric strings to compensate for using fewer symbols:</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true"></a><span class="bu">String</span> easy = RandomString.<span class="fu">digits</span> + <span class="st">&quot;ACEFGHJKLMNPQRUVWXYabcdefhijkprstuvwx&quot;</span>;</span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true"></a>RandomString tickets = <span class="kw">new</span> <span class="fu">RandomString</span>(<span class="dv">23</span>, <span class="kw">new</span> <span class="bu">SecureRandom</span>(), easy);</span></code></pre></div>
<h5>
Use as session identifiers
</h2>
<p>Generating session identifiers that are likely to be unique is not good enough, or you could just use a simple counter. Attackers hijack sessions when predictable identifiers are used.</p>
<p>There is tension between length and security. Shorter identifiers are easier to guess, because there are fewer possibilities. But longer identifiers consume more storage and bandwidth. A larger set of symbols helps, but might cause encoding problems if identifiers are included in URLs or re-entered by hand.</p>
<p>The underlying source of randomness, or entropy, for session identifiers should come from a random number generator designed for cryptography. However, initializing these generators can sometimes be computationally expensive or slow, so effort should be made to re-use them when possible.</p>
<h5>
Use as object identifiers
</h2>
<p>Not every application requires security. Random assignment can be an efficient way for multiple entities to generate identifiers in a shared space without any coordination or partitioning. Coordination can be slow, especially in a clustered or distributed environment, and splitting up a space causes problems when entities end up with shares that are too small or too big.</p>
<p>Identifiers generated without taking measures to make them unpredictable should be protected by other means if an attacker might be able to view and manipulate them, as happens in most web applications. There should be a separate authorization system that protects objects whose identifier can be guessed by an attacker without access permission.</p>
<p>Care must be also be taken to use identifiers that are long enough to make collisions unlikely given the anticipated total number of identifiers. This is referred to as “the birthday paradox.” <a href="https://en.wikipedia.org/wiki/Birthday_problem
#Square_approximation" rel="noreferrer">The probability of a collision,</a> <em>p</em>, is approximately n<sup>2</sup>/(2q<sup>x</sup>), where <em>n</em> is the number of identifiers actually generated, <em>q</em> is the number of distinct symbols in the alphabet, and <em>x</em> is the length of the identifiers. This should be a very small number, like 2<sup>‑50</sup> or less.</p>
<p>Working this out shows that the chance of collision among 500k 15-character identifiers is about 2<sup>&amp; #8209;52</sup>, which is probably less likely than undetected errors from cosmic rays, etc.</p>
<h5>
Comparison with UUIDs
</h2>
<p>According to their specification, UUIDs are not designed to be unpredictable, and <em>should not</em> be used as session identifiers.</p>
<p>UUIDs in their standard format take a lot of space: 36 characters for only 122 bits of entropy. (Not all bits of a “random” UUID are selected randomly.) A randomly chosen alphanumeric string packs more entropy in just 21 characters.</p>
<p>UUIDs are not flexible; they have a standardized structure and layout. This is their chief virtue as well as their main weakness. When collaborating with an outside party, the standardization offered by UUIDs may be helpful. For purely internal use, they can be inefficient.</p>
</section>
<section id="answer-2-score-792" class="level4">
<h4>Answer 2 (score 792)</h4>
<p>Java supplies a way of doing this directly. If you don’t want the dashes, they are easy to strip out. Just use <code>uuid.replace("-", "")</code></p>
<div class="sourceCode" id="cb200"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true"></a><span class="kw">import</span><span class="im"> java.util.UUID;</span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true"></a></span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">class</span> randomStringGenerator {</span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span>(<span class="bu">String</span>[] args) {</span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true"></a>        <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="fu">generateString</span>());</span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true"></a>    }</span>
<span id="cb200-7"><a href="#cb200-7" aria-hidden="true"></a></span>
<span id="cb200-8"><a href="#cb200-8" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="bu">String</span> <span class="fu">generateString</span>() {</span>
<span id="cb200-9"><a href="#cb200-9" aria-hidden="true"></a>        <span class="bu">String</span> uuid = <span class="bu">UUID</span>.<span class="fu">randomUUID</span>().<span class="fu">toString</span>();</span>
<span id="cb200-10"><a href="#cb200-10" aria-hidden="true"></a>        <span class="kw">return</span> <span class="st">&quot;uuid = &quot;</span> + uuid;</span>
<span id="cb200-11"><a href="#cb200-11" aria-hidden="true"></a>    }</span>
<span id="cb200-12"><a href="#cb200-12" aria-hidden="true"></a>}</span></code></pre></div>
<p><strong>Output:</strong></p>
<div class="sourceCode" id="cb201"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true"></a>uuid = 2d7428a6-b58c-<span class="dv">4008</span>-<span class="dv">8575</span>-f05549f16316</span></code></pre></div>
</section>
<section id="answer-3-score-530" class="level4">
<h4>Answer 3 (score 530)</h4>
<div class="sourceCode" id="cb202"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true"></a><span class="dt">static</span> <span class="dt">final</span> <span class="bu">String</span> AB = <span class="st">&quot;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz&quot;</span>;</span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true"></a><span class="dt">static</span> <span class="bu">SecureRandom</span> rnd = <span class="kw">new</span> <span class="bu">SecureRandom</span>();</span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true"></a></span>
<span id="cb202-4"><a href="#cb202-4" aria-hidden="true"></a><span class="bu">String</span> <span class="fu">randomString</span>( <span class="dt">int</span> len ){</span>
<span id="cb202-5"><a href="#cb202-5" aria-hidden="true"></a>   <span class="bu">StringBuilder</span> sb = <span class="kw">new</span> <span class="bu">StringBuilder</span>( len );</span>
<span id="cb202-6"><a href="#cb202-6" aria-hidden="true"></a>   <span class="kw">for</span>( <span class="dt">int</span> i = <span class="dv">0</span>; i &lt; len; i++ ) </span>
<span id="cb202-7"><a href="#cb202-7" aria-hidden="true"></a>      sb.<span class="fu">append</span>( AB.<span class="fu">charAt</span>( rnd.<span class="fu">nextInt</span>(AB.<span class="fu">length</span>()) ) );</span>
<span id="cb202-8"><a href="#cb202-8" aria-hidden="true"></a>   <span class="kw">return</span> sb.<span class="fu">toString</span>();</span>
<span id="cb202-9"><a href="#cb202-9" aria-hidden="true"></a>}</span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="sort-a-mapkey-value-by-values-score-1327878-in-2018" class="level3">
<h3>23: Sort a Map&lt;Key, Value&gt; by values (score <a href="https://stackoverflow.com/q/109383.html">1327878</a> in 2018)</h3>
<section id="question-22" class="level4">
<h4>Question</h4>
<p>I am relatively new to Java, and often find that I need to sort a <code>Map&amp;lt;Key, Value&amp;gt;</code> on the values.</p>
<p>Since the values are not unique, I find myself converting the <code>keySet</code> into an <code>array</code>, and sorting that array through <strong>array sort</strong> with a <strong>custom comparator</strong> that sorts on the value associated with the key.</p>
<p>Is there an easier way?</p>
</section>
<section id="answer-2-score-865-1" class="level4">
<h4>Answer 2 (score 865)</h4>
<p>Here’s a generic-friendly version:</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">class</span> MapUtil {</span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">static</span> &lt;K, V <span class="kw">extends</span> <span class="bu">Comparable</span>&lt;? <span class="kw">super</span> V&gt;&gt; <span class="bu">Map</span>&lt;K, V&gt; <span class="fu">sortByValue</span>(<span class="bu">Map</span>&lt;K, V&gt; map) {</span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true"></a>        <span class="bu">List</span>&lt;Entry&lt;K, V&gt;&gt; list = <span class="kw">new</span> <span class="bu">ArrayList</span>&lt;&gt;(map.<span class="fu">entrySet</span>());</span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true"></a>        list.<span class="fu">sort</span>(Entry.<span class="fu">comparingByValue</span>());</span>
<span id="cb203-5"><a href="#cb203-5" aria-hidden="true"></a></span>
<span id="cb203-6"><a href="#cb203-6" aria-hidden="true"></a>        <span class="bu">Map</span>&lt;K, V&gt; result = <span class="kw">new</span> <span class="bu">LinkedHashMap</span>&lt;&gt;();</span>
<span id="cb203-7"><a href="#cb203-7" aria-hidden="true"></a>        <span class="kw">for</span> (Entry&lt;K, V&gt; entry : list) {</span>
<span id="cb203-8"><a href="#cb203-8" aria-hidden="true"></a>            result.<span class="fu">put</span>(entry.<span class="fu">getKey</span>(), entry.<span class="fu">getValue</span>());</span>
<span id="cb203-9"><a href="#cb203-9" aria-hidden="true"></a>        }</span>
<span id="cb203-10"><a href="#cb203-10" aria-hidden="true"></a></span>
<span id="cb203-11"><a href="#cb203-11" aria-hidden="true"></a>        <span class="kw">return</span> result;</span>
<span id="cb203-12"><a href="#cb203-12" aria-hidden="true"></a>    }</span>
<span id="cb203-13"><a href="#cb203-13" aria-hidden="true"></a>}</span></code></pre></div>
</section>
<section id="answer-3-score-410" class="level4">
<h4>Answer 3 (score 410)</h4>
<h5>
Important note:
</h3>
<p><strong>This code can break in multiple ways.</strong> If you intend to use the code provided, be sure to read the comments as well to be aware of the implications. For example, values can no longer be retrieved by their key. (<code>get</code> always returns <code>null</code>.)</p>
<hr>
<p>It seems much easier than all of the foregoing. Use a TreeMap as follows:</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">class</span> Testing {</span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span>(<span class="bu">String</span>[] args) {</span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true"></a>        <span class="bu">HashMap</span>&lt;<span class="bu">String</span>, <span class="bu">Double</span>&gt; map = <span class="kw">new</span> <span class="bu">HashMap</span>&lt;<span class="bu">String</span>, <span class="bu">Double</span>&gt;();</span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true"></a>        ValueComparator bvc = <span class="kw">new</span> <span class="fu">ValueComparator</span>(map);</span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true"></a>        <span class="bu">TreeMap</span>&lt;<span class="bu">String</span>, <span class="bu">Double</span>&gt; sorted_map = <span class="kw">new</span> <span class="bu">TreeMap</span>&lt;<span class="bu">String</span>, <span class="bu">Double</span>&gt;(bvc);</span>
<span id="cb204-6"><a href="#cb204-6" aria-hidden="true"></a></span>
<span id="cb204-7"><a href="#cb204-7" aria-hidden="true"></a>        map.<span class="fu">put</span>(<span class="st">&quot;A&quot;</span>, <span class="fl">99.</span><span class="dv">5</span>);</span>
<span id="cb204-8"><a href="#cb204-8" aria-hidden="true"></a>        map.<span class="fu">put</span>(<span class="st">&quot;B&quot;</span>, <span class="fl">67.</span><span class="dv">4</span>);</span>
<span id="cb204-9"><a href="#cb204-9" aria-hidden="true"></a>        map.<span class="fu">put</span>(<span class="st">&quot;C&quot;</span>, <span class="fl">67.</span><span class="dv">4</span>);</span>
<span id="cb204-10"><a href="#cb204-10" aria-hidden="true"></a>        map.<span class="fu">put</span>(<span class="st">&quot;D&quot;</span>, <span class="fl">67.</span><span class="dv">3</span>);</span>
<span id="cb204-11"><a href="#cb204-11" aria-hidden="true"></a></span>
<span id="cb204-12"><a href="#cb204-12" aria-hidden="true"></a>        <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;unsorted map: &quot;</span> + map);</span>
<span id="cb204-13"><a href="#cb204-13" aria-hidden="true"></a>        sorted_map.<span class="fu">putAll</span>(map);</span>
<span id="cb204-14"><a href="#cb204-14" aria-hidden="true"></a>        <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;results: &quot;</span> + sorted_map);</span>
<span id="cb204-15"><a href="#cb204-15" aria-hidden="true"></a>    }</span>
<span id="cb204-16"><a href="#cb204-16" aria-hidden="true"></a>}</span>
<span id="cb204-17"><a href="#cb204-17" aria-hidden="true"></a></span>
<span id="cb204-18"><a href="#cb204-18" aria-hidden="true"></a><span class="kw">class</span> ValueComparator <span class="kw">implements</span> <span class="bu">Comparator</span>&lt;<span class="bu">String</span>&gt; {</span>
<span id="cb204-19"><a href="#cb204-19" aria-hidden="true"></a>    <span class="bu">Map</span>&lt;<span class="bu">String</span>, <span class="bu">Double</span>&gt; base;</span>
<span id="cb204-20"><a href="#cb204-20" aria-hidden="true"></a></span>
<span id="cb204-21"><a href="#cb204-21" aria-hidden="true"></a>    <span class="kw">public</span> <span class="fu">ValueComparator</span>(<span class="bu">Map</span>&lt;<span class="bu">String</span>, <span class="bu">Double</span>&gt; base) {</span>
<span id="cb204-22"><a href="#cb204-22" aria-hidden="true"></a>        <span class="kw">this</span>.<span class="fu">base</span> = base;</span>
<span id="cb204-23"><a href="#cb204-23" aria-hidden="true"></a>    }</span>
<span id="cb204-24"><a href="#cb204-24" aria-hidden="true"></a></span>
<span id="cb204-25"><a href="#cb204-25" aria-hidden="true"></a>    <span class="co">// Note: this comparator imposes orderings that are inconsistent with</span></span>
<span id="cb204-26"><a href="#cb204-26" aria-hidden="true"></a>    <span class="co">// equals.</span></span>
<span id="cb204-27"><a href="#cb204-27" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">int</span> <span class="fu">compare</span>(<span class="bu">String</span> a, <span class="bu">String</span> b) {</span>
<span id="cb204-28"><a href="#cb204-28" aria-hidden="true"></a>        <span class="kw">if</span> (base.<span class="fu">get</span>(a) &gt;= base.<span class="fu">get</span>(b)) {</span>
<span id="cb204-29"><a href="#cb204-29" aria-hidden="true"></a>            <span class="kw">return</span> -<span class="dv">1</span>;</span>
<span id="cb204-30"><a href="#cb204-30" aria-hidden="true"></a>        } <span class="kw">else</span> {</span>
<span id="cb204-31"><a href="#cb204-31" aria-hidden="true"></a>            <span class="kw">return</span> <span class="dv">1</span>;</span>
<span id="cb204-32"><a href="#cb204-32" aria-hidden="true"></a>        } <span class="co">// returning 0 would merge keys</span></span>
<span id="cb204-33"><a href="#cb204-33" aria-hidden="true"></a>    }</span>
<span id="cb204-34"><a href="#cb204-34" aria-hidden="true"></a>}</span></code></pre></div>
<p>Output:</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true"></a>unsorted map: {D=<span class="fl">67.</span><span class="dv">3</span>, A=<span class="fl">99.</span><span class="dv">5</span>, B=<span class="fl">67.</span><span class="dv">4</span>, C=<span class="fl">67.</span><span class="dv">4</span>}</span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true"></a>results: {D=<span class="fl">67.</span><span class="dv">3</span>, B=<span class="fl">67.</span><span class="dv">4</span>, C=<span class="fl">67.</span><span class="dv">4</span>, A=<span class="fl">99.</span><span class="dv">5</span>}</span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-do-i-create-a-java-string-from-the-contents-of-a-file-score-1307219-in-2018" class="level3">
<h3>24: How do I create a Java string from the contents of a file? (score <a href="https://stackoverflow.com/q/326390.html">1307219</a> in 2018)</h3>
<section id="question-23" class="level4">
<h4>Question</h4>
<p>I’ve been using the idiom below for some time now. And it seems to be the most wide-spread, at least on the sites I’ve visited.</p>
<p>Is there a better/different way to read a file into a string in Java?</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true"></a><span class="kw">private</span> <span class="bu">String</span> <span class="fu">readFile</span>(<span class="bu">String</span> file) <span class="kw">throws</span> <span class="bu">IOException</span> {</span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true"></a>    <span class="bu">BufferedReader</span> reader = <span class="kw">new</span> <span class="bu">BufferedReader</span>(<span class="kw">new</span> <span class="bu">FileReader</span> (file));</span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true"></a>    <span class="bu">String</span>         line = <span class="kw">null</span>;</span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true"></a>    <span class="bu">StringBuilder</span>  stringBuilder = <span class="kw">new</span> <span class="bu">StringBuilder</span>();</span>
<span id="cb206-5"><a href="#cb206-5" aria-hidden="true"></a>    <span class="bu">String</span>         ls = <span class="bu">System</span>.<span class="fu">getProperty</span>(<span class="st">&quot;line.separator&quot;</span>);</span>
<span id="cb206-6"><a href="#cb206-6" aria-hidden="true"></a></span>
<span id="cb206-7"><a href="#cb206-7" aria-hidden="true"></a>    <span class="kw">try</span> {</span>
<span id="cb206-8"><a href="#cb206-8" aria-hidden="true"></a>        <span class="kw">while</span>((line = reader.<span class="fu">readLine</span>()) != <span class="kw">null</span>) {</span>
<span id="cb206-9"><a href="#cb206-9" aria-hidden="true"></a>            stringBuilder.<span class="fu">append</span>(line);</span>
<span id="cb206-10"><a href="#cb206-10" aria-hidden="true"></a>            stringBuilder.<span class="fu">append</span>(ls);</span>
<span id="cb206-11"><a href="#cb206-11" aria-hidden="true"></a>        }</span>
<span id="cb206-12"><a href="#cb206-12" aria-hidden="true"></a></span>
<span id="cb206-13"><a href="#cb206-13" aria-hidden="true"></a>        <span class="kw">return</span> stringBuilder.<span class="fu">toString</span>();</span>
<span id="cb206-14"><a href="#cb206-14" aria-hidden="true"></a>    } <span class="kw">finally</span> {</span>
<span id="cb206-15"><a href="#cb206-15" aria-hidden="true"></a>        reader.<span class="fu">close</span>();</span>
<span id="cb206-16"><a href="#cb206-16" aria-hidden="true"></a>    }</span>
<span id="cb206-17"><a href="#cb206-17" aria-hidden="true"></a>}</span></code></pre></div>
</section>
<section id="answer-2-score-1443" class="level4">
<h4>Answer 2 (score 1443)</h4>
<h5>
Read all text from a file
</h2>
<p>Java 11 added the <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/nio/file/Files.html
#readString(java.nio.file.Path,java.nio.charset.Charset)" rel="noreferrer">readString()</a> method to read small files as a <code>String</code>, preserving line terminators:</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true"></a><span class="bu">String</span> content = Files.<span class="fu">readString</span>(path, StandardCharsets.<span class="fu">US_ASCII</span>);</span></code></pre></div>
<p>For versions between Java 7 and 11, here’s a compact, robust idiom, wrapped up in a utility method:</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true"></a><span class="dt">static</span> <span class="bu">String</span> <span class="fu">readFile</span>(<span class="bu">String</span> path, <span class="bu">Charset</span> encoding) </span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true"></a>  <span class="kw">throws</span> <span class="bu">IOException</span> </span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true"></a>{</span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true"></a>  <span class="dt">byte</span>[] encoded = Files.<span class="fu">readAllBytes</span>(Paths.<span class="fu">get</span>(path));</span>
<span id="cb208-5"><a href="#cb208-5" aria-hidden="true"></a>  <span class="kw">return</span> <span class="kw">new</span> <span class="bu">String</span>(encoded, encoding);</span>
<span id="cb208-6"><a href="#cb208-6" aria-hidden="true"></a>}</span></code></pre></div>
<h5>
Read lines of text from a file
</h2>
<p>Java 7 added a <a href="http://docs.oracle.com/javase/7/docs/api/java/nio/file/Files.html
#readAllLines%28java.nio.file.Path,%20java.nio.charset.Charset%29" rel="noreferrer">convenience method to read a file as lines of text,</a> represented as a <code>List&amp;lt;String&amp;gt;</code>. This approach is “lossy” because the line separators are stripped from the end of each line.</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true"></a><span class="bu">List</span>&lt;<span class="bu">String</span>&gt; lines = Files.<span class="fu">readAllLines</span>(Paths.<span class="fu">get</span>(path), encoding);</span></code></pre></div>
<p>Java 8 added the <a href="https://docs.oracle.com/javase/8/docs/api/java/nio/file/Files.html
#lines-java.nio.file.Path-java.nio.charset.Charset-" rel="noreferrer"><code>Files.lines()</code></a> method to produce a <code>Stream&amp;lt;String&amp;gt;</code>. Again, this method is lossy because line separators are stripped. If an <code>IOException</code> is encountered while reading the file, it is wrapped in an <a href="https://docs.oracle.com/javase/8/docs/api/java/io/UncheckedIOException.html" rel="noreferrer"><code>UncheckedIOException</code></a>, since <code>Stream</code> doesn’t accept lambdas that throw checked exceptions.</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true"></a><span class="kw">try</span> (Stream&lt;<span class="bu">String</span>&gt; lines = Files.<span class="fu">lines</span>(path, encoding)) {</span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true"></a>  lines.<span class="fu">forEach</span>(<span class="bu">System</span>.<span class="fu">out</span>::println);</span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true"></a>}</span></code></pre></div>
<p>This <code>Stream</code> does need a <a href="https://docs.oracle.com/javase/8/docs/api/java/util/stream/BaseStream.html
#close--" rel="noreferrer"><code>close()</code></a> call; this is poorly documented on the API, and I suspect many people don’t even notice <code>Stream</code> has a <code>close()</code> method. Be sure to use an ARM-block as shown.</p>
<p>If you are working with a source other than a file, you can use the <a href="https://docs.oracle.com/javase/8/docs/api/java/io/BufferedReader.html
#lines--" rel="noreferrer"><code>lines()</code></a> method in <code>BufferedReader</code> instead.</p>
<h5>
Memory utilization
</h2>
<p>The first method, that preserves line breaks, can temporarily require memory several times the size of the file, because for a short time the raw file contents (a byte array), and the decoded characters (each of which is 16 bits even if encoded as 8 bits in the file) reside in memory at once. It is safest to apply to files that you know to be small relative to the available memory.</p>
<p>The second method, reading lines, is usually more memory efficient, because the input byte buffer for decoding doesn’t need to contain the entire file. However, it’s still not suitable for files that are very large relative to available memory.</p>
<p>For reading large files, you need a different design for your program, one that reads a chunk of text from a stream, processes it, and then moves on to the next, reusing the same fixed-sized memory block. Here, “large” depends on the computer specs. Nowadays, this threshold might be many gigabytes of RAM. The third method, using a <code>Stream&amp;lt;String&amp;gt;</code> is one way to do this, if your input “records” happen to be individual lines. (Using the <code>readLine()</code> method of <code>BufferedReader</code> is the procedural equivalent to this approach.)</p>
<h5>
Character encoding
</h2>
<p>One thing that is missing from the sample in the original post is the character encoding. There are some special cases where the platform default is what you want, but they are rare, and you should be able justify your choice.</p>
<p>The <a href="http://docs.oracle.com/javase/7/docs/api/java/nio/charset/StandardCharsets.html" rel="noreferrer"><code>StandardCharsets</code></a> class define some constants for the encodings required of all Java runtimes:</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true"></a><span class="bu">String</span> content = <span class="fu">readFile</span>(<span class="st">&quot;test.txt&quot;</span>, StandardCharsets.<span class="fu">UTF_8</span>);</span></code></pre></div>
<p>The platform default is available from <a href="http://docs.oracle.com/javase/7/docs/api/java/nio/charset/Charset.html
#defaultCharset%28%29" rel="noreferrer">the <code>Charset</code> class</a> itself:</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true"></a><span class="bu">String</span> content = <span class="fu">readFile</span>(<span class="st">&quot;test.txt&quot;</span>, <span class="bu">Charset</span>.<span class="fu">defaultCharset</span>());</span></code></pre></div>
<hr>
<p>Note: This answer largely replaces my Java 6 version. The utility of Java 7 safely simplifies the code, and the old answer, which used a mapped byte buffer, prevented the file that was read from being deleted until the mapped buffer was garbage collected. You can view the old version via the “edited” link on this answer.</p>
</section>
<section id="answer-3-score-330" class="level4">
<h4>Answer 3 (score 330)</h4>
<p>If you’re willing to use an external library, check out <a href="https://commons.apache.org/proper/commons-io/" rel="noreferrer">Apache Commons IO</a> (200KB JAR). It contains an <a href="https://commons.apache.org/proper/commons-io/javadocs/api-release/org/apache/commons/io/FileUtils.html
#readFileToString-java.io.File-java.nio.charset.Charset-" rel="noreferrer"><code>org.apache.commons.io.FileUtils.readFileToString()</code></a> method that allows you to read an entire <code>File</code> into a <code>String</code> with one line of code.</p>
<p>Example:</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true"></a><span class="kw">import</span><span class="im"> java.io.*;</span></span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true"></a><span class="kw">import</span><span class="im"> java.nio.charset.*;</span></span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true"></a><span class="kw">import</span><span class="im"> org.apache.commons.io.*;</span></span>
<span id="cb213-4"><a href="#cb213-4" aria-hidden="true"></a></span>
<span id="cb213-5"><a href="#cb213-5" aria-hidden="true"></a><span class="kw">public</span> <span class="bu">String</span> <span class="fu">readFile</span>() <span class="kw">throws</span> <span class="bu">IOException</span> {</span>
<span id="cb213-6"><a href="#cb213-6" aria-hidden="true"></a>    <span class="bu">File</span> file = <span class="kw">new</span> <span class="bu">File</span>(<span class="st">&quot;data.txt&quot;</span>);</span>
<span id="cb213-7"><a href="#cb213-7" aria-hidden="true"></a>    <span class="kw">return</span> FileUtils.<span class="fu">readFileToString</span>(file, StandardCharsets.<span class="fu">UTF_8</span>);</span>
<span id="cb213-8"><a href="#cb213-8" aria-hidden="true"></a>}</span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-can-i-create-an-executable-jar-with-dependencies-using-maven-score-1210754-in-2018" class="level3">
<h3>25: How can I create an executable JAR with dependencies using Maven? (score <a href="https://stackoverflow.com/q/574594.html">1210754</a> in 2018)</h3>
<section id="question-24" class="level4">
<h4>Question</h4>
<p>I want to package my project in a single executable JAR for distribution.</p>
<p>How can I make a Maven project package all dependency JARs into my output JAR?</p>
</section>
<section id="answer-accepted-score-2196" class="level4">
<h4>Answer accepted (score 2196)</h4>
<div class="sourceCode" id="cb214"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true"></a>&lt;build&gt;</span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true"></a>  &lt;plugins&gt;</span>
<span id="cb214-3"><a href="#cb214-3" aria-hidden="true"></a>    &lt;plugin&gt;</span>
<span id="cb214-4"><a href="#cb214-4" aria-hidden="true"></a>      &lt;artifactId&gt;maven-assembly-plugin&lt;/artifactId&gt;</span>
<span id="cb214-5"><a href="#cb214-5" aria-hidden="true"></a>      &lt;configuration&gt;</span>
<span id="cb214-6"><a href="#cb214-6" aria-hidden="true"></a>        &lt;archive&gt;</span>
<span id="cb214-7"><a href="#cb214-7" aria-hidden="true"></a>          &lt;manifest&gt;</span>
<span id="cb214-8"><a href="#cb214-8" aria-hidden="true"></a>            &lt;mainClass&gt;fully.<span class="fu">qualified</span>.<span class="fu">MainClass</span>&lt;/mainClass&gt;</span>
<span id="cb214-9"><a href="#cb214-9" aria-hidden="true"></a>          &lt;/manifest&gt;</span>
<span id="cb214-10"><a href="#cb214-10" aria-hidden="true"></a>        &lt;/archive&gt;</span>
<span id="cb214-11"><a href="#cb214-11" aria-hidden="true"></a>        &lt;descriptorRefs&gt;</span>
<span id="cb214-12"><a href="#cb214-12" aria-hidden="true"></a>          &lt;descriptorRef&gt;jar-with-dependencies&lt;/descriptorRef&gt;</span>
<span id="cb214-13"><a href="#cb214-13" aria-hidden="true"></a>        &lt;/descriptorRefs&gt;</span>
<span id="cb214-14"><a href="#cb214-14" aria-hidden="true"></a>      &lt;/configuration&gt;</span>
<span id="cb214-15"><a href="#cb214-15" aria-hidden="true"></a>    &lt;/plugin&gt;</span>
<span id="cb214-16"><a href="#cb214-16" aria-hidden="true"></a>  &lt;/plugins&gt;</span>
<span id="cb214-17"><a href="#cb214-17" aria-hidden="true"></a>&lt;/build&gt;</span></code></pre></div>
<p>and you run it with</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true"></a>mvn clean compile assembly:single</span></code></pre></div>
<p><em>Compile goal should be added before assembly:single or otherwise the code on your own project is not included.</em></p>
<p>See more details in comments.</p>
<hr>
<p>Commonly this goal is tied to a build phase to execute automatically. This ensures the JAR is built when executing <code>mvn install</code> or performing a deployment/release.</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true"></a>&lt;plugin&gt;</span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true"></a>  &lt;artifactId&gt;maven-assembly-plugin&lt;/artifactId&gt;</span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true"></a>  &lt;configuration&gt;</span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true"></a>    &lt;archive&gt;</span>
<span id="cb216-5"><a href="#cb216-5" aria-hidden="true"></a>      &lt;manifest&gt;</span>
<span id="cb216-6"><a href="#cb216-6" aria-hidden="true"></a>        &lt;mainClass&gt;fully.<span class="fu">qualified</span>.<span class="fu">MainClass</span>&lt;/mainClass&gt;</span>
<span id="cb216-7"><a href="#cb216-7" aria-hidden="true"></a>      &lt;/manifest&gt;</span>
<span id="cb216-8"><a href="#cb216-8" aria-hidden="true"></a>    &lt;/archive&gt;</span>
<span id="cb216-9"><a href="#cb216-9" aria-hidden="true"></a>    &lt;descriptorRefs&gt;</span>
<span id="cb216-10"><a href="#cb216-10" aria-hidden="true"></a>      &lt;descriptorRef&gt;jar-with-dependencies&lt;/descriptorRef&gt;</span>
<span id="cb216-11"><a href="#cb216-11" aria-hidden="true"></a>    &lt;/descriptorRefs&gt;</span>
<span id="cb216-12"><a href="#cb216-12" aria-hidden="true"></a>  &lt;/configuration&gt;</span>
<span id="cb216-13"><a href="#cb216-13" aria-hidden="true"></a>  &lt;executions&gt;</span>
<span id="cb216-14"><a href="#cb216-14" aria-hidden="true"></a>    &lt;execution&gt;</span>
<span id="cb216-15"><a href="#cb216-15" aria-hidden="true"></a>      &lt;id&gt;make-assembly&lt;/id&gt; &lt;!-- <span class="kw">this</span> is used <span class="kw">for</span> inheritance merges --&gt;</span>
<span id="cb216-16"><a href="#cb216-16" aria-hidden="true"></a>      &lt;phase&gt;<span class="kw">package</span>&lt;/phase&gt; &lt;!-- bind to the packaging phase --&gt;</span>
<span id="cb216-17"><a href="#cb216-17" aria-hidden="true"></a>      &lt;goals&gt;</span>
<span id="cb216-18"><a href="#cb216-18" aria-hidden="true"></a>        &lt;goal&gt;single&lt;/goal&gt;</span>
<span id="cb216-19"><a href="#cb216-19" aria-hidden="true"></a>      &lt;/goals&gt;</span>
<span id="cb216-20"><a href="#cb216-20" aria-hidden="true"></a>    &lt;/execution&gt;</span>
<span id="cb216-21"><a href="#cb216-21" aria-hidden="true"></a>  &lt;/executions&gt;</span>
<span id="cb216-22"><a href="#cb216-22" aria-hidden="true"></a>&lt;/plugin&gt;</span></code></pre></div>
</section>
<section id="answer-2-score-331" class="level4">
<h4>Answer 2 (score 331)</h4>
<p>You can use the dependency-plugin to generate all dependencies in a separate directory before the package phase and then include that in the classpath of the manifest:</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true"></a>&lt;plugin&gt;</span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true"></a>    &lt;groupId&gt;org.<span class="fu">apache</span>.<span class="fu">maven</span>.<span class="fu">plugins</span>&lt;/groupId&gt;</span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true"></a>    &lt;artifactId&gt;maven-dependency-plugin&lt;/artifactId&gt;</span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true"></a>    &lt;executions&gt;</span>
<span id="cb217-5"><a href="#cb217-5" aria-hidden="true"></a>        &lt;execution&gt;</span>
<span id="cb217-6"><a href="#cb217-6" aria-hidden="true"></a>            &lt;id&gt;copy-dependencies&lt;/id&gt;</span>
<span id="cb217-7"><a href="#cb217-7" aria-hidden="true"></a>            &lt;phase&gt;prepare-<span class="kw">package</span>&lt;/phase&gt;</span>
<span id="cb217-8"><a href="#cb217-8" aria-hidden="true"></a>            &lt;goals&gt;</span>
<span id="cb217-9"><a href="#cb217-9" aria-hidden="true"></a>                &lt;goal&gt;copy-dependencies&lt;/goal&gt;</span>
<span id="cb217-10"><a href="#cb217-10" aria-hidden="true"></a>            &lt;/goals&gt;</span>
<span id="cb217-11"><a href="#cb217-11" aria-hidden="true"></a>            &lt;configuration&gt;</span>
<span id="cb217-12"><a href="#cb217-12" aria-hidden="true"></a>                &lt;outputDirectory&gt;${project.<span class="fu">build</span>.<span class="fu">directory</span>}/lib&lt;/outputDirectory&gt;</span>
<span id="cb217-13"><a href="#cb217-13" aria-hidden="true"></a>                &lt;overWriteReleases&gt;<span class="kw">false</span>&lt;/overWriteReleases&gt;</span>
<span id="cb217-14"><a href="#cb217-14" aria-hidden="true"></a>                &lt;overWriteSnapshots&gt;<span class="kw">false</span>&lt;/overWriteSnapshots&gt;</span>
<span id="cb217-15"><a href="#cb217-15" aria-hidden="true"></a>                &lt;overWriteIfNewer&gt;<span class="kw">true</span>&lt;/overWriteIfNewer&gt;</span>
<span id="cb217-16"><a href="#cb217-16" aria-hidden="true"></a>            &lt;/configuration&gt;</span>
<span id="cb217-17"><a href="#cb217-17" aria-hidden="true"></a>        &lt;/execution&gt;</span>
<span id="cb217-18"><a href="#cb217-18" aria-hidden="true"></a>    &lt;/executions&gt;</span>
<span id="cb217-19"><a href="#cb217-19" aria-hidden="true"></a>&lt;/plugin&gt;</span>
<span id="cb217-20"><a href="#cb217-20" aria-hidden="true"></a>&lt;plugin&gt;</span>
<span id="cb217-21"><a href="#cb217-21" aria-hidden="true"></a>    &lt;groupId&gt;org.<span class="fu">apache</span>.<span class="fu">maven</span>.<span class="fu">plugins</span>&lt;/groupId&gt;</span>
<span id="cb217-22"><a href="#cb217-22" aria-hidden="true"></a>    &lt;artifactId&gt;maven-jar-plugin&lt;/artifactId&gt;</span>
<span id="cb217-23"><a href="#cb217-23" aria-hidden="true"></a>    &lt;configuration&gt;</span>
<span id="cb217-24"><a href="#cb217-24" aria-hidden="true"></a>        &lt;archive&gt;</span>
<span id="cb217-25"><a href="#cb217-25" aria-hidden="true"></a>            &lt;manifest&gt;</span>
<span id="cb217-26"><a href="#cb217-26" aria-hidden="true"></a>                &lt;addClasspath&gt;<span class="kw">true</span>&lt;/addClasspath&gt;</span>
<span id="cb217-27"><a href="#cb217-27" aria-hidden="true"></a>                &lt;classpathPrefix&gt;lib/&lt;/classpathPrefix&gt;</span>
<span id="cb217-28"><a href="#cb217-28" aria-hidden="true"></a>                &lt;mainClass&gt;theMainClass&lt;/mainClass&gt;</span>
<span id="cb217-29"><a href="#cb217-29" aria-hidden="true"></a>            &lt;/manifest&gt;</span>
<span id="cb217-30"><a href="#cb217-30" aria-hidden="true"></a>        &lt;/archive&gt;</span>
<span id="cb217-31"><a href="#cb217-31" aria-hidden="true"></a>    &lt;/configuration&gt;</span>
<span id="cb217-32"><a href="#cb217-32" aria-hidden="true"></a>&lt;/plugin&gt;</span></code></pre></div>
<p>Alternatively use <code>${project.build.directory}/classes/lib</code> as OutputDirectory to integrate all jar-files into the main jar, but then you will need to add custom classloading code to load the jars.</p>
</section>
<section id="answer-3-score-195" class="level4">
<h4>Answer 3 (score 195)</h4>
<p>I blogged about some different ways to do this.</p>
<p>See <a href="http://jinahya.wordpress.com/2014/05/22/executable-jar-with-apache-maven/" rel="noreferrer">Executable Jar with Apache Maven</a> (WordPress)</p>
<p>or <a href="https://github.com/jinahya/executable-jar-with-maven-example" rel="noreferrer">executable-jar-with-maven-example</a> (GitHub)</p>
<h5>
Notes
</h2>
<p>Those pros and cons are provided by <a href="https://stackoverflow.com/users/363573/stephan">Stephan</a>.</p>
<hr>
<h5>
For Manual Deployment
</h2>
<ul>
<li>
Pros
</li>
<li>
<p>Cons</p>
<ul>
<li>
Dependencies are out of the final jar.
</li>
</ul>
</li>
</ul>
<h5>
Copy Dependencies to a specific directory
</h3>
<div class="sourceCode" id="cb218"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true"></a>&lt;plugin&gt;</span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true"></a>  &lt;groupId&gt;org.<span class="fu">apache</span>.<span class="fu">maven</span>.<span class="fu">plugins</span>&lt;/groupId&gt;</span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true"></a>  &lt;artifactId&gt;maven-dependency-plugin&lt;/artifactId&gt;</span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true"></a>  &lt;executions&gt;</span>
<span id="cb218-5"><a href="#cb218-5" aria-hidden="true"></a>    &lt;execution&gt;</span>
<span id="cb218-6"><a href="#cb218-6" aria-hidden="true"></a>      &lt;id&gt;copy-dependencies&lt;/id&gt;</span>
<span id="cb218-7"><a href="#cb218-7" aria-hidden="true"></a>      &lt;phase&gt;prepare-<span class="kw">package</span>&lt;/phase&gt;</span>
<span id="cb218-8"><a href="#cb218-8" aria-hidden="true"></a>      &lt;goals&gt;</span>
<span id="cb218-9"><a href="#cb218-9" aria-hidden="true"></a>        &lt;goal&gt;copy-dependencies&lt;/goal&gt;</span>
<span id="cb218-10"><a href="#cb218-10" aria-hidden="true"></a>      &lt;/goals&gt;</span>
<span id="cb218-11"><a href="#cb218-11" aria-hidden="true"></a>      &lt;configuration&gt;</span>
<span id="cb218-12"><a href="#cb218-12" aria-hidden="true"></a>        &lt;outputDirectory&gt;${project.<span class="fu">build</span>.<span class="fu">directory</span>}/${project.<span class="fu">build</span>.<span class="fu">finalName</span>}.<span class="fu">lib</span>&lt;/outputDirectory&gt;</span>
<span id="cb218-13"><a href="#cb218-13" aria-hidden="true"></a>      &lt;/configuration&gt;</span>
<span id="cb218-14"><a href="#cb218-14" aria-hidden="true"></a>    &lt;/execution&gt;</span>
<span id="cb218-15"><a href="#cb218-15" aria-hidden="true"></a>  &lt;/executions&gt;</span>
<span id="cb218-16"><a href="#cb218-16" aria-hidden="true"></a>&lt;/plugin&gt;</span></code></pre></div>
<h5>
Make the Jar Executable and Classpath Aware
</h3>
<div class="sourceCode" id="cb219"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true"></a>&lt;plugin&gt;</span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true"></a>  &lt;groupId&gt;org.<span class="fu">apache</span>.<span class="fu">maven</span>.<span class="fu">plugins</span>&lt;/groupId&gt;</span>
<span id="cb219-3"><a href="#cb219-3" aria-hidden="true"></a>  &lt;artifactId&gt;maven-jar-plugin&lt;/artifactId&gt;</span>
<span id="cb219-4"><a href="#cb219-4" aria-hidden="true"></a>  &lt;configuration&gt;</span>
<span id="cb219-5"><a href="#cb219-5" aria-hidden="true"></a>    &lt;archive&gt;</span>
<span id="cb219-6"><a href="#cb219-6" aria-hidden="true"></a>      &lt;manifest&gt;</span>
<span id="cb219-7"><a href="#cb219-7" aria-hidden="true"></a>        &lt;addClasspath&gt;<span class="kw">true</span>&lt;/addClasspath&gt;</span>
<span id="cb219-8"><a href="#cb219-8" aria-hidden="true"></a>        &lt;classpathPrefix&gt;${project.<span class="fu">build</span>.<span class="fu">finalName</span>}.<span class="fu">lib</span>/&lt;/classpathPrefix&gt;</span>
<span id="cb219-9"><a href="#cb219-9" aria-hidden="true"></a>        &lt;mainClass&gt;${fully.<span class="fu">qualified</span>.<span class="fu">main</span>.<span class="fu">class</span>}&lt;/mainClass&gt;</span>
<span id="cb219-10"><a href="#cb219-10" aria-hidden="true"></a>      &lt;/manifest&gt;</span>
<span id="cb219-11"><a href="#cb219-11" aria-hidden="true"></a>    &lt;/archive&gt;</span>
<span id="cb219-12"><a href="#cb219-12" aria-hidden="true"></a>  &lt;/configuration&gt;</span>
<span id="cb219-13"><a href="#cb219-13" aria-hidden="true"></a>&lt;/plugin&gt;</span></code></pre></div>
<p>At this point the <code>jar</code> is actually executable with external classpath elements.</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true"></a>$ java -jar target/${project.<span class="fu">build</span>.<span class="fu">finalName</span>}.<span class="fu">jar</span></span></code></pre></div>
<h5>
Make Deployable Archives
</h3>
<p>
<p>The <code>jar</code> file is only executable with the sibling <code>...lib/</code> directory. We need to make archives to deploy with the directory and its content.</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true"></a>&lt;plugin&gt;</span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true"></a>  &lt;groupId&gt;org.<span class="fu">apache</span>.<span class="fu">maven</span>.<span class="fu">plugins</span>&lt;/groupId&gt;</span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true"></a>  &lt;artifactId&gt;maven-antrun-plugin&lt;/artifactId&gt;</span>
<span id="cb221-4"><a href="#cb221-4" aria-hidden="true"></a>  &lt;executions&gt;</span>
<span id="cb221-5"><a href="#cb221-5" aria-hidden="true"></a>    &lt;execution&gt;</span>
<span id="cb221-6"><a href="#cb221-6" aria-hidden="true"></a>      &lt;id&gt;antrun-archive&lt;/id&gt;</span>
<span id="cb221-7"><a href="#cb221-7" aria-hidden="true"></a>      &lt;phase&gt;<span class="kw">package</span>&lt;/phase&gt;</span>
<span id="cb221-8"><a href="#cb221-8" aria-hidden="true"></a>      &lt;goals&gt;</span>
<span id="cb221-9"><a href="#cb221-9" aria-hidden="true"></a>        &lt;goal&gt;run&lt;/goal&gt;</span>
<span id="cb221-10"><a href="#cb221-10" aria-hidden="true"></a>      &lt;/goals&gt;</span>
<span id="cb221-11"><a href="#cb221-11" aria-hidden="true"></a>      &lt;configuration&gt;</span>
<span id="cb221-12"><a href="#cb221-12" aria-hidden="true"></a>        &lt;target&gt;</span>
<span id="cb221-13"><a href="#cb221-13" aria-hidden="true"></a>          &lt;property name=<span class="st">&quot;final.name&quot;</span> value=<span class="st">&quot;${project.build.directory}/${project.build.finalName}&quot;</span>/&gt;</span>
<span id="cb221-14"><a href="#cb221-14" aria-hidden="true"></a>          &lt;property name=<span class="st">&quot;archive.includes&quot;</span> value=<span class="st">&quot;${project.build.finalName}.${project.packaging} ${project.build.finalName}.lib/*&quot;</span>/&gt;</span>
<span id="cb221-15"><a href="#cb221-15" aria-hidden="true"></a>          &lt;property name=<span class="st">&quot;tar.destfile&quot;</span> value=<span class="st">&quot;${final.name}.tar&quot;</span>/&gt;</span>
<span id="cb221-16"><a href="#cb221-16" aria-hidden="true"></a>          &lt;zip basedir=<span class="st">&quot;${project.build.directory}&quot;</span> destfile=<span class="st">&quot;${final.name}.zip&quot;</span> includes=<span class="st">&quot;${archive.includes}&quot;</span> /&gt;</span>
<span id="cb221-17"><a href="#cb221-17" aria-hidden="true"></a>          &lt;tar basedir=<span class="st">&quot;${project.build.directory}&quot;</span> destfile=<span class="st">&quot;${tar.destfile}&quot;</span> includes=<span class="st">&quot;${archive.includes}&quot;</span> /&gt;</span>
<span id="cb221-18"><a href="#cb221-18" aria-hidden="true"></a>          &lt;gzip src=<span class="st">&quot;${tar.destfile}&quot;</span> destfile=<span class="st">&quot;${tar.destfile}.gz&quot;</span> /&gt;</span>
<span id="cb221-19"><a href="#cb221-19" aria-hidden="true"></a>          &lt;bzip2 src=<span class="st">&quot;${tar.destfile}&quot;</span> destfile=<span class="st">&quot;${tar.destfile}.bz2&quot;</span> /&gt;</span>
<span id="cb221-20"><a href="#cb221-20" aria-hidden="true"></a>        &lt;/target&gt;</span>
<span id="cb221-21"><a href="#cb221-21" aria-hidden="true"></a>      &lt;/configuration&gt;</span>
<span id="cb221-22"><a href="#cb221-22" aria-hidden="true"></a>    &lt;/execution&gt;</span>
<span id="cb221-23"><a href="#cb221-23" aria-hidden="true"></a>  &lt;/executions&gt;</span>
<span id="cb221-24"><a href="#cb221-24" aria-hidden="true"></a>&lt;/plugin&gt;</span></code></pre></div>
<p>Now you have <code>target/${project.build.finalName}.(zip|tar|tar.bz2|tar.gz)</code> which each contains the <code>jar</code> and <code>lib/*</code>.</p>
<hr>
<h5>
Apache Maven Assembly Plugin
</h2>
<ul>
<li>
Pros
</li>
<li>
<p>Cons</p>
<ul>
<li>
No class relocation support (use maven-shade-plugin if class relocation is needed).
</li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb222"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true"></a>&lt;plugin&gt;</span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true"></a>  &lt;groupId&gt;org.<span class="fu">apache</span>.<span class="fu">maven</span>.<span class="fu">plugins</span>&lt;/groupId&gt;</span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true"></a>  &lt;artifactId&gt;maven-assembly-plugin&lt;/artifactId&gt;</span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true"></a>  &lt;executions&gt;</span>
<span id="cb222-5"><a href="#cb222-5" aria-hidden="true"></a>    &lt;execution&gt;</span>
<span id="cb222-6"><a href="#cb222-6" aria-hidden="true"></a>      &lt;phase&gt;<span class="kw">package</span>&lt;/phase&gt;</span>
<span id="cb222-7"><a href="#cb222-7" aria-hidden="true"></a>      &lt;goals&gt;</span>
<span id="cb222-8"><a href="#cb222-8" aria-hidden="true"></a>        &lt;goal&gt;single&lt;/goal&gt;</span>
<span id="cb222-9"><a href="#cb222-9" aria-hidden="true"></a>      &lt;/goals&gt;</span>
<span id="cb222-10"><a href="#cb222-10" aria-hidden="true"></a>      &lt;configuration&gt;</span>
<span id="cb222-11"><a href="#cb222-11" aria-hidden="true"></a>        &lt;archive&gt;</span>
<span id="cb222-12"><a href="#cb222-12" aria-hidden="true"></a>          &lt;manifest&gt;</span>
<span id="cb222-13"><a href="#cb222-13" aria-hidden="true"></a>            &lt;mainClass&gt;${fully.<span class="fu">qualified</span>.<span class="fu">main</span>.<span class="fu">class</span>}&lt;/mainClass&gt;</span>
<span id="cb222-14"><a href="#cb222-14" aria-hidden="true"></a>          &lt;/manifest&gt;</span>
<span id="cb222-15"><a href="#cb222-15" aria-hidden="true"></a>        &lt;/archive&gt;</span>
<span id="cb222-16"><a href="#cb222-16" aria-hidden="true"></a>        &lt;descriptorRefs&gt;</span>
<span id="cb222-17"><a href="#cb222-17" aria-hidden="true"></a>          &lt;descriptorRef&gt;jar-with-dependencies&lt;/descriptorRef&gt;</span>
<span id="cb222-18"><a href="#cb222-18" aria-hidden="true"></a>        &lt;/descriptorRefs&gt;</span>
<span id="cb222-19"><a href="#cb222-19" aria-hidden="true"></a>      &lt;/configuration&gt;</span>
<span id="cb222-20"><a href="#cb222-20" aria-hidden="true"></a>    &lt;/execution&gt;</span>
<span id="cb222-21"><a href="#cb222-21" aria-hidden="true"></a>  &lt;/executions&gt;</span>
<span id="cb222-22"><a href="#cb222-22" aria-hidden="true"></a>&lt;/plugin&gt;</span></code></pre></div>
<p>You have <code>target/${project.bulid.finalName}-jar-with-dependencies.jar</code>.</p>
<hr>
<h5>
Apache Maven Shade Plugin
</h2>
<ul>
<li>
Pros
</li>
<li>
Cons
</li>
</ul>
<div class="sourceCode" id="cb223"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true"></a>&lt;plugin&gt;</span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true"></a>  &lt;groupId&gt;org.<span class="fu">apache</span>.<span class="fu">maven</span>.<span class="fu">plugins</span>&lt;/groupId&gt;</span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true"></a>  &lt;artifactId&gt;maven-shade-plugin&lt;/artifactId&gt;</span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true"></a>  &lt;executions&gt;</span>
<span id="cb223-5"><a href="#cb223-5" aria-hidden="true"></a>    &lt;execution&gt;</span>
<span id="cb223-6"><a href="#cb223-6" aria-hidden="true"></a>      &lt;goals&gt;</span>
<span id="cb223-7"><a href="#cb223-7" aria-hidden="true"></a>        &lt;goal&gt;shade&lt;/goal&gt;</span>
<span id="cb223-8"><a href="#cb223-8" aria-hidden="true"></a>      &lt;/goals&gt;</span>
<span id="cb223-9"><a href="#cb223-9" aria-hidden="true"></a>      &lt;configuration&gt;</span>
<span id="cb223-10"><a href="#cb223-10" aria-hidden="true"></a>        &lt;shadedArtifactAttached&gt;<span class="kw">true</span>&lt;/shadedArtifactAttached&gt;</span>
<span id="cb223-11"><a href="#cb223-11" aria-hidden="true"></a>        &lt;transformers&gt;</span>
<span id="cb223-12"><a href="#cb223-12" aria-hidden="true"></a>          &lt;transformer implementation=<span class="st">&quot;org.apache.maven.plugins.shade.resource.ManifestResourceTransformer&quot;</span>&gt;</span>
<span id="cb223-13"><a href="#cb223-13" aria-hidden="true"></a>            &lt;mainClass&gt;${fully.<span class="fu">qualified</span>.<span class="fu">main</span>.<span class="fu">class</span>}&lt;/mainClass&gt;</span>
<span id="cb223-14"><a href="#cb223-14" aria-hidden="true"></a>          &lt;/transformer&gt;</span>
<span id="cb223-15"><a href="#cb223-15" aria-hidden="true"></a>        &lt;/transformers&gt;</span>
<span id="cb223-16"><a href="#cb223-16" aria-hidden="true"></a>      &lt;/configuration&gt;</span>
<span id="cb223-17"><a href="#cb223-17" aria-hidden="true"></a>    &lt;/execution&gt;</span>
<span id="cb223-18"><a href="#cb223-18" aria-hidden="true"></a>  &lt;/executions&gt;</span>
<span id="cb223-19"><a href="#cb223-19" aria-hidden="true"></a>&lt;/plugin&gt;</span></code></pre></div>
<p>You have <code>target/${project.build.finalName}-shaded.jar</code>.</p>
<hr>
<h5>
onejar-maven-plugin
</h2>
<ul>
<li>
Pros
</li>
<li>
<p>Cons</p>
<ul>
<li>
Not actively supported since 2012.
</li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb224"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true"></a>&lt;plugin&gt;</span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true"></a>  &lt;!--groupId&gt;org.<span class="fu">dstovall</span>&lt;/groupId--&gt; &lt;!-- not available on the central --&gt;</span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true"></a>  &lt;groupId&gt;com.<span class="fu">jolira</span>&lt;/groupId&gt;</span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true"></a>  &lt;artifactId&gt;onejar-maven-plugin&lt;/artifactId&gt;</span>
<span id="cb224-5"><a href="#cb224-5" aria-hidden="true"></a>  &lt;executions&gt;</span>
<span id="cb224-6"><a href="#cb224-6" aria-hidden="true"></a>    &lt;execution&gt;</span>
<span id="cb224-7"><a href="#cb224-7" aria-hidden="true"></a>      &lt;configuration&gt;</span>
<span id="cb224-8"><a href="#cb224-8" aria-hidden="true"></a>        &lt;mainClass&gt;${fully.<span class="fu">qualified</span>.<span class="fu">main</span>.<span class="fu">class</span>}&lt;/mainClass&gt;</span>
<span id="cb224-9"><a href="#cb224-9" aria-hidden="true"></a>        &lt;attachToBuild&gt;<span class="kw">true</span>&lt;/attachToBuild&gt;</span>
<span id="cb224-10"><a href="#cb224-10" aria-hidden="true"></a>        &lt;!-- https:<span class="co">//code.google.com/p/onejar-maven-plugin/issues/detail?id=8 --&gt;</span></span>
<span id="cb224-11"><a href="#cb224-11" aria-hidden="true"></a>        &lt;!--classifier&gt;onejar&lt;/classifier--&gt;</span>
<span id="cb224-12"><a href="#cb224-12" aria-hidden="true"></a>        &lt;filename&gt;${project.<span class="fu">build</span>.<span class="fu">finalName</span>}-onejar.${project.<span class="fu">packaging</span>}&lt;/filename&gt;</span>
<span id="cb224-13"><a href="#cb224-13" aria-hidden="true"></a>      &lt;/configuration&gt;</span>
<span id="cb224-14"><a href="#cb224-14" aria-hidden="true"></a>      &lt;goals&gt;</span>
<span id="cb224-15"><a href="#cb224-15" aria-hidden="true"></a>        &lt;goal&gt;one-jar&lt;/goal&gt;</span>
<span id="cb224-16"><a href="#cb224-16" aria-hidden="true"></a>      &lt;/goals&gt;</span>
<span id="cb224-17"><a href="#cb224-17" aria-hidden="true"></a>    &lt;/execution&gt;</span>
<span id="cb224-18"><a href="#cb224-18" aria-hidden="true"></a>  &lt;/executions&gt;</span>
<span id="cb224-19"><a href="#cb224-19" aria-hidden="true"></a>&lt;/plugin&gt;</span></code></pre></div>
<hr>
<h5>
Spring Boot Maven Plugin
</h2>
<ul>
<li>
Pros
</li>
<li>
<p>Cons</p>
<ul>
<li>
Add potential unecessary Spring and Spring Boot related classes.
</li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb225"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true"></a>&lt;plugin&gt;</span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true"></a>  &lt;groupId&gt;org.<span class="fu">springframework</span>.<span class="fu">boot</span>&lt;/groupId&gt;</span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true"></a>  &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;</span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true"></a>  &lt;executions&gt;</span>
<span id="cb225-5"><a href="#cb225-5" aria-hidden="true"></a>    &lt;execution&gt;</span>
<span id="cb225-6"><a href="#cb225-6" aria-hidden="true"></a>      &lt;goals&gt;</span>
<span id="cb225-7"><a href="#cb225-7" aria-hidden="true"></a>        &lt;goal&gt;repackage&lt;/goal&gt;</span>
<span id="cb225-8"><a href="#cb225-8" aria-hidden="true"></a>      &lt;/goals&gt;</span>
<span id="cb225-9"><a href="#cb225-9" aria-hidden="true"></a>      &lt;configuration&gt;</span>
<span id="cb225-10"><a href="#cb225-10" aria-hidden="true"></a>        &lt;classifier&gt;spring-boot&lt;/classifier&gt;</span>
<span id="cb225-11"><a href="#cb225-11" aria-hidden="true"></a>        &lt;mainClass&gt;${fully.<span class="fu">qualified</span>.<span class="fu">main</span>.<span class="fu">class</span>}&lt;/mainClass&gt;</span>
<span id="cb225-12"><a href="#cb225-12" aria-hidden="true"></a>      &lt;/configuration&gt;</span>
<span id="cb225-13"><a href="#cb225-13" aria-hidden="true"></a>    &lt;/execution&gt;</span>
<span id="cb225-14"><a href="#cb225-14" aria-hidden="true"></a>  &lt;/executions&gt;</span>
<span id="cb225-15"><a href="#cb225-15" aria-hidden="true"></a>&lt;/plugin&gt;</span></code></pre></div>
<p>You have <code>target/${project.bulid.finalName}-spring-boot.jar</code>.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-do-you-assert-that-a-certain-exception-is-thrown-in-junit-4-tests-score-1186587-in-2013" class="level3">
<h3>26: How do you assert that a certain exception is thrown in JUnit 4 tests? (score <a href="https://stackoverflow.com/q/156503.html">1186587</a> in 2013)</h3>
<section id="question-25" class="level4">
<h4>Question</h4>
<p>How can I use JUnit4 idiomatically to test that some code throws an exception?</p>
<p>While I can certainly do something like this:</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true"></a><span class="at">@Test</span></span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true"></a><span class="kw">public</span> <span class="dt">void</span> <span class="fu">testFooThrowsIndexOutOfBoundsException</span>() {</span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true"></a>  <span class="dt">boolean</span> thrown = <span class="kw">false</span>;</span>
<span id="cb226-4"><a href="#cb226-4" aria-hidden="true"></a></span>
<span id="cb226-5"><a href="#cb226-5" aria-hidden="true"></a>  <span class="kw">try</span> {</span>
<span id="cb226-6"><a href="#cb226-6" aria-hidden="true"></a>    foo.<span class="fu">doStuff</span>();</span>
<span id="cb226-7"><a href="#cb226-7" aria-hidden="true"></a>  } <span class="kw">catch</span> (<span class="bu">IndexOutOfBoundsException</span> e) {</span>
<span id="cb226-8"><a href="#cb226-8" aria-hidden="true"></a>    thrown = <span class="kw">true</span>;</span>
<span id="cb226-9"><a href="#cb226-9" aria-hidden="true"></a>  }</span>
<span id="cb226-10"><a href="#cb226-10" aria-hidden="true"></a></span>
<span id="cb226-11"><a href="#cb226-11" aria-hidden="true"></a>  <span class="fu">assertTrue</span>(thrown);</span>
<span id="cb226-12"><a href="#cb226-12" aria-hidden="true"></a>}</span></code></pre></div>
<p>I recall that there is an annotation or an Assert.xyz or <em>something</em> that is far less kludgy and far more in-the-spirit of JUnit for these sorts of situations.</p>
</section>
<section id="answer-accepted-score-2269" class="level4">
<h4>Answer accepted (score 2269)</h4>
<p><code>JUnit 4</code> has support for this:</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true"></a><span class="at">@Test</span>(expected = <span class="bu">IndexOutOfBoundsException</span>.<span class="fu">class</span>)</span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true"></a><span class="kw">public</span> <span class="dt">void</span> <span class="fu">testIndexOutOfBoundsException</span>() {</span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true"></a></span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true"></a>    <span class="bu">ArrayList</span> emptyList = <span class="kw">new</span> <span class="bu">ArrayList</span>();</span>
<span id="cb227-5"><a href="#cb227-5" aria-hidden="true"></a>    <span class="bu">Object</span> o = emptyList.<span class="fu">get</span>(<span class="dv">0</span>);</span>
<span id="cb227-6"><a href="#cb227-6" aria-hidden="true"></a></span>
<span id="cb227-7"><a href="#cb227-7" aria-hidden="true"></a>}</span></code></pre></div>
<p>Reference :</p>
<ul>
<li>
<a href="https://junit.org/junit4/faq.html
#atests_7" rel="noreferrer">JUnit Test-FAQ</a>
</li>
</ul>
</section>
<section id="answer-2-score-1271" class="level4">
<h4>Answer 2 (score 1271)</h4>
<p><strong>Edit</strong> Now that JUnit5 has released, the best option would be to use <code>Assertions.assertThrows()</code> (see <a href="https://stackoverflow.com/a/46514550/95725">my other answer</a>).</p>
<p>If you haven’t migrated to JUnit 5, but can use JUnit 4.7, you can use the <a href="http://junit.org/javadoc/latest/org/junit/rules/ExpectedException.html" rel="noreferrer"><code>ExpectedException</code></a> Rule:</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">class</span> FooTest {</span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true"></a>  <span class="at">@Rule</span></span>
<span id="cb228-3"><a href="#cb228-3" aria-hidden="true"></a>  <span class="kw">public</span> <span class="dt">final</span> ExpectedException exception = ExpectedException.<span class="fu">none</span>();</span>
<span id="cb228-4"><a href="#cb228-4" aria-hidden="true"></a></span>
<span id="cb228-5"><a href="#cb228-5" aria-hidden="true"></a>  <span class="at">@Test</span></span>
<span id="cb228-6"><a href="#cb228-6" aria-hidden="true"></a>  <span class="kw">public</span> <span class="dt">void</span> <span class="fu">doStuffThrowsIndexOutOfBoundsException</span>() {</span>
<span id="cb228-7"><a href="#cb228-7" aria-hidden="true"></a>    Foo foo = <span class="kw">new</span> <span class="fu">Foo</span>();</span>
<span id="cb228-8"><a href="#cb228-8" aria-hidden="true"></a></span>
<span id="cb228-9"><a href="#cb228-9" aria-hidden="true"></a>    exception.<span class="fu">expect</span>(<span class="bu">IndexOutOfBoundsException</span>.<span class="fu">class</span>);</span>
<span id="cb228-10"><a href="#cb228-10" aria-hidden="true"></a>    foo.<span class="fu">doStuff</span>();</span>
<span id="cb228-11"><a href="#cb228-11" aria-hidden="true"></a>  }</span>
<span id="cb228-12"><a href="#cb228-12" aria-hidden="true"></a>}</span></code></pre></div>
<p>This is much better than <code>@Test(expected=IndexOutOfBoundsException.class)</code> because the test will fail if <code>IndexOutOfBoundsException</code> is thrown before <code>foo.doStuff()</code></p>
<p>See <a href="http://www.infoq.com/news/2009/07/junit-4.7-rules" rel="noreferrer">this article</a> for details</p>
</section>
<section id="answer-3-score-458" class="level4">
<h4>Answer 3 (score 458)</h4>
<p>Be careful using expected exception, because it only asserts that the <strong>method</strong> threw that exception, not a <strong>particular line of code</strong> in the test.</p>
<p>I tend to use this for testing parameter validation, because such methods are usually very simple, but more complex tests might better be served with:</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true"></a><span class="kw">try</span> {</span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true"></a>    <span class="fu">methodThatShouldThrow</span>();</span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true"></a>    <span class="fu">fail</span>( <span class="st">&quot;My method didn&#39;t throw when I expected it to&quot;</span> );</span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true"></a>} <span class="kw">catch</span> (MyException expectedException) {</span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true"></a>}</span></code></pre></div>
<p>Apply judgement.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="avoiding-null-statements-score-1182090-in-2018" class="level3">
<h3>27: Avoiding != null statements (score <a href="https://stackoverflow.com/q/271526.html">1182090</a> in 2018)</h3>
<section id="question-26" class="level4">
<h4>Question</h4>
<p>I use <code>object != null</code> a lot to avoid <a href="https://docs.oracle.com/javase/9/docs/api/java/lang/NullPointerException.html" rel="noreferrer"><code>NullPointerException</code></a>.</p>
<p>Is there a good alternative to this?</p>
<p>For example:</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true"></a><span class="kw">if</span> (someobject != <span class="kw">null</span>) {</span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true"></a>    someobject.<span class="fu">doCalc</span>();</span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true"></a>}</span></code></pre></div>
<p>This avoids a <code>NullPointerException</code>, when it is unknown if the object is <code>null</code> or not.</p>
<p>Note that the accepted answer may be out of date, see <a href="https://stackoverflow.com/a/2386013/12943">https://stackoverflow.com/a/2386013/12943</a> for a more recent approach.</p>
</section>
<section id="answer-accepted-score-2570" class="level4">
<h4>Answer accepted (score 2570)</h4>
<p>This to me sounds like a reasonably common problem that junior to intermediate developers tend to face at some point: they either don’t know or don’t trust the contracts they are participating in and defensively overcheck for nulls. Additionally, when writing their own code, they tend to rely on returning nulls to indicate something thus requiring the caller to check for nulls.</p>
<p>To put this another way, there are two instances where null checking comes up:</p>
<ol>
<li>
<p>
Where null is a valid response in terms of the contract; and
</p>
</li>
<li>
<p>
Where it isn’t a valid response.
</p>
</li>
</ol>
<ol start="2" type="1">
<li>is easy. Either use <code>assert</code> statements (assertions) or allow failure (for example, <a href="http://docs.oracle.com/javase/6/docs/api/index.html?java/lang/NullPointerException.html" rel="noreferrer">NullPointerException</a>). Assertions are a highly-underused Java feature that was added in 1.4. The syntax is:</li>
</ol>
<div class="sourceCode" id="cb231"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true"></a>assert &lt;condition&gt;</span></code></pre></div>
<p>or</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true"></a>assert &lt;condition&gt; : &lt;object&gt;</span></code></pre></div>
<p>where <code>&amp;lt;condition&amp;gt;</code> is a boolean expression and <code>&amp;lt;object&amp;gt;</code> is an object whose <code>toString()</code> method’s output will be included in the error.</p>
<p>An <code>assert</code> statement throws an <code>Error</code> (<code>AssertionError</code>) if the condition is not true. By default, Java ignores assertions. You can enable assertions by passing the option <code>-ea</code> to the JVM. You can enable and disable assertions for individual classes and packages. This means that you can validate code with the assertions while developing and testing, and disable them in a production environment, although my testing has shown next to no performance impact from assertions.</p>
<p>Not using assertions in this case is OK because the code will just fail, which is what will happen if you use assertions. The only difference is that with assertions it might happen sooner, in a more-meaningful way and possibly with extra information, which may help you to figure out why it happened if you weren’t expecting it.</p>
<ol type="1">
<li>is a little harder. If you have no control over the code you’re calling then you’re stuck. If null is a valid response, you have to check for it.</li>
</ol>
<p>If it’s code that you do control, however (and this is often the case), then it’s a different story. Avoid using nulls as a response. With methods that return collections, it’s easy: return empty collections (or arrays) instead of nulls pretty much all the time.</p>
<p>With non-collections it might be harder. Consider this as an example: if you have these interfaces:</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">interface</span> <span class="bu">Action</span> {</span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true"></a>  <span class="dt">void</span> <span class="fu">doSomething</span>();</span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true"></a>}</span>
<span id="cb233-4"><a href="#cb233-4" aria-hidden="true"></a></span>
<span id="cb233-5"><a href="#cb233-5" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">interface</span> <span class="bu">Parser</span> {</span>
<span id="cb233-6"><a href="#cb233-6" aria-hidden="true"></a>  <span class="bu">Action</span> <span class="fu">findAction</span>(<span class="bu">String</span> userInput);</span>
<span id="cb233-7"><a href="#cb233-7" aria-hidden="true"></a>}</span></code></pre></div>
<p>where Parser takes raw user input and finds something to do, perhaps if you’re implementing a command line interface for something. Now you might make the contract that it returns null if there’s no appropriate action. That leads the null checking you’re talking about.</p>
<p>An alternative solution is to never return null and instead use the <a href="https://en.wikipedia.org/wiki/Null_Object_pattern" rel="noreferrer">Null Object pattern</a>:</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">class</span> MyParser <span class="kw">implements</span> <span class="bu">Parser</span> {</span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true"></a>  <span class="kw">private</span> <span class="dt">static</span> <span class="bu">Action</span> DO_NOTHING = <span class="kw">new</span> <span class="bu">Action</span>() {</span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">void</span> <span class="fu">doSomething</span>() { <span class="co">/* do nothing */</span> }</span>
<span id="cb234-4"><a href="#cb234-4" aria-hidden="true"></a>  };</span>
<span id="cb234-5"><a href="#cb234-5" aria-hidden="true"></a></span>
<span id="cb234-6"><a href="#cb234-6" aria-hidden="true"></a>  <span class="kw">public</span> <span class="bu">Action</span> <span class="fu">findAction</span>(<span class="bu">String</span> userInput) {</span>
<span id="cb234-7"><a href="#cb234-7" aria-hidden="true"></a>    <span class="co">// ...</span></span>
<span id="cb234-8"><a href="#cb234-8" aria-hidden="true"></a>    <span class="kw">if</span> ( <span class="co">/* we can&#39;t find any actions */</span> ) {</span>
<span id="cb234-9"><a href="#cb234-9" aria-hidden="true"></a>      <span class="kw">return</span> DO_NOTHING;</span>
<span id="cb234-10"><a href="#cb234-10" aria-hidden="true"></a>    }</span>
<span id="cb234-11"><a href="#cb234-11" aria-hidden="true"></a>  }</span>
<span id="cb234-12"><a href="#cb234-12" aria-hidden="true"></a>}</span></code></pre></div>
<p>Compare:</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true"></a><span class="bu">Parser</span> parser = <span class="bu">ParserFactory</span>.<span class="fu">getParser</span>();</span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true"></a><span class="kw">if</span> (parser == <span class="kw">null</span>) {</span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true"></a>  <span class="co">// now what?</span></span>
<span id="cb235-4"><a href="#cb235-4" aria-hidden="true"></a>  <span class="co">// this would be an example of where null isn&#39;t (or shouldn&#39;t be) a valid response</span></span>
<span id="cb235-5"><a href="#cb235-5" aria-hidden="true"></a>}</span>
<span id="cb235-6"><a href="#cb235-6" aria-hidden="true"></a><span class="bu">Action</span> action = parser.<span class="fu">findAction</span>(someInput);</span>
<span id="cb235-7"><a href="#cb235-7" aria-hidden="true"></a><span class="kw">if</span> (action == <span class="kw">null</span>) {</span>
<span id="cb235-8"><a href="#cb235-8" aria-hidden="true"></a>  <span class="co">// do nothing</span></span>
<span id="cb235-9"><a href="#cb235-9" aria-hidden="true"></a>} <span class="kw">else</span> {</span>
<span id="cb235-10"><a href="#cb235-10" aria-hidden="true"></a>  action.<span class="fu">doSomething</span>();</span>
<span id="cb235-11"><a href="#cb235-11" aria-hidden="true"></a>}</span></code></pre></div>
<p>to</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true"></a><span class="bu">ParserFactory</span>.<span class="fu">getParser</span>().<span class="fu">findAction</span>(someInput).<span class="fu">doSomething</span>();</span></code></pre></div>
<p>which is a much better design because it leads to more concise code.</p>
<p>That said, perhaps it is entirely appropriate for the findAction() method to throw an Exception with a meaningful error message – especially in this case where you are relying on user input. It would be much better for the findAction method to throw an Exception than for the calling method to blow up with a simple NullPointerException with no explanation.</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true"></a><span class="kw">try</span> {</span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true"></a>    <span class="bu">ParserFactory</span>.<span class="fu">getParser</span>().<span class="fu">findAction</span>(someInput).<span class="fu">doSomething</span>();</span>
<span id="cb237-3"><a href="#cb237-3" aria-hidden="true"></a>} <span class="kw">catch</span>(ActionNotFoundException anfe) {</span>
<span id="cb237-4"><a href="#cb237-4" aria-hidden="true"></a>    userConsole.<span class="fu">err</span>(anfe.<span class="fu">getMessage</span>());</span>
<span id="cb237-5"><a href="#cb237-5" aria-hidden="true"></a>}</span></code></pre></div>
<p>Or if you think the try/catch mechanism is too ugly, rather than Do Nothing your default action should provide feedback to the user.</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true"></a><span class="kw">public</span> <span class="bu">Action</span> <span class="fu">findAction</span>(<span class="dt">final</span> <span class="bu">String</span> userInput) {</span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true"></a>    <span class="co">/* Code to return requested Action if found */</span></span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true"></a>    <span class="kw">return</span> <span class="kw">new</span> <span class="bu">Action</span>() {</span>
<span id="cb238-4"><a href="#cb238-4" aria-hidden="true"></a>        <span class="kw">public</span> <span class="dt">void</span> <span class="fu">doSomething</span>() {</span>
<span id="cb238-5"><a href="#cb238-5" aria-hidden="true"></a>            userConsole.<span class="fu">err</span>(<span class="st">&quot;Action not found: &quot;</span> + userInput);</span>
<span id="cb238-6"><a href="#cb238-6" aria-hidden="true"></a>        }</span>
<span id="cb238-7"><a href="#cb238-7" aria-hidden="true"></a>    }</span>
<span id="cb238-8"><a href="#cb238-8" aria-hidden="true"></a>}</span></code></pre></div>
</section>
<section id="answer-2-score-595" class="level4">
<h4>Answer 2 (score 595)</h4>
<p>If you use (or planning to use) a Java IDE like <a href="https://www.jetbrains.com/idea/" rel="noreferrer">JetBrains IntelliJ IDEA</a>, <a href="https://www.eclipse.org/" rel="noreferrer">Eclipse</a> or <a href="https://netbeans.org/" rel="noreferrer">Netbeans</a> or a tool like findbugs then you can use annotations to solve this problem.</p>
<p>Basically, you’ve got <code>@Nullable</code> and <code>@NotNull</code>.</p>
<p>You can use in method and parameters, like this:</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true"></a><span class="at">@NotNull</span> <span class="kw">public</span> <span class="dt">static</span> <span class="bu">String</span> <span class="fu">helloWorld</span>() {</span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true"></a>    <span class="kw">return</span> <span class="st">&quot;Hello World&quot;</span>;</span>
<span id="cb239-3"><a href="#cb239-3" aria-hidden="true"></a>}</span></code></pre></div>
<p>or</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true"></a><span class="at">@Nullable</span> <span class="kw">public</span> <span class="dt">static</span> <span class="bu">String</span> <span class="fu">helloWorld</span>() {</span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true"></a>    <span class="kw">return</span> <span class="st">&quot;Hello World&quot;</span>;</span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true"></a>}</span></code></pre></div>
<p>The second example won’t compile (in IntelliJ IDEA).</p>
<p>When you use the first <code>helloWorld()</code> function in another piece of code:</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true"></a><span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span>(<span class="bu">String</span>[] args)</span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true"></a>{</span>
<span id="cb241-3"><a href="#cb241-3" aria-hidden="true"></a>    <span class="bu">String</span> result = <span class="fu">helloWorld</span>();</span>
<span id="cb241-4"><a href="#cb241-4" aria-hidden="true"></a>    <span class="kw">if</span>(result != <span class="kw">null</span>) {</span>
<span id="cb241-5"><a href="#cb241-5" aria-hidden="true"></a>        <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(result);</span>
<span id="cb241-6"><a href="#cb241-6" aria-hidden="true"></a>    }</span>
<span id="cb241-7"><a href="#cb241-7" aria-hidden="true"></a>}</span></code></pre></div>
<p>Now the IntelliJ IDEA compiler will tell you that the check is useless, since the <code>helloWorld()</code> function won’t return <code>null</code>, ever.</p>
<p>Using parameter</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true"></a><span class="dt">void</span> <span class="fu">someMethod</span>(<span class="at">@NotNull</span> someParameter) { }</span></code></pre></div>
<p>if you write something like:</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true"></a><span class="fu">someMethod</span>(<span class="kw">null</span>);</span></code></pre></div>
<p>This won’t compile.</p>
<p>Last example using <code>@Nullable</code></p>
<div class="sourceCode" id="cb244"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true"></a><span class="at">@Nullable</span> <span class="fu">iWantToDestroyEverything</span>() { <span class="kw">return</span> <span class="kw">null</span>; }</span></code></pre></div>
<p>Doing this</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true"></a><span class="fu">iWantToDestroyEverything</span>().<span class="fu">something</span>();</span></code></pre></div>
<p>And you can be sure that this won’t happen. :)</p>
<p>It’s a nice way to let the compiler check something more than it usually does and to enforce your contracts to be stronger. Unfortunately, it’s not supported by all the compilers.</p>
<p>In IntelliJ IDEA 10.5 and on, they added support for any other <code>@Nullable</code> <code>@NotNull</code> implementations.</p>
<p>See blog post <em><a href="https://blog.jetbrains.com/idea/2011/03/more-flexible-and-configurable-nullublenotnull-annotations/" rel="noreferrer">More flexible and configurable <span class="citation" data-cites="Nullable">@Nullable</span>/<span class="citation" data-cites="NotNull">@NotNull</span> annotations</a></em>.</p>
</section>
<section id="answer-3-score-304" class="level4">
<h4>Answer 3 (score 304)</h4>
<h5>
If null-values are not allowed
</h2>
<p>If your method is called externally, start with something like this:</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true"></a><span class="kw">public</span> <span class="dt">void</span> <span class="fu">method</span>(<span class="bu">Object</span> object) {</span>
<span id="cb246-2"><a href="#cb246-2" aria-hidden="true"></a>  <span class="kw">if</span> (object == <span class="kw">null</span>) {</span>
<span id="cb246-3"><a href="#cb246-3" aria-hidden="true"></a>    <span class="kw">throw</span> <span class="kw">new</span> <span class="bu">IllegalArgumentException</span>(<span class="st">&quot;...&quot;</span>);</span>
<span id="cb246-4"><a href="#cb246-4" aria-hidden="true"></a>  }</span></code></pre></div>
<p>Then, in the rest of that method, you’ll know that <code>object</code> is not null.</p>
<p>If it is an internal method (not part of an API), just document that it cannot be null, and that’s it.</p>
<p>Example:</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true"></a><span class="kw">public</span> <span class="bu">String</span> <span class="fu">getFirst3Chars</span>(<span class="bu">String</span> text) {</span>
<span id="cb247-2"><a href="#cb247-2" aria-hidden="true"></a>  <span class="kw">return</span> text.<span class="fu">subString</span>(<span class="dv">0</span>, <span class="dv">3</span>);</span>
<span id="cb247-3"><a href="#cb247-3" aria-hidden="true"></a>}</span></code></pre></div>
<p>However, if your method just passes the value on, and the next method passes it on etc. it could get problematic. In that case you may want to check the argument as above.</p>
<h5>
If null is allowed
</h2>
<p>This really depends. If find that I often do something like this:</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true"></a><span class="kw">if</span> (object == <span class="kw">null</span>) {</span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true"></a>  <span class="co">// something</span></span>
<span id="cb248-3"><a href="#cb248-3" aria-hidden="true"></a>} <span class="kw">else</span> {</span>
<span id="cb248-4"><a href="#cb248-4" aria-hidden="true"></a>  <span class="co">// something else</span></span>
<span id="cb248-5"><a href="#cb248-5" aria-hidden="true"></a>}</span></code></pre></div>
<p>So I branch, and do two completely different things. There is no ugly code snippet, because I really need to do two different things depending on the data. For example, should I work on the input, or should I calculate a good default value?</p>
<hr>
<p>It’s actually rare for me to use the idiom “<code>if (object != null &amp;amp;&amp;amp; ...</code>”.</p>
<p>It may be easier to give you examples, if you show examples of where you typically use the idiom.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-do-i-fix-android.os.networkonmainthreadexception-score-1139887-in-2019" class="level3">
<h3>28: How do I fix ‘android.os.NetworkOnMainThreadException’? (score <a href="https://stackoverflow.com/q/6343166.html">1139887</a> in 2019)</h3>
<section id="question-27" class="level4">
<h4>Question</h4>
<p>I got an error while running my Android project for RssReader.</p>
<p>Code:</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true"></a><span class="bu">URL</span> url = <span class="kw">new</span> <span class="bu">URL</span>(urlToRssFeed);</span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true"></a><span class="bu">SAXParserFactory</span> factory = <span class="bu">SAXParserFactory</span>.<span class="fu">newInstance</span>();</span>
<span id="cb249-3"><a href="#cb249-3" aria-hidden="true"></a><span class="bu">SAXParser</span> parser = factory.<span class="fu">newSAXParser</span>();</span>
<span id="cb249-4"><a href="#cb249-4" aria-hidden="true"></a><span class="bu">XMLReader</span> xmlreader = parser.<span class="fu">getXMLReader</span>();</span>
<span id="cb249-5"><a href="#cb249-5" aria-hidden="true"></a>RssHandler theRSSHandler = <span class="kw">new</span> <span class="fu">RssHandler</span>();</span>
<span id="cb249-6"><a href="#cb249-6" aria-hidden="true"></a>xmlreader.<span class="fu">setContentHandler</span>(theRSSHandler);</span>
<span id="cb249-7"><a href="#cb249-7" aria-hidden="true"></a><span class="bu">InputSource</span> is = <span class="kw">new</span> <span class="bu">InputSource</span>(url.<span class="fu">openStream</span>());</span>
<span id="cb249-8"><a href="#cb249-8" aria-hidden="true"></a>xmlreader.<span class="fu">parse</span>(is);</span>
<span id="cb249-9"><a href="#cb249-9" aria-hidden="true"></a><span class="kw">return</span> theRSSHandler.<span class="fu">getFeed</span>();</span></code></pre></div>
<p>And it shows the below error:</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true"></a>android.<span class="fu">os</span>.<span class="fu">NetworkOnMainThreadException</span></span></code></pre></div>
<p>How can I fix this issue?</p>
</section>
<section id="answer-accepted-score-2481" class="level4">
<h4>Answer accepted (score 2481)</h4>
<p>This exception is thrown when an application attempts to perform a networking operation on its main thread. Run your code in <a href="http://developer.android.com/reference/android/os/AsyncTask.html" rel="noreferrer"><code>AsyncTask</code></a>:</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true"></a><span class="kw">class</span> RetrieveFeedTask <span class="kw">extends</span> AsyncTask&lt;<span class="bu">String</span>, <span class="bu">Void</span>, RSSFeed&gt; {</span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true"></a></span>
<span id="cb251-3"><a href="#cb251-3" aria-hidden="true"></a>    <span class="kw">private</span> <span class="bu">Exception</span> exception;</span>
<span id="cb251-4"><a href="#cb251-4" aria-hidden="true"></a></span>
<span id="cb251-5"><a href="#cb251-5" aria-hidden="true"></a>    <span class="kw">protected</span> RSSFeed <span class="fu">doInBackground</span>(<span class="bu">String</span><span class="kw">... </span>urls) {</span>
<span id="cb251-6"><a href="#cb251-6" aria-hidden="true"></a>        <span class="kw">try</span> {</span>
<span id="cb251-7"><a href="#cb251-7" aria-hidden="true"></a>            <span class="bu">URL</span> url = <span class="kw">new</span> <span class="bu">URL</span>(urls[<span class="dv">0</span>]);</span>
<span id="cb251-8"><a href="#cb251-8" aria-hidden="true"></a>            <span class="bu">SAXParserFactory</span> factory = <span class="bu">SAXParserFactory</span>.<span class="fu">newInstance</span>();</span>
<span id="cb251-9"><a href="#cb251-9" aria-hidden="true"></a>            <span class="bu">SAXParser</span> parser = factory.<span class="fu">newSAXParser</span>();</span>
<span id="cb251-10"><a href="#cb251-10" aria-hidden="true"></a>            <span class="bu">XMLReader</span> xmlreader = parser.<span class="fu">getXMLReader</span>();</span>
<span id="cb251-11"><a href="#cb251-11" aria-hidden="true"></a>            RssHandler theRSSHandler = <span class="kw">new</span> <span class="fu">RssHandler</span>();</span>
<span id="cb251-12"><a href="#cb251-12" aria-hidden="true"></a>            xmlreader.<span class="fu">setContentHandler</span>(theRSSHandler);</span>
<span id="cb251-13"><a href="#cb251-13" aria-hidden="true"></a>            <span class="bu">InputSource</span> is = <span class="kw">new</span> <span class="bu">InputSource</span>(url.<span class="fu">openStream</span>());</span>
<span id="cb251-14"><a href="#cb251-14" aria-hidden="true"></a>            xmlreader.<span class="fu">parse</span>(is);</span>
<span id="cb251-15"><a href="#cb251-15" aria-hidden="true"></a></span>
<span id="cb251-16"><a href="#cb251-16" aria-hidden="true"></a>            <span class="kw">return</span> theRSSHandler.<span class="fu">getFeed</span>();</span>
<span id="cb251-17"><a href="#cb251-17" aria-hidden="true"></a>        } <span class="kw">catch</span> (<span class="bu">Exception</span> e) {</span>
<span id="cb251-18"><a href="#cb251-18" aria-hidden="true"></a>            <span class="kw">this</span>.<span class="fu">exception</span> = e;</span>
<span id="cb251-19"><a href="#cb251-19" aria-hidden="true"></a></span>
<span id="cb251-20"><a href="#cb251-20" aria-hidden="true"></a>            <span class="kw">return</span> <span class="kw">null</span>;</span>
<span id="cb251-21"><a href="#cb251-21" aria-hidden="true"></a>        } <span class="kw">finally</span> {</span>
<span id="cb251-22"><a href="#cb251-22" aria-hidden="true"></a>            is.<span class="fu">close</span>();</span>
<span id="cb251-23"><a href="#cb251-23" aria-hidden="true"></a>        }</span>
<span id="cb251-24"><a href="#cb251-24" aria-hidden="true"></a>    }</span>
<span id="cb251-25"><a href="#cb251-25" aria-hidden="true"></a></span>
<span id="cb251-26"><a href="#cb251-26" aria-hidden="true"></a>    <span class="kw">protected</span> <span class="dt">void</span> <span class="fu">onPostExecute</span>(RSSFeed feed) {</span>
<span id="cb251-27"><a href="#cb251-27" aria-hidden="true"></a>        <span class="co">// </span><span class="al">TODO</span><span class="co">: check this.exception</span></span>
<span id="cb251-28"><a href="#cb251-28" aria-hidden="true"></a>        <span class="co">// </span><span class="al">TODO</span><span class="co">: do something with the feed</span></span>
<span id="cb251-29"><a href="#cb251-29" aria-hidden="true"></a>    }</span>
<span id="cb251-30"><a href="#cb251-30" aria-hidden="true"></a>}</span></code></pre></div>
<p>How to execute the task:</p>
<p>In <code>MainActivity.java</code> file you can add this line within your <code>oncreate()</code> method</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true"></a><span class="kw">new</span> <span class="fu">RetrieveFeedTask</span>().<span class="fu">execute</span>(urlToRssFeed);</span></code></pre></div>
<p>Don’t forget to add this to <code>AndroidManifest.xml</code> file:</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true"></a>&lt;uses-permission android:name=<span class="st">&quot;android.permission.INTERNET&quot;</span>/&gt;</span></code></pre></div>
</section>
<section id="answer-2-score-640" class="level4">
<h4>Answer 2 (score 640)</h4>
<p><strong>You should almost always run network operations on a thread or as an asynchronous task.</strong></p>
<p>But it <em>is</em> possible to remove this restriction and you override the default behavior, if you are willing to accept the consequences.</p>
<p>Add:</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true"></a>StrictMode.<span class="fu">ThreadPolicy</span> policy = <span class="kw">new</span> StrictMode.<span class="fu">ThreadPolicy</span>.<span class="fu">Builder</span>().<span class="fu">permitAll</span>().<span class="fu">build</span>();</span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true"></a></span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true"></a>StrictMode.<span class="fu">setThreadPolicy</span>(policy); </span></code></pre></div>
<p>In your class,</p>
<p>and</p>
<p>ADD this permission in android manifest.xml file:    </p>
<div class="sourceCode" id="cb255"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true"></a>&lt;uses-permission android:name=<span class="st">&quot;android.permission.INTERNET&quot;</span>/&gt;</span></code></pre></div>
<p>Consequences:</p>
<p>Your app will (in areas of spotty internet connection) become unresponsive and lock up, the user perceives slowness and has to do a force kill, and you risk the activity manager killing your app and telling the user that the app has stopped.</p>
<p>
Android has some good tips on good programming practices to design for responsiveness: <a href="http://developer.android.com/reference/android/os/NetworkOnMainThreadException.html" rel="noreferrer">http://developer.android.com/reference/android/os/NetworkOnMainThreadException.html</a>
</p>
</section>
<section id="answer-3-score-403" class="level4">
<h4>Answer 3 (score 403)</h4>
<p>I solved this problem using a new <code>Thread</code>.</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true"></a><span class="bu">Thread</span> thread = <span class="kw">new</span> <span class="bu">Thread</span>(<span class="kw">new</span> <span class="bu">Runnable</span>() {</span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true"></a></span>
<span id="cb256-3"><a href="#cb256-3" aria-hidden="true"></a>    <span class="at">@Override</span></span>
<span id="cb256-4"><a href="#cb256-4" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">void</span> <span class="fu">run</span>() {</span>
<span id="cb256-5"><a href="#cb256-5" aria-hidden="true"></a>        <span class="kw">try</span>  {</span>
<span id="cb256-6"><a href="#cb256-6" aria-hidden="true"></a>            <span class="co">//Your code goes here</span></span>
<span id="cb256-7"><a href="#cb256-7" aria-hidden="true"></a>        } <span class="kw">catch</span> (<span class="bu">Exception</span> e) {</span>
<span id="cb256-8"><a href="#cb256-8" aria-hidden="true"></a>            e.<span class="fu">printStackTrace</span>();</span>
<span id="cb256-9"><a href="#cb256-9" aria-hidden="true"></a>        }</span>
<span id="cb256-10"><a href="#cb256-10" aria-hidden="true"></a>    }</span>
<span id="cb256-11"><a href="#cb256-11" aria-hidden="true"></a>});</span>
<span id="cb256-12"><a href="#cb256-12" aria-hidden="true"></a></span>
<span id="cb256-13"><a href="#cb256-13" aria-hidden="true"></a>thread.<span class="fu">start</span>(); </span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="does-java-support-default-parameter-values-score-1111010-in-2019" class="level3">
<h3>29: Does Java support default parameter values? (score <a href="https://stackoverflow.com/q/997482.html">1111010</a> in 2019)</h3>
<section id="question-28" class="level4">
<h4>Question</h4>
<p>I came across some Java code that had the following structure:</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true"></a><span class="kw">public</span> <span class="fu">MyParameterizedFunction</span>(<span class="bu">String</span> param1, <span class="dt">int</span> param2)</span>
<span id="cb257-2"><a href="#cb257-2" aria-hidden="true"></a>{</span>
<span id="cb257-3"><a href="#cb257-3" aria-hidden="true"></a>    <span class="kw">this</span>(param1, param2, <span class="kw">false</span>);</span>
<span id="cb257-4"><a href="#cb257-4" aria-hidden="true"></a>}</span>
<span id="cb257-5"><a href="#cb257-5" aria-hidden="true"></a></span>
<span id="cb257-6"><a href="#cb257-6" aria-hidden="true"></a><span class="kw">public</span> <span class="fu">MyParameterizedFunction</span>(<span class="bu">String</span> param1, <span class="dt">int</span> param2, <span class="dt">boolean</span> param3)</span>
<span id="cb257-7"><a href="#cb257-7" aria-hidden="true"></a>{</span>
<span id="cb257-8"><a href="#cb257-8" aria-hidden="true"></a>    <span class="co">//use all three parameters here</span></span>
<span id="cb257-9"><a href="#cb257-9" aria-hidden="true"></a>}</span></code></pre></div>
<p>I know that in C++ I can assign a parameter a default value. For example:</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true"></a><span class="dt">void</span> <span class="fu">MyParameterizedFunction</span>(<span class="bu">String</span> param1, <span class="dt">int</span> param2, bool param3=<span class="kw">false</span>);</span></code></pre></div>
<p>Does Java support this kind of syntax? Are there any reasons why this two step syntax is preferable?</p>
</section>
<section id="answer-accepted-score-884" class="level4">
<h4>Answer accepted (score 884)</h4>
<p>No, the structure you found is how Java handles it (that is, with overloading instead of default parameters).</p>
<p>For constructors, <em><a href="https://en.wikipedia.org/wiki/Joshua_Bloch
#Bibliography" rel="noreferrer">See Effective Java: Programming Language Guide’s</a></em> Item 1 tip (Consider static factory methods instead of constructors) if the overloading is getting complicated. For other methods, renaming some cases or using a parameter object can help. This is when you have enough complexity that differentiating is difficult. A definite case is where you have to differentiate using the order of parameters, not just number and type.</p>
</section>
<section id="answer-2-score-607" class="level4">
<h4>Answer 2 (score 607)</h4>
<p>No, but you can use the <a href="http://en.wikipedia.org/wiki/Builder_pattern" rel="noreferrer">Builder Pattern</a>, as described in <a href="https://stackoverflow.com/questions/222214/managing-constructors-with-many-parameters-in-java-1-4/222295
#222295">this Stack Overflow answer</a>.</p>
<p>As described in the linked answer, the Builder Pattern lets you write code like</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true"></a>Student s1 = <span class="kw">new</span> <span class="fu">StudentBuilder</span>().<span class="fu">name</span>(<span class="st">&quot;Eli&quot;</span>).<span class="fu">buildStudent</span>();</span>
<span id="cb259-2"><a href="#cb259-2" aria-hidden="true"></a>Student s2 = <span class="kw">new</span> <span class="fu">StudentBuilder</span>()</span>
<span id="cb259-3"><a href="#cb259-3" aria-hidden="true"></a>                 .<span class="fu">name</span>(<span class="st">&quot;Spicoli&quot;</span>)</span>
<span id="cb259-4"><a href="#cb259-4" aria-hidden="true"></a>                 .<span class="fu">age</span>(<span class="dv">16</span>)</span>
<span id="cb259-5"><a href="#cb259-5" aria-hidden="true"></a>                 .<span class="fu">motto</span>(<span class="st">&quot;Aloha, Mr Hand&quot;</span>)</span>
<span id="cb259-6"><a href="#cb259-6" aria-hidden="true"></a>                 .<span class="fu">buildStudent</span>();</span></code></pre></div>
<p>in which some fields can have default values or otherwise be optional.</p>
</section>
<section id="answer-3-score-442" class="level4">
<h4>Answer 3 (score 442)</h4>
<p>There are several ways to simulate default parameters in Java:</p>
<ol>
<li>
<p>
<strong>Method overloading.</strong>
</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true"></a><span class="dt">void</span> <span class="fu">foo</span>(<span class="bu">String</span> a, <span class="bu">Integer</span> b) {</span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true"></a>    <span class="co">//...</span></span>
<span id="cb260-3"><a href="#cb260-3" aria-hidden="true"></a>}</span>
<span id="cb260-4"><a href="#cb260-4" aria-hidden="true"></a></span>
<span id="cb260-5"><a href="#cb260-5" aria-hidden="true"></a><span class="dt">void</span> <span class="fu">foo</span>(<span class="bu">String</span> a) {</span>
<span id="cb260-6"><a href="#cb260-6" aria-hidden="true"></a>    <span class="fu">foo</span>(a, <span class="dv">0</span>); <span class="co">// here, 0 is a default value for b</span></span>
<span id="cb260-7"><a href="#cb260-7" aria-hidden="true"></a>}</span>
<span id="cb260-8"><a href="#cb260-8" aria-hidden="true"></a></span>
<span id="cb260-9"><a href="#cb260-9" aria-hidden="true"></a><span class="fu">foo</span>(<span class="st">&quot;a&quot;</span>, <span class="dv">2</span>);</span>
<span id="cb260-10"><a href="#cb260-10" aria-hidden="true"></a><span class="fu">foo</span>(<span class="st">&quot;a&quot;</span>);</span></code></pre></div>
One of the limitations of this approach is that it doesn’t work if you have two optional parameters of the same type and any of them can be omitted.
</li>
<li>
<p>
<strong>Varargs.</strong>
</p>
<ol type="a">
<li>All optional parameters are of the same type:</li>
</ol>
<div class="sourceCode" id="cb261"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true"></a><span class="dt">void</span> <span class="fu">foo</span>(<span class="bu">String</span> a, <span class="bu">Integer</span><span class="kw">... </span>b) {</span>
<span id="cb261-2"><a href="#cb261-2" aria-hidden="true"></a>    <span class="bu">Integer</span> b1 = b.<span class="fu">length</span> &gt; <span class="dv">0</span> ? b[<span class="dv">0</span>] : <span class="dv">0</span>;</span>
<span id="cb261-3"><a href="#cb261-3" aria-hidden="true"></a>    <span class="bu">Integer</span> b2 = b.<span class="fu">length</span> &gt; <span class="dv">1</span> ? b[<span class="dv">1</span>] : <span class="dv">0</span>;</span>
<span id="cb261-4"><a href="#cb261-4" aria-hidden="true"></a>    <span class="co">//...</span></span>
<span id="cb261-5"><a href="#cb261-5" aria-hidden="true"></a>}</span>
<span id="cb261-6"><a href="#cb261-6" aria-hidden="true"></a></span>
<span id="cb261-7"><a href="#cb261-7" aria-hidden="true"></a><span class="fu">foo</span>(<span class="st">&quot;a&quot;</span>);</span>
<span id="cb261-8"><a href="#cb261-8" aria-hidden="true"></a><span class="fu">foo</span>(<span class="st">&quot;a&quot;</span>, <span class="dv">1</span>, <span class="dv">2</span>);</span></code></pre></div>
<ol start="2" type="a">
<li>Types of optional parameters may be different:</li>
</ol>
<div class="sourceCode" id="cb262"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true"></a><span class="dt">void</span> <span class="fu">foo</span>(<span class="bu">String</span> a, <span class="bu">Object</span><span class="kw">... </span>b) {</span>
<span id="cb262-2"><a href="#cb262-2" aria-hidden="true"></a>    <span class="bu">Integer</span> b1 = <span class="dv">0</span>;</span>
<span id="cb262-3"><a href="#cb262-3" aria-hidden="true"></a>    <span class="bu">String</span> b2 = <span class="st">&quot;&quot;</span>;</span>
<span id="cb262-4"><a href="#cb262-4" aria-hidden="true"></a>    <span class="kw">if</span> (b.<span class="fu">length</span> &gt; <span class="dv">0</span>) {</span>
<span id="cb262-5"><a href="#cb262-5" aria-hidden="true"></a>      <span class="kw">if</span> (!(b[<span class="dv">0</span>] <span class="kw">instanceof</span> <span class="bu">Integer</span>)) { </span>
<span id="cb262-6"><a href="#cb262-6" aria-hidden="true"></a>          <span class="kw">throw</span> <span class="kw">new</span> <span class="bu">IllegalArgumentException</span>(<span class="st">&quot;...&quot;</span>);</span>
<span id="cb262-7"><a href="#cb262-7" aria-hidden="true"></a>      }</span>
<span id="cb262-8"><a href="#cb262-8" aria-hidden="true"></a>      b1 = (<span class="bu">Integer</span>)b[<span class="dv">0</span>];</span>
<span id="cb262-9"><a href="#cb262-9" aria-hidden="true"></a>    }</span>
<span id="cb262-10"><a href="#cb262-10" aria-hidden="true"></a>    <span class="kw">if</span> (b.<span class="fu">length</span> &gt; <span class="dv">1</span>) {</span>
<span id="cb262-11"><a href="#cb262-11" aria-hidden="true"></a>        <span class="kw">if</span> (!(b[<span class="dv">1</span>] <span class="kw">instanceof</span> <span class="bu">String</span>)) { </span>
<span id="cb262-12"><a href="#cb262-12" aria-hidden="true"></a>            <span class="kw">throw</span> <span class="kw">new</span> <span class="bu">IllegalArgumentException</span>(<span class="st">&quot;...&quot;</span>);</span>
<span id="cb262-13"><a href="#cb262-13" aria-hidden="true"></a>        }</span>
<span id="cb262-14"><a href="#cb262-14" aria-hidden="true"></a>        b2 = (<span class="bu">String</span>)b[<span class="dv">1</span>];</span>
<span id="cb262-15"><a href="#cb262-15" aria-hidden="true"></a>        <span class="co">//...</span></span>
<span id="cb262-16"><a href="#cb262-16" aria-hidden="true"></a>    }</span>
<span id="cb262-17"><a href="#cb262-17" aria-hidden="true"></a>    <span class="co">//...</span></span>
<span id="cb262-18"><a href="#cb262-18" aria-hidden="true"></a>}</span>
<span id="cb262-19"><a href="#cb262-19" aria-hidden="true"></a></span>
<span id="cb262-20"><a href="#cb262-20" aria-hidden="true"></a><span class="fu">foo</span>(<span class="st">&quot;a&quot;</span>);</span>
<span id="cb262-21"><a href="#cb262-21" aria-hidden="true"></a><span class="fu">foo</span>(<span class="st">&quot;a&quot;</span>, <span class="dv">1</span>);</span>
<span id="cb262-22"><a href="#cb262-22" aria-hidden="true"></a><span class="fu">foo</span>(<span class="st">&quot;a&quot;</span>, <span class="dv">1</span>, <span class="st">&quot;b2&quot;</span>);</span></code></pre></div>
The main drawback of this approach is that if optional parameters are of different types you lose static type checking. Furthermore, if each parameter has different meaning you need some way to distinguish them.
</li>
<li>
<p>
<strong>Nulls.</strong> To address the limitations of the previous approaches you can allow null values and then analyse each parameter in a method body:
</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true"></a><span class="dt">void</span> <span class="fu">foo</span>(<span class="bu">String</span> a, <span class="bu">Integer</span> b, <span class="bu">Integer</span> c) {</span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true"></a>    b = b != <span class="kw">null</span> ? b : <span class="dv">0</span>;</span>
<span id="cb263-3"><a href="#cb263-3" aria-hidden="true"></a>    c = c != <span class="kw">null</span> ? c : <span class="dv">0</span>;</span>
<span id="cb263-4"><a href="#cb263-4" aria-hidden="true"></a>    <span class="co">//...</span></span>
<span id="cb263-5"><a href="#cb263-5" aria-hidden="true"></a>}</span>
<span id="cb263-6"><a href="#cb263-6" aria-hidden="true"></a></span>
<span id="cb263-7"><a href="#cb263-7" aria-hidden="true"></a><span class="fu">foo</span>(<span class="st">&quot;a&quot;</span>, <span class="kw">null</span>, <span class="dv">2</span>);</span></code></pre></div>
Now all arguments values must be provided, but the default ones may be null.
</li>
<li>
<p>
<strong>Optional class.</strong> This approach is similar to nulls, but uses Java 8 Optional class for parameters that have a default value:
</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true"></a><span class="dt">void</span> <span class="fu">foo</span>(<span class="bu">String</span> a, Optional&lt;<span class="bu">Integer</span>&gt; bOpt) {</span>
<span id="cb264-2"><a href="#cb264-2" aria-hidden="true"></a>    <span class="bu">Integer</span> b = bOpt.<span class="fu">isPresent</span>() ? bOpt.<span class="fu">get</span>() : <span class="dv">0</span>;</span>
<span id="cb264-3"><a href="#cb264-3" aria-hidden="true"></a>    <span class="co">//...</span></span>
<span id="cb264-4"><a href="#cb264-4" aria-hidden="true"></a>}</span>
<span id="cb264-5"><a href="#cb264-5" aria-hidden="true"></a></span>
<span id="cb264-6"><a href="#cb264-6" aria-hidden="true"></a><span class="fu">foo</span>(<span class="st">&quot;a&quot;</span>, Optional.<span class="fu">of</span>(<span class="dv">2</span>));</span>
<span id="cb264-7"><a href="#cb264-7" aria-hidden="true"></a><span class="fu">foo</span>(<span class="st">&quot;a&quot;</span>, Optional.&lt;<span class="bu">Integer</span>&gt;<span class="fu">absent</span>());</span></code></pre></div>
Optional makes a method contract explicit for a caller, however, one may find such signature too verbose.
</li>
<li>
<p>
<strong>Builder pattern.</strong> The builder pattern is used for constructors and is implemented by introducing a separate Builder class:
</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true"></a> <span class="kw">class</span> Foo {</span>
<span id="cb265-2"><a href="#cb265-2" aria-hidden="true"></a>     <span class="kw">private</span> <span class="dt">final</span> <span class="bu">String</span> a; </span>
<span id="cb265-3"><a href="#cb265-3" aria-hidden="true"></a>     <span class="kw">private</span> <span class="dt">final</span> <span class="bu">Integer</span> b;</span>
<span id="cb265-4"><a href="#cb265-4" aria-hidden="true"></a></span>
<span id="cb265-5"><a href="#cb265-5" aria-hidden="true"></a>     <span class="fu">Foo</span>(<span class="bu">String</span> a, <span class="bu">Integer</span> b) {</span>
<span id="cb265-6"><a href="#cb265-6" aria-hidden="true"></a>       <span class="kw">this</span>.<span class="fu">a</span> = a;</span>
<span id="cb265-7"><a href="#cb265-7" aria-hidden="true"></a>       <span class="kw">this</span>.<span class="fu">b</span> = b;</span>
<span id="cb265-8"><a href="#cb265-8" aria-hidden="true"></a>     }</span>
<span id="cb265-9"><a href="#cb265-9" aria-hidden="true"></a></span>
<span id="cb265-10"><a href="#cb265-10" aria-hidden="true"></a>     <span class="co">//...</span></span>
<span id="cb265-11"><a href="#cb265-11" aria-hidden="true"></a> }</span>
<span id="cb265-12"><a href="#cb265-12" aria-hidden="true"></a></span>
<span id="cb265-13"><a href="#cb265-13" aria-hidden="true"></a> <span class="kw">class</span> FooBuilder {</span>
<span id="cb265-14"><a href="#cb265-14" aria-hidden="true"></a>   <span class="kw">private</span> <span class="bu">String</span> a = <span class="st">&quot;&quot;</span>; </span>
<span id="cb265-15"><a href="#cb265-15" aria-hidden="true"></a>   <span class="kw">private</span> <span class="bu">Integer</span> b = <span class="dv">0</span>;</span>
<span id="cb265-16"><a href="#cb265-16" aria-hidden="true"></a></span>
<span id="cb265-17"><a href="#cb265-17" aria-hidden="true"></a>   FooBuilder <span class="fu">setA</span>(<span class="bu">String</span> a) {</span>
<span id="cb265-18"><a href="#cb265-18" aria-hidden="true"></a>     <span class="kw">this</span>.<span class="fu">a</span> = a;</span>
<span id="cb265-19"><a href="#cb265-19" aria-hidden="true"></a>     <span class="kw">return</span> <span class="kw">this</span>;</span>
<span id="cb265-20"><a href="#cb265-20" aria-hidden="true"></a>   }</span>
<span id="cb265-21"><a href="#cb265-21" aria-hidden="true"></a></span>
<span id="cb265-22"><a href="#cb265-22" aria-hidden="true"></a>   FooBuilder <span class="fu">setB</span>(<span class="bu">Integer</span> b) {</span>
<span id="cb265-23"><a href="#cb265-23" aria-hidden="true"></a>     <span class="kw">this</span>.<span class="fu">b</span> = b;</span>
<span id="cb265-24"><a href="#cb265-24" aria-hidden="true"></a>     <span class="kw">return</span> <span class="kw">this</span>;</span>
<span id="cb265-25"><a href="#cb265-25" aria-hidden="true"></a>   }</span>
<span id="cb265-26"><a href="#cb265-26" aria-hidden="true"></a></span>
<span id="cb265-27"><a href="#cb265-27" aria-hidden="true"></a>   Foo <span class="fu">build</span>() {</span>
<span id="cb265-28"><a href="#cb265-28" aria-hidden="true"></a>     <span class="kw">return</span> <span class="kw">new</span> <span class="fu">Foo</span>(a, b);</span>
<span id="cb265-29"><a href="#cb265-29" aria-hidden="true"></a>   }</span>
<span id="cb265-30"><a href="#cb265-30" aria-hidden="true"></a> }</span>
<span id="cb265-31"><a href="#cb265-31" aria-hidden="true"></a></span>
<span id="cb265-32"><a href="#cb265-32" aria-hidden="true"></a> Foo foo = <span class="kw">new</span> <span class="fu">FooBuilder</span>().<span class="fu">setA</span>(<span class="st">&quot;a&quot;</span>).<span class="fu">build</span>();</span>
<span id="cb265-33"><a href="#cb265-33" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb265-34"><a href="#cb265-34" aria-hidden="true"></a>&lt;li&gt;&lt;p&gt;&lt;strong&gt;Maps.&lt;/strong&gt; When the number of parameters is too large and <span class="kw">for</span> most of them <span class="kw">default</span> values are usually used, you can pass method arguments as a map of their names/values:&lt;/p&gt;</span>
<span id="cb265-35"><a href="#cb265-35" aria-hidden="true"></a></span>
<span id="cb265-36"><a href="#cb265-36" aria-hidden="true"></a>```java</span>
<span id="cb265-37"><a href="#cb265-37" aria-hidden="true"></a><span class="dt">void</span> <span class="fu">foo</span>(<span class="bu">Map</span>&lt;<span class="bu">String</span>, <span class="bu">Object</span>&gt; parameters) {</span>
<span id="cb265-38"><a href="#cb265-38" aria-hidden="true"></a>    <span class="bu">String</span> a = <span class="st">&quot;&quot;</span>; </span>
<span id="cb265-39"><a href="#cb265-39" aria-hidden="true"></a>    <span class="bu">Integer</span> b = <span class="dv">0</span>;</span>
<span id="cb265-40"><a href="#cb265-40" aria-hidden="true"></a>    <span class="kw">if</span> (parameters.<span class="fu">containsKey</span>(<span class="st">&quot;a&quot;</span>)) { </span>
<span id="cb265-41"><a href="#cb265-41" aria-hidden="true"></a>        <span class="kw">if</span> (!(parameters.<span class="fu">get</span>(<span class="st">&quot;a&quot;</span>) <span class="kw">instanceof</span> <span class="bu">Integer</span>)) { </span>
<span id="cb265-42"><a href="#cb265-42" aria-hidden="true"></a>            <span class="kw">throw</span> <span class="kw">new</span> <span class="bu">IllegalArgumentException</span>(<span class="st">&quot;...&quot;</span>);</span>
<span id="cb265-43"><a href="#cb265-43" aria-hidden="true"></a>        }</span>
<span id="cb265-44"><a href="#cb265-44" aria-hidden="true"></a>        a = (<span class="bu">String</span>)parameters.<span class="fu">get</span>(<span class="st">&quot;a&quot;</span>);</span>
<span id="cb265-45"><a href="#cb265-45" aria-hidden="true"></a>    } <span class="kw">else</span> <span class="kw">if</span> (parameters.<span class="fu">containsKey</span>(<span class="st">&quot;b&quot;</span>)) { </span>
<span id="cb265-46"><a href="#cb265-46" aria-hidden="true"></a>        <span class="co">//... </span></span>
<span id="cb265-47"><a href="#cb265-47" aria-hidden="true"></a>    }</span>
<span id="cb265-48"><a href="#cb265-48" aria-hidden="true"></a>    <span class="co">//...</span></span>
<span id="cb265-49"><a href="#cb265-49" aria-hidden="true"></a>}</span>
<span id="cb265-50"><a href="#cb265-50" aria-hidden="true"></a></span>
<span id="cb265-51"><a href="#cb265-51" aria-hidden="true"></a><span class="fu">foo</span>(ImmutableMap.&lt;<span class="bu">String</span>, <span class="bu">Object</span>&gt;<span class="fu">of</span>(</span>
<span id="cb265-52"><a href="#cb265-52" aria-hidden="true"></a>    <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>,</span>
<span id="cb265-53"><a href="#cb265-53" aria-hidden="true"></a>    <span class="st">&quot;b&quot;</span>, <span class="dv">2</span>, </span>
<span id="cb265-54"><a href="#cb265-54" aria-hidden="true"></a>    <span class="st">&quot;d&quot;</span>, <span class="st">&quot;value&quot;</span>)); </span>
<span id="cb265-55"><a href="#cb265-55" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb265-56"><a href="#cb265-56" aria-hidden="true"></a>&lt;/ol&gt;</span>
<span id="cb265-57"><a href="#cb265-57" aria-hidden="true"></a></span>
<span id="cb265-58"><a href="#cb265-58" aria-hidden="true"></a>Please note that you can combine any of these approaches to achieve a desirable result.  </span>
<span id="cb265-59"><a href="#cb265-59" aria-hidden="true"></a></span>
<span id="cb265-60"><a href="#cb265-60" aria-hidden="true"></a>&lt;/b&gt; &lt;/em&gt; &lt;/i&gt; &lt;/small&gt; &lt;/strong&gt; &lt;/sub&gt; &lt;/sup&gt;</span>
<span id="cb265-61"><a href="#cb265-61" aria-hidden="true"></a></span>
<span id="cb265-62"><a href="#cb265-62" aria-hidden="true"></a></span>
<span id="cb265-63"><a href="#cb265-63" aria-hidden="true"></a>### <span class="dv">30</span>: How <span class="kw">do</span> I <span class="kw">break</span> out of nested loops in Java? (score [<span class="dv">1078453</span>](https:<span class="co">//stackoverflow.com/q/886955.html) in 2019)</span></span>
<span id="cb265-64"><a href="#cb265-64" aria-hidden="true"></a></span>
<span id="cb265-65"><a href="#cb265-65" aria-hidden="true"></a></span>
<span id="cb265-66"><a href="#cb265-66" aria-hidden="true"></a>#### Question</span>
<span id="cb265-67"><a href="#cb265-67" aria-hidden="true"></a>I&#39;ve got a nested loop construct like <span class="kw">this</span>:  </span>
<span id="cb265-68"><a href="#cb265-68" aria-hidden="true"></a></span>
<span id="cb265-69"><a href="#cb265-69" aria-hidden="true"></a>```java</span>
<span id="cb265-70"><a href="#cb265-70" aria-hidden="true"></a><span class="kw">for</span> (<span class="bu">Type</span> type : types) {</span>
<span id="cb265-71"><a href="#cb265-71" aria-hidden="true"></a>    <span class="kw">for</span> (<span class="bu">Type</span> t : types2) {</span>
<span id="cb265-72"><a href="#cb265-72" aria-hidden="true"></a>         <span class="kw">if</span> (some condition) {</span>
<span id="cb265-73"><a href="#cb265-73" aria-hidden="true"></a>             <span class="co">// Do something and break...</span></span>
<span id="cb265-74"><a href="#cb265-74" aria-hidden="true"></a>             <span class="kw">break</span>; <span class="co">// Breaks out of the inner loop</span></span>
<span id="cb265-75"><a href="#cb265-75" aria-hidden="true"></a>         }</span>
<span id="cb265-76"><a href="#cb265-76" aria-hidden="true"></a>    }</span>
<span id="cb265-77"><a href="#cb265-77" aria-hidden="true"></a>}</span></code></pre></div>
<p>Now how can I break out of both loops? I’ve looked at similar questions, but none concerns Java specifically. I couldn’t apply these solutions because most used gotos.</p>
<p>I don’t want to put the inner loop in a different method.</p>
<p>I don’t want to rerun the loops. When breaking I’m finished with the execution of the loop block.</p>
</section>
<section id="answer-accepted-score-2313" class="level4">
<h4>Answer accepted (score 2313)</h4>
<p>Like other answerers, I’d definitely <em>prefer</em> to put the loops in a different method, at which point you can just return to stop iterating completely. This answer just shows how the requirements in the question can be met.</p>
<p>You can use <code>break</code> with a label for the outer loop. For example:</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">class</span> Test {</span>
<span id="cb266-2"><a href="#cb266-2" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span>(<span class="bu">String</span>[] args) {</span>
<span id="cb266-3"><a href="#cb266-3" aria-hidden="true"></a>        outerloop:</span>
<span id="cb266-4"><a href="#cb266-4" aria-hidden="true"></a>        <span class="kw">for</span> (<span class="dt">int</span> i=<span class="dv">0</span>; i &lt; <span class="dv">5</span>; i++) {</span>
<span id="cb266-5"><a href="#cb266-5" aria-hidden="true"></a>            <span class="kw">for</span> (<span class="dt">int</span> j=<span class="dv">0</span>; j &lt; <span class="dv">5</span>; j++) {</span>
<span id="cb266-6"><a href="#cb266-6" aria-hidden="true"></a>                <span class="kw">if</span> (i * j &gt; <span class="dv">6</span>) {</span>
<span id="cb266-7"><a href="#cb266-7" aria-hidden="true"></a>                    <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;Breaking&quot;</span>);</span>
<span id="cb266-8"><a href="#cb266-8" aria-hidden="true"></a>                    <span class="kw">break</span> outerloop;</span>
<span id="cb266-9"><a href="#cb266-9" aria-hidden="true"></a>                }</span>
<span id="cb266-10"><a href="#cb266-10" aria-hidden="true"></a>                <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(i + <span class="st">&quot; &quot;</span> + j);</span>
<span id="cb266-11"><a href="#cb266-11" aria-hidden="true"></a>            }</span>
<span id="cb266-12"><a href="#cb266-12" aria-hidden="true"></a>        }</span>
<span id="cb266-13"><a href="#cb266-13" aria-hidden="true"></a>        <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;Done&quot;</span>);</span>
<span id="cb266-14"><a href="#cb266-14" aria-hidden="true"></a>    }</span>
<span id="cb266-15"><a href="#cb266-15" aria-hidden="true"></a>}</span></code></pre></div>
<p>This prints:</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true"></a><span class="dv">0</span> <span class="dv">0</span></span>
<span id="cb267-2"><a href="#cb267-2" aria-hidden="true"></a><span class="dv">0</span> <span class="dv">1</span></span>
<span id="cb267-3"><a href="#cb267-3" aria-hidden="true"></a><span class="dv">0</span> <span class="dv">2</span></span>
<span id="cb267-4"><a href="#cb267-4" aria-hidden="true"></a><span class="dv">0</span> <span class="dv">3</span></span>
<span id="cb267-5"><a href="#cb267-5" aria-hidden="true"></a><span class="dv">0</span> <span class="dv">4</span></span>
<span id="cb267-6"><a href="#cb267-6" aria-hidden="true"></a><span class="dv">1</span> <span class="dv">0</span></span>
<span id="cb267-7"><a href="#cb267-7" aria-hidden="true"></a><span class="dv">1</span> <span class="dv">1</span></span>
<span id="cb267-8"><a href="#cb267-8" aria-hidden="true"></a><span class="dv">1</span> <span class="dv">2</span></span>
<span id="cb267-9"><a href="#cb267-9" aria-hidden="true"></a><span class="dv">1</span> <span class="dv">3</span></span>
<span id="cb267-10"><a href="#cb267-10" aria-hidden="true"></a><span class="dv">1</span> <span class="dv">4</span></span>
<span id="cb267-11"><a href="#cb267-11" aria-hidden="true"></a><span class="dv">2</span> <span class="dv">0</span></span>
<span id="cb267-12"><a href="#cb267-12" aria-hidden="true"></a><span class="dv">2</span> <span class="dv">1</span></span>
<span id="cb267-13"><a href="#cb267-13" aria-hidden="true"></a><span class="dv">2</span> <span class="dv">2</span></span>
<span id="cb267-14"><a href="#cb267-14" aria-hidden="true"></a><span class="dv">2</span> <span class="dv">3</span></span>
<span id="cb267-15"><a href="#cb267-15" aria-hidden="true"></a>Breaking</span>
<span id="cb267-16"><a href="#cb267-16" aria-hidden="true"></a>Done</span></code></pre></div>
</section>
<section id="answer-2-score-389" class="level4">
<h4>Answer 2 (score 389)</h4>
<p>Technically the correct answer is to label the outer loop. In practice if you want to exit at any point inside an inner loop then you would be better off externalizing the code into a method (a static method if needs be) and then call it.</p>
<p>That would pay off for readability.</p>
<p>The code would become something like that:</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true"></a><span class="kw">private</span> <span class="dt">static</span> <span class="bu">String</span> <span class="fu">search</span>(...) </span>
<span id="cb268-2"><a href="#cb268-2" aria-hidden="true"></a>{</span>
<span id="cb268-3"><a href="#cb268-3" aria-hidden="true"></a>    <span class="kw">for</span> (<span class="bu">Type</span> type : types) {</span>
<span id="cb268-4"><a href="#cb268-4" aria-hidden="true"></a>        <span class="kw">for</span> (<span class="bu">Type</span> t : types2) {</span>
<span id="cb268-5"><a href="#cb268-5" aria-hidden="true"></a>            <span class="kw">if</span> (some condition) {</span>
<span id="cb268-6"><a href="#cb268-6" aria-hidden="true"></a>                <span class="co">// Do something and break...</span></span>
<span id="cb268-7"><a href="#cb268-7" aria-hidden="true"></a>                <span class="kw">return</span> search;</span>
<span id="cb268-8"><a href="#cb268-8" aria-hidden="true"></a>            }</span>
<span id="cb268-9"><a href="#cb268-9" aria-hidden="true"></a>        }</span>
<span id="cb268-10"><a href="#cb268-10" aria-hidden="true"></a>    }</span>
<span id="cb268-11"><a href="#cb268-11" aria-hidden="true"></a>    <span class="kw">return</span> <span class="kw">null</span>; </span>
<span id="cb268-12"><a href="#cb268-12" aria-hidden="true"></a>}</span></code></pre></div>
<p>Matching the example for the accepted answer:</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true"></a> <span class="kw">public</span> <span class="kw">class</span> Test {</span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span>(<span class="bu">String</span>[] args) {</span>
<span id="cb269-3"><a href="#cb269-3" aria-hidden="true"></a>        <span class="fu">loop</span>();</span>
<span id="cb269-4"><a href="#cb269-4" aria-hidden="true"></a>        <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;Done&quot;</span>);</span>
<span id="cb269-5"><a href="#cb269-5" aria-hidden="true"></a>    }</span>
<span id="cb269-6"><a href="#cb269-6" aria-hidden="true"></a></span>
<span id="cb269-7"><a href="#cb269-7" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">loop</span>() {</span>
<span id="cb269-8"><a href="#cb269-8" aria-hidden="true"></a>        <span class="kw">for</span> (<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; <span class="dv">5</span>; i++) {</span>
<span id="cb269-9"><a href="#cb269-9" aria-hidden="true"></a>            <span class="kw">for</span> (<span class="dt">int</span> j = <span class="dv">0</span>; j &lt; <span class="dv">5</span>; j++) {</span>
<span id="cb269-10"><a href="#cb269-10" aria-hidden="true"></a>                <span class="kw">if</span> (i * j &gt; <span class="dv">6</span>) {</span>
<span id="cb269-11"><a href="#cb269-11" aria-hidden="true"></a>                    <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;Breaking&quot;</span>);</span>
<span id="cb269-12"><a href="#cb269-12" aria-hidden="true"></a>                    <span class="kw">return</span>;</span>
<span id="cb269-13"><a href="#cb269-13" aria-hidden="true"></a>                }</span>
<span id="cb269-14"><a href="#cb269-14" aria-hidden="true"></a>                <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(i + <span class="st">&quot; &quot;</span> + j);</span>
<span id="cb269-15"><a href="#cb269-15" aria-hidden="true"></a>            }</span>
<span id="cb269-16"><a href="#cb269-16" aria-hidden="true"></a>        }</span>
<span id="cb269-17"><a href="#cb269-17" aria-hidden="true"></a>    }</span>
<span id="cb269-18"><a href="#cb269-18" aria-hidden="true"></a>}</span></code></pre></div>
</section>
<section id="answer-3-score-210" class="level4">
<h4>Answer 3 (score 210)</h4>
<p>You can use a named block around the loops:</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true"></a>search: {</span>
<span id="cb270-2"><a href="#cb270-2" aria-hidden="true"></a>    <span class="kw">for</span> (<span class="bu">Type</span> type : types) {</span>
<span id="cb270-3"><a href="#cb270-3" aria-hidden="true"></a>        <span class="kw">for</span> (<span class="bu">Type</span> t : types2) {</span>
<span id="cb270-4"><a href="#cb270-4" aria-hidden="true"></a>            <span class="kw">if</span> (some condition) {</span>
<span id="cb270-5"><a href="#cb270-5" aria-hidden="true"></a>                <span class="co">// Do something and break...</span></span>
<span id="cb270-6"><a href="#cb270-6" aria-hidden="true"></a>                <span class="kw">break</span> search;</span>
<span id="cb270-7"><a href="#cb270-7" aria-hidden="true"></a>            }</span>
<span id="cb270-8"><a href="#cb270-8" aria-hidden="true"></a>        }</span>
<span id="cb270-9"><a href="#cb270-9" aria-hidden="true"></a>    }</span>
<span id="cb270-10"><a href="#cb270-10" aria-hidden="true"></a>}</span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-to-get-an-enum-value-from-a-string-value-in-java-score-1045192-in-2018" class="level3">
<h3>31: How to get an enum value from a string value in Java? (score <a href="https://stackoverflow.com/q/604424.html">1045192</a> in 2018)</h3>
<section id="question-29" class="level4">
<h4>Question</h4>
<p>Say I have an enum which is just</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">enum</span> Blah {</span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true"></a>    A, B, C, D</span>
<span id="cb271-3"><a href="#cb271-3" aria-hidden="true"></a>}</span></code></pre></div>
<p>and I would like to find the enum value of a string, for example <code>"A"</code> which would be <code>Blah.A</code>. How would it be possible to do this?</p>
<p>Is the <code>Enum.valueOf()</code> the method I need? If so, how would I use this?</p>
</section>
<section id="answer-accepted-score-2149" class="level4">
<h4>Answer accepted (score 2149)</h4>
<p>Yes, <code>Blah.valueOf("A")</code> will give you <code>Blah.A</code>.</p>
<p>Note that the name must be an <em>exact</em> match, including case: <code>Blah.valueOf("a")</code> and <code>Blah.valueOf("A ")</code> both throw an <code>IllegalArgumentException</code>.</p>
<p>The static methods <code>valueOf()</code> and <code>values()</code> are created at compile time and do not appear in source code. They do appear in Javadoc, though; for example, <a href="http://docs.oracle.com/javase/7/docs/api/java/awt/Dialog.ModalityType.html" rel="noreferrer"><code>Dialog.ModalityType</code></a> shows both methods.</p>
</section>
<section id="answer-2-score-818" class="level4">
<h4>Answer 2 (score 818)</h4>
<p>Another solution if the text is not the same to the enumeration value:</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">enum</span> Blah {</span>
<span id="cb272-2"><a href="#cb272-2" aria-hidden="true"></a>    <span class="fu">A</span>(<span class="st">&quot;text1&quot;</span>),</span>
<span id="cb272-3"><a href="#cb272-3" aria-hidden="true"></a>    <span class="fu">B</span>(<span class="st">&quot;text2&quot;</span>),</span>
<span id="cb272-4"><a href="#cb272-4" aria-hidden="true"></a>    <span class="fu">C</span>(<span class="st">&quot;text3&quot;</span>),</span>
<span id="cb272-5"><a href="#cb272-5" aria-hidden="true"></a>    <span class="fu">D</span>(<span class="st">&quot;text4&quot;</span>);</span>
<span id="cb272-6"><a href="#cb272-6" aria-hidden="true"></a></span>
<span id="cb272-7"><a href="#cb272-7" aria-hidden="true"></a>    <span class="kw">private</span> <span class="bu">String</span> text;</span>
<span id="cb272-8"><a href="#cb272-8" aria-hidden="true"></a></span>
<span id="cb272-9"><a href="#cb272-9" aria-hidden="true"></a>    <span class="fu">Blah</span>(<span class="bu">String</span> text) {</span>
<span id="cb272-10"><a href="#cb272-10" aria-hidden="true"></a>        <span class="kw">this</span>.<span class="fu">text</span> = text;</span>
<span id="cb272-11"><a href="#cb272-11" aria-hidden="true"></a>    }</span>
<span id="cb272-12"><a href="#cb272-12" aria-hidden="true"></a></span>
<span id="cb272-13"><a href="#cb272-13" aria-hidden="true"></a>    <span class="kw">public</span> <span class="bu">String</span> <span class="fu">getText</span>() {</span>
<span id="cb272-14"><a href="#cb272-14" aria-hidden="true"></a>        <span class="kw">return</span> <span class="kw">this</span>.<span class="fu">text</span>;</span>
<span id="cb272-15"><a href="#cb272-15" aria-hidden="true"></a>    }</span>
<span id="cb272-16"><a href="#cb272-16" aria-hidden="true"></a></span>
<span id="cb272-17"><a href="#cb272-17" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">static</span> Blah <span class="fu">fromString</span>(<span class="bu">String</span> text) {</span>
<span id="cb272-18"><a href="#cb272-18" aria-hidden="true"></a>        <span class="kw">for</span> (Blah b : Blah.<span class="fu">values</span>()) {</span>
<span id="cb272-19"><a href="#cb272-19" aria-hidden="true"></a>            <span class="kw">if</span> (b.<span class="fu">text</span>.<span class="fu">equalsIgnoreCase</span>(text)) {</span>
<span id="cb272-20"><a href="#cb272-20" aria-hidden="true"></a>                <span class="kw">return</span> b;</span>
<span id="cb272-21"><a href="#cb272-21" aria-hidden="true"></a>            }</span>
<span id="cb272-22"><a href="#cb272-22" aria-hidden="true"></a>        }</span>
<span id="cb272-23"><a href="#cb272-23" aria-hidden="true"></a>        <span class="kw">return</span> <span class="kw">null</span>;</span>
<span id="cb272-24"><a href="#cb272-24" aria-hidden="true"></a>    }</span>
<span id="cb272-25"><a href="#cb272-25" aria-hidden="true"></a>}</span></code></pre></div>
</section>
<section id="answer-3-score-117" class="level4">
<h4>Answer 3 (score 117)</h4>
<p>Here’s a nifty utility I use:</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true"></a><span class="co">/**</span></span>
<span id="cb273-2"><a href="#cb273-2" aria-hidden="true"></a> <span class="co">*</span> A common method for all enums since they can<span class="co">&#39;</span>t have another base class</span>
<span id="cb273-3"><a href="#cb273-3" aria-hidden="true"></a> <span class="co">* </span><span class="an">@param &lt;T&gt; </span>Enum type</span>
<span id="cb273-4"><a href="#cb273-4" aria-hidden="true"></a> <span class="co">*</span> <span class="an">@param c </span>enum type<span class="co">.</span> All enums must be all caps<span class="co">.</span></span>
<span id="cb273-5"><a href="#cb273-5" aria-hidden="true"></a> <span class="co">*</span> <span class="an">@param string </span>case insensitive</span>
<span id="cb273-6"><a href="#cb273-6" aria-hidden="true"></a> <span class="co">*</span> <span class="an">@return </span>corresponding enum<span class="co">,</span> or null</span>
<span id="cb273-7"><a href="#cb273-7" aria-hidden="true"></a> <span class="co">*/</span></span>
<span id="cb273-8"><a href="#cb273-8" aria-hidden="true"></a><span class="kw">public</span> <span class="dt">static</span> &lt;T <span class="kw">extends</span> <span class="bu">Enum</span>&lt;T&gt;&gt; T <span class="fu">getEnumFromString</span>(<span class="bu">Class</span>&lt;T&gt; c, <span class="bu">String</span> string) {</span>
<span id="cb273-9"><a href="#cb273-9" aria-hidden="true"></a>    <span class="kw">if</span>( c != <span class="kw">null</span> &amp;&amp; string != <span class="kw">null</span> ) {</span>
<span id="cb273-10"><a href="#cb273-10" aria-hidden="true"></a>        <span class="kw">try</span> {</span>
<span id="cb273-11"><a href="#cb273-11" aria-hidden="true"></a>            <span class="kw">return</span> <span class="bu">Enum</span>.<span class="fu">valueOf</span>(c, string.<span class="fu">trim</span>().<span class="fu">toUpperCase</span>());</span>
<span id="cb273-12"><a href="#cb273-12" aria-hidden="true"></a>        } <span class="kw">catch</span>(<span class="bu">IllegalArgumentException</span> ex) {</span>
<span id="cb273-13"><a href="#cb273-13" aria-hidden="true"></a>        }</span>
<span id="cb273-14"><a href="#cb273-14" aria-hidden="true"></a>    }</span>
<span id="cb273-15"><a href="#cb273-15" aria-hidden="true"></a>    <span class="kw">return</span> <span class="kw">null</span>;</span>
<span id="cb273-16"><a href="#cb273-16" aria-hidden="true"></a>}</span></code></pre></div>
<p>Then in my enum class I usually have this to save some typing:</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true"></a><span class="kw">public</span> <span class="dt">static</span> MyEnum <span class="fu">fromString</span>(<span class="bu">String</span> name) {</span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true"></a>    <span class="kw">return</span> <span class="fu">getEnumFromString</span>(MyEnum.<span class="fu">class</span>, name);</span>
<span id="cb274-3"><a href="#cb274-3" aria-hidden="true"></a>}</span></code></pre></div>
<p>If your enums are not all caps, just change the <code>Enum.valueOf</code> line.</p>
<p>Too bad I can’t use <code>T.class</code> for <code>Enum.valueOf</code> as <code>T</code> is erased.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="sort-arraylist-of-custom-objects-by-property-score-1033206-in-2016" class="level3">
<h3>32: Sort ArrayList of custom Objects by property (score <a href="https://stackoverflow.com/q/2784514.html">1033206</a> in 2016)</h3>
<section id="question-30" class="level4">
<h4>Question</h4>
<p>I read about sorting ArrayLists using a Comparator but in all of the examples people used <code>compareTo</code> which according to some research is a method for Strings.</p>
<p>
I wanted to sort an ArrayList of custom objects by one of their properties: a Date object (<code>getStartDay()</code>). Normally I compare them by <code>item1.getStartDate().before(item2.getStartDate())</code> so I was wondering whether I could write something like:
</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">class</span> CustomComparator {</span>
<span id="cb275-2"><a href="#cb275-2" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">boolean</span> <span class="fu">compare</span>(<span class="bu">Object</span> object1, <span class="bu">Object</span> object2) {</span>
<span id="cb275-3"><a href="#cb275-3" aria-hidden="true"></a>        <span class="kw">return</span> object1.<span class="fu">getStartDate</span>().<span class="fu">before</span>(object2.<span class="fu">getStartDate</span>());</span>
<span id="cb275-4"><a href="#cb275-4" aria-hidden="true"></a>    }</span>
<span id="cb275-5"><a href="#cb275-5" aria-hidden="true"></a>}</span>
<span id="cb275-6"><a href="#cb275-6" aria-hidden="true"></a></span>
<span id="cb275-7"><a href="#cb275-7" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">class</span> RandomName {</span>
<span id="cb275-8"><a href="#cb275-8" aria-hidden="true"></a>    ...</span>
<span id="cb275-9"><a href="#cb275-9" aria-hidden="true"></a>    <span class="bu">Collections</span>.<span class="fu">sort</span>(Database.<span class="fu">arrayList</span>, <span class="kw">new</span> CustomComparator);</span>
<span id="cb275-10"><a href="#cb275-10" aria-hidden="true"></a>    ...</span>
<span id="cb275-11"><a href="#cb275-11" aria-hidden="true"></a>}</span></code></pre></div>
</section>
<section id="answer-accepted-score-1478" class="level4">
<h4>Answer accepted (score 1478)</h4>
<p>Since <a href="//docs.oracle.com/javase/8/docs/api/java/util/Date.html" rel="noreferrer"><code>Date</code></a> implements <a href="//docs.oracle.com/javase/8/docs/api/java/lang/Comparable.html" rel="noreferrer"><code>Comparable</code></a>, it has a <code>compareTo</code> method just like <code>String</code> does.</p>
<p>So your custom <a href="//docs.oracle.com/javase/8/docs/api/java/util/Comparator.html" rel="noreferrer"><code>Comparator</code></a> could look like this:</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">class</span> CustomComparator <span class="kw">implements</span> <span class="bu">Comparator</span>&lt;MyObject&gt; {</span>
<span id="cb276-2"><a href="#cb276-2" aria-hidden="true"></a>    <span class="at">@Override</span></span>
<span id="cb276-3"><a href="#cb276-3" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">int</span> <span class="fu">compare</span>(MyObject o1, MyObject o2) {</span>
<span id="cb276-4"><a href="#cb276-4" aria-hidden="true"></a>        <span class="kw">return</span> o1.<span class="fu">getStartDate</span>().<span class="fu">compareTo</span>(o2.<span class="fu">getStartDate</span>());</span>
<span id="cb276-5"><a href="#cb276-5" aria-hidden="true"></a>    }</span>
<span id="cb276-6"><a href="#cb276-6" aria-hidden="true"></a>}</span></code></pre></div>
<p>The <code>compare()</code> method must return an <code>int</code>, so you couldn’t directly return a <code>boolean</code> like you were planning to anyway.</p>
<p>Your sorting code would be just about like you wrote:</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true"></a><span class="bu">Collections</span>.<span class="fu">sort</span>(Database.<span class="fu">arrayList</span>, <span class="kw">new</span> <span class="fu">CustomComparator</span>());</span></code></pre></div>
<p>A slightly shorter way to write all this, if you don’t need to reuse your comparator, is to write it as an inline anonymous class:</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true"></a><span class="bu">Collections</span>.<span class="fu">sort</span>(Database.<span class="fu">arrayList</span>, <span class="kw">new</span> <span class="bu">Comparator</span>&lt;MyObject&gt;() {</span>
<span id="cb278-2"><a href="#cb278-2" aria-hidden="true"></a>    <span class="at">@Override</span></span>
<span id="cb278-3"><a href="#cb278-3" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">int</span> <span class="fu">compare</span>(MyObject o1, MyObject o2) {</span>
<span id="cb278-4"><a href="#cb278-4" aria-hidden="true"></a>        <span class="kw">return</span> o1.<span class="fu">getStartDate</span>().<span class="fu">compareTo</span>(o2.<span class="fu">getStartDate</span>());</span>
<span id="cb278-5"><a href="#cb278-5" aria-hidden="true"></a>    }</span>
<span id="cb278-6"><a href="#cb278-6" aria-hidden="true"></a>});</span></code></pre></div>
<hr>
<h5>
Since <a href="/questions/tagged/java-8" class="post-tag" title="show questions tagged &
#39;java-8&#39;" rel="tag">java-8</a>
</h1>
<p>You can now write the last example in a shorter form by using a <a href="//docs.oracle.com/javase/tutorial/java/javaOO/lambdaexpressions.html" rel="noreferrer">lambda expression</a> for the <code>Comparator</code>:</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true"></a><span class="bu">Collections</span>.<span class="fu">sort</span>(Database.<span class="fu">arrayList</span>, </span>
<span id="cb279-2"><a href="#cb279-2" aria-hidden="true"></a>                        (o1, o2) -&gt; o1.<span class="fu">getStartDate</span>().<span class="fu">compareTo</span>(o2.<span class="fu">getStartDate</span>()));</span></code></pre></div>
<p>And <code>List</code> has a <a href="//docs.oracle.com/javase/8/docs/api/java/util/List.html
#sort-java.util.Comparator-" rel="noreferrer"><code>sort(Comparator)</code></a> method, so you can shorten this even further:</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true"></a>Database.<span class="fu">arrayList</span>.<span class="fu">sort</span>((o1, o2) -&gt; o1.<span class="fu">getStartDate</span>().<span class="fu">compareTo</span>(o2.<span class="fu">getStartDate</span>()));</span></code></pre></div>
<p>This is such a common idiom that there’s <a href="//docs.oracle.com/javase/8/docs/api/java/util/Comparator.html
#comparing-java.util.function.Function-" rel="noreferrer">a built-in method</a> to generate a <code>Comparator</code> for a class with a <code>Comparable</code> key:</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true"></a>Database.<span class="fu">arrayList</span>.<span class="fu">sort</span>(<span class="bu">Comparator</span>.<span class="fu">comparing</span>(MyObject::getStartDate));</span></code></pre></div>
<p>All of these are equivalent forms.</p>
</section>
<section id="answer-2-score-191" class="level4">
<h4>Answer 2 (score 191)</h4>
<p>Classes that has a natural sort order (a class Number, as an example) should implement the Comparable interface, whilst classes that has no natural sort order (a class Chair, as an example) should be provided with a Comparator (or an anonymous Comparator class).</p>
<p>Two examples:</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">class</span> <span class="bu">Number</span> <span class="kw">implements</span> <span class="bu">Comparable</span>&lt;<span class="bu">Number</span>&gt; {</span>
<span id="cb282-2"><a href="#cb282-2" aria-hidden="true"></a>    <span class="kw">private</span> <span class="dt">int</span> value;</span>
<span id="cb282-3"><a href="#cb282-3" aria-hidden="true"></a></span>
<span id="cb282-4"><a href="#cb282-4" aria-hidden="true"></a>    <span class="kw">public</span> <span class="bu">Number</span>(<span class="dt">int</span> value) { <span class="kw">this</span>.<span class="fu">value</span> = value; }</span>
<span id="cb282-5"><a href="#cb282-5" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">int</span> <span class="fu">compareTo</span>(<span class="bu">Number</span> anotherInstance) {</span>
<span id="cb282-6"><a href="#cb282-6" aria-hidden="true"></a>        <span class="kw">return</span> <span class="kw">this</span>.<span class="fu">value</span> - anotherInstance.<span class="fu">value</span>;</span>
<span id="cb282-7"><a href="#cb282-7" aria-hidden="true"></a>    }</span>
<span id="cb282-8"><a href="#cb282-8" aria-hidden="true"></a>}</span>
<span id="cb282-9"><a href="#cb282-9" aria-hidden="true"></a></span>
<span id="cb282-10"><a href="#cb282-10" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">class</span> Chair {</span>
<span id="cb282-11"><a href="#cb282-11" aria-hidden="true"></a>    <span class="kw">private</span> <span class="dt">int</span> weight;</span>
<span id="cb282-12"><a href="#cb282-12" aria-hidden="true"></a>    <span class="kw">private</span> <span class="dt">int</span> height;</span>
<span id="cb282-13"><a href="#cb282-13" aria-hidden="true"></a></span>
<span id="cb282-14"><a href="#cb282-14" aria-hidden="true"></a>    <span class="kw">public</span> <span class="fu">Chair</span>(<span class="dt">int</span> weight, <span class="dt">int</span> height) {</span>
<span id="cb282-15"><a href="#cb282-15" aria-hidden="true"></a>        <span class="kw">this</span>.<span class="fu">weight</span> = weight;</span>
<span id="cb282-16"><a href="#cb282-16" aria-hidden="true"></a>        <span class="kw">this</span>.<span class="fu">height</span> = height;</span>
<span id="cb282-17"><a href="#cb282-17" aria-hidden="true"></a>    }</span>
<span id="cb282-18"><a href="#cb282-18" aria-hidden="true"></a>    <span class="co">/* Omitting getters and setters */</span></span>
<span id="cb282-19"><a href="#cb282-19" aria-hidden="true"></a>}</span>
<span id="cb282-20"><a href="#cb282-20" aria-hidden="true"></a><span class="kw">class</span> ChairWeightComparator <span class="kw">implements</span> <span class="bu">Comparator</span>&lt;Chair&gt; {</span>
<span id="cb282-21"><a href="#cb282-21" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">int</span> <span class="fu">compare</span>(Chair chair1, Chair chair2) {</span>
<span id="cb282-22"><a href="#cb282-22" aria-hidden="true"></a>        <span class="kw">return</span> chair1.<span class="fu">getWeight</span>() - chair2.<span class="fu">getWeight</span>();</span>
<span id="cb282-23"><a href="#cb282-23" aria-hidden="true"></a>    }</span>
<span id="cb282-24"><a href="#cb282-24" aria-hidden="true"></a>}</span>
<span id="cb282-25"><a href="#cb282-25" aria-hidden="true"></a><span class="kw">class</span> ChairHeightComparator <span class="kw">implements</span> <span class="bu">Comparator</span>&lt;Chair&gt; {</span>
<span id="cb282-26"><a href="#cb282-26" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">int</span> <span class="fu">compare</span>(Chair chair1, Chair chair2) {</span>
<span id="cb282-27"><a href="#cb282-27" aria-hidden="true"></a>        <span class="kw">return</span> chair1.<span class="fu">getHeight</span>() - chair2.<span class="fu">getHeight</span>();</span>
<span id="cb282-28"><a href="#cb282-28" aria-hidden="true"></a>    }</span>
<span id="cb282-29"><a href="#cb282-29" aria-hidden="true"></a>}</span></code></pre></div>
<p>Usage:</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true"></a><span class="bu">List</span>&lt;<span class="bu">Number</span>&gt; numbers = <span class="kw">new</span> <span class="bu">ArrayList</span>&lt;<span class="bu">Number</span>&gt;();</span>
<span id="cb283-2"><a href="#cb283-2" aria-hidden="true"></a>...</span>
<span id="cb283-3"><a href="#cb283-3" aria-hidden="true"></a><span class="bu">Collections</span>.<span class="fu">sort</span>(numbers);</span>
<span id="cb283-4"><a href="#cb283-4" aria-hidden="true"></a></span>
<span id="cb283-5"><a href="#cb283-5" aria-hidden="true"></a><span class="bu">List</span>&lt;Chair&gt; chairs = <span class="kw">new</span> <span class="bu">ArrayList</span>&lt;Chair&gt;();</span>
<span id="cb283-6"><a href="#cb283-6" aria-hidden="true"></a><span class="co">// Sort by weight:</span></span>
<span id="cb283-7"><a href="#cb283-7" aria-hidden="true"></a><span class="bu">Collections</span>.<span class="fu">sort</span>(chairs, <span class="kw">new</span> <span class="fu">ChairWeightComparator</span>());</span>
<span id="cb283-8"><a href="#cb283-8" aria-hidden="true"></a><span class="co">// Sort by height:</span></span>
<span id="cb283-9"><a href="#cb283-9" aria-hidden="true"></a><span class="bu">Collections</span>.<span class="fu">sort</span>(chairs, <span class="kw">new</span> <span class="fu">ChairHeightComparator</span>());</span>
<span id="cb283-10"><a href="#cb283-10" aria-hidden="true"></a></span>
<span id="cb283-11"><a href="#cb283-11" aria-hidden="true"></a><span class="co">// You can also create anonymous comparators;</span></span>
<span id="cb283-12"><a href="#cb283-12" aria-hidden="true"></a><span class="co">// Sort by color:</span></span>
<span id="cb283-13"><a href="#cb283-13" aria-hidden="true"></a><span class="bu">Collections</span>.<span class="fu">sort</span>(chairs, <span class="kw">new</span> <span class="bu">Comparator</span>&lt;Chair&gt;() {</span>
<span id="cb283-14"><a href="#cb283-14" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">int</span> <span class="fu">compare</span>(Chair chair1, Chair chair2) {</span>
<span id="cb283-15"><a href="#cb283-15" aria-hidden="true"></a>        ...</span>
<span id="cb283-16"><a href="#cb283-16" aria-hidden="true"></a>    }</span>
<span id="cb283-17"><a href="#cb283-17" aria-hidden="true"></a>});</span></code></pre></div>
</section>
<section id="answer-3-score-155" class="level4">
<h4>Answer 3 (score 155)</h4>
<p>For sorting an <code>ArrayList</code> you could use the following code snippet:</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true"></a><span class="bu">Collections</span>.<span class="fu">sort</span>(studList, <span class="kw">new</span> <span class="bu">Comparator</span>&lt;Student&gt;(){</span>
<span id="cb284-2"><a href="#cb284-2" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">int</span> <span class="fu">compare</span>(Student s1, Student s2) {</span>
<span id="cb284-3"><a href="#cb284-3" aria-hidden="true"></a>        <span class="kw">return</span> s1.<span class="fu">getFirstName</span>().<span class="fu">compareToIgnoreCase</span>(s2.<span class="fu">getFirstName</span>());</span>
<span id="cb284-4"><a href="#cb284-4" aria-hidden="true"></a>    }</span>
<span id="cb284-5"><a href="#cb284-5" aria-hidden="true"></a>});</span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-can-i-concatenate-two-arrays-in-java-score-1023252-in-2018" class="level3">
<h3>33: How can I concatenate two arrays in Java? (score <a href="https://stackoverflow.com/q/80476.html">1023252</a> in 2018)</h3>
<section id="question-31" class="level4">
<h4>Question</h4>
<p>I need to concatenate two <code>String</code> arrays in Java.</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true"></a><span class="dt">void</span> <span class="fu">f</span>(<span class="bu">String</span>[] first, <span class="bu">String</span>[] second) {</span>
<span id="cb285-2"><a href="#cb285-2" aria-hidden="true"></a>    <span class="bu">String</span>[] both = ???</span>
<span id="cb285-3"><a href="#cb285-3" aria-hidden="true"></a>}</span></code></pre></div>
<p>What is the easiest way to do this?</p>
</section>
<section id="answer-2-score-1026" class="level4">
<h4>Answer 2 (score 1026)</h4>
<p>I found a one-line solution from the good old Apache Commons Lang library.<br> <a href="http://commons.apache.org/proper/commons-lang/javadocs/api-3.1/org/apache/commons/lang3/ArrayUtils.html
#addAll%28T%5B%5D,%20T...%29" rel="noreferrer"><code>ArrayUtils.addAll(T[], T...)</code></a></p>
<p>Code:</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true"></a><span class="bu">String</span>[] both = ArrayUtils.<span class="fu">addAll</span>(first, second);</span></code></pre></div>
</section>
<section id="answer-3-score-753" class="level4">
<h4>Answer 3 (score 753)</h4>
<p>Here’s a simple method that will concatenate two arrays and return the result:</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true"></a><span class="kw">public</span> &lt;T&gt; T[] <span class="fu">concatenate</span>(T[] a, T[] b) {</span>
<span id="cb287-2"><a href="#cb287-2" aria-hidden="true"></a>    <span class="dt">int</span> aLen = a.<span class="fu">length</span>;</span>
<span id="cb287-3"><a href="#cb287-3" aria-hidden="true"></a>    <span class="dt">int</span> bLen = b.<span class="fu">length</span>;</span>
<span id="cb287-4"><a href="#cb287-4" aria-hidden="true"></a></span>
<span id="cb287-5"><a href="#cb287-5" aria-hidden="true"></a>    <span class="at">@SuppressWarnings</span>(<span class="st">&quot;unchecked&quot;</span>)</span>
<span id="cb287-6"><a href="#cb287-6" aria-hidden="true"></a>    T[] c = (T[]) <span class="bu">Array</span>.<span class="fu">newInstance</span>(a.<span class="fu">getClass</span>().<span class="fu">getComponentType</span>(), aLen + bLen);</span>
<span id="cb287-7"><a href="#cb287-7" aria-hidden="true"></a>    <span class="bu">System</span>.<span class="fu">arraycopy</span>(a, <span class="dv">0</span>, c, <span class="dv">0</span>, aLen);</span>
<span id="cb287-8"><a href="#cb287-8" aria-hidden="true"></a>    <span class="bu">System</span>.<span class="fu">arraycopy</span>(b, <span class="dv">0</span>, c, aLen, bLen);</span>
<span id="cb287-9"><a href="#cb287-9" aria-hidden="true"></a></span>
<span id="cb287-10"><a href="#cb287-10" aria-hidden="true"></a>    <span class="kw">return</span> c;</span>
<span id="cb287-11"><a href="#cb287-11" aria-hidden="true"></a>}</span></code></pre></div>
<p>Note that it will not work with primitive data types, only with object types.</p>
<p>The following slightly more complicated version works with both object and primitive arrays. It does this by using <code>T</code> instead of <code>T[]</code> as the argument type.</p>
<p>It also makes it possible to concatenate arrays of two different types by picking the most general type as the component type of the result.</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true"></a><span class="kw">public</span> <span class="dt">static</span> &lt;T&gt; T <span class="fu">concatenate</span>(T a, T b) {</span>
<span id="cb288-2"><a href="#cb288-2" aria-hidden="true"></a>    <span class="kw">if</span> (!a.<span class="fu">getClass</span>().<span class="fu">isArray</span>() || !b.<span class="fu">getClass</span>().<span class="fu">isArray</span>()) {</span>
<span id="cb288-3"><a href="#cb288-3" aria-hidden="true"></a>        <span class="kw">throw</span> <span class="kw">new</span> <span class="bu">IllegalArgumentException</span>();</span>
<span id="cb288-4"><a href="#cb288-4" aria-hidden="true"></a>    }</span>
<span id="cb288-5"><a href="#cb288-5" aria-hidden="true"></a></span>
<span id="cb288-6"><a href="#cb288-6" aria-hidden="true"></a>    <span class="bu">Class</span>&lt;?&gt; resCompType;</span>
<span id="cb288-7"><a href="#cb288-7" aria-hidden="true"></a>    <span class="bu">Class</span>&lt;?&gt; aCompType = a.<span class="fu">getClass</span>().<span class="fu">getComponentType</span>();</span>
<span id="cb288-8"><a href="#cb288-8" aria-hidden="true"></a>    <span class="bu">Class</span>&lt;?&gt; bCompType = b.<span class="fu">getClass</span>().<span class="fu">getComponentType</span>();</span>
<span id="cb288-9"><a href="#cb288-9" aria-hidden="true"></a></span>
<span id="cb288-10"><a href="#cb288-10" aria-hidden="true"></a>    <span class="kw">if</span> (aCompType.<span class="fu">isAssignableFrom</span>(bCompType)) {</span>
<span id="cb288-11"><a href="#cb288-11" aria-hidden="true"></a>        resCompType = aCompType;</span>
<span id="cb288-12"><a href="#cb288-12" aria-hidden="true"></a>    } <span class="kw">else</span> <span class="kw">if</span> (bCompType.<span class="fu">isAssignableFrom</span>(aCompType)) {</span>
<span id="cb288-13"><a href="#cb288-13" aria-hidden="true"></a>        resCompType = bCompType;</span>
<span id="cb288-14"><a href="#cb288-14" aria-hidden="true"></a>    } <span class="kw">else</span> {</span>
<span id="cb288-15"><a href="#cb288-15" aria-hidden="true"></a>        <span class="kw">throw</span> <span class="kw">new</span> <span class="bu">IllegalArgumentException</span>();</span>
<span id="cb288-16"><a href="#cb288-16" aria-hidden="true"></a>    }</span>
<span id="cb288-17"><a href="#cb288-17" aria-hidden="true"></a></span>
<span id="cb288-18"><a href="#cb288-18" aria-hidden="true"></a>    <span class="dt">int</span> aLen = <span class="bu">Array</span>.<span class="fu">getLength</span>(a);</span>
<span id="cb288-19"><a href="#cb288-19" aria-hidden="true"></a>    <span class="dt">int</span> bLen = <span class="bu">Array</span>.<span class="fu">getLength</span>(b);</span>
<span id="cb288-20"><a href="#cb288-20" aria-hidden="true"></a></span>
<span id="cb288-21"><a href="#cb288-21" aria-hidden="true"></a>    <span class="at">@SuppressWarnings</span>(<span class="st">&quot;unchecked&quot;</span>)</span>
<span id="cb288-22"><a href="#cb288-22" aria-hidden="true"></a>    T result = (T) <span class="bu">Array</span>.<span class="fu">newInstance</span>(resCompType, aLen + bLen);</span>
<span id="cb288-23"><a href="#cb288-23" aria-hidden="true"></a>    <span class="bu">System</span>.<span class="fu">arraycopy</span>(a, <span class="dv">0</span>, result, <span class="dv">0</span>, aLen);</span>
<span id="cb288-24"><a href="#cb288-24" aria-hidden="true"></a>    <span class="bu">System</span>.<span class="fu">arraycopy</span>(b, <span class="dv">0</span>, result, aLen, bLen);        </span>
<span id="cb288-25"><a href="#cb288-25" aria-hidden="true"></a></span>
<span id="cb288-26"><a href="#cb288-26" aria-hidden="true"></a>    <span class="kw">return</span> result;</span>
<span id="cb288-27"><a href="#cb288-27" aria-hidden="true"></a>}</span></code></pre></div>
<p>Here is an example:</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true"></a>Assert.<span class="fu">assertArrayEquals</span>(<span class="kw">new</span> <span class="dt">int</span>[] { <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span> }, <span class="fu">concatenate</span>(<span class="kw">new</span> <span class="dt">int</span>[] { <span class="dv">1</span>, <span class="dv">2</span> }, <span class="kw">new</span> <span class="dt">int</span>[] { <span class="dv">3</span> }));</span>
<span id="cb289-2"><a href="#cb289-2" aria-hidden="true"></a>Assert.<span class="fu">assertArrayEquals</span>(<span class="kw">new</span> <span class="bu">Number</span>[] { <span class="dv">1</span>, <span class="dv">2</span>, <span class="fl">3f</span> }, <span class="fu">concatenate</span>(<span class="kw">new</span> <span class="bu">Integer</span>[] { <span class="dv">1</span>, <span class="dv">2</span> }, <span class="kw">new</span> <span class="bu">Number</span>[] { <span class="fl">3f</span> }));</span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="when-to-use-linkedlist-over-arraylist-in-java-score-1008299-in-2018" class="level3">
<h3>34: When to use LinkedList over ArrayList in Java? (score <a href="https://stackoverflow.com/q/322715.html">1008299</a> in 2018)</h3>
<section id="question-32" class="level4">
<h4>Question</h4>
<p>I’ve always been one to simply use:</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true"></a><span class="bu">List</span>&lt;<span class="bu">String</span>&gt; names = <span class="kw">new</span> <span class="bu">ArrayList</span>&lt;&gt;();</span></code></pre></div>
<p>I use the interface as the type name for <em>portability</em>, so that when I ask questions such as these I can rework my code.</p>
<p>When should <a href="https://docs.oracle.com/javase/9/docs/api/java/util/LinkedList.html" rel="noreferrer"><code>LinkedList</code></a> be used over <a href="https://docs.oracle.com/javase/9/docs/api/java/util/ArrayList.html" rel="noreferrer"><code>ArrayList</code></a> and vice-versa?</p>
</section>
<section id="answer-accepted-score-3214" class="level4">
<h4>Answer accepted (score 3214)</h4>
<p><strong>Summary</strong> <code>ArrayList</code> with <code>ArrayDeque</code> are preferable in <em>many</em> more use-cases than <code>LinkedList</code>. If you’re not sure — just start with <code>ArrayList</code>.</p>
<hr>
<p><code>LinkedList</code> and <code>ArrayList</code> are two different implementations of the List interface. <code>LinkedList</code> implements it with a doubly-linked list. <code>ArrayList</code> implements it with a dynamically re-sizing array.</p>
<p>As with standard linked list and array operations, the various methods will have different algorithmic runtimes.</p>
<p>For <a href="http://docs.oracle.com/javase/8/docs/api/java/util/LinkedList.html" rel="noreferrer"><code>LinkedList&amp;lt;E&amp;gt;</code></a></p>
<ul>
<li>
<code>get(int index)</code> is <em>O(n)</em> (with <em>n/4</em> steps on average)
</li>
<li>
<code>add(E element)</code> is <em>O(1)</em>
</li>
<li>
<code>add(int index, E element)</code> is <em>O(n)</em> (with <em>n/4</em> steps on average), but <em>O(1)</em> when <code>index = 0</code> &lt;— main benefit of <code>LinkedList&amp;lt;E&amp;gt;</code>
</li>
<li>
<code>remove(int index)</code> is <em>O(n)</em> (with <em>n/4</em> steps on average)
</li>
<li>
<code>Iterator.remove()</code> is <em>O(1)</em>. &lt;— main benefit of <code>LinkedList&amp;lt;E&amp;gt;</code>
</li>
<li>
<code>ListIterator.add(E element)</code> is <em>O(1)</em> This is one of the main benefits of <code>LinkedList&amp;lt;E&amp;gt;</code>
</li>
</ul>
<p><sup>Note: Many of the operations need <em>n/4</em> steps on average, <em>constant</em> number of steps in the best case (e.g. index = 0), and <em>n/2</em> steps in worst case (middle of list)</sup></p>
<p>For <a href="http://docs.oracle.com/javase/8/docs/api/java/util/ArrayList.html" rel="noreferrer"><code>ArrayList&amp;lt;E&amp;gt;</code></a></p>
<ul>
<li>
<code>get(int index)</code> is <em>O(1)</em> &lt;— main benefit of <code>ArrayList&amp;lt;E&amp;gt;</code>
</li>
<li>
<code>add(E element)</code> is <em>O(1)</em> amortized, but <em>O(n)</em> worst-case since the array must be resized and copied
</li>
<li>
<code>add(int index, E element)</code> is <em>O(n)</em> (with <em>n/2</em> steps on average)
</li>
<li>
<code>remove(int index)</code> is <em>O(n)</em> (with <em>n/2</em> steps on average)
</li>
<li>
<code>Iterator.remove()</code> is <em>O(n)</em> (with <em>n/2</em> steps on average)
</li>
<li>
<code>ListIterator.add(E element)</code> is <em>O(n)</em> (with <em>n/2</em> steps on average)
</li>
</ul>
<p><sup>Note: Many of the operations need <em>n/2</em> steps on average, <em>constant</em> number of steps in the best case (end of list), <em>n</em> steps in the worst case (start of list)</sup></p>
<p><code>LinkedList&amp;lt;E&amp;gt;</code> allows for constant-time insertions or removals <em>using iterators</em>, but only sequential access of elements. In other words, you can walk the list forwards or backwards, but finding a position in the list takes time proportional to the size of the list. Javadoc says <em>“operations that index into the list will traverse the list from the beginning or the end, whichever is closer”</em>, so those methods are <em>O(n)</em> (<em>n/4</em> steps) on average, though <em>O(1)</em> for <code>index = 0</code>.</p>
<p><code>ArrayList&amp;lt;E&amp;gt;</code>, on the other hand, allow fast random read access, so you can grab any element in constant time. But adding or removing from anywhere but the end requires shifting all the latter elements over, either to make an opening or fill the gap. Also, if you add more elements than the capacity of the underlying array, a new array (1.5 times the size) is allocated, and the old array is copied to the new one, so adding to an <code>ArrayList</code> is <em>O(n)</em> in the worst case but constant on average.</p>
<p>So depending on the operations you intend to do, you should choose the implementations accordingly. Iterating over either kind of List is practically equally cheap. (Iterating over an <code>ArrayList</code> is technically faster, but unless you’re doing something really performance-sensitive, you shouldn’t worry about this – they’re both constants.)</p>
<p>The main benefits of using a <code>LinkedList</code> arise when you re-use existing iterators to insert and remove elements. These operations can then be done in <em>O(1)</em> by changing the list locally only. In an array list, the remainder of the array needs to be <em>moved</em> (i.e. copied). On the other side, seeking in a <code>LinkedList</code> means following the links in <em>O(n)</em> (<em>n/2</em> steps) for worst case, whereas in an <code>ArrayList</code> the desired position can be computed mathematically and accessed in <em>O(1)</em>.</p>
<p>Another benefit of using a <code>LinkedList</code> arise when you add or remove from the head of the list, since those operations are <em>O(1)</em>, while they are <em>O(n)</em> for <code>ArrayList</code>. Note that <code>ArrayDeque</code> may be a good alternative to <code>LinkedList</code> for adding and removing from the head, but it is not a <code>List</code>.</p>
<p>Also, if you have large lists, keep in mind that memory usage is also different. Each element of a <code>LinkedList</code> has more overhead since pointers to the next and previous elements are also stored. <code>ArrayLists</code> don’t have this overhead. However, <code>ArrayLists</code> take up as much memory as is allocated for the capacity, regardless of whether elements have actually been added.</p>
<p>The default initial capacity of an <code>ArrayList</code> is pretty small (10 from Java 1.4 - 1.8). But since the underlying implementation is an array, the array must be resized if you add a lot of elements. To avoid the high cost of resizing when you know you’re going to add a lot of elements, construct the <code>ArrayList</code> with a higher initial capacity.</p>
</section>
<section id="answer-2-score-605" class="level4">
<h4>Answer 2 (score 605)</h4>
<p>Thus far, nobody seems to have addressed the memory footprint of each of these lists besides the general consensus that a <code>LinkedList</code> is “lots more” than an <code>ArrayList</code> so I did some number crunching to demonstrate exactly how much both lists take up for N null references.</p>
<p>Since references are either 32 or 64 bits (even when null) on their relative systems, I have included 4 sets of data for 32 and 64 bit <code>LinkedLists</code> and <code>ArrayLists</code>.</p>
<p><strong>Note:</strong> The sizes shown for the <code>ArrayList</code> lines are for <em>trimmed lists</em> - In practice, the capacity of the backing array in an <code>ArrayList</code> is generally larger than its current element count.</p>
<p><strong>Note 2:</strong> <em>(thanks BeeOnRope)</em> As CompressedOops is default now from mid JDK6 and up, the values below for 64-bit machines will basically match their 32-bit counterparts, unless of course you specifically turn it off.</p>
<hr>
<p><img src="https://i.imgur.com/f83xDyz.png" alt="Graph of LinkedList and ArrayList No. of Elements x Bytes"></p>
<hr>
<p>The result clearly shows that <code>LinkedList</code> is a whole lot more than <code>ArrayList</code>, especially with a very high element count. If memory is a factor, steer clear of <code>LinkedLists</code>.</p>
<p>The formulas I used follow, let me know if I have done anything wrong and I will fix it up. ‘b’ is either 4 or 8 for 32 or 64 bit systems, and ‘n’ is the number of elements. Note the reason for the mods is because all objects in java will take up a multiple of 8 bytes space regardless of whether it is all used or not.</p>
<p><strong>ArrayList:</strong></p>
<p><code>ArrayList object header + size integer + modCount integer + array reference + (array oject header + b * n) + MOD(array oject, 8) + MOD(ArrayList object, 8) == 8 + 4 + 4 + b + (12 + b * n) + MOD(12 + b * n, 8) + MOD(8 + 4 + 4 + b + (12 + b * n) + MOD(12 + b * n, 8), 8)</code></p>
<p><strong>LinkedList:</strong></p>
<p><code>LinkedList object header + size integer + modCount integer + reference to header + reference to footer + (node object overhead + reference to previous element + reference to next element + reference to element) * n) + MOD(node object, 8) * n + MOD(LinkedList object, 8) == 8 + 4 + 4 + 2 * b + (8 + 3 * b) * n + MOD(8 + 3 * b, 8) * n + MOD(8 + 4 + 4 + 2 * b + (8 + 3 * b) * n + MOD(8 + 3 * b, 8) * n, 8)</code></p>
</section>
<section id="answer-3-score-226" class="level4">
<h4>Answer 3 (score 226)</h4>
<p><code>ArrayList</code> is what you want. <code>LinkedList</code> is almost always a (performance) bug.</p>
<p>Why <code>LinkedList</code> sucks:</p>
<ul>
<li>
It uses lots of small memory objects, and therefore impacts performance across the process.
</li>
<li>
Lots of small objects are bad for cache-locality.
</li>
<li>
Any indexed operation requires a traversal, i.e. has O(n) performance. This is not obvious in the source code, leading to algorithms O(n) slower than if <code>ArrayList</code> was used.
</li>
<li>
Getting good performance is tricky.
</li>
<li>
Even when big-O performance is the same as <code>ArrayList</code>, it is probably going to be significantly slower anyway.
</li>
<li>
It’s jarring to see <code>LinkedList</code> in source because it is probably the wrong choice.
</li>
</ul>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-to-use-java.net.urlconnection-to-fire-and-handle-http-requests-score-989794-in-2018" class="level3">
<h3>35: How to use java.net.URLConnection to fire and handle HTTP requests (score <a href="https://stackoverflow.com/q/2793150.html">989794</a> in 2018)</h3>
<section id="question-33" class="level4">
<h4>Question</h4>
<p>Use of <a href="http://docs.oracle.com/javase/8/docs/api/java/net/URLConnection.html" rel="noreferrer"><code>java.net.URLConnection</code></a> is asked about pretty often here, and the <a href="http://download.oracle.com/javase/tutorial/networking/urls/connecting.html" rel="noreferrer">Oracle tutorial</a> is <em>too</em> concise about it.</p>
<p>That tutorial basically only shows how to fire a GET request and read the response. It doesn’t explain anywhere how to use it to among others perform a POST request, set request headers, read response headers, deal with cookies, submit a HTML form, upload a file, etc.</p>
<p>So, how can I use <code>java.net.URLConnection</code> to fire and handle “advanced” HTTP requests?</p>
</section>
<section id="answer-accepted-score-2660" class="level4">
<h4>Answer accepted (score 2660)</h4>
<p><sup><em>First a disclaimer beforehand: the posted code snippets are all basic examples. You’ll need to handle trivial <code>IOException</code>s and <code>RuntimeException</code>s like <code>NullPointerException</code>, <code>ArrayIndexOutOfBoundsException</code> and consorts yourself.</em></sup></p>
<hr>
<h5>
Preparing
</h3>
<p>We first need to know at least the URL and the charset. The parameters are optional and depend on the functional requirements.</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true"></a><span class="bu">String</span> url = <span class="st">&quot;http://example.com&quot;</span>;</span>
<span id="cb291-2"><a href="#cb291-2" aria-hidden="true"></a><span class="bu">String</span> charset = <span class="st">&quot;UTF-8&quot;</span>;  <span class="co">// Or in Java 7 and later, use the constant: java.nio.charset.StandardCharsets.UTF_8.name()</span></span>
<span id="cb291-3"><a href="#cb291-3" aria-hidden="true"></a><span class="bu">String</span> param1 = <span class="st">&quot;value1&quot;</span>;</span>
<span id="cb291-4"><a href="#cb291-4" aria-hidden="true"></a><span class="bu">String</span> param2 = <span class="st">&quot;value2&quot;</span>;</span>
<span id="cb291-5"><a href="#cb291-5" aria-hidden="true"></a><span class="co">// ...</span></span>
<span id="cb291-6"><a href="#cb291-6" aria-hidden="true"></a></span>
<span id="cb291-7"><a href="#cb291-7" aria-hidden="true"></a><span class="bu">String</span> query = <span class="bu">String</span><span class="fu">.format</span>(<span class="st">&quot;param1=</span><span class="sc">%s</span><span class="st">&amp;param2=</span><span class="sc">%s</span><span class="st">&quot;</span>, </span>
<span id="cb291-8"><a href="#cb291-8" aria-hidden="true"></a>     <span class="bu">URLEncoder</span>.<span class="fu">encode</span>(param1, charset), </span>
<span id="cb291-9"><a href="#cb291-9" aria-hidden="true"></a>     <span class="bu">URLEncoder</span>.<span class="fu">encode</span>(param2, charset));</span></code></pre></div>
<p>The query parameters must be in <code>name=value</code> format and be concatenated by <code>&amp;amp;</code>. You would normally also <a href="http://en.wikipedia.org/wiki/Percent-encoding" rel="noreferrer">URL-encode</a> the query parameters with the specified charset using <a href="http://docs.oracle.com/javase/8/docs/api/java/net/URLEncoder.html
#encode-java.lang.String-java.lang.String-" rel="noreferrer"><code>URLEncoder#encode()</code></a>.</p>
<p><sup>The <code>String #format()</code> is just for convenience. I prefer it when I would need the String concatenation operator <code>+</code> more than twice.</sup></p>
<hr>
<h5>
Firing a <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html
#sec9.3" rel="noreferrer">HTTP GET</a> request with (optionally) query parameters
</h3>
<p>It’s a trivial task. It’s the default request method.</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true"></a><span class="bu">URLConnection</span> connection = <span class="kw">new</span> <span class="bu">URL</span>(url + <span class="st">&quot;?&quot;</span> + query).<span class="fu">openConnection</span>();</span>
<span id="cb292-2"><a href="#cb292-2" aria-hidden="true"></a>connection.<span class="fu">setRequestProperty</span>(<span class="st">&quot;Accept-Charset&quot;</span>, charset);</span>
<span id="cb292-3"><a href="#cb292-3" aria-hidden="true"></a><span class="bu">InputStream</span> response = connection.<span class="fu">getInputStream</span>();</span>
<span id="cb292-4"><a href="#cb292-4" aria-hidden="true"></a><span class="co">// ...</span></span></code></pre></div>
<p>Any query string should be concatenated to the URL using <code>?</code>. The <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html
#sec14.2" rel="noreferrer"><code>Accept-Charset</code></a> header may hint the server what encoding the parameters are in. If you don’t send any query string, then you can leave the <code>Accept-Charset</code> header away. If you don’t need to set any headers, then you can even use the <a href="http://docs.oracle.com/javase/8/docs/api/java/net/URL.html#openStream%28%29" rel="noreferrer"><code>URL#openStream()</code></a> shortcut method.</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true"></a><span class="bu">InputStream</span> response = <span class="kw">new</span> <span class="bu">URL</span>(url).<span class="fu">openStream</span>();</span>
<span id="cb293-2"><a href="#cb293-2" aria-hidden="true"></a><span class="co">// ...</span></span></code></pre></div>
<p>Either way, if the other side is a <a href="http://docs.oracle.com/javaee/7/api/javax/servlet/http/HttpServlet.html" rel="noreferrer"><code>HttpServlet</code></a>, then its <a href="http://docs.oracle.com/javaee/7/api/javax/servlet/http/HttpServlet.html
#doGet%28javax.servlet.http.HttpServletRequest,%20javax.servlet.http.HttpServletResponse%29" rel="noreferrer"><code>doGet()</code></a> method will be called and the parameters will be available by <a href="http://docs.oracle.com/javaee/7/api/javax/servlet/ServletRequest.html#getParameter%28java.lang.String%29" rel="noreferrer"><code>HttpServletRequest#getParameter()</code></a>.</p>
<p>For testing purposes, you can print the response body to stdout as below:</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true"></a><span class="kw">try</span> (<span class="bu">Scanner</span> scanner = <span class="kw">new</span> <span class="bu">Scanner</span>(response)) {</span>
<span id="cb294-2"><a href="#cb294-2" aria-hidden="true"></a>    <span class="bu">String</span> responseBody = scanner.<span class="fu">useDelimiter</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">A&quot;</span>).<span class="fu">next</span>();</span>
<span id="cb294-3"><a href="#cb294-3" aria-hidden="true"></a>    <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(responseBody);</span>
<span id="cb294-4"><a href="#cb294-4" aria-hidden="true"></a>}</span></code></pre></div>
<hr>
<h5>
Firing a <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html
#sec9.5" rel="noreferrer">HTTP POST</a> request with query parameters
</h3>
<p>Setting the <a href="http://docs.oracle.com/javase/8/docs/api/java/net/URLConnection.html
#setDoOutput%28boolean%29" rel="noreferrer"><code>URLConnection#setDoOutput()</code></a> to <code>true</code> implicitly sets the request method to POST. The standard HTTP POST as web forms do is of type <code>application/x-www-form-urlencoded</code> wherein the query string is written to the request body.</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true"></a><span class="bu">URLConnection</span> connection = <span class="kw">new</span> <span class="bu">URL</span>(url).<span class="fu">openConnection</span>();</span>
<span id="cb295-2"><a href="#cb295-2" aria-hidden="true"></a>connection.<span class="fu">setDoOutput</span>(<span class="kw">true</span>); <span class="co">// Triggers POST.</span></span>
<span id="cb295-3"><a href="#cb295-3" aria-hidden="true"></a>connection.<span class="fu">setRequestProperty</span>(<span class="st">&quot;Accept-Charset&quot;</span>, charset);</span>
<span id="cb295-4"><a href="#cb295-4" aria-hidden="true"></a>connection.<span class="fu">setRequestProperty</span>(<span class="st">&quot;Content-Type&quot;</span>, <span class="st">&quot;application/x-www-form-urlencoded;charset=&quot;</span> + charset);</span>
<span id="cb295-5"><a href="#cb295-5" aria-hidden="true"></a></span>
<span id="cb295-6"><a href="#cb295-6" aria-hidden="true"></a><span class="kw">try</span> (<span class="bu">OutputStream</span> output = connection.<span class="fu">getOutputStream</span>()) {</span>
<span id="cb295-7"><a href="#cb295-7" aria-hidden="true"></a>    output.<span class="fu">write</span>(query.<span class="fu">getBytes</span>(charset));</span>
<span id="cb295-8"><a href="#cb295-8" aria-hidden="true"></a>}</span>
<span id="cb295-9"><a href="#cb295-9" aria-hidden="true"></a></span>
<span id="cb295-10"><a href="#cb295-10" aria-hidden="true"></a><span class="bu">InputStream</span> response = connection.<span class="fu">getInputStream</span>();</span>
<span id="cb295-11"><a href="#cb295-11" aria-hidden="true"></a><span class="co">// ...</span></span></code></pre></div>
<p>Note: whenever you’d like to submit a HTML form programmatically, don’t forget to take the <code>name=value</code> pairs of any <code>&amp;lt;input type="hidden"&amp;gt;</code> elements into the query string and of course also the <code>name=value</code> pair of the <code>&amp;lt;input type="submit"&amp;gt;</code> element which you’d like to “press” programmatically (because that’s usually been used in the server side to distinguish if a button was pressed and if so, which one).</p>
<p>You can also cast the obtained <a href="http://docs.oracle.com/javase/8/docs/api/java/net/URLConnection.html" rel="noreferrer"><code>URLConnection</code></a> to <a href="http://docs.oracle.com/javase/8/docs/api/java/net/HttpURLConnection.html" rel="noreferrer"><code>HttpURLConnection</code></a> and use its <a href="http://docs.oracle.com/javase/8/docs/api/java/net/HttpURLConnection.html
#setRequestMethod%28java.lang.String%29" rel="noreferrer"><code>HttpURLConnection#setRequestMethod()</code></a> instead. But if you’re trying to use the connection for output you still need to set <a href="http://docs.oracle.com/javase/8/docs/api/java/net/URLConnection.html#setDoOutput%28boolean%29" rel="noreferrer"><code>URLConnection#setDoOutput()</code></a> to <code>true</code>.</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true"></a><span class="bu">HttpURLConnection</span> httpConnection = (<span class="bu">HttpURLConnection</span>) <span class="kw">new</span> <span class="bu">URL</span>(url).<span class="fu">openConnection</span>();</span>
<span id="cb296-2"><a href="#cb296-2" aria-hidden="true"></a>httpConnection.<span class="fu">setRequestMethod</span>(<span class="st">&quot;POST&quot;</span>);</span>
<span id="cb296-3"><a href="#cb296-3" aria-hidden="true"></a><span class="co">// ...</span></span></code></pre></div>
<p>Either way, if the other side is a <a href="http://docs.oracle.com/javaee/7/api/javax/servlet/http/HttpServlet.html" rel="noreferrer"><code>HttpServlet</code></a>, then its <a href="http://docs.oracle.com/javaee/7/api/javax/servlet/http/HttpServlet.html
#doPost%28javax.servlet.http.HttpServletRequest,%20javax.servlet.http.HttpServletResponse%29" rel="noreferrer"><code>doPost()</code></a> method will be called and the parameters will be available by <a href="http://docs.oracle.com/javaee/7/api/javax/servlet/ServletRequest.html#getParameter%28java.lang.String%29" rel="noreferrer"><code>HttpServletRequest#getParameter()</code></a>.</p>
<hr>
<h5>
Actually firing the HTTP request
</h3>
<p>You can fire the HTTP request explicitly with <a href="http://docs.oracle.com/javase/8/docs/api/java/net/URLConnection.html
#connect%28%29" rel="noreferrer"><code>URLConnection#connect()</code></a>, but the request will automatically be fired on demand when you want to get any information about the HTTP response, such as the response body using <a href="http://docs.oracle.com/javase/8/docs/api/java/net/URLConnection.html#getInputStream%28%29" rel="noreferrer"><code>URLConnection#getInputStream()</code></a> and so on. The above examples does exactly that, so the <code>connect()</code> call is in fact superfluous.</p>
<hr>
<h5>
Gathering HTTP response information
</h3>
<ol>
<li>
<p>
<a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html" rel="noreferrer">HTTP response status</a>:
</p>
<p>You need a <a href="http://docs.oracle.com/javase/8/docs/api/java/net/HttpURLConnection.html" rel="noreferrer"><code>HttpURLConnection</code></a> here. Cast it first if necessary.</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true"></a><span class="dt">int</span> status = httpConnection.<span class="fu">getResponseCode</span>();</span>
<span id="cb297-2"><a href="#cb297-2" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb297-3"><a href="#cb297-3" aria-hidden="true"></a>&lt;li&gt;&lt;p&gt;&lt;a href=<span class="st">&quot;http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html&quot;</span> rel=<span class="st">&quot;noreferrer&quot;</span>&gt;HTTP response headers&lt;/a&gt;:&lt;/p&gt;</span>
<span id="cb297-4"><a href="#cb297-4" aria-hidden="true"></a></span>
<span id="cb297-5"><a href="#cb297-5" aria-hidden="true"></a>```java</span>
<span id="cb297-6"><a href="#cb297-6" aria-hidden="true"></a><span class="kw">for</span> (Entry&lt;<span class="bu">String</span>, <span class="bu">List</span>&lt;<span class="bu">String</span>&gt;&gt; header : connection.<span class="fu">getHeaderFields</span>().<span class="fu">entrySet</span>()) {</span>
<span id="cb297-7"><a href="#cb297-7" aria-hidden="true"></a>    <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(header.<span class="fu">getKey</span>() + <span class="st">&quot;=&quot;</span> + header.<span class="fu">getValue</span>());</span>
<span id="cb297-8"><a href="#cb297-8" aria-hidden="true"></a>}</span>
<span id="cb297-9"><a href="#cb297-9" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb297-10"><a href="#cb297-10" aria-hidden="true"></a>&lt;li&gt;&lt;p&gt;&lt;a href=<span class="st">&quot;http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html</span></span>
<span id="cb297-11"><a href="#cb297-11" aria-hidden="true"></a>#sec14<span class="fl">.17</span><span class="st">&quot; rel=&quot;</span>noreferrer<span class="st">&quot;&gt;HTTP response encoding&lt;/a&gt;:&lt;/p&gt;</span></span>
<span id="cb297-12"><a href="#cb297-12" aria-hidden="true"></a></span>
<span id="cb297-13"><a href="#cb297-13" aria-hidden="true"></a>When the `Content-Type` contains a `charset` parameter, then the response body is likely text based and we&#39;d like to process the response body with the server-side specified character encoding then.  </span>
<span id="cb297-14"><a href="#cb297-14" aria-hidden="true"></a></span>
<span id="cb297-15"><a href="#cb297-15" aria-hidden="true"></a>```java</span>
<span id="cb297-16"><a href="#cb297-16" aria-hidden="true"></a><span class="bu">String</span> contentType = connection.<span class="fu">getHeaderField</span>(<span class="st">&quot;Content-Type&quot;</span>);</span>
<span id="cb297-17"><a href="#cb297-17" aria-hidden="true"></a><span class="bu">String</span> charset = <span class="kw">null</span>;</span>
<span id="cb297-18"><a href="#cb297-18" aria-hidden="true"></a></span>
<span id="cb297-19"><a href="#cb297-19" aria-hidden="true"></a><span class="kw">for</span> (<span class="bu">String</span> param : contentType.<span class="fu">replace</span>(<span class="st">&quot; &quot;</span>, <span class="st">&quot;&quot;</span>).<span class="fu">split</span>(<span class="st">&quot;;&quot;</span>)) {</span>
<span id="cb297-20"><a href="#cb297-20" aria-hidden="true"></a>    <span class="kw">if</span> (param.<span class="fu">startsWith</span>(<span class="st">&quot;charset=&quot;</span>)) {</span>
<span id="cb297-21"><a href="#cb297-21" aria-hidden="true"></a>        charset = param.<span class="fu">split</span>(<span class="st">&quot;=&quot;</span>, <span class="dv">2</span>)[<span class="dv">1</span>];</span>
<span id="cb297-22"><a href="#cb297-22" aria-hidden="true"></a>        <span class="kw">break</span>;</span>
<span id="cb297-23"><a href="#cb297-23" aria-hidden="true"></a>    }</span>
<span id="cb297-24"><a href="#cb297-24" aria-hidden="true"></a>}</span>
<span id="cb297-25"><a href="#cb297-25" aria-hidden="true"></a></span>
<span id="cb297-26"><a href="#cb297-26" aria-hidden="true"></a><span class="kw">if</span> (charset != <span class="kw">null</span>) {</span>
<span id="cb297-27"><a href="#cb297-27" aria-hidden="true"></a>    <span class="kw">try</span> (<span class="bu">BufferedReader</span> reader = <span class="kw">new</span> <span class="bu">BufferedReader</span>(<span class="kw">new</span> <span class="bu">InputStreamReader</span>(response, charset))) {</span>
<span id="cb297-28"><a href="#cb297-28" aria-hidden="true"></a>        <span class="kw">for</span> (<span class="bu">String</span> line; (line = reader.<span class="fu">readLine</span>()) != <span class="kw">null</span>;) {</span>
<span id="cb297-29"><a href="#cb297-29" aria-hidden="true"></a>            <span class="co">// ... System.out.println(line) ?</span></span>
<span id="cb297-30"><a href="#cb297-30" aria-hidden="true"></a>        }</span>
<span id="cb297-31"><a href="#cb297-31" aria-hidden="true"></a>    }</span>
<span id="cb297-32"><a href="#cb297-32" aria-hidden="true"></a>} <span class="kw">else</span> {</span>
<span id="cb297-33"><a href="#cb297-33" aria-hidden="true"></a>    <span class="co">// It&#39;s likely binary content, use InputStream/OutputStream.</span></span>
<span id="cb297-34"><a href="#cb297-34" aria-hidden="true"></a>}</span>
<span id="cb297-35"><a href="#cb297-35" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb297-36"><a href="#cb297-36" aria-hidden="true"></a>&lt;/ol&gt;</span>
<span id="cb297-37"><a href="#cb297-37" aria-hidden="true"></a></span>
<span id="cb297-38"><a href="#cb297-38" aria-hidden="true"></a>&lt;hr&gt;</span>
<span id="cb297-39"><a href="#cb297-39" aria-hidden="true"></a></span>
<span id="cb297-40"><a href="#cb297-40" aria-hidden="true"></a>&lt;h5&gt;Maintaining the session&lt;/h3&gt;</span>
<span id="cb297-41"><a href="#cb297-41" aria-hidden="true"></a></span>
<span id="cb297-42"><a href="#cb297-42" aria-hidden="true"></a>The server side session is usually backed by a cookie. Some web forms require that you&#39;re logged in and/or are tracked by a session. You can use the &lt;a href=<span class="st">&quot;http://docs.oracle.com/javase/8/docs/api/java/net/CookieHandler.html&quot;</span> rel=<span class="st">&quot;noreferrer&quot;</span>&gt;`CookieHandler`&lt;/a&gt; API to maintain cookies. You need to prepare a &lt;a href=<span class="st">&quot;http://docs.oracle.com/javase/8/docs/api/java/net/CookieManager.html&quot;</span> rel=<span class="st">&quot;noreferrer&quot;</span>&gt;`CookieManager`&lt;/a&gt; with a &lt;a href=<span class="st">&quot;http://docs.oracle.com/javase/8/docs/api/java/net/CookiePolicy.html&quot;</span> rel=<span class="st">&quot;noreferrer&quot;</span>&gt;`CookiePolicy`&lt;/a&gt; of &lt;a href=<span class="st">&quot;http://docs.oracle.com/javase/8/docs/api/java/net/CookiePolicy.html</span></span>
<span id="cb297-43"><a href="#cb297-43" aria-hidden="true"></a>#ACCEPT_ALL<span class="st">&quot; rel=&quot;</span>noreferrer<span class="st">&quot;&gt;`ACCEPT_ALL`&lt;/a&gt; before sending all HTTP requests.  </span></span>
<span id="cb297-44"><a href="#cb297-44" aria-hidden="true"></a></span>
<span id="cb297-45"><a href="#cb297-45" aria-hidden="true"></a>```java</span>
<span id="cb297-46"><a href="#cb297-46" aria-hidden="true"></a><span class="co">// First set the default cookie manager.</span></span>
<span id="cb297-47"><a href="#cb297-47" aria-hidden="true"></a><span class="bu">CookieHandler</span>.<span class="fu">setDefault</span>(<span class="kw">new</span> <span class="bu">CookieManager</span>(<span class="kw">null</span>, <span class="bu">CookiePolicy</span>.<span class="fu">ACCEPT_ALL</span>));</span>
<span id="cb297-48"><a href="#cb297-48" aria-hidden="true"></a></span>
<span id="cb297-49"><a href="#cb297-49" aria-hidden="true"></a><span class="co">// All the following subsequent URLConnections will use the same cookie manager.</span></span>
<span id="cb297-50"><a href="#cb297-50" aria-hidden="true"></a><span class="bu">URLConnection</span> connection = <span class="kw">new</span> <span class="bu">URL</span>(url).<span class="fu">openConnection</span>();</span>
<span id="cb297-51"><a href="#cb297-51" aria-hidden="true"></a><span class="co">// ...</span></span>
<span id="cb297-52"><a href="#cb297-52" aria-hidden="true"></a></span>
<span id="cb297-53"><a href="#cb297-53" aria-hidden="true"></a>connection = <span class="kw">new</span> <span class="bu">URL</span>(url).<span class="fu">openConnection</span>();</span>
<span id="cb297-54"><a href="#cb297-54" aria-hidden="true"></a><span class="co">// ...</span></span>
<span id="cb297-55"><a href="#cb297-55" aria-hidden="true"></a></span>
<span id="cb297-56"><a href="#cb297-56" aria-hidden="true"></a>connection = <span class="kw">new</span> <span class="bu">URL</span>(url).<span class="fu">openConnection</span>();</span>
<span id="cb297-57"><a href="#cb297-57" aria-hidden="true"></a><span class="co">// ...</span></span></code></pre></div>
<p>Note that this is known to not always work properly in all circumstances. If it fails for you, then best is to manually gather and set the cookie headers. You basically need to grab all <code>Set-Cookie</code> headers from the response of the login or the first <code>GET</code> request and then pass this through the subsequent requests.</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true"></a><span class="co">// Gather all cookies on the first request.</span></span>
<span id="cb298-2"><a href="#cb298-2" aria-hidden="true"></a><span class="bu">URLConnection</span> connection = <span class="kw">new</span> <span class="bu">URL</span>(url).<span class="fu">openConnection</span>();</span>
<span id="cb298-3"><a href="#cb298-3" aria-hidden="true"></a><span class="bu">List</span>&lt;<span class="bu">String</span>&gt; cookies = connection.<span class="fu">getHeaderFields</span>().<span class="fu">get</span>(<span class="st">&quot;Set-Cookie&quot;</span>);</span>
<span id="cb298-4"><a href="#cb298-4" aria-hidden="true"></a><span class="co">// ...</span></span>
<span id="cb298-5"><a href="#cb298-5" aria-hidden="true"></a></span>
<span id="cb298-6"><a href="#cb298-6" aria-hidden="true"></a><span class="co">// Then use the same cookies on all subsequent requests.</span></span>
<span id="cb298-7"><a href="#cb298-7" aria-hidden="true"></a>connection = <span class="kw">new</span> <span class="bu">URL</span>(url).<span class="fu">openConnection</span>();</span>
<span id="cb298-8"><a href="#cb298-8" aria-hidden="true"></a><span class="kw">for</span> (<span class="bu">String</span> cookie : cookies) {</span>
<span id="cb298-9"><a href="#cb298-9" aria-hidden="true"></a>    connection.<span class="fu">addRequestProperty</span>(<span class="st">&quot;Cookie&quot;</span>, cookie.<span class="fu">split</span>(<span class="st">&quot;;&quot;</span>, <span class="dv">2</span>)[<span class="dv">0</span>]);</span>
<span id="cb298-10"><a href="#cb298-10" aria-hidden="true"></a>}</span>
<span id="cb298-11"><a href="#cb298-11" aria-hidden="true"></a><span class="co">// ...</span></span></code></pre></div>
<p>The <code>split(";", 2)[0]</code> is there to get rid of cookie attributes which are irrelevant for the server side like <code>expires</code>, <code>path</code>, etc. Alternatively, you could also use <code>cookie.substring(0, cookie.indexOf(';'))</code> instead of <code>split()</code>.</p>
<hr>
<h5>
Streaming mode
</h3>
<p>The <a href="http://docs.oracle.com/javase/8/docs/api/java/net/HttpURLConnection.html" rel="noreferrer"><code>HttpURLConnection</code></a> will by default buffer the <em>entire</em> request body before actually sending it, regardless of whether you’ve set a fixed content length yourself using <code>connection.setRequestProperty("Content-Length", contentLength);</code>. This may cause <code>OutOfMemoryException</code>s whenever you concurrently send large POST requests (e.g. uploading files). To avoid this, you would like to set the <a href="http://docs.oracle.com/javase/8/docs/api/java/net/HttpURLConnection.html
#setFixedLengthStreamingMode%28int%29" rel="noreferrer"><code>HttpURLConnection#setFixedLengthStreamingMode()</code></a>.</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true"></a>httpConnection.<span class="fu">setFixedLengthStreamingMode</span>(contentLength);</span></code></pre></div>
<p>But if the content length is really not known beforehand, then you can make use of chunked streaming mode by setting the <a href="http://docs.oracle.com/javase/8/docs/api/java/net/HttpURLConnection.html
#setChunkedStreamingMode%28int%29" rel="noreferrer"><code>HttpURLConnection#setChunkedStreamingMode()</code></a> accordingly. This will set the HTTP <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.41" rel="noreferrer"><code>Transfer-Encoding</code></a> header to <code>chunked</code> which will force the request body being sent in chunks. The below example will send the body in chunks of 1KB.</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb300-1"><a href="#cb300-1" aria-hidden="true"></a>httpConnection.<span class="fu">setChunkedStreamingMode</span>(<span class="dv">1024</span>);</span></code></pre></div>
<hr>
<h5>
User-Agent
</h3>
<p>It can happen that <a href="https://stackoverflow.com/questions/13670692/403-forbidden-with-java-but-not-web-browser">a request returns an unexpected response, while it works fine with a real web browser</a>. The server side is probably blocking requests based on the <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html
#sec14.43" rel="noreferrer"><code>User-Agent</code></a> request header. The <code>URLConnection</code> will by default set it to <code>Java/1.6.0_19</code> where the last part is obviously the JRE version. You can override this as follows:</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true"></a>connection.<span class="fu">setRequestProperty</span>(<span class="st">&quot;User-Agent&quot;</span>, <span class="st">&quot;Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.36&quot;</span>); <span class="co">// Do as if you&#39;re using Chrome 41 on Windows 7.</span></span></code></pre></div>
<p>Use the User-Agent string from a <a href="http://www.useragentstring.com/pages/useragentstring.php" rel="noreferrer">recent browser</a>.</p>
<hr>
<h5>
Error handling
</h3>
<p>If the HTTP response code is <code>4nn</code> (Client Error) or <code>5nn</code> (Server Error), then you may want to read the <code>HttpURLConnection #getErrorStream()</code> to see if the server has sent any useful error information.</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true"></a><span class="bu">InputStream</span> error = ((<span class="bu">HttpURLConnection</span>) connection).<span class="fu">getErrorStream</span>();</span></code></pre></div>
<p>If the HTTP response code is -1, then something went wrong with connection and response handling. The <code>HttpURLConnection</code> implementation is in older JREs somewhat buggy with keeping connections alive. You may want to turn it off by setting the <code>http.keepAlive</code> system property to <code>false</code>. You can do this programmatically in the beginning of your application by:</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true"></a><span class="bu">System</span>.<span class="fu">setProperty</span>(<span class="st">&quot;http.keepAlive&quot;</span>, <span class="st">&quot;false&quot;</span>);</span></code></pre></div>
<hr>
<h5>
Uploading files
</h3>
<p>You’d normally use <a href="http://www.w3.org/TR/html401/interact/forms.html
#h-17.13.4.2" rel="noreferrer"><code>multipart/form-data</code></a> encoding for mixed POST content (binary and character data). The encoding is in more detail described in <a href="http://www.faqs.org/rfcs/rfc2388.html" rel="noreferrer">RFC2388</a>.</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb304-1"><a href="#cb304-1" aria-hidden="true"></a><span class="bu">String</span> param = <span class="st">&quot;value&quot;</span>;</span>
<span id="cb304-2"><a href="#cb304-2" aria-hidden="true"></a><span class="bu">File</span> textFile = <span class="kw">new</span> <span class="bu">File</span>(<span class="st">&quot;/path/to/file.txt&quot;</span>);</span>
<span id="cb304-3"><a href="#cb304-3" aria-hidden="true"></a><span class="bu">File</span> binaryFile = <span class="kw">new</span> <span class="bu">File</span>(<span class="st">&quot;/path/to/file.bin&quot;</span>);</span>
<span id="cb304-4"><a href="#cb304-4" aria-hidden="true"></a><span class="bu">String</span> boundary = <span class="bu">Long</span>.<span class="fu">toHexString</span>(<span class="bu">System</span>.<span class="fu">currentTimeMillis</span>()); <span class="co">// Just generate some unique random value.</span></span>
<span id="cb304-5"><a href="#cb304-5" aria-hidden="true"></a><span class="bu">String</span> CRLF = <span class="st">&quot;</span><span class="sc">\r\n</span><span class="st">&quot;</span>; <span class="co">// Line separator required by multipart/form-data.</span></span>
<span id="cb304-6"><a href="#cb304-6" aria-hidden="true"></a><span class="bu">URLConnection</span> connection = <span class="kw">new</span> <span class="bu">URL</span>(url).<span class="fu">openConnection</span>();</span>
<span id="cb304-7"><a href="#cb304-7" aria-hidden="true"></a>connection.<span class="fu">setDoOutput</span>(<span class="kw">true</span>);</span>
<span id="cb304-8"><a href="#cb304-8" aria-hidden="true"></a>connection.<span class="fu">setRequestProperty</span>(<span class="st">&quot;Content-Type&quot;</span>, <span class="st">&quot;multipart/form-data; boundary=&quot;</span> + boundary);</span>
<span id="cb304-9"><a href="#cb304-9" aria-hidden="true"></a></span>
<span id="cb304-10"><a href="#cb304-10" aria-hidden="true"></a><span class="kw">try</span> (</span>
<span id="cb304-11"><a href="#cb304-11" aria-hidden="true"></a>    <span class="bu">OutputStream</span> output = connection.<span class="fu">getOutputStream</span>();</span>
<span id="cb304-12"><a href="#cb304-12" aria-hidden="true"></a>    <span class="bu">PrintWriter</span> writer = <span class="kw">new</span> <span class="bu">PrintWriter</span>(<span class="kw">new</span> <span class="bu">OutputStreamWriter</span>(output, charset), <span class="kw">true</span>);</span>
<span id="cb304-13"><a href="#cb304-13" aria-hidden="true"></a>) {</span>
<span id="cb304-14"><a href="#cb304-14" aria-hidden="true"></a>    <span class="co">// Send normal param.</span></span>
<span id="cb304-15"><a href="#cb304-15" aria-hidden="true"></a>    writer.<span class="fu">append</span>(<span class="st">&quot;--&quot;</span> + boundary).<span class="fu">append</span>(CRLF);</span>
<span id="cb304-16"><a href="#cb304-16" aria-hidden="true"></a>    writer.<span class="fu">append</span>(<span class="st">&quot;Content-Disposition: form-data; name=</span><span class="sc">\&quot;</span><span class="st">param</span><span class="sc">\&quot;</span><span class="st">&quot;</span>).<span class="fu">append</span>(CRLF);</span>
<span id="cb304-17"><a href="#cb304-17" aria-hidden="true"></a>    writer.<span class="fu">append</span>(<span class="st">&quot;Content-Type: text/plain; charset=&quot;</span> + charset).<span class="fu">append</span>(CRLF);</span>
<span id="cb304-18"><a href="#cb304-18" aria-hidden="true"></a>    writer.<span class="fu">append</span>(CRLF).<span class="fu">append</span>(param).<span class="fu">append</span>(CRLF).<span class="fu">flush</span>();</span>
<span id="cb304-19"><a href="#cb304-19" aria-hidden="true"></a></span>
<span id="cb304-20"><a href="#cb304-20" aria-hidden="true"></a>    <span class="co">// Send text file.</span></span>
<span id="cb304-21"><a href="#cb304-21" aria-hidden="true"></a>    writer.<span class="fu">append</span>(<span class="st">&quot;--&quot;</span> + boundary).<span class="fu">append</span>(CRLF);</span>
<span id="cb304-22"><a href="#cb304-22" aria-hidden="true"></a>    writer.<span class="fu">append</span>(<span class="st">&quot;Content-Disposition: form-data; name=</span><span class="sc">\&quot;</span><span class="st">textFile</span><span class="sc">\&quot;</span><span class="st">; filename=</span><span class="sc">\&quot;</span><span class="st">&quot;</span> + textFile.<span class="fu">getName</span>() + <span class="st">&quot;</span><span class="sc">\&quot;</span><span class="st">&quot;</span>).<span class="fu">append</span>(CRLF);</span>
<span id="cb304-23"><a href="#cb304-23" aria-hidden="true"></a>    writer.<span class="fu">append</span>(<span class="st">&quot;Content-Type: text/plain; charset=&quot;</span> + charset).<span class="fu">append</span>(CRLF); <span class="co">// Text file itself must be saved in this charset!</span></span>
<span id="cb304-24"><a href="#cb304-24" aria-hidden="true"></a>    writer.<span class="fu">append</span>(CRLF).<span class="fu">flush</span>();</span>
<span id="cb304-25"><a href="#cb304-25" aria-hidden="true"></a>    Files.<span class="fu">copy</span>(textFile.<span class="fu">toPath</span>(), output);</span>
<span id="cb304-26"><a href="#cb304-26" aria-hidden="true"></a>    output.<span class="fu">flush</span>(); <span class="co">// Important before continuing with writer!</span></span>
<span id="cb304-27"><a href="#cb304-27" aria-hidden="true"></a>    writer.<span class="fu">append</span>(CRLF).<span class="fu">flush</span>(); <span class="co">// CRLF is important! It indicates end of boundary.</span></span>
<span id="cb304-28"><a href="#cb304-28" aria-hidden="true"></a></span>
<span id="cb304-29"><a href="#cb304-29" aria-hidden="true"></a>    <span class="co">// Send binary file.</span></span>
<span id="cb304-30"><a href="#cb304-30" aria-hidden="true"></a>    writer.<span class="fu">append</span>(<span class="st">&quot;--&quot;</span> + boundary).<span class="fu">append</span>(CRLF);</span>
<span id="cb304-31"><a href="#cb304-31" aria-hidden="true"></a>    writer.<span class="fu">append</span>(<span class="st">&quot;Content-Disposition: form-data; name=</span><span class="sc">\&quot;</span><span class="st">binaryFile</span><span class="sc">\&quot;</span><span class="st">; filename=</span><span class="sc">\&quot;</span><span class="st">&quot;</span> + binaryFile.<span class="fu">getName</span>() + <span class="st">&quot;</span><span class="sc">\&quot;</span><span class="st">&quot;</span>).<span class="fu">append</span>(CRLF);</span>
<span id="cb304-32"><a href="#cb304-32" aria-hidden="true"></a>    writer.<span class="fu">append</span>(<span class="st">&quot;Content-Type: &quot;</span> + <span class="bu">URLConnection</span>.<span class="fu">guessContentTypeFromName</span>(binaryFile.<span class="fu">getName</span>())).<span class="fu">append</span>(CRLF);</span>
<span id="cb304-33"><a href="#cb304-33" aria-hidden="true"></a>    writer.<span class="fu">append</span>(<span class="st">&quot;Content-Transfer-Encoding: binary&quot;</span>).<span class="fu">append</span>(CRLF);</span>
<span id="cb304-34"><a href="#cb304-34" aria-hidden="true"></a>    writer.<span class="fu">append</span>(CRLF).<span class="fu">flush</span>();</span>
<span id="cb304-35"><a href="#cb304-35" aria-hidden="true"></a>    Files.<span class="fu">copy</span>(binaryFile.<span class="fu">toPath</span>(), output);</span>
<span id="cb304-36"><a href="#cb304-36" aria-hidden="true"></a>    output.<span class="fu">flush</span>(); <span class="co">// Important before continuing with writer!</span></span>
<span id="cb304-37"><a href="#cb304-37" aria-hidden="true"></a>    writer.<span class="fu">append</span>(CRLF).<span class="fu">flush</span>(); <span class="co">// CRLF is important! It indicates end of boundary.</span></span>
<span id="cb304-38"><a href="#cb304-38" aria-hidden="true"></a></span>
<span id="cb304-39"><a href="#cb304-39" aria-hidden="true"></a>    <span class="co">// End of multipart/form-data.</span></span>
<span id="cb304-40"><a href="#cb304-40" aria-hidden="true"></a>    writer.<span class="fu">append</span>(<span class="st">&quot;--&quot;</span> + boundary + <span class="st">&quot;--&quot;</span>).<span class="fu">append</span>(CRLF).<span class="fu">flush</span>();</span>
<span id="cb304-41"><a href="#cb304-41" aria-hidden="true"></a>}</span></code></pre></div>
<p>If the other side is a <a href="http://docs.oracle.com/javaee/7/api/javax/servlet/http/HttpServlet.html" rel="noreferrer"><code>HttpServlet</code></a>, then its <a href="http://docs.oracle.com/javaee/7/api/javax/servlet/http/HttpServlet.html
#doPost%28javax.servlet.http.HttpServletRequest,%20javax.servlet.http.HttpServletResponse%29" rel="noreferrer"><code>doPost()</code></a> method will be called and the parts will be available by <a href="http://docs.oracle.com/javaee/7/api/javax/servlet/http/HttpServletRequest.html#getPart%28java.lang.String%29" rel="noreferrer"><code>HttpServletRequest#getPart()</code></a> (note, thus <strong>not</strong> <code>getParameter()</code> and so on!). The <code>getPart()</code> method is however relatively new, it’s introduced in Servlet 3.0 (Glassfish 3, Tomcat 7, etc). Prior to Servlet 3.0, your best choice is using <a href="http://commons.apache.org/fileupload" rel="noreferrer">Apache Commons FileUpload</a> to parse a <code>multipart/form-data</code> request. Also see <a href="https://stackoverflow.com/questions/2422468/upload-big-file-to-servlet/2424824#2424824">this answer</a> for examples of both the FileUpload and the Servelt 3.0 approaches.</p>
<hr>
<h5>
Dealing with untrusted or misconfigured HTTPS sites
</h3>
<p>Sometimes you need to connect a HTTPS URL, perhaps because you’re writing a web scraper. In that case, you may likely face a <code>javax.net.ssl.SSLException: Not trusted server certificate</code> on some HTTPS sites who doesn’t keep their SSL certificates up to date, or a <code>java.security.cert.CertificateException: No subject alternative DNS name matching [hostname] found</code> or <code>javax.net.ssl.SSLProtocolException: handshake alert: unrecognized_name</code> on some misconfigured HTTPS sites.</p>
<p>The following one-time-run <code>static</code> initializer in your web scraper class should make <code>HttpsURLConnection</code> more lenient as to those HTTPS sites and thus not throw those exceptions anymore.</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true"></a><span class="dt">static</span> {</span>
<span id="cb305-2"><a href="#cb305-2" aria-hidden="true"></a>    <span class="bu">TrustManager</span>[] trustAllCertificates = <span class="kw">new</span> <span class="bu">TrustManager</span>[] {</span>
<span id="cb305-3"><a href="#cb305-3" aria-hidden="true"></a>        <span class="kw">new</span> <span class="bu">X509TrustManager</span>() {</span>
<span id="cb305-4"><a href="#cb305-4" aria-hidden="true"></a>            <span class="at">@Override</span></span>
<span id="cb305-5"><a href="#cb305-5" aria-hidden="true"></a>            <span class="kw">public</span> <span class="bu">X509Certificate</span>[] <span class="fu">getAcceptedIssuers</span>() {</span>
<span id="cb305-6"><a href="#cb305-6" aria-hidden="true"></a>                <span class="kw">return</span> <span class="kw">null</span>; <span class="co">// Not relevant.</span></span>
<span id="cb305-7"><a href="#cb305-7" aria-hidden="true"></a>            }</span>
<span id="cb305-8"><a href="#cb305-8" aria-hidden="true"></a>            <span class="at">@Override</span></span>
<span id="cb305-9"><a href="#cb305-9" aria-hidden="true"></a>            <span class="kw">public</span> <span class="dt">void</span> <span class="fu">checkClientTrusted</span>(<span class="bu">X509Certificate</span>[] certs, <span class="bu">String</span> authType) {</span>
<span id="cb305-10"><a href="#cb305-10" aria-hidden="true"></a>                <span class="co">// Do nothing. Just allow them all.</span></span>
<span id="cb305-11"><a href="#cb305-11" aria-hidden="true"></a>            }</span>
<span id="cb305-12"><a href="#cb305-12" aria-hidden="true"></a>            <span class="at">@Override</span></span>
<span id="cb305-13"><a href="#cb305-13" aria-hidden="true"></a>            <span class="kw">public</span> <span class="dt">void</span> <span class="fu">checkServerTrusted</span>(<span class="bu">X509Certificate</span>[] certs, <span class="bu">String</span> authType) {</span>
<span id="cb305-14"><a href="#cb305-14" aria-hidden="true"></a>                <span class="co">// Do nothing. Just allow them all.</span></span>
<span id="cb305-15"><a href="#cb305-15" aria-hidden="true"></a>            }</span>
<span id="cb305-16"><a href="#cb305-16" aria-hidden="true"></a>        }</span>
<span id="cb305-17"><a href="#cb305-17" aria-hidden="true"></a>    };</span>
<span id="cb305-18"><a href="#cb305-18" aria-hidden="true"></a></span>
<span id="cb305-19"><a href="#cb305-19" aria-hidden="true"></a>    <span class="bu">HostnameVerifier</span> trustAllHostnames = <span class="kw">new</span> <span class="bu">HostnameVerifier</span>() {</span>
<span id="cb305-20"><a href="#cb305-20" aria-hidden="true"></a>        <span class="at">@Override</span></span>
<span id="cb305-21"><a href="#cb305-21" aria-hidden="true"></a>        <span class="kw">public</span> <span class="dt">boolean</span> <span class="fu">verify</span>(<span class="bu">String</span> hostname, <span class="bu">SSLSession</span> session) {</span>
<span id="cb305-22"><a href="#cb305-22" aria-hidden="true"></a>            <span class="kw">return</span> <span class="kw">true</span>; <span class="co">// Just allow them all.</span></span>
<span id="cb305-23"><a href="#cb305-23" aria-hidden="true"></a>        }</span>
<span id="cb305-24"><a href="#cb305-24" aria-hidden="true"></a>    };</span>
<span id="cb305-25"><a href="#cb305-25" aria-hidden="true"></a></span>
<span id="cb305-26"><a href="#cb305-26" aria-hidden="true"></a>    <span class="kw">try</span> {</span>
<span id="cb305-27"><a href="#cb305-27" aria-hidden="true"></a>        <span class="bu">System</span>.<span class="fu">setProperty</span>(<span class="st">&quot;jsse.enableSNIExtension&quot;</span>, <span class="st">&quot;false&quot;</span>);</span>
<span id="cb305-28"><a href="#cb305-28" aria-hidden="true"></a>        <span class="bu">SSLContext</span> sc = <span class="bu">SSLContext</span>.<span class="fu">getInstance</span>(<span class="st">&quot;SSL&quot;</span>);</span>
<span id="cb305-29"><a href="#cb305-29" aria-hidden="true"></a>        sc.<span class="fu">init</span>(<span class="kw">null</span>, trustAllCertificates, <span class="kw">new</span> <span class="bu">SecureRandom</span>());</span>
<span id="cb305-30"><a href="#cb305-30" aria-hidden="true"></a>        <span class="bu">HttpsURLConnection</span>.<span class="fu">setDefaultSSLSocketFactory</span>(sc.<span class="fu">getSocketFactory</span>());</span>
<span id="cb305-31"><a href="#cb305-31" aria-hidden="true"></a>        <span class="bu">HttpsURLConnection</span>.<span class="fu">setDefaultHostnameVerifier</span>(trustAllHostnames);</span>
<span id="cb305-32"><a href="#cb305-32" aria-hidden="true"></a>    }</span>
<span id="cb305-33"><a href="#cb305-33" aria-hidden="true"></a>    <span class="kw">catch</span> (<span class="bu">GeneralSecurityException</span> e) {</span>
<span id="cb305-34"><a href="#cb305-34" aria-hidden="true"></a>        <span class="kw">throw</span> <span class="kw">new</span> <span class="bu">ExceptionInInitializerError</span>(e);</span>
<span id="cb305-35"><a href="#cb305-35" aria-hidden="true"></a>    }</span>
<span id="cb305-36"><a href="#cb305-36" aria-hidden="true"></a>}</span></code></pre></div>
<hr>
<h5>
Last words
</h3>
<p>The <a href="http://hc.apache.org/httpcomponents-client-ga/" rel="noreferrer">Apache HttpComponents HttpClient</a> is <em>much</em> more convenient in this all :)</p>
<ul>
<li>
<a href="http://hc.apache.org/httpcomponents-client-ga/tutorial/html/" rel="noreferrer">HttpClient Tutorial</a>
</li>
<li>
<a href="http://hc.apache.org/httpcomponents-client-ga/examples.html" rel="noreferrer">HttpClient Examples</a>
</li>
</ul>
<hr>
<h5>
Parsing and extracting HTML
</h3>
<p>If all you want is parsing and extracting data from HTML, then better use a HTML parser like <a href="http://jsoup.org" rel="noreferrer">Jsoup</a></p>
<ul>
<li>
<a href="https://stackoverflow.com/questions/3152138/what-are-the-pros-and-cons-of-the-leading-java-html-parsers/3154281
#3154281">What are the pros/cons of leading HTML parsers in Java</a>
</li>
<li>
<a href="https://stackoverflow.com/questions/2835505/how-to-scan-a-website-or-page-for-info-and-bring-it-into-my-program/2835555
#2835555">How to scan and extract a webpage in Java</a>
</li>
</ul>
</section>
<section id="answer-2-score-88" class="level4">
<h4>Answer 2 (score 88)</h4>
<p>When working with HTTP it’s almost always more useful to refer to <code>HttpURLConnection</code> rather than the base class <code>URLConnection</code> (since <code>URLConnection</code> is an abstract class when you ask for <code>URLConnection.openConnection()</code> on a HTTP URL that’s what you’ll get back anyway).</p>
<p>Then you can instead of relying on <code>URLConnection #setDoOutput(true)</code> to implicitly set the request method to <em>POST</em> instead do <code>httpURLConnection.setRequestMethod("POST")</code> which some might find more natural (and which also allows you to specify other request methods such as <em>PUT</em>, <em>DELETE</em>, …).</p>
<p>It also provides useful HTTP constants so you can do:</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb306-1"><a href="#cb306-1" aria-hidden="true"></a><span class="dt">int</span> responseCode = httpURLConnection.<span class="fu">getResponseCode</span>();</span>
<span id="cb306-2"><a href="#cb306-2" aria-hidden="true"></a></span>
<span id="cb306-3"><a href="#cb306-3" aria-hidden="true"></a><span class="kw">if</span> (responseCode == <span class="bu">HttpURLConnection</span>.<span class="fu">HTTP_OK</span>) {</span></code></pre></div>
</section>
<section id="answer-3-score-50" class="level4">
<h4>Answer 3 (score 50)</h4>
<p>Inspired by this and other questions on SO, I’ve created a minimal open source <a href="http://code.google.com/p/basic-http-client/">basic-http-client</a> that embodies most of the techniques found here.</p>
<p><a href="https://code.google.com/p/google-http-java-client/">google-http-java-client</a> is also a great open source resource.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="what-are-the-possible-values-of-the-hibernate-hbm2ddl.auto-configuration-and-what-do-they-do-score-955696-in-2019" class="level3">
<h3>36: What are the possible values of the Hibernate hbm2ddl.auto configuration and what do they do (score <a href="https://stackoverflow.com/q/438146.html">955696</a> in 2019)</h3>
<section id="question-34" class="level4">
<h4>Question</h4>
<p>
I really want to know more about the update, export and the values that could be given to <code>hibernate.hbm2ddl.auto</code><br> I need to know when to use the update and when not? And what is the alternative?
</p>
<p>These are changes that could happen over DB:</p>
<ul>
<li>
new tables
</li>
<li>
new columns in old tables
</li>
<li>
columns deleted
</li>
<li>
data type of a column changed
</li>
<li>
a type of a column changed its attributes
</li>
<li>
tables dropped
</li>
<li>
values of a column changed
</li>
</ul>
<p>In each case what is the best solution?</p>
</section>
<section id="answer-2-score-1031" class="level4">
<h4>Answer 2 (score 1031)</h4>
<p>From the <a href="https://docs.jboss.org/hibernate/orm/5.2/userguide/html_single/Hibernate_User_Guide.html
#configurations-hbmddl" rel="noreferrer">community documentation</a>:</p>
<blockquote>
<p>hibernate.hbm2ddl.auto Automatically validates or exports schema DDL to the database when the SessionFactory is created. With create-drop, the database schema will be dropped when the SessionFactory is closed explicitly.</p>
e.g. validate | update | create | create-drop
</blockquote>
<p>So the list of possible options are,</p>
<ul>
<li>
<em>validate</em>: validate the schema, makes no changes to the database.
</li>
<li>
<em>update</em>: update the schema.
</li>
<li>
<em>create</em>: creates the schema, destroying previous data.
</li>
<li>
<em>create-drop</em>: drop the schema when the SessionFactory is closed explicitly, typically when the application is stopped.
</li>
</ul>
<p>These options seem intended to be developers tools and not to facilitate any production level databases, you may want to have a look at the following question; <a href="https://stackoverflow.com/questions/221379/hibernate-hbm2ddl-autoupdate-in-production">Hibernate: hbm2ddl.auto=update in production?</a></p>
</section>
<section id="answer-3-score-190" class="level4">
<h4>Answer 3 (score 190)</h4>
<p>There’s also the undocumented value of “none” to disable it entirely.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="difference-between-wait-and-sleep-score-864573-in-2017" class="level3">
<h3>37: Difference between wait() and sleep() (score <a href="https://stackoverflow.com/q/1036754.html">864573</a> in 2017)</h3>
<section id="question-35" class="level4">
<h4>Question</h4>
<p>What is the difference between a <code>wait()</code> and <code>sleep()</code> in Threads?</p>
<p>Is my understanding that a <code>wait()</code>-ing Thread is still in running mode and uses CPU cycles but a <code>sleep()</code>-ing does not consume any CPU cycles correct?</p>
<p>Why do we have <em>both</em> <code>wait()</code> and <code>sleep()</code>: how does their implementation vary at a lower level?</p>
</section>
<section id="answer-accepted-score-805" class="level4">
<h4>Answer accepted (score 805)</h4>
<p>A <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html
#wait%28%29" rel="noreferrer"><code>wait</code></a> can be “woken up” by another thread calling <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html#notify%28%29" rel="noreferrer"><code>notify</code></a> on the monitor which is being waited on whereas a <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Thread.html#sleep%28long%29" rel="noreferrer"><code>sleep</code></a> cannot. Also a <code>wait</code> (and <code>notify</code>) must happen in a block <code>synchronized</code> on the monitor object whereas <code>sleep</code> does not:</p>
<div class="sourceCode" id="cb307"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true"></a><span class="bu">Object</span> mon = ...;</span>
<span id="cb307-2"><a href="#cb307-2" aria-hidden="true"></a><span class="kw">synchronized</span> (mon) {</span>
<span id="cb307-3"><a href="#cb307-3" aria-hidden="true"></a>    mon.<span class="fu">wait</span>();</span>
<span id="cb307-4"><a href="#cb307-4" aria-hidden="true"></a>} </span></code></pre></div>
<p>At this point the currently executing thread waits <em>and releases the monitor</em>. Another thread may do</p>
<div class="sourceCode" id="cb308"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb308-1"><a href="#cb308-1" aria-hidden="true"></a><span class="kw">synchronized</span> (mon) { mon.<span class="fu">notify</span>(); }</span></code></pre></div>
<p>(on the same <code>mon</code> object) and the first thread (assuming it is the only thread waiting on the monitor) will wake up.</p>
<p>You can also call <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html
#notifyAll%28%29" rel="noreferrer"><code>notifyAll</code></a> if more than one thread is waiting on the monitor – this will wake <em>all of them up</em>. However, only one of the threads will be able to grab the monitor (remember that the <code>wait</code> is in a <code>synchronized</code> block) and carry on – the others will then be blocked until they can acquire the monitor’s lock.</p>
<p>Another point is that you call <code>wait</code> on <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html" rel="noreferrer"><code>Object</code></a> itself (i.e. you wait on an object’s monitor) whereas you call <code>sleep</code> on <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Thread.html" rel="noreferrer"><code>Thread</code></a>.</p>
<p>Yet another point is that you can get <em>spurious wakeups</em> from <code>wait</code> (i.e. the thread which is waiting resumes for no apparent reason). You should <strong>always <code>wait</code> whilst spinning on some condition</strong> as follows:</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true"></a><span class="kw">synchronized</span> {</span>
<span id="cb309-2"><a href="#cb309-2" aria-hidden="true"></a>    <span class="kw">while</span> (!condition) { mon.<span class="fu">wait</span>(); }</span>
<span id="cb309-3"><a href="#cb309-3" aria-hidden="true"></a>}</span></code></pre></div>
</section>
<section id="answer-2-score-319" class="level4">
<h4>Answer 2 (score 319)</h4>
<p>One key difference not yet mentioned is that while sleeping a Thread does <em>not</em> release the locks it holds, while waiting releases the lock on the object that <code>wait()</code> is called on.</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb310-1"><a href="#cb310-1" aria-hidden="true"></a><span class="kw">synchronized</span>(LOCK) {</span>
<span id="cb310-2"><a href="#cb310-2" aria-hidden="true"></a>    <span class="bu">Thread</span>.<span class="fu">sleep</span>(<span class="dv">1000</span>); <span class="co">// LOCK is held</span></span>
<span id="cb310-3"><a href="#cb310-3" aria-hidden="true"></a>}</span>
<span id="cb310-4"><a href="#cb310-4" aria-hidden="true"></a></span>
<span id="cb310-5"><a href="#cb310-5" aria-hidden="true"></a></span>
<span id="cb310-6"><a href="#cb310-6" aria-hidden="true"></a><span class="kw">synchronized</span>(LOCK) {</span>
<span id="cb310-7"><a href="#cb310-7" aria-hidden="true"></a>    LOCK.<span class="fu">wait</span>(); <span class="co">// LOCK is not held</span></span>
<span id="cb310-8"><a href="#cb310-8" aria-hidden="true"></a>}</span></code></pre></div>
</section>
<section id="answer-3-score-230" class="level4">
<h4>Answer 3 (score 230)</h4>
<p>I found <a href="https://groups.google.com/group/comp.lang.java.programmer/msg/12b19fdb8157883d?dmode=source&amp;hl=en&amp;pli=1" rel="noreferrer">this post</a> helpful. It puts the difference between <code>Thread.sleep()</code>, <code>Thread.yield()</code>, and <code>Object.wait()</code> in human terms. To quote:</p>
<blockquote>
<p>
It all eventually makes its way down to the OS’s scheduler, which hands out timeslices to processes and threads.
</p>
<p>
<code>sleep(n)</code> says <strong><em>“I’m done with my timeslice, and please don’t give me another one for at least n milliseconds.”</em></strong> The OS doesn’t even try to schedule the sleeping thread until requested time has passed.
</p>
<p>
<code>yield()</code> says <strong><em>“I’m done with my timeslice, but I still have work to do.”</em></strong> The OS is free to immediately give the thread another timeslice, or to give some other thread or process the CPU the yielding thread just gave up.
</p>
<p>
<code>wait()</code> says <strong><em>“I’m done with my timeslice. Don’t give me another timeslice until someone calls notify().”</em></strong> As with <code>sleep()</code>, the OS won’t even try to schedule your task unless someone calls <code>notify()</code> (or one of a few other wakeup scenarios occurs).
</p>
<p>
Threads also lose the remainder of their timeslice when they perform blocking IO and under a few other circumstances. If a thread works through the entire timeslice, the OS forcibly takes control roughly as if <code>yield()</code> had been called, so that other processes can run.
</p>
<p>
You rarely need <code>yield()</code>, but if you have a compute-heavy app with logical task boundaries, inserting a <code>yield()</code> <em>might</em> improve system responsiveness (at the expense of time — context switches, even just to the OS and back, aren’t free). Measure and test against goals you care about, as always.
</p>
</blockquote>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="whats-the-difference-between-component-repository-service-annotations-in-spring-score-852949-in-2017" class="level3">
<h3>38: What’s the difference between <span class="citation" data-cites="Component">@Component</span>, <span class="citation" data-cites="Repository">@Repository</span> &amp; <span class="citation" data-cites="Service">@Service</span> annotations in Spring? (score <a href="https://stackoverflow.com/q/6827752.html">852949</a> in 2017)</h3>
<section id="question-36" class="level4">
<h4>Question</h4>
<p>Can <code>@Component</code>, <code>@Repository</code> and <code>@Service</code> annotations be used interchangeably in Spring or do they provide any particular functionality besides acting as a notation device?</p>
<p>In other words, if I have a Service class and I change the annotation from <code>@Service</code> to <code>@Component</code>, will it still behave the same way?</p>
<p>Or does the annotation also influence the behavior and functionality of the class?</p>
</section>
<section id="answer-2-score-1423" class="level4">
<h4>Answer 2 (score 1423)</h4>
<p>From <a href="https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html
#beans-stereotype-annotations" rel="noreferrer">Spring Documentation</a>:</p>
<blockquote>
<p>
In Spring 2.0 and later, the <code>@Repository</code> annotation is a marker for any class that fulfills the role or stereotype (also known as Data Access Object or DAO) of a repository. Among the uses of this marker is the automatic translation of exceptions.
</p>
<p>
Spring 2.5 introduces further stereotype annotations: <code>@Component</code>, <code>@Service</code>, and <code>@Controller</code>. <code>@Component</code> is a generic stereotype for any Spring-managed component. <code>@Repository</code>, <code>@Service</code>, and <code>@Controller</code> are specializations of <code>@Component</code> for more specific use cases, for example, in the persistence, service, and presentation layers, respectively.
</p>
<p>
Therefore, you can annotate your component classes with <code>@Component</code>, but by annotating them with <code>@Repository</code>, <code>@Service</code>, or <code>@Controller</code> instead, your classes are more properly suited for processing by tools or associating with aspects. For example, these stereotype annotations make ideal targets for pointcuts.
</p>
<p>
Thus, if you are choosing between using <code>@Component</code> or <code>@Service</code> for your service layer, <code>@Service</code> is clearly the better choice. Similarly, as stated above, <code>@Repository</code> is already supported as a marker for automatic exception translation in your persistence layer.
</p>
</blockquote>
<div class="sourceCode" id="cb311"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true"></a>┌────────────┬─────────────────────────────────────────────────────┐</span>
<span id="cb311-2"><a href="#cb311-2" aria-hidden="true"></a>│ <span class="bu">Annotation</span> │ Meaning                                             │</span>
<span id="cb311-3"><a href="#cb311-3" aria-hidden="true"></a>├────────────┼─────────────────────────────────────────────────────┤</span>
<span id="cb311-4"><a href="#cb311-4" aria-hidden="true"></a>│ <span class="at">@Component</span> │ generic stereotype <span class="kw">for</span> any <span class="bu">Spring</span>-managed component │</span>
<span id="cb311-5"><a href="#cb311-5" aria-hidden="true"></a>│ <span class="at">@Repository</span>│ stereotype <span class="kw">for</span> persistence layer                    │</span>
<span id="cb311-6"><a href="#cb311-6" aria-hidden="true"></a>│ <span class="at">@Service</span>   │ stereotype <span class="kw">for</span> service layer                        │</span>
<span id="cb311-7"><a href="#cb311-7" aria-hidden="true"></a>│ <span class="at">@Controller</span>│ stereotype <span class="kw">for</span> presentation <span class="fu">layer</span> (spring-mvc)      │</span>
<span id="cb311-8"><a href="#cb311-8" aria-hidden="true"></a>└────────────┴─────────────────────────────────────────────────────┘</span></code></pre></div>
</section>
<section id="answer-3-score-718" class="level4">
<h4>Answer 3 (score 718)</h4>
<p>As many of the answers already state what these annotations are used for, we’ll here focus on some minor differences among them.</p>
<blockquote>
<p>First the <strong>Similarity</strong></p>
<p>
First point worth highlighting again is that <strong>with respect to scan-auto-detection and dependency injection for BeanDefinition</strong> all these annotations (viz., <span class="citation" data-cites="Component">@Component</span>, <span class="citation" data-cites="Service">@Service</span>, <span class="citation" data-cites="Repository">@Repository</span>, <span class="citation" data-cites="Controller">@Controller</span>) are the same. <strong>We can use one in place of another and can still get our way around.</strong>
</p>
</blockquote>
<hr>
<h5>
Differences between <span class="citation" data-cites="Component">@Component</span>, <span class="citation" data-cites="Repository">@Repository</span>, <span class="citation" data-cites="Controller">@Controller</span> and <span class="citation" data-cites="Service">@Service</span>
</h2>
<blockquote>
<strong><span class="citation" data-cites="Component">@Component</span></strong>
</blockquote>
<p>This is a general-purpose stereotype annotation indicating that the class is a spring component.</p>
<p>
<strong><em>What’s special about <span class="citation" data-cites="Component">@Component</span></em></strong><br> <code>&amp;lt;context:component-scan&amp;gt;</code> only scans <code>@Component</code> and does not look for <code>@Controller</code>, <code>@Service</code> and <code>@Repository</code> in general. They are scanned because they themselves are annotated with <code>@Component</code>.
</p>
<p>Just take a look at <code>@Controller</code>, <code>@Service</code> and <code>@Repository</code> annotation definitions:</p>
<div class="sourceCode" id="cb312"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true"></a><span class="at">@Component</span></span>
<span id="cb312-2"><a href="#cb312-2" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">@interface</span> <span class="bu">Service</span> {</span>
<span id="cb312-3"><a href="#cb312-3" aria-hidden="true"></a>    ….</span>
<span id="cb312-4"><a href="#cb312-4" aria-hidden="true"></a>}</span></code></pre></div>
<p> </p>
<div class="sourceCode" id="cb313"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true"></a><span class="at">@Component</span></span>
<span id="cb313-2"><a href="#cb313-2" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">@interface</span> Repository {</span>
<span id="cb313-3"><a href="#cb313-3" aria-hidden="true"></a>    ….</span>
<span id="cb313-4"><a href="#cb313-4" aria-hidden="true"></a>}</span></code></pre></div>
<p> </p>
<div class="sourceCode" id="cb314"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb314-1"><a href="#cb314-1" aria-hidden="true"></a><span class="at">@Component</span></span>
<span id="cb314-2"><a href="#cb314-2" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">@interface</span> Controller {</span>
<span id="cb314-3"><a href="#cb314-3" aria-hidden="true"></a>    …</span>
<span id="cb314-4"><a href="#cb314-4" aria-hidden="true"></a>}</span></code></pre></div>
<p>Thus, it’s not wrong to say that <code>@Controller</code>, <code>@Service</code> and <code>@Repository</code> are special types of <code>@Component</code> annotation. <code>&amp;lt;context:component-scan&amp;gt;</code> picks them up and registers their following classes as beans, just as if they were annotated with <code>@Component</code>.</p>
<p>Special type annotations are also scanned, because they themselves are annotated with <code>@Component</code> annotation, which means they are also <code>@Component</code>s. If we define our own custom annotation and annotate it with <code>@Component</code>, it will also get scanned with <code>&amp;lt;context:component-scan&amp;gt;</code></p>
<hr>
<blockquote>
<strong><span class="citation" data-cites="Repository">@Repository</span></strong>
</blockquote>
<p>This is to indicate that the class defines a data repository.</p>
<p><strong><em>What’s special about <span class="citation" data-cites="Repository">@Repository</span>?</em></strong></p>
<p>In addition to pointing out, that this is an <em>Annotation based Configuration</em>, <code>@Repository</code>’s job is to catch platform specific exceptions and re-throw them as one of Spring’s unified unchecked exception. For this, we’re provided with <code>PersistenceExceptionTranslationPostProcessor</code>, that we are required to add in our Spring’s application context like this:</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true"></a>&lt;bean <span class="kw">class</span>=<span class="st">&quot;org.springframework.dao.annotation.PersistenceExceptionTranslationPostProcessor&quot;</span>/&gt;</span></code></pre></div>
<p>This bean post processor adds an advisor to any bean that’s annotated with <code>@Repository</code> so that any platform-specific exceptions are caught and then re-thrown as one of Spring’s unchecked data access exceptions.</p>
<hr>
<blockquote>
<strong><span class="citation" data-cites="Controller">@Controller</span></strong>
</blockquote>
<p>The <code>@Controller</code> annotation indicates that a particular class serves the role of a controller. The <code>@Controller</code> annotation acts as a stereotype for the annotated class, indicating its role.</p>
<p><strong><em>What’s special about <span class="citation" data-cites="Controller">@Controller</span>?</em></strong></p>
<p>
We cannot switch this annotation with any other like <code>@Service</code> or <code>@Repository</code>, even though they look same. The dispatcher scans the classes annotated with <code>@Controller</code> and detects methods annotated with <code>@RequestMapping</code> annotations within them. We can use <code>@RequestMapping</code> on/in only those methods whose classes are annotated with <code>@Controller</code> and it will <strong>NOT</strong> work with <code>@Component</code>, <code>@Service</code>, <code>@Repository</code> etc…
</p>
<p><sub><em>Note: If a class is already registered as a bean through any alternate method, like through <code>@Bean</code> or through <code>@Component</code>, <code>@Service</code> etc… annotations, then <code>@RequestMapping</code> can be picked if the class is also annotated with <code>@RequestMapping</code> annotation. But that’s a different scenario.</em></sub></p>
<hr>
<blockquote>
<strong><span class="citation" data-cites="Service">@Service</span></strong>
</blockquote>
<p><code>@Service</code> beans hold the business logic and call methods in the repository layer.</p>
<p><strong><em>What’s special about <span class="citation" data-cites="Service">@Service</span>?</em></strong></p>
<p>Apart from the fact that it’s used to indicate, that it’s holding the business logic, there’s nothing else noticeable in this annotation; but who knows, Spring may add some additional exceptional in future.</p>
<hr>
<blockquote>
<strong><em>What else?</em></strong>
</blockquote>
<p>Similar to above, in the future Spring may add special functionalities for <code>@Service</code>, <code>@Controller</code> and <code>@Repository</code> based on their layering conventions. Hence, it’s always a good idea to respect the convention and use it in line with layers.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="what-is-reflection-and-why-is-it-useful-score-846678-in-2015" class="level3">
<h3>39: What is reflection and why is it useful? (score <a href="https://stackoverflow.com/q/37628.html">846678</a> in 2015)</h3>
<section id="question-37" class="level4">
<h4>Question</h4>
<p>What is reflection, and why is it useful?</p>
<p>I’m particularly interested in Java, but I assume the principles are the same in any language.</p>
</section>
<section id="answer-accepted-score-1628" class="level4">
<h4>Answer accepted (score 1628)</h4>
<p>The name reflection is used to describe code which is able to inspect other code in the same system (or itself).</p>
<p>For example, say you have an object of an unknown type in Java, and you would like to call a ‘doSomething’ method on it if one exists. Java’s static typing system isn’t really designed to support this unless the object conforms to a known interface, but using reflection, your code can look at the object and find out if it has a method called ‘doSomething’ and then call it if you want to.</p>
<p>So, to give you a code example of this in Java (imagine the object in question is foo) :</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb316-1"><a href="#cb316-1" aria-hidden="true"></a><span class="bu">Method</span> method = foo.<span class="fu">getClass</span>().<span class="fu">getMethod</span>(<span class="st">&quot;doSomething&quot;</span>, <span class="kw">null</span>);</span>
<span id="cb316-2"><a href="#cb316-2" aria-hidden="true"></a>method.<span class="fu">invoke</span>(foo, <span class="kw">null</span>);</span></code></pre></div>
<p>One very common use case in Java is the usage with annotations. JUnit 4, for example, will use reflection to look through your classes for methods tagged with the <span class="citation" data-cites="Test">@Test</span> annotation, and will then call them when running the unit test.</p>
<p>There are some good reflection examples to get you started at <a href="http://docs.oracle.com/javase/tutorial/reflect/index.html" rel="noreferrer">http://docs.oracle.com/javase/tutorial/reflect/index.html</a></p>
<p>And finally, yes, the concepts are pretty much similar in other statically types languages which support reflection (like C #). In dynamically typed languages, the use case described above is less necessary (since the compiler will allow any method to be called on any object, failing at runtime if it does not exist), but the second case of looking for methods which are marked or work in a certain way is still common.</p>
<p><strong>Update from a comment:</strong></p>
<blockquote>
<p>
The ability to inspect the code in the system and see object types is not reflection, but rather Type Introspection. Reflection is then the ability to make modifications at runtime by making use of introspection. The distinction is necessary here as some languages support introspection, but do not support reflection. One such example is C++
</p>
</blockquote>
</section>
<section id="answer-2-score-227" class="level4">
<h4>Answer 2 (score 227)</h4>
<blockquote>
<strong>Reflection</strong> is a language’s ability to inspect and dynamically call classes, methods, attributes, etc. at runtime.
</blockquote>
<p>For example, all objects in Java have the method <code>getClass()</code>, which lets you determine the object’s class even if you don’t know it at compile time (e.g. if you declared it as an <code>Object</code>) - this might seem trivial, but such reflection is not possible in less dynamic languages such as <code>C++</code>. More advanced uses lets you list and call methods, constructors, etc.</p>
<p>Reflection is important since it lets you write programs that do not have to “know” everything at compile time, making them more dynamic, since they can be tied together at runtime. The code can be written against known interfaces, but the actual classes to be used can be instantiated using reflection from configuration files.</p>
<p>Lots of modern frameworks use reflection extensively for this very reason. Most other modern languages use reflection as well, and in scripting languages (such as Python) they are even more tightly integrated, since it feels more natural within the general programming model of those languages.</p>
</section>
<section id="answer-3-score-104" class="level4">
<h4>Answer 3 (score 104)</h4>
<p>One of my favorite uses of reflection is the below Java dump method. It takes any object as a parameter and uses the Java reflection API to print out every field name and value.</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true"></a><span class="kw">import</span><span class="im"> java.lang.reflect.Array;</span></span>
<span id="cb317-2"><a href="#cb317-2" aria-hidden="true"></a><span class="kw">import</span><span class="im"> java.lang.reflect.Field;</span></span>
<span id="cb317-3"><a href="#cb317-3" aria-hidden="true"></a></span>
<span id="cb317-4"><a href="#cb317-4" aria-hidden="true"></a><span class="kw">public</span> <span class="dt">static</span> <span class="bu">String</span> <span class="fu">dump</span>(<span class="bu">Object</span> o, <span class="dt">int</span> callCount) {</span>
<span id="cb317-5"><a href="#cb317-5" aria-hidden="true"></a>    callCount++;</span>
<span id="cb317-6"><a href="#cb317-6" aria-hidden="true"></a>    <span class="bu">StringBuffer</span> tabs = <span class="kw">new</span> <span class="bu">StringBuffer</span>();</span>
<span id="cb317-7"><a href="#cb317-7" aria-hidden="true"></a>    <span class="kw">for</span> (<span class="dt">int</span> k = <span class="dv">0</span>; k &lt; callCount; k++) {</span>
<span id="cb317-8"><a href="#cb317-8" aria-hidden="true"></a>        tabs.<span class="fu">append</span>(<span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>);</span>
<span id="cb317-9"><a href="#cb317-9" aria-hidden="true"></a>    }</span>
<span id="cb317-10"><a href="#cb317-10" aria-hidden="true"></a>    <span class="bu">StringBuffer</span> buffer = <span class="kw">new</span> <span class="bu">StringBuffer</span>();</span>
<span id="cb317-11"><a href="#cb317-11" aria-hidden="true"></a>    <span class="bu">Class</span> oClass = o.<span class="fu">getClass</span>();</span>
<span id="cb317-12"><a href="#cb317-12" aria-hidden="true"></a>    <span class="kw">if</span> (oClass.<span class="fu">isArray</span>()) {</span>
<span id="cb317-13"><a href="#cb317-13" aria-hidden="true"></a>        buffer.<span class="fu">append</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>);</span>
<span id="cb317-14"><a href="#cb317-14" aria-hidden="true"></a>        buffer.<span class="fu">append</span>(tabs.<span class="fu">toString</span>());</span>
<span id="cb317-15"><a href="#cb317-15" aria-hidden="true"></a>        buffer.<span class="fu">append</span>(<span class="st">&quot;[&quot;</span>);</span>
<span id="cb317-16"><a href="#cb317-16" aria-hidden="true"></a>        <span class="kw">for</span> (<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; <span class="bu">Array</span>.<span class="fu">getLength</span>(o); i++) {</span>
<span id="cb317-17"><a href="#cb317-17" aria-hidden="true"></a>            <span class="kw">if</span> (i &lt; <span class="dv">0</span>)</span>
<span id="cb317-18"><a href="#cb317-18" aria-hidden="true"></a>                buffer.<span class="fu">append</span>(<span class="st">&quot;,&quot;</span>);</span>
<span id="cb317-19"><a href="#cb317-19" aria-hidden="true"></a>            <span class="bu">Object</span> value = <span class="bu">Array</span>.<span class="fu">get</span>(o, i);</span>
<span id="cb317-20"><a href="#cb317-20" aria-hidden="true"></a>            <span class="kw">if</span> (value.<span class="fu">getClass</span>().<span class="fu">isPrimitive</span>() ||</span>
<span id="cb317-21"><a href="#cb317-21" aria-hidden="true"></a>                    value.<span class="fu">getClass</span>() == java.<span class="fu">lang</span>.<span class="fu">Long</span>.<span class="fu">class</span> ||</span>
<span id="cb317-22"><a href="#cb317-22" aria-hidden="true"></a>                    value.<span class="fu">getClass</span>() == java.<span class="fu">lang</span>.<span class="fu">String</span>.<span class="fu">class</span> ||</span>
<span id="cb317-23"><a href="#cb317-23" aria-hidden="true"></a>                    value.<span class="fu">getClass</span>() == java.<span class="fu">lang</span>.<span class="fu">Integer</span>.<span class="fu">class</span> ||</span>
<span id="cb317-24"><a href="#cb317-24" aria-hidden="true"></a>                    value.<span class="fu">getClass</span>() == java.<span class="fu">lang</span>.<span class="fu">Boolean</span>.<span class="fu">class</span></span>
<span id="cb317-25"><a href="#cb317-25" aria-hidden="true"></a>                    ) {</span>
<span id="cb317-26"><a href="#cb317-26" aria-hidden="true"></a>                buffer.<span class="fu">append</span>(value);</span>
<span id="cb317-27"><a href="#cb317-27" aria-hidden="true"></a>            } <span class="kw">else</span> {</span>
<span id="cb317-28"><a href="#cb317-28" aria-hidden="true"></a>                buffer.<span class="fu">append</span>(<span class="fu">dump</span>(value, callCount));</span>
<span id="cb317-29"><a href="#cb317-29" aria-hidden="true"></a>            }</span>
<span id="cb317-30"><a href="#cb317-30" aria-hidden="true"></a>        }</span>
<span id="cb317-31"><a href="#cb317-31" aria-hidden="true"></a>        buffer.<span class="fu">append</span>(tabs.<span class="fu">toString</span>());</span>
<span id="cb317-32"><a href="#cb317-32" aria-hidden="true"></a>        buffer.<span class="fu">append</span>(<span class="st">&quot;]</span><span class="sc">\n</span><span class="st">&quot;</span>);</span>
<span id="cb317-33"><a href="#cb317-33" aria-hidden="true"></a>    } <span class="kw">else</span> {</span>
<span id="cb317-34"><a href="#cb317-34" aria-hidden="true"></a>        buffer.<span class="fu">append</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>);</span>
<span id="cb317-35"><a href="#cb317-35" aria-hidden="true"></a>        buffer.<span class="fu">append</span>(tabs.<span class="fu">toString</span>());</span>
<span id="cb317-36"><a href="#cb317-36" aria-hidden="true"></a>        buffer.<span class="fu">append</span>(<span class="st">&quot;{</span><span class="sc">\n</span><span class="st">&quot;</span>);</span>
<span id="cb317-37"><a href="#cb317-37" aria-hidden="true"></a>        <span class="kw">while</span> (oClass != <span class="kw">null</span>) {</span>
<span id="cb317-38"><a href="#cb317-38" aria-hidden="true"></a>            <span class="bu">Field</span>[] fields = oClass.<span class="fu">getDeclaredFields</span>();</span>
<span id="cb317-39"><a href="#cb317-39" aria-hidden="true"></a>            <span class="kw">for</span> (<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; fields.<span class="fu">length</span>; i++) {</span>
<span id="cb317-40"><a href="#cb317-40" aria-hidden="true"></a>                buffer.<span class="fu">append</span>(tabs.<span class="fu">toString</span>());</span>
<span id="cb317-41"><a href="#cb317-41" aria-hidden="true"></a>                fields[i].<span class="fu">setAccessible</span>(<span class="kw">true</span>);</span>
<span id="cb317-42"><a href="#cb317-42" aria-hidden="true"></a>                buffer.<span class="fu">append</span>(fields[i].<span class="fu">getName</span>());</span>
<span id="cb317-43"><a href="#cb317-43" aria-hidden="true"></a>                buffer.<span class="fu">append</span>(<span class="st">&quot;=&quot;</span>);</span>
<span id="cb317-44"><a href="#cb317-44" aria-hidden="true"></a>                <span class="kw">try</span> {</span>
<span id="cb317-45"><a href="#cb317-45" aria-hidden="true"></a>                    <span class="bu">Object</span> value = fields[i].<span class="fu">get</span>(o);</span>
<span id="cb317-46"><a href="#cb317-46" aria-hidden="true"></a>                    <span class="kw">if</span> (value != <span class="kw">null</span>) {</span>
<span id="cb317-47"><a href="#cb317-47" aria-hidden="true"></a>                        <span class="kw">if</span> (value.<span class="fu">getClass</span>().<span class="fu">isPrimitive</span>() ||</span>
<span id="cb317-48"><a href="#cb317-48" aria-hidden="true"></a>                                value.<span class="fu">getClass</span>() == java.<span class="fu">lang</span>.<span class="fu">Long</span>.<span class="fu">class</span> ||</span>
<span id="cb317-49"><a href="#cb317-49" aria-hidden="true"></a>                                value.<span class="fu">getClass</span>() == java.<span class="fu">lang</span>.<span class="fu">String</span>.<span class="fu">class</span> ||</span>
<span id="cb317-50"><a href="#cb317-50" aria-hidden="true"></a>                                value.<span class="fu">getClass</span>() == java.<span class="fu">lang</span>.<span class="fu">Integer</span>.<span class="fu">class</span> ||</span>
<span id="cb317-51"><a href="#cb317-51" aria-hidden="true"></a>                                value.<span class="fu">getClass</span>() == java.<span class="fu">lang</span>.<span class="fu">Boolean</span>.<span class="fu">class</span></span>
<span id="cb317-52"><a href="#cb317-52" aria-hidden="true"></a>                                ) {</span>
<span id="cb317-53"><a href="#cb317-53" aria-hidden="true"></a>                            buffer.<span class="fu">append</span>(value);</span>
<span id="cb317-54"><a href="#cb317-54" aria-hidden="true"></a>                        } <span class="kw">else</span> {</span>
<span id="cb317-55"><a href="#cb317-55" aria-hidden="true"></a>                            buffer.<span class="fu">append</span>(<span class="fu">dump</span>(value, callCount));</span>
<span id="cb317-56"><a href="#cb317-56" aria-hidden="true"></a>                        }</span>
<span id="cb317-57"><a href="#cb317-57" aria-hidden="true"></a>                    }</span>
<span id="cb317-58"><a href="#cb317-58" aria-hidden="true"></a>                } <span class="kw">catch</span> (<span class="bu">IllegalAccessException</span> e) {</span>
<span id="cb317-59"><a href="#cb317-59" aria-hidden="true"></a>                    buffer.<span class="fu">append</span>(e.<span class="fu">getMessage</span>());</span>
<span id="cb317-60"><a href="#cb317-60" aria-hidden="true"></a>                }</span>
<span id="cb317-61"><a href="#cb317-61" aria-hidden="true"></a>                buffer.<span class="fu">append</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>);</span>
<span id="cb317-62"><a href="#cb317-62" aria-hidden="true"></a>            }</span>
<span id="cb317-63"><a href="#cb317-63" aria-hidden="true"></a>            oClass = oClass.<span class="fu">getSuperclass</span>();</span>
<span id="cb317-64"><a href="#cb317-64" aria-hidden="true"></a>        }</span>
<span id="cb317-65"><a href="#cb317-65" aria-hidden="true"></a>        buffer.<span class="fu">append</span>(tabs.<span class="fu">toString</span>());</span>
<span id="cb317-66"><a href="#cb317-66" aria-hidden="true"></a>        buffer.<span class="fu">append</span>(<span class="st">&quot;}</span><span class="sc">\n</span><span class="st">&quot;</span>);</span>
<span id="cb317-67"><a href="#cb317-67" aria-hidden="true"></a>    }</span>
<span id="cb317-68"><a href="#cb317-68" aria-hidden="true"></a>    <span class="kw">return</span> buffer.<span class="fu">toString</span>();</span>
<span id="cb317-69"><a href="#cb317-69" aria-hidden="true"></a>}</span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="what-is-a-serialversionuid-and-why-should-i-use-it-score-845205-in-2015" class="level3">
<h3>40: What is a serialVersionUID and why should I use it? (score <a href="https://stackoverflow.com/q/285793.html">845205</a> in 2015)</h3>
<section id="question-38" class="level4">
<h4>Question</h4>
<p>Eclipse issues warnings when a <code>serialVersionUID</code> is missing.</p>
<blockquote>
<p>
The serializable class Foo does not declare a static final serialVersionUID field of type long
</p>
</blockquote>
<p>What is <code>serialVersionUID</code> and why is it important? Please show an example where missing <code>serialVersionUID</code> will cause a problem.</p>
</section>
<section id="answer-accepted-score-2177" class="level4">
<h4>Answer accepted (score 2177)</h4>
<p>The docs for <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/io/Serializable.html" rel="noreferrer"><code>java.io.Serializable</code></a> are probably about as good an explanation as you’ll get:</p>
<blockquote>
<p>
The serialization runtime associates with each serializable class a version number, called a <code>serialVersionUID</code>, which is used during deserialization to verify that the sender and receiver of a serialized object have loaded classes for that object that are compatible with respect to serialization. If the receiver has loaded a class for the object that has a different <code>serialVersionUID</code> than that of the corresponding sender’s class, then deserialization will result in an <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/io/InvalidClassException.html" rel="noreferrer"><code>InvalidClassException</code></a>. A serializable class can declare its own <code>serialVersionUID</code> explicitly by declaring a field named <code>serialVersionUID</code> that must be static, final, and of type <code>long</code>:
</p>
<div class="sourceCode" id="cb318"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb318-1"><a href="#cb318-1" aria-hidden="true"></a>ANY-ACCESS-MODIFIER <span class="dt">static</span> <span class="dt">final</span> <span class="dt">long</span> serialVersionUID = <span class="dv">42L</span>;</span></code></pre></div>
If a serializable class does not explicitly declare a <code>serialVersionUID</code>, then the serialization runtime will calculate a default <code>serialVersionUID</code> value for that class based on various aspects of the class, as described in the Java(TM) Object Serialization Specification. However, it is <em>strongly recommended</em> that all serializable classes explicitly declare <code>serialVersionUID</code> values, since the default <code>serialVersionUID</code> computation is highly sensitive to class details that may vary depending on compiler implementations, and can thus result in unexpected <code>InvalidClassExceptions</code> during deserialization. Therefore, to guarantee a consistent <code>serialVersionUID</code> value across different java compiler implementations, a serializable class must declare an explicit <code>serialVersionUID</code> value. It is also strongly advised that explicit <code>serialVersionUID</code> declarations use the private modifier where possible, since such declarations apply only to the immediately declaring class <code>serialVersionUID</code> fields are not useful as inherited members.
</blockquote>
</section>
<section id="answer-2-score-452-1" class="level4">
<h4>Answer 2 (score 452)</h4>
<p>If you’re serializing just because you have to serialize for the implementation’s sake (who cares if you serialize for an <code>HTTPSession</code>, for instance…if it’s stored or not, you probably don’t care about <code>de-serializing</code> a form object), then you can ignore this.</p>
<p>If you’re actually using serialization, it only matters if you plan on storing and retrieving objects using serialization directly. The <code>serialVersionUID</code> represents your class version, and you should increment it if the current version of your class is not backwards compatible with its previous version.</p>
<p>Most of the time, you will probably not use serialization directly. If this is the case, generate a default <code>SerialVersionUID</code> by clicking the quick fix option and don’t worry about it.</p>
</section>
<section id="answer-3-score-293" class="level4">
<h4>Answer 3 (score 293)</h4>
<p>I can’t pass up this opportunity to plug Josh Bloch’s book <a href="https://rads.stackoverflow.com/amzn/click/com/0321356683" rel="noreferrer" rel="nofollow noreferrer">Effective Java</a> (2nd Edition). Chapter 11 is an indispensible resource on Java serialization.</p>
<p>Per Josh, the automatically-generated UID is generated based on a class name, implemented interfaces, and all public and protected members. Changing any of these in any way will change the <code>serialVersionUID</code>. So you don’t need to mess with them only if you are certain that no more than one version of the class will ever be serialized (either across processes or retrieved from storage at a later time).</p>
<p>If you ignore them for now, and find later that you need to change the class in some way but maintain compatibility w/ old version of the class, you can use the JDK tool <strong>serialver</strong> to generate the <code>serialVersionUID</code> on the <em>old</em> class, and explicitly set that on the new class. (Depending on your changes you may need to also implement custom serialization by adding <code>writeObject</code> and <code>readObject</code> methods - see <code>Serializable</code> javadoc or aforementioned chapter 11.)</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-can-i-initialise-a-static-map-score-808780-in-2018" class="level3">
<h3>41: How can I initialise a static Map? (score <a href="https://stackoverflow.com/q/507602.html">808780</a> in 2018)</h3>
<section id="question-39" class="level4">
<h4>Question</h4>
<p>How would you initialise a static <code>Map</code> in Java?</p>
<p>
Method one: static initialiser <br> Method two: instance initialiser (anonymous subclass) or some other method?
</p>
<p>What are the pros and cons of each?</p>
<p>Here is an example illustrating the two methods:</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true"></a><span class="kw">import</span><span class="im"> java.util.HashMap;</span></span>
<span id="cb319-2"><a href="#cb319-2" aria-hidden="true"></a><span class="kw">import</span><span class="im"> java.util.Map;</span></span>
<span id="cb319-3"><a href="#cb319-3" aria-hidden="true"></a></span>
<span id="cb319-4"><a href="#cb319-4" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">class</span> Test {</span>
<span id="cb319-5"><a href="#cb319-5" aria-hidden="true"></a>    <span class="kw">private</span> <span class="dt">static</span> <span class="dt">final</span> <span class="bu">Map</span>&lt;<span class="bu">Integer</span>, <span class="bu">String</span>&gt; myMap = <span class="kw">new</span> <span class="bu">HashMap</span>&lt;<span class="bu">Integer</span>, <span class="bu">String</span>&gt;();</span>
<span id="cb319-6"><a href="#cb319-6" aria-hidden="true"></a>    <span class="dt">static</span> {</span>
<span id="cb319-7"><a href="#cb319-7" aria-hidden="true"></a>        myMap.<span class="fu">put</span>(<span class="dv">1</span>, <span class="st">&quot;one&quot;</span>);</span>
<span id="cb319-8"><a href="#cb319-8" aria-hidden="true"></a>        myMap.<span class="fu">put</span>(<span class="dv">2</span>, <span class="st">&quot;two&quot;</span>);</span>
<span id="cb319-9"><a href="#cb319-9" aria-hidden="true"></a>    }</span>
<span id="cb319-10"><a href="#cb319-10" aria-hidden="true"></a></span>
<span id="cb319-11"><a href="#cb319-11" aria-hidden="true"></a>    <span class="kw">private</span> <span class="dt">static</span> <span class="dt">final</span> <span class="bu">Map</span>&lt;<span class="bu">Integer</span>, <span class="bu">String</span>&gt; myMap2 = <span class="kw">new</span> <span class="bu">HashMap</span>&lt;<span class="bu">Integer</span>, <span class="bu">String</span>&gt;(){</span>
<span id="cb319-12"><a href="#cb319-12" aria-hidden="true"></a>        {</span>
<span id="cb319-13"><a href="#cb319-13" aria-hidden="true"></a>            <span class="fu">put</span>(<span class="dv">1</span>, <span class="st">&quot;one&quot;</span>);</span>
<span id="cb319-14"><a href="#cb319-14" aria-hidden="true"></a>            <span class="fu">put</span>(<span class="dv">2</span>, <span class="st">&quot;two&quot;</span>);</span>
<span id="cb319-15"><a href="#cb319-15" aria-hidden="true"></a>        }</span>
<span id="cb319-16"><a href="#cb319-16" aria-hidden="true"></a>    };</span>
<span id="cb319-17"><a href="#cb319-17" aria-hidden="true"></a>}</span></code></pre></div>
</section>
<section id="answer-accepted-score-1064" class="level4">
<h4>Answer accepted (score 1064)</h4>
<p>The instance initialiser is just syntactic sugar in this case, right? I don’t see why you need an extra anonymous class just to initialize. And it won’t work if the class being created is final.</p>
<p>You can create an immutable map using a static initialiser too:</p>
<div class="sourceCode" id="cb320"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb320-1"><a href="#cb320-1" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">class</span> Test {</span>
<span id="cb320-2"><a href="#cb320-2" aria-hidden="true"></a>    <span class="kw">private</span> <span class="dt">static</span> <span class="dt">final</span> <span class="bu">Map</span>&lt;<span class="bu">Integer</span>, <span class="bu">String</span>&gt; myMap;</span>
<span id="cb320-3"><a href="#cb320-3" aria-hidden="true"></a>    <span class="dt">static</span> {</span>
<span id="cb320-4"><a href="#cb320-4" aria-hidden="true"></a>        <span class="bu">Map</span>&lt;<span class="bu">Integer</span>, <span class="bu">String</span>&gt; aMap = ....;</span>
<span id="cb320-5"><a href="#cb320-5" aria-hidden="true"></a>        aMap.<span class="fu">put</span>(<span class="dv">1</span>, <span class="st">&quot;one&quot;</span>);</span>
<span id="cb320-6"><a href="#cb320-6" aria-hidden="true"></a>        aMap.<span class="fu">put</span>(<span class="dv">2</span>, <span class="st">&quot;two&quot;</span>);</span>
<span id="cb320-7"><a href="#cb320-7" aria-hidden="true"></a>        myMap = <span class="bu">Collections</span>.<span class="fu">unmodifiableMap</span>(aMap);</span>
<span id="cb320-8"><a href="#cb320-8" aria-hidden="true"></a>    }</span>
<span id="cb320-9"><a href="#cb320-9" aria-hidden="true"></a>}</span></code></pre></div>
</section>
<section id="answer-2-score-426" class="level4">
<h4>Answer 2 (score 426)</h4>
<p>I like the <a href="https://github.com/google/guava" rel="noreferrer">Guava</a> way of initialising a static, immutable map:</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true"></a><span class="dt">static</span> <span class="dt">final</span> <span class="bu">Map</span>&lt;<span class="bu">Integer</span>, <span class="bu">String</span>&gt; MY_MAP = ImmutableMap.<span class="fu">of</span>(</span>
<span id="cb321-2"><a href="#cb321-2" aria-hidden="true"></a>    <span class="dv">1</span>, <span class="st">&quot;one&quot;</span>,</span>
<span id="cb321-3"><a href="#cb321-3" aria-hidden="true"></a>    <span class="dv">2</span>, <span class="st">&quot;two&quot;</span></span>
<span id="cb321-4"><a href="#cb321-4" aria-hidden="true"></a>);</span></code></pre></div>
<p>As you can see, it’s very concise (because of the convenient factory methods in <a href="https://google.github.io/guava/releases/snapshot/api/docs/com/google/common/collect/ImmutableMap.html" rel="noreferrer"><code>ImmutableMap</code></a>).</p>
<p>If you want the map to have more than 5 entries, you can no longer use <code>ImmutableMap.of()</code>. Instead, try <a href="https://google.github.io/guava/releases/snapshot/api/docs/com/google/common/collect/ImmutableMap.html
#builder--" rel="noreferrer"><code>ImmutableMap.builder()</code></a> along these lines:</p>
<div class="sourceCode" id="cb322"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb322-1"><a href="#cb322-1" aria-hidden="true"></a><span class="dt">static</span> <span class="dt">final</span> <span class="bu">Map</span>&lt;<span class="bu">Integer</span>, <span class="bu">String</span>&gt; MY_MAP = ImmutableMap.&lt;<span class="bu">Integer</span>, <span class="bu">String</span>&gt;<span class="fu">builder</span>()</span>
<span id="cb322-2"><a href="#cb322-2" aria-hidden="true"></a>    .<span class="fu">put</span>(<span class="dv">1</span>, <span class="st">&quot;one&quot;</span>)</span>
<span id="cb322-3"><a href="#cb322-3" aria-hidden="true"></a>    .<span class="fu">put</span>(<span class="dv">2</span>, <span class="st">&quot;two&quot;</span>)</span>
<span id="cb322-4"><a href="#cb322-4" aria-hidden="true"></a>    <span class="co">// ... </span></span>
<span id="cb322-5"><a href="#cb322-5" aria-hidden="true"></a>    .<span class="fu">put</span>(<span class="dv">15</span>, <span class="st">&quot;fifteen&quot;</span>)</span>
<span id="cb322-6"><a href="#cb322-6" aria-hidden="true"></a>    .<span class="fu">build</span>();</span></code></pre></div>
<p>To learn more about the benefits of Guava’s immutable collection utilities, see <a href="https://code.google.com/p/guava-libraries/wiki/ImmutableCollectionsExplained" rel="noreferrer"><em>Immutable Collections Explained</em> in Guava User Guide</a>.</p>
<p>(A subset of) Guava used to be called <em>Google Collections</em>. If you aren’t using this library in your Java project yet, I <strong>strongly</strong> recommend trying it out! Guava has quickly become one of the most popular and useful free 3rd party libs for Java, as <a href="https://stackoverflow.com/questions/130095/most-useful-free-third-party-java-libraries/132639
#132639">fellow SO users agree</a>. (If you are new to it, there are some excellent learning resources behind that link.)</p>
<hr>
<p><strong>Update (2015)</strong>: As for <strong>Java 8</strong>, well, I would still use the Guava approach because it is way cleaner than anything else. If you don’t want Guava dependency, consider a <a href="https://stackoverflow.com/a/509016/56285">plain old init method</a>. The hack with <a href="https://stackoverflow.com/a/25829097/56285">two-dimensional array and Stream API</a> is pretty ugly if you ask me, and gets uglier if you need to create a Map whose keys and values are not the same type (like <code>Map&amp;lt;Integer, String&amp;gt;</code> in the question).</p>
<p>As for future of Guava in general, with regards to Java 8, Louis Wasserman <a href="https://groups.google.com/d/msg/guava-discuss/fEdrMyNa8tA/F4XFm6-uA6oJ" rel="noreferrer">said this</a> back in 2014, and [<em>update</em>] in 2016 it was announced that <a href="https://groups.google.com/forum/?utm_medium=email&amp;utm_source=footer
#!msg/guava-announce/o954PqvaXLY/7ss96X6sAwAJ" rel="noreferrer"><strong>Guava 21 will require and properly support Java 8</strong></a>.</p>
<hr>
<p><strong>Update (2016)</strong>: As <a href="https://stackoverflow.com/questions/507602/how-can-i-initialise-a-static-map/34508760
#34508760">Tagir Valeev points out</a>, <strong>Java 9</strong> will finally make this clean to do using nothing but pure JDK, by adding <a href="http://openjdk.java.net/jeps/269" rel="noreferrer">convenience factory methods</a> for collections:</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true"></a><span class="dt">static</span> <span class="dt">final</span> <span class="bu">Map</span>&lt;<span class="bu">Integer</span>, <span class="bu">String</span>&gt; MY_MAP = <span class="bu">Map</span>.<span class="fu">of</span>(</span>
<span id="cb323-2"><a href="#cb323-2" aria-hidden="true"></a>    <span class="dv">1</span>, <span class="st">&quot;one&quot;</span>, </span>
<span id="cb323-3"><a href="#cb323-3" aria-hidden="true"></a>    <span class="dv">2</span>, <span class="st">&quot;two&quot;</span></span>
<span id="cb323-4"><a href="#cb323-4" aria-hidden="true"></a>);</span></code></pre></div>
</section>
<section id="answer-3-score-173" class="level4">
<h4>Answer 3 (score 173)</h4>
<p>I would use:</p>
<div class="sourceCode" id="cb324"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb324-1"><a href="#cb324-1" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">class</span> Test {</span>
<span id="cb324-2"><a href="#cb324-2" aria-hidden="true"></a>    <span class="kw">private</span> <span class="dt">static</span> <span class="dt">final</span> <span class="bu">Map</span>&lt;<span class="bu">Integer</span>, <span class="bu">String</span>&gt; MY_MAP = <span class="fu">createMap</span>();</span>
<span id="cb324-3"><a href="#cb324-3" aria-hidden="true"></a></span>
<span id="cb324-4"><a href="#cb324-4" aria-hidden="true"></a>    <span class="kw">private</span> <span class="dt">static</span> <span class="bu">Map</span>&lt;<span class="bu">Integer</span>, <span class="bu">String</span>&gt; <span class="fu">createMap</span>() {</span>
<span id="cb324-5"><a href="#cb324-5" aria-hidden="true"></a>        <span class="bu">Map</span>&lt;<span class="bu">Integer</span>, <span class="bu">String</span>&gt; result = <span class="kw">new</span> <span class="bu">HashMap</span>&lt;<span class="bu">Integer</span>, <span class="bu">String</span>&gt;();</span>
<span id="cb324-6"><a href="#cb324-6" aria-hidden="true"></a>        result.<span class="fu">put</span>(<span class="dv">1</span>, <span class="st">&quot;one&quot;</span>);</span>
<span id="cb324-7"><a href="#cb324-7" aria-hidden="true"></a>        result.<span class="fu">put</span>(<span class="dv">2</span>, <span class="st">&quot;two&quot;</span>);</span>
<span id="cb324-8"><a href="#cb324-8" aria-hidden="true"></a>        <span class="kw">return</span> <span class="bu">Collections</span>.<span class="fu">unmodifiableMap</span>(result);</span>
<span id="cb324-9"><a href="#cb324-9" aria-hidden="true"></a>    }</span>
<span id="cb324-10"><a href="#cb324-10" aria-hidden="true"></a>}</span></code></pre></div>
<ol>
<li>
it avoids anonymous class, which I personally consider to be a bad style, and avoid
</li>
<li>
it makes creation of map more explicit
</li>
<li>
it makes map unmodifiable
</li>
<li>
as MY_MAP is constant, I would name it like constant
</li>
</ol>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-do-i-test-a-private-function-or-a-class-that-has-private-methods-fields-or-inner-classes-score-804279-in-2019" class="level3">
<h3>42: How do I test a private function or a class that has private methods, fields or inner classes? (score <a href="https://stackoverflow.com/q/34571.html">804279</a> in 2019)</h3>
<section id="question-40" class="level4">
<h4>Question</h4>
<p>How do I unit test (using xUnit) a class that has internal private methods, fields or nested classes? Or a function that is made private by having <a href="https://stackoverflow.com/questions/1358400/what-is-external-linkage-and-internal-linkage">internal linkage</a> (<code>static</code> in C/C++) or is in a private (<a href="https://stackoverflow.com/questions/154469/unnamed-anonymous-namespaces-vs-static-functions">anonymous</a>) namespace?</p>
<p>It seems bad to change the access modifier for a method or function just to be able to run a test.</p>
</section>
<section id="answer-accepted-score-1562" class="level4">
<h4>Answer accepted (score 1562)</h4>
<blockquote>
<p><strong>Update:</strong></p>
<p>Some 10 years later perhaps the best way to test a private method, or any inaccessible member, is via <strong><code>@Jailbreak</code></strong> from the <a href="https://manifold.systems" rel="noreferrer">Manifold</a> framework.</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb325-1"><a href="#cb325-1" aria-hidden="true"></a><span class="at">@Jailbreak</span> Foo foo = <span class="kw">new</span> <span class="fu">Foo</span>();</span>
<span id="cb325-2"><a href="#cb325-2" aria-hidden="true"></a><span class="co">// Direct, *type-safe* access to *all* foo&#39;s members</span></span>
<span id="cb325-3"><a href="#cb325-3" aria-hidden="true"></a>foo.<span class="fu">privateMethod</span>(x, y, z);</span>
<span id="cb325-4"><a href="#cb325-4" aria-hidden="true"></a>foo.<span class="fu">privateField</span> = value;</span></code></pre></div>
This way your code remains type-safe and readable. No design compromises, no overexposing methods and fields for the sake of tests.
</blockquote>
<p>If you have somewhat of a legacy <strong>Java</strong> application, and you’re not allowed to change the visibility of your methods, the best way to test private methods is to use <a href="http://en.wikipedia.org/wiki/Reflection_%28computer_programming%29" rel="noreferrer">reflection</a>.</p>
<p>Internally we’re using helpers to get/set <code>private</code> and <code>private static</code> variables as well as invoke <code>private</code> and <code>private static</code> methods. The following patterns will let you do pretty much anything related to the private methods and fields. Of course, you can’t change <code>private static final</code> variables through reflection.</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb326-1"><a href="#cb326-1" aria-hidden="true"></a><span class="bu">Method</span> method = TargetClass.<span class="fu">getDeclaredMethod</span>(methodName, argClasses);</span>
<span id="cb326-2"><a href="#cb326-2" aria-hidden="true"></a>method.<span class="fu">setAccessible</span>(<span class="kw">true</span>);</span>
<span id="cb326-3"><a href="#cb326-3" aria-hidden="true"></a><span class="kw">return</span> method.<span class="fu">invoke</span>(targetObject, argObjects);</span></code></pre></div>
<p>And for fields:</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb327-1"><a href="#cb327-1" aria-hidden="true"></a><span class="bu">Field</span> field = TargetClass.<span class="fu">getDeclaredField</span>(fieldName);</span>
<span id="cb327-2"><a href="#cb327-2" aria-hidden="true"></a>field.<span class="fu">setAccessible</span>(<span class="kw">true</span>);</span>
<span id="cb327-3"><a href="#cb327-3" aria-hidden="true"></a>field.<span class="fu">set</span>(object, value);</span></code></pre></div>
<hr>
<blockquote>
<p>
<strong>Notes:</strong><br> 1. <code>TargetClass.getDeclaredMethod(methodName, argClasses)</code> lets you look into <code>private</code> methods. The same thing applies for <code>getDeclaredField</code>.<br> 2. The <code>setAccessible(true)</code> is required to play around with privates.
</p>
</blockquote>
</section>
<section id="answer-2-score-574" class="level4">
<h4>Answer 2 (score 574)</h4>
<p>The best way to test a private method is via another public method. If this cannot be done, then one of the following conditions is true:</p>
<ol>
<li>
The private method is dead code
</li>
<li>
There is a design smell near the class that you are testing
</li>
<li>
The method that you are trying to test should not be private
</li>
</ol>
</section>
<section id="answer-3-score-301" class="level4">
<h4>Answer 3 (score 301)</h4>
<p>When I have private methods in a class that are sufficiently complicated that I feel the need to test the private methods directly, that is a code smell: my class is too complicated.</p>
<p>My usual approach to addressing such issues is to tease out a new class that contains the interesting bits. Often, this method and the fields it interacts with, and maybe another method or two can be extracted in to a new class.</p>
<p>The new class exposes these methods as ‘public’, so they’re accessible for unit testing. The new and old classes are now both simpler than the original class, which is great for me (I need to keep things simple, or I get lost!).</p>
<p>Note that I’m not suggesting that people create classes without using their brain! The point here is to use the forces of unit testing to help you find good new classes.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-do-i-call-one-constructor-from-another-in-java-score-798292-in-2008" class="level3">
<h3>43: How do I call one constructor from another in Java? (score <a href="https://stackoverflow.com/q/285177.html">798292</a> in 2008)</h3>
<section id="question-41" class="level4">
<h4>Question</h4>
<p>Is it possible to call a constructor from another (within the same class, not from a subclass)? If yes how? And what could be the best way to call another constructor (if there are several ways to do it)?</p>
</section>
<section id="answer-accepted-score-2825" class="level4">
<h4>Answer accepted (score 2825)</h4>
<p>Yes, it is possible:</p>
<div class="sourceCode" id="cb328"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb328-1"><a href="#cb328-1" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">class</span> Foo {</span>
<span id="cb328-2"><a href="#cb328-2" aria-hidden="true"></a>    <span class="kw">private</span> <span class="dt">int</span> x;</span>
<span id="cb328-3"><a href="#cb328-3" aria-hidden="true"></a></span>
<span id="cb328-4"><a href="#cb328-4" aria-hidden="true"></a>    <span class="kw">public</span> <span class="fu">Foo</span>() {</span>
<span id="cb328-5"><a href="#cb328-5" aria-hidden="true"></a>        <span class="kw">this</span>(<span class="dv">1</span>);</span>
<span id="cb328-6"><a href="#cb328-6" aria-hidden="true"></a>    }</span>
<span id="cb328-7"><a href="#cb328-7" aria-hidden="true"></a></span>
<span id="cb328-8"><a href="#cb328-8" aria-hidden="true"></a>    <span class="kw">public</span> <span class="fu">Foo</span>(<span class="dt">int</span> x) {</span>
<span id="cb328-9"><a href="#cb328-9" aria-hidden="true"></a>        <span class="kw">this</span>.<span class="fu">x</span> = x;</span>
<span id="cb328-10"><a href="#cb328-10" aria-hidden="true"></a>    }</span>
<span id="cb328-11"><a href="#cb328-11" aria-hidden="true"></a>}</span></code></pre></div>
<p>To chain to a particular superclass constructor instead of one in the same class, use <code>super</code> instead of <code>this</code>. Note that <strong>you can only chain to one constructor</strong>, and <strong>it has to be the first statement in your constructor body</strong>.</p>
<p>See also <a href="https://stackoverflow.com/questions/284896">this related question</a>, which is about C # but where the same principles apply.</p>
</section>
<section id="answer-2-score-233" class="level4">
<h4>Answer 2 (score 233)</h4>
<p>Using <code>this(args)</code>. The preferred pattern is to work from the smallest constructor to the largest.</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb329-1"><a href="#cb329-1" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">class</span> Cons {</span>
<span id="cb329-2"><a href="#cb329-2" aria-hidden="true"></a></span>
<span id="cb329-3"><a href="#cb329-3" aria-hidden="true"></a>    <span class="kw">public</span> <span class="fu">Cons</span>() {</span>
<span id="cb329-4"><a href="#cb329-4" aria-hidden="true"></a>        <span class="co">// A no arguments constructor that sends default values to the largest</span></span>
<span id="cb329-5"><a href="#cb329-5" aria-hidden="true"></a>        <span class="kw">this</span>(madeUpArg1Value,madeUpArg2Value,madeUpArg3Value);</span>
<span id="cb329-6"><a href="#cb329-6" aria-hidden="true"></a>    }</span>
<span id="cb329-7"><a href="#cb329-7" aria-hidden="true"></a></span>
<span id="cb329-8"><a href="#cb329-8" aria-hidden="true"></a>    <span class="kw">public</span> <span class="fu">Cons</span>(<span class="dt">int</span> arg1, <span class="dt">int</span> arg2) {</span>
<span id="cb329-9"><a href="#cb329-9" aria-hidden="true"></a>       <span class="co">// An example of a partial constructor that uses the passed in arguments</span></span>
<span id="cb329-10"><a href="#cb329-10" aria-hidden="true"></a>        <span class="co">// and sends a hidden default value to the largest</span></span>
<span id="cb329-11"><a href="#cb329-11" aria-hidden="true"></a>        <span class="kw">this</span>(arg1,arg2, madeUpArg3Value);</span>
<span id="cb329-12"><a href="#cb329-12" aria-hidden="true"></a>    }</span>
<span id="cb329-13"><a href="#cb329-13" aria-hidden="true"></a></span>
<span id="cb329-14"><a href="#cb329-14" aria-hidden="true"></a>    <span class="co">// Largest constructor that does the work</span></span>
<span id="cb329-15"><a href="#cb329-15" aria-hidden="true"></a>    <span class="kw">public</span> <span class="fu">Cons</span>(<span class="dt">int</span> arg1, <span class="dt">int</span> arg2, <span class="dt">int</span> arg3) {</span>
<span id="cb329-16"><a href="#cb329-16" aria-hidden="true"></a>        <span class="kw">this</span>.<span class="fu">arg1</span> = arg1;</span>
<span id="cb329-17"><a href="#cb329-17" aria-hidden="true"></a>        <span class="kw">this</span>.<span class="fu">arg2</span> = arg2;</span>
<span id="cb329-18"><a href="#cb329-18" aria-hidden="true"></a>        <span class="kw">this</span>.<span class="fu">arg3</span> = arg3;</span>
<span id="cb329-19"><a href="#cb329-19" aria-hidden="true"></a>    }</span>
<span id="cb329-20"><a href="#cb329-20" aria-hidden="true"></a>}</span></code></pre></div>
<p>You can also use a more recently advocated approach of valueOf or just “of”:</p>
<div class="sourceCode" id="cb330"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb330-1"><a href="#cb330-1" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">class</span> Cons {</span>
<span id="cb330-2"><a href="#cb330-2" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">static</span> Cons <span class="fu">newCons</span>(<span class="dt">int</span> arg1,...) {</span>
<span id="cb330-3"><a href="#cb330-3" aria-hidden="true"></a>        <span class="co">// This function is commonly called valueOf, like Integer.valueOf(..)</span></span>
<span id="cb330-4"><a href="#cb330-4" aria-hidden="true"></a>        <span class="co">// More recently called &quot;of&quot;, like EnumSet.of(..)</span></span>
<span id="cb330-5"><a href="#cb330-5" aria-hidden="true"></a>        Cons c = <span class="kw">new</span> <span class="fu">Cons</span>(...);</span>
<span id="cb330-6"><a href="#cb330-6" aria-hidden="true"></a>        c.<span class="fu">setArg1</span>(....);</span>
<span id="cb330-7"><a href="#cb330-7" aria-hidden="true"></a>        <span class="kw">return</span> c;</span>
<span id="cb330-8"><a href="#cb330-8" aria-hidden="true"></a>    }</span>
<span id="cb330-9"><a href="#cb330-9" aria-hidden="true"></a>} </span></code></pre></div>
<p>To call a super class, use <code>super(someValue)</code>. The call to super must be the first call in the constructor or you will get a compiler error.</p>
</section>
<section id="answer-3-score-195-1" class="level4">
<h4>Answer 3 (score 195)</h4>
<p>[<em>Note: I just want to add one aspect, which I did not see in the other answers: how to overcome limitations of the requirement that this() has to be on the first line).</em>]</p>
<p>In Java another constructor of the same class can be called from a constructor via <code>this()</code>. Note however that <code>this</code> has to be on the first line.</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb331-1"><a href="#cb331-1" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">class</span> MyClass {</span>
<span id="cb331-2"><a href="#cb331-2" aria-hidden="true"></a></span>
<span id="cb331-3"><a href="#cb331-3" aria-hidden="true"></a>  <span class="kw">public</span> <span class="fu">MyClass</span>(<span class="dt">double</span> argument1, <span class="dt">double</span> argument2) {</span>
<span id="cb331-4"><a href="#cb331-4" aria-hidden="true"></a>    <span class="kw">this</span>(argument1, argument2, <span class="fl">0.</span><span class="dv">0</span>);</span>
<span id="cb331-5"><a href="#cb331-5" aria-hidden="true"></a>  }</span>
<span id="cb331-6"><a href="#cb331-6" aria-hidden="true"></a></span>
<span id="cb331-7"><a href="#cb331-7" aria-hidden="true"></a>  <span class="kw">public</span> <span class="fu">MyClass</span>(<span class="dt">double</span> argument1, <span class="dt">double</span> argument2, <span class="dt">double</span> argument3) {</span>
<span id="cb331-8"><a href="#cb331-8" aria-hidden="true"></a>    <span class="kw">this</span>.<span class="fu">argument1</span> = argument1;</span>
<span id="cb331-9"><a href="#cb331-9" aria-hidden="true"></a>    <span class="kw">this</span>.<span class="fu">argument2</span> = argument2;</span>
<span id="cb331-10"><a href="#cb331-10" aria-hidden="true"></a>    <span class="kw">this</span>.<span class="fu">argument3</span> = argument3;</span>
<span id="cb331-11"><a href="#cb331-11" aria-hidden="true"></a>  }</span>
<span id="cb331-12"><a href="#cb331-12" aria-hidden="true"></a>}</span></code></pre></div>
<p>That <code>this</code> has to appear on the first line looks like a big limitation, but you can construct the arguments of other constructors via static methods. For example:</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">class</span> MyClass {</span>
<span id="cb332-2"><a href="#cb332-2" aria-hidden="true"></a></span>
<span id="cb332-3"><a href="#cb332-3" aria-hidden="true"></a>  <span class="kw">public</span> <span class="fu">MyClass</span>(<span class="dt">double</span> argument1, <span class="dt">double</span> argument2) {</span>
<span id="cb332-4"><a href="#cb332-4" aria-hidden="true"></a>    <span class="kw">this</span>(argument1, argument2, <span class="fu">getDefaultArg3</span>(argument1, argument2));</span>
<span id="cb332-5"><a href="#cb332-5" aria-hidden="true"></a>  }</span>
<span id="cb332-6"><a href="#cb332-6" aria-hidden="true"></a></span>
<span id="cb332-7"><a href="#cb332-7" aria-hidden="true"></a>  <span class="kw">public</span> <span class="fu">MyClass</span>(<span class="dt">double</span> argument1, <span class="dt">double</span> argument2, <span class="dt">double</span> argument3) {</span>
<span id="cb332-8"><a href="#cb332-8" aria-hidden="true"></a>    <span class="kw">this</span>.<span class="fu">argument1</span> = argument1;</span>
<span id="cb332-9"><a href="#cb332-9" aria-hidden="true"></a>    <span class="kw">this</span>.<span class="fu">argument2</span> = argument2;</span>
<span id="cb332-10"><a href="#cb332-10" aria-hidden="true"></a>    <span class="kw">this</span>.<span class="fu">argument3</span> = argument3;</span>
<span id="cb332-11"><a href="#cb332-11" aria-hidden="true"></a>  }</span>
<span id="cb332-12"><a href="#cb332-12" aria-hidden="true"></a></span>
<span id="cb332-13"><a href="#cb332-13" aria-hidden="true"></a>  <span class="kw">private</span> <span class="dt">static</span> <span class="dt">double</span> <span class="fu">getDefaultArg3</span>(<span class="dt">double</span> argument1, <span class="dt">double</span> argument2) {</span>
<span id="cb332-14"><a href="#cb332-14" aria-hidden="true"></a>    <span class="dt">double</span> argument3 = <span class="dv">0</span>;</span>
<span id="cb332-15"><a href="#cb332-15" aria-hidden="true"></a></span>
<span id="cb332-16"><a href="#cb332-16" aria-hidden="true"></a>    <span class="co">// Calculate argument3 here if you like.</span></span>
<span id="cb332-17"><a href="#cb332-17" aria-hidden="true"></a></span>
<span id="cb332-18"><a href="#cb332-18" aria-hidden="true"></a>    <span class="kw">return</span> argument3;</span>
<span id="cb332-19"><a href="#cb332-19" aria-hidden="true"></a></span>
<span id="cb332-20"><a href="#cb332-20" aria-hidden="true"></a>  }</span>
<span id="cb332-21"><a href="#cb332-21" aria-hidden="true"></a></span>
<span id="cb332-22"><a href="#cb332-22" aria-hidden="true"></a>}</span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-to-add-local-jar-files-to-a-maven-project-score-786969-in-2018" class="level3">
<h3>44: How to add local jar files to a Maven project? (score <a href="https://stackoverflow.com/q/4955635.html">786969</a> in 2018)</h3>
<section id="question-42" class="level4">
<h4>Question</h4>
<p>How do I add local jar files (not yet part of the Maven repository) directly in my project’s library sources?</p>
</section>
<section id="answer-accepted-score-592" class="level4">
<h4>Answer accepted (score 592)</h4>
<p>Install the JAR into your local Maven repository as follows:</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb333-1"><a href="#cb333-1" aria-hidden="true"></a>mvn install:install-file \</span>
<span id="cb333-2"><a href="#cb333-2" aria-hidden="true"></a>   -Dfile=&lt;path-to-file&gt; \</span>
<span id="cb333-3"><a href="#cb333-3" aria-hidden="true"></a>   -DgroupId=&lt;group-id&gt; \</span>
<span id="cb333-4"><a href="#cb333-4" aria-hidden="true"></a>   -DartifactId=&lt;artifact-id&gt; \</span>
<span id="cb333-5"><a href="#cb333-5" aria-hidden="true"></a>   -Dversion=&lt;version&gt; \</span>
<span id="cb333-6"><a href="#cb333-6" aria-hidden="true"></a>   -Dpackaging=&lt;packaging&gt; \</span>
<span id="cb333-7"><a href="#cb333-7" aria-hidden="true"></a>   -DgeneratePom=<span class="kw">true</span></span></code></pre></div>
<p>Where each refers to:</p>
<p><code>&amp;lt;path-to-file&amp;gt;</code>: the path to the file to load e.g → <code>c:\kaptcha-2.3.jar</code></p>
<p><code>&amp;lt;group-id&amp;gt;</code>: the group that the file should be registered under e.g → <code>com.google.code</code></p>
<p><code>&amp;lt;artifact-id&amp;gt;</code>: the artifact name for the file e.g → <code>kaptcha</code></p>
<p><code>&amp;lt;version&amp;gt;</code>: the version of the file e.g → <code>2.3</code></p>
<p><code>&amp;lt;packaging&amp;gt;</code>: the packaging of the file e.g. → <code>jar</code></p>
<p><strong>Reference</strong></p>
<ul>
<li>
Maven FAQ: <a href="http://maven.apache.org/general.html
#importing-jars" rel="noreferrer">I have a jar that I want to put into my local repository. How can I copy it in?</a>
</li>
<li>
Maven Install Plugin Usage: <a href="https://maven.apache.org/plugins/maven-install-plugin/usage.html
#The_install:install-file_goal" rel="noreferrer">The <code>install:install-file</code> goal</a>
</li>
</ul>
</section>
<section id="answer-2-score-1299" class="level4">
<h4>Answer 2 (score 1299)</h4>
<p>You can add local dependencies directly (as mentioned in <a href="https://stackoverflow.com/questions/4491199/build-maven-project-with-propriatery-libraries-included/4491343
#4491343">build maven project with propriatery libraries included</a>) like this:</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb334-1"><a href="#cb334-1" aria-hidden="true"></a>&lt;dependency&gt;</span>
<span id="cb334-2"><a href="#cb334-2" aria-hidden="true"></a>    &lt;groupId&gt;com.<span class="fu">sample</span>&lt;/groupId&gt;</span>
<span id="cb334-3"><a href="#cb334-3" aria-hidden="true"></a>    &lt;artifactId&gt;sample&lt;/artifactId&gt;</span>
<span id="cb334-4"><a href="#cb334-4" aria-hidden="true"></a>    &lt;version&gt;<span class="fl">1.</span><span class="dv">0</span>&lt;/version&gt;</span>
<span id="cb334-5"><a href="#cb334-5" aria-hidden="true"></a>    &lt;scope&gt;system&lt;/scope&gt;</span>
<span id="cb334-6"><a href="#cb334-6" aria-hidden="true"></a>    &lt;systemPath&gt;${project.<span class="fu">basedir</span>}/src/main/resources/Name_Your_JAR.<span class="fu">jar</span>&lt;/systemPath&gt;</span>
<span id="cb334-7"><a href="#cb334-7" aria-hidden="true"></a>&lt;/dependency&gt;</span></code></pre></div>
<p><strong>Update</strong></p>
<p>In new releases this feature is marked as deprecated but still working and not removed yet ( You just see warning in the log during maven start). An issue is raised at maven group about this <a href="https://issues.apache.org/jira/browse/MNG-6523" rel="noreferrer">https://issues.apache.org/jira/browse/MNG-6523</a> ( You can participate and describe why this feature is helpful in some cases). I hope this feature remains there!</p>
<p>If you are asking me, as long as the feature is not removed, I use this to <strong>make dependency to only <em>one</em> naughty jar file</strong> in my project which is not fit in repository. If this feature is removed, well, there are lots of good answers here which I can chose from later!</p>
</section>
<section id="answer-3-score-120" class="level4">
<h4>Answer 3 (score 120)</h4>
<p>Firstly, I would like to give credit for this answer to an anonymous Stack Overflow user - I am pretty sure I’ve seen a similar answer here before - but now I cannot find it.</p>
<p>The best option for having local JAR files as a dependency is to create a local Maven repository. Such a repository is nothing more than a proper directory structure with pom files in it.</p>
<p>
For my example: I have my master project on <code>${master_project}</code> location and subproject1 is on <code>${master_project}/${subproject1}</code>.
</p>
<p>
Then I create a Maven repository in: <code>${master_project}/local-maven-repo</code>.
</p>
<p>In the pom file in subproject1 located at <code>${master_project}/${subproject1}/pom.xml</code>, the repository needs to be specified which would take file path as a URL parameter:</p>
<div class="sourceCode" id="cb335"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb335-1"><a href="#cb335-1" aria-hidden="true"></a>&lt;repositories&gt;</span>
<span id="cb335-2"><a href="#cb335-2" aria-hidden="true"></a>    &lt;repository&gt;</span>
<span id="cb335-3"><a href="#cb335-3" aria-hidden="true"></a>        &lt;id&gt;local-maven-repo&lt;/id&gt;</span>
<span id="cb335-4"><a href="#cb335-4" aria-hidden="true"></a>        &lt;url&gt;file:<span class="co">///${project.parent.basedir}/local-maven-repo&lt;/url&gt;</span></span>
<span id="cb335-5"><a href="#cb335-5" aria-hidden="true"></a>    &lt;/repository&gt;</span>
<span id="cb335-6"><a href="#cb335-6" aria-hidden="true"></a>&lt;/repositories&gt;</span></code></pre></div>
<p>The dependency can be specified as for any other repository. This makes your pom repository independent. For instance, once the desired JAR is available in Maven central, you just need to delete it from your local repo and it will be pulled from the default repo.</p>
<div class="sourceCode" id="cb336"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb336-1"><a href="#cb336-1" aria-hidden="true"></a>    &lt;dependency&gt;</span>
<span id="cb336-2"><a href="#cb336-2" aria-hidden="true"></a>        &lt;groupId&gt;org.<span class="fu">apache</span>.<span class="fu">felix</span>&lt;/groupId&gt;</span>
<span id="cb336-3"><a href="#cb336-3" aria-hidden="true"></a>        &lt;artifactId&gt;org.<span class="fu">apache</span>.<span class="fu">felix</span>.<span class="fu">servicebinder</span>&lt;/artifactId&gt;</span>
<span id="cb336-4"><a href="#cb336-4" aria-hidden="true"></a>        &lt;version&gt;<span class="fl">0.9.</span><span class="dv">0</span>-SNAPSHOT&lt;/version&gt;</span>
<span id="cb336-5"><a href="#cb336-5" aria-hidden="true"></a>    &lt;/dependency&gt;</span></code></pre></div>
<p>The last but not least thing to do is to add the JAR file to local repository using -DlocalRepositoryPath switch like so:</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb337-1"><a href="#cb337-1" aria-hidden="true"></a>mvn org.<span class="fu">apache</span>.<span class="fu">maven</span>.<span class="fu">plugins</span>:maven-install-plugin:<span class="fl">2.5.</span><span class="dv">2</span>:install-file  \</span>
<span id="cb337-2"><a href="#cb337-2" aria-hidden="true"></a>    -Dfile=/some/path/on/my/local/filesystem/felix/servicebinder/target/org.<span class="fu">apache</span>.<span class="fu">felix</span>.<span class="fu">servicebinder</span>-<span class="fl">0.9.</span><span class="dv">0</span>-SNAPSHOT.<span class="fu">jar</span> \</span>
<span id="cb337-3"><a href="#cb337-3" aria-hidden="true"></a>    -DgroupId=org.<span class="fu">apache</span>.<span class="fu">felix</span> -DartifactId=org.<span class="fu">apache</span>.<span class="fu">felix</span>.<span class="fu">servicebinder</span> \</span>
<span id="cb337-4"><a href="#cb337-4" aria-hidden="true"></a>    -Dversion=<span class="fl">0.9.</span><span class="dv">0</span>-SNAPSHOT -Dpackaging=jar \</span>
<span id="cb337-5"><a href="#cb337-5" aria-hidden="true"></a>    -DlocalRepositoryPath=${master_project}/local-maven-repo</span></code></pre></div>
<p>Once the JAR file is installed, your Maven repo can be committed to a code repository, and the whole set-up is system independent. (<a href="https://github.com/jjromannet/apache-felix-tutorials" rel="noreferrer">Working example in GitHub</a>).</p>
<p>I agree that having JARs committed to source code repo is not a good practice, but in real life, quick and dirty solutions are sometimes better than a full blown Nexus repo to host one JAR that you cannot publish.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="difference-between-stringbuilder-and-stringbuffer-score-761903-in-2016" class="level3">
<h3>45: Difference between StringBuilder and StringBuffer (score <a href="https://stackoverflow.com/q/355089.html">761903</a> in 2016)</h3>
<section id="question-43" class="level4">
<h4>Question</h4>
<p>
What is the main difference between <code>StringBuffer</code> and <code>StringBuilder</code>? Is there any performance issues when deciding on any one of these?
</p>
</section>
<section id="answer-accepted-score-1596" class="level4">
<h4>Answer accepted (score 1596)</h4>
<p><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/StringBuffer.html" rel="noreferrer"><code>StringBuffer</code></a> is synchronized, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/StringBuilder.html" rel="noreferrer"><code>StringBuilder</code></a> is not.</p>
</section>
<section id="answer-2-score-711" class="level4">
<h4>Answer 2 (score 711)</h4>
<p><a href="http://docs.oracle.com/javase/9/docs/api/java/lang/StringBuilder.html" rel="noreferrer"><code>StringBuilder</code></a> is faster than <a href="https://docs.oracle.com/javase/9/docs/api/java/lang/StringBuffer.html" rel="noreferrer"><code>StringBuffer</code></a> because it’s not <code>synchronized</code>.</p>
<p>Here’s a simple benchmark test:</p>
<div class="sourceCode" id="cb338"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb338-1"><a href="#cb338-1" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">class</span> Main {</span>
<span id="cb338-2"><a href="#cb338-2" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span>(<span class="bu">String</span>[] args) {</span>
<span id="cb338-3"><a href="#cb338-3" aria-hidden="true"></a>        <span class="dt">int</span> N = <span class="dv">77777777</span>;</span>
<span id="cb338-4"><a href="#cb338-4" aria-hidden="true"></a>        <span class="dt">long</span> t;</span>
<span id="cb338-5"><a href="#cb338-5" aria-hidden="true"></a></span>
<span id="cb338-6"><a href="#cb338-6" aria-hidden="true"></a>        {</span>
<span id="cb338-7"><a href="#cb338-7" aria-hidden="true"></a>            <span class="bu">StringBuffer</span> sb = <span class="kw">new</span> <span class="bu">StringBuffer</span>();</span>
<span id="cb338-8"><a href="#cb338-8" aria-hidden="true"></a>            t = <span class="bu">System</span>.<span class="fu">currentTimeMillis</span>();</span>
<span id="cb338-9"><a href="#cb338-9" aria-hidden="true"></a>            <span class="kw">for</span> (<span class="dt">int</span> i = N; i --&gt; <span class="dv">0</span> ;) {</span>
<span id="cb338-10"><a href="#cb338-10" aria-hidden="true"></a>                sb.<span class="fu">append</span>(<span class="st">&quot;&quot;</span>);</span>
<span id="cb338-11"><a href="#cb338-11" aria-hidden="true"></a>            }</span>
<span id="cb338-12"><a href="#cb338-12" aria-hidden="true"></a>            <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="bu">System</span>.<span class="fu">currentTimeMillis</span>() - t);</span>
<span id="cb338-13"><a href="#cb338-13" aria-hidden="true"></a>        }</span>
<span id="cb338-14"><a href="#cb338-14" aria-hidden="true"></a></span>
<span id="cb338-15"><a href="#cb338-15" aria-hidden="true"></a>        {</span>
<span id="cb338-16"><a href="#cb338-16" aria-hidden="true"></a>            <span class="bu">StringBuilder</span> sb = <span class="kw">new</span> <span class="bu">StringBuilder</span>();</span>
<span id="cb338-17"><a href="#cb338-17" aria-hidden="true"></a>            t = <span class="bu">System</span>.<span class="fu">currentTimeMillis</span>();</span>
<span id="cb338-18"><a href="#cb338-18" aria-hidden="true"></a>            <span class="kw">for</span> (<span class="dt">int</span> i = N; i &gt; <span class="dv">0</span> ; i--) {</span>
<span id="cb338-19"><a href="#cb338-19" aria-hidden="true"></a>                sb.<span class="fu">append</span>(<span class="st">&quot;&quot;</span>);</span>
<span id="cb338-20"><a href="#cb338-20" aria-hidden="true"></a>            }</span>
<span id="cb338-21"><a href="#cb338-21" aria-hidden="true"></a>            <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="bu">System</span>.<span class="fu">currentTimeMillis</span>() - t);</span>
<span id="cb338-22"><a href="#cb338-22" aria-hidden="true"></a>        }</span>
<span id="cb338-23"><a href="#cb338-23" aria-hidden="true"></a>    }</span>
<span id="cb338-24"><a href="#cb338-24" aria-hidden="true"></a>}</span></code></pre></div>
<p>A <a href="http://ideone.com/OpUDPU" rel="noreferrer">test run</a> gives the numbers of <code>2241 ms</code> for <code>StringBuffer</code> vs <code>753 ms</code> for <code>StringBuilder</code>.</p>
</section>
<section id="answer-3-score-239" class="level4">
<h4>Answer 3 (score 239)</h4>
<p>Basically, <code>StringBuffer</code> methods are synchronized while <code>StringBuilder</code> are not.</p>
<p>The operations are “almost” the same, but using synchronized methods in a single thread is overkill.</p>
<p>That’s pretty much about it.</p>
<p>Quote from <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/StringBuilder.html" rel="noreferrer">StringBuilder API</a>:</p>
<blockquote>
This class [StringBuilder] provides an API compatible with StringBuffer, <strong>but with no guarantee of synchronization</strong>. This class is designed for use as a drop-in replacement for StringBuffer in places where the string buffer was being used by a single thread (as is generally the case). Where possible, it is recommended that this class be used in preference to StringBuffer as <strong>it will be faster under most implementations.</strong>
</blockquote>
<p>So it was made to substitute it.</p>
<p>The same happened with <code>Vector</code> and <code>ArrayList</code>.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-to-create-a-generic-array-in-java-score-727576-in-2017" class="level3">
<h3>46: How to create a generic array in Java? (score <a href="https://stackoverflow.com/q/529085.html">727576</a> in 2017)</h3>
<section id="question-44" class="level4">
<h4>Question</h4>
<p>Due to the implementation of Java generics, you can’t have code like this:</p>
<div class="sourceCode" id="cb339"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb339-1"><a href="#cb339-1" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">class</span> GenSet&lt;E&gt; {</span>
<span id="cb339-2"><a href="#cb339-2" aria-hidden="true"></a>    <span class="kw">private</span> E a[];</span>
<span id="cb339-3"><a href="#cb339-3" aria-hidden="true"></a></span>
<span id="cb339-4"><a href="#cb339-4" aria-hidden="true"></a>    <span class="kw">public</span> <span class="fu">GenSet</span>() {</span>
<span id="cb339-5"><a href="#cb339-5" aria-hidden="true"></a>        a = <span class="kw">new</span> E[INITIAL_ARRAY_LENGTH]; <span class="co">// error: generic array creation</span></span>
<span id="cb339-6"><a href="#cb339-6" aria-hidden="true"></a>    }</span>
<span id="cb339-7"><a href="#cb339-7" aria-hidden="true"></a>}</span></code></pre></div>
<p>How can I implement this while maintaining type safety?</p>
<p>I saw a solution on the Java forums that goes like this:</p>
<div class="sourceCode" id="cb340"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb340-1"><a href="#cb340-1" aria-hidden="true"></a><span class="kw">import</span><span class="im"> java.lang.reflect.Array;</span></span>
<span id="cb340-2"><a href="#cb340-2" aria-hidden="true"></a></span>
<span id="cb340-3"><a href="#cb340-3" aria-hidden="true"></a><span class="kw">class</span> <span class="bu">Stack</span>&lt;T&gt; {</span>
<span id="cb340-4"><a href="#cb340-4" aria-hidden="true"></a>    <span class="kw">public</span> <span class="bu">Stack</span>(<span class="bu">Class</span>&lt;T&gt; clazz, <span class="dt">int</span> capacity) {</span>
<span id="cb340-5"><a href="#cb340-5" aria-hidden="true"></a>        array = (T[])<span class="bu">Array</span>.<span class="fu">newInstance</span>(clazz, capacity);</span>
<span id="cb340-6"><a href="#cb340-6" aria-hidden="true"></a>    }</span>
<span id="cb340-7"><a href="#cb340-7" aria-hidden="true"></a></span>
<span id="cb340-8"><a href="#cb340-8" aria-hidden="true"></a>    <span class="kw">private</span> <span class="dt">final</span> T[] array;</span>
<span id="cb340-9"><a href="#cb340-9" aria-hidden="true"></a>}</span></code></pre></div>
<p>But I really don’t get what’s going on.</p>
</section>
<section id="answer-accepted-score-671" class="level4">
<h4>Answer accepted (score 671)</h4>
<p>
I have to ask a question in return: is your <code>GenSet</code> “checked” or “unchecked”? What does that mean?
</p>
<ul>
<li>
<p>
<strong>Checked</strong>: <em>strong typing</em>. <code>GenSet</code> knows explicitly what type of objects it contains (i.e. its constructor was explicitly called with a <code>Class&amp;lt;E&amp;gt;</code> argument, and methods will throw an exception when they are passed arguments that are not of type <code>E</code>. See <a href="http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html
#checkedCollection%28java.util.Collection,%20java.lang.Class%29" rel="noreferrer"><code>Collections.checkedCollection</code></a>.
</p>
<p>-&gt; in that case, you should write:</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb341-1"><a href="#cb341-1" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">class</span> GenSet&lt;E&gt; {</span>
<span id="cb341-2"><a href="#cb341-2" aria-hidden="true"></a></span>
<span id="cb341-3"><a href="#cb341-3" aria-hidden="true"></a>    <span class="kw">private</span> E[] a;</span>
<span id="cb341-4"><a href="#cb341-4" aria-hidden="true"></a></span>
<span id="cb341-5"><a href="#cb341-5" aria-hidden="true"></a>    <span class="kw">public</span> <span class="fu">GenSet</span>(<span class="bu">Class</span>&lt;E&gt; c, <span class="dt">int</span> s) {</span>
<span id="cb341-6"><a href="#cb341-6" aria-hidden="true"></a>        <span class="co">// Use Array native method to create array</span></span>
<span id="cb341-7"><a href="#cb341-7" aria-hidden="true"></a>        <span class="co">// of a type only known at run time</span></span>
<span id="cb341-8"><a href="#cb341-8" aria-hidden="true"></a>        <span class="at">@SuppressWarnings</span>(<span class="st">&quot;unchecked&quot;</span>)</span>
<span id="cb341-9"><a href="#cb341-9" aria-hidden="true"></a>        <span class="dt">final</span> E[] a = (E[]) <span class="bu">Array</span>.<span class="fu">newInstance</span>(c, s);</span>
<span id="cb341-10"><a href="#cb341-10" aria-hidden="true"></a>        <span class="kw">this</span>.<span class="fu">a</span> = a;</span>
<span id="cb341-11"><a href="#cb341-11" aria-hidden="true"></a>    }</span>
<span id="cb341-12"><a href="#cb341-12" aria-hidden="true"></a></span>
<span id="cb341-13"><a href="#cb341-13" aria-hidden="true"></a>    E <span class="fu">get</span>(<span class="dt">int</span> i) {</span>
<span id="cb341-14"><a href="#cb341-14" aria-hidden="true"></a>        <span class="kw">return</span> a[i];</span>
<span id="cb341-15"><a href="#cb341-15" aria-hidden="true"></a>    }</span>
<span id="cb341-16"><a href="#cb341-16" aria-hidden="true"></a>}</span>
<span id="cb341-17"><a href="#cb341-17" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb341-18"><a href="#cb341-18" aria-hidden="true"></a>&lt;li&gt;&lt;p&gt;&lt;strong&gt;Unchecked&lt;/strong&gt;: &lt;em&gt;weak typing&lt;/em&gt;. No type checking is actually done on any of the objects passed as argument.&lt;/p&gt;</span>
<span id="cb341-19"><a href="#cb341-19" aria-hidden="true"></a></span>
<span id="cb341-20"><a href="#cb341-20" aria-hidden="true"></a>-&gt; in that <span class="kw">case</span>, you should write  </span>
<span id="cb341-21"><a href="#cb341-21" aria-hidden="true"></a></span>
<span id="cb341-22"><a href="#cb341-22" aria-hidden="true"></a>```java</span>
<span id="cb341-23"><a href="#cb341-23" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">class</span> GenSet&lt;E&gt; {</span>
<span id="cb341-24"><a href="#cb341-24" aria-hidden="true"></a></span>
<span id="cb341-25"><a href="#cb341-25" aria-hidden="true"></a>    <span class="kw">private</span> <span class="bu">Object</span>[] a;</span>
<span id="cb341-26"><a href="#cb341-26" aria-hidden="true"></a></span>
<span id="cb341-27"><a href="#cb341-27" aria-hidden="true"></a>    <span class="kw">public</span> <span class="fu">GenSet</span>(<span class="dt">int</span> s) {</span>
<span id="cb341-28"><a href="#cb341-28" aria-hidden="true"></a>        a = <span class="kw">new</span> <span class="bu">Object</span>[s];</span>
<span id="cb341-29"><a href="#cb341-29" aria-hidden="true"></a>    }</span>
<span id="cb341-30"><a href="#cb341-30" aria-hidden="true"></a></span>
<span id="cb341-31"><a href="#cb341-31" aria-hidden="true"></a>    E <span class="fu">get</span>(<span class="dt">int</span> i) {</span>
<span id="cb341-32"><a href="#cb341-32" aria-hidden="true"></a>        <span class="at">@SuppressWarnings</span>(<span class="st">&quot;unchecked&quot;</span>)</span>
<span id="cb341-33"><a href="#cb341-33" aria-hidden="true"></a>        <span class="dt">final</span> E e = (E) a[i];</span>
<span id="cb341-34"><a href="#cb341-34" aria-hidden="true"></a>        <span class="kw">return</span> e;</span>
<span id="cb341-35"><a href="#cb341-35" aria-hidden="true"></a>    }</span>
<span id="cb341-36"><a href="#cb341-36" aria-hidden="true"></a>}</span></code></pre></div>
<p>Note that the component type of the array should be the <a href="http://docs.oracle.com/javase/tutorial/java/generics/erasure.html" rel="noreferrer"><em>erasure</em></a> of the type parameter:</p>
<div class="sourceCode" id="cb342"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb342-1"><a href="#cb342-1" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">class</span> GenSet&lt;E <span class="kw">extends</span> Foo&gt; { <span class="co">// E has an upper bound of Foo</span></span>
<span id="cb342-2"><a href="#cb342-2" aria-hidden="true"></a></span>
<span id="cb342-3"><a href="#cb342-3" aria-hidden="true"></a>    <span class="kw">private</span> Foo[] a; <span class="co">// E erases to Foo, so use Foo[]</span></span>
<span id="cb342-4"><a href="#cb342-4" aria-hidden="true"></a></span>
<span id="cb342-5"><a href="#cb342-5" aria-hidden="true"></a>    <span class="kw">public</span> <span class="fu">GenSet</span>(<span class="dt">int</span> s) {</span>
<span id="cb342-6"><a href="#cb342-6" aria-hidden="true"></a>        a = <span class="kw">new</span> Foo[s];</span>
<span id="cb342-7"><a href="#cb342-7" aria-hidden="true"></a>    }</span>
<span id="cb342-8"><a href="#cb342-8" aria-hidden="true"></a></span>
<span id="cb342-9"><a href="#cb342-9" aria-hidden="true"></a>    ...</span>
<span id="cb342-10"><a href="#cb342-10" aria-hidden="true"></a>}</span>
<span id="cb342-11"><a href="#cb342-11" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb342-12"><a href="#cb342-12" aria-hidden="true"></a>&lt;/ul&gt;</span>
<span id="cb342-13"><a href="#cb342-13" aria-hidden="true"></a></span>
<span id="cb342-14"><a href="#cb342-14" aria-hidden="true"></a>All of <span class="kw">this</span> results from a known, and deliberate, weakness of generics in Java: it was implemented using erasure, so <span class="st">&quot;generic&quot;</span> classes don&#39;t know what type argument they were created with at run time, and therefore can not provide type-safety unless some explicit <span class="fu">mechanism</span> (type-checking) is implemented.  </span>
<span id="cb342-15"><a href="#cb342-15" aria-hidden="true"></a></span>
<span id="cb342-16"><a href="#cb342-16" aria-hidden="true"></a></span>
<span id="cb342-17"><a href="#cb342-17" aria-hidden="true"></a>#### Answer <span class="dv">2</span> (score <span class="dv">192</span>)</span>
<span id="cb342-18"><a href="#cb342-18" aria-hidden="true"></a>You can <span class="kw">do</span> <span class="kw">this</span>:  </span>
<span id="cb342-19"><a href="#cb342-19" aria-hidden="true"></a></span>
<span id="cb342-20"><a href="#cb342-20" aria-hidden="true"></a>```java</span>
<span id="cb342-21"><a href="#cb342-21" aria-hidden="true"></a>E[] arr = (E[])<span class="kw">new</span> <span class="bu">Object</span>[INITIAL_ARRAY_LENGTH];</span></code></pre></div>
<p>This is one of the suggested ways of implementing a generic collection in <em>Effective Java; Item 26</em>. No type errors, no need to cast the array repeatedly. <em>However</em> this triggers a warning because it is potentially dangerous, and should be used with caution. As detailed in the comments, this <code>Object[]</code> is now masquerading as our <code>E[]</code> type, and can cause unexpected errors or <code>ClassCastException</code>s if used unsafely.</p>
<p>As a rule of thumb, this behavior is safe as long as the cast array is used internally (e.g. to back a data structure), and not returned or exposed to client code. Should you need to return an array of a generic type to other code, the reflection <code>Array</code> class you mention is the right way to go.</p>
<hr>
<p>Worth mentioning that wherever possible, you’ll have a much happier time working with <code>List</code>s rather than arrays if you’re using generics. Certainly sometimes you don’t have a choice, but using the collections framework is far more robust.</p>
</section>
<section id="answer-3-score-61" class="level4">
<h4>Answer 3 (score 61)</h4>
<p>Here’s how to use generics to get an array of precisely the type you’re looking for while preserving type safety (as opposed to the other answers, which will either give you back an <code>Object</code> array or result in warnings at compile time):</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb343-1"><a href="#cb343-1" aria-hidden="true"></a><span class="kw">import</span><span class="im"> java.lang.reflect.Array;</span>  </span>
<span id="cb343-2"><a href="#cb343-2" aria-hidden="true"></a></span>
<span id="cb343-3"><a href="#cb343-3" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">class</span> GenSet&lt;E&gt; {  </span>
<span id="cb343-4"><a href="#cb343-4" aria-hidden="true"></a>    <span class="kw">private</span> E[] a;  </span>
<span id="cb343-5"><a href="#cb343-5" aria-hidden="true"></a></span>
<span id="cb343-6"><a href="#cb343-6" aria-hidden="true"></a>    <span class="kw">public</span> <span class="fu">GenSet</span>(<span class="bu">Class</span>&lt;E[]&gt; clazz, <span class="dt">int</span> length) {  </span>
<span id="cb343-7"><a href="#cb343-7" aria-hidden="true"></a>        a = clazz.<span class="fu">cast</span>(<span class="bu">Array</span>.<span class="fu">newInstance</span>(clazz.<span class="fu">getComponentType</span>(), length));  </span>
<span id="cb343-8"><a href="#cb343-8" aria-hidden="true"></a>    }  </span>
<span id="cb343-9"><a href="#cb343-9" aria-hidden="true"></a></span>
<span id="cb343-10"><a href="#cb343-10" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span>(<span class="bu">String</span>[] args) {  </span>
<span id="cb343-11"><a href="#cb343-11" aria-hidden="true"></a>        GenSet&lt;<span class="bu">String</span>&gt; foo = <span class="kw">new</span> GenSet&lt;<span class="bu">String</span>&gt;(<span class="bu">String</span>[].<span class="fu">class</span>, <span class="dv">1</span>);  </span>
<span id="cb343-12"><a href="#cb343-12" aria-hidden="true"></a>        <span class="bu">String</span>[] bar = foo.<span class="fu">a</span>;  </span>
<span id="cb343-13"><a href="#cb343-13" aria-hidden="true"></a>        foo.<span class="fu">a</span>[<span class="dv">0</span>] = <span class="st">&quot;xyzzy&quot;</span>;  </span>
<span id="cb343-14"><a href="#cb343-14" aria-hidden="true"></a>        <span class="bu">String</span> baz = foo.<span class="fu">a</span>[<span class="dv">0</span>];  </span>
<span id="cb343-15"><a href="#cb343-15" aria-hidden="true"></a>    }  </span>
<span id="cb343-16"><a href="#cb343-16" aria-hidden="true"></a>}</span></code></pre></div>
<p>That compiles without warnings, and as you can see in <code>main</code>, for whatever type you declare an instance of <code>GenSet</code> as, you can assign <code>a</code> to an array of that type, and you can assign an element from <code>a</code> to a variable of that type, meaning that the array and the values in the array are of the correct type.</p>
<p>It works by using class literals as runtime type tokens, as discussed in the <a href="http://download.oracle.com/javase/tutorial/extra/generics/literals.html" rel="noreferrer">Java Tutorials</a>. Class literals are treated by the compiler as instances of <code>java.lang.Class</code>. To use one, simply follow the name of a class with <code>.class</code>. So, <code>String.class</code> acts as a <code>Class</code> object representing the class <code>String</code>. This also works for interfaces, enums, any-dimensional arrays (e.g. <code>String[].class</code>), primitives (e.g. <code>int.class</code>), and the keyword <code>void</code> (i.e. <code>void.class</code>).</p>
<p><code>Class</code> itself is generic (declared as <code>Class&amp;lt;T&amp;gt;</code>, where <code>T</code> stands for the type that the <code>Class</code> object is representing), meaning that the type of <code>String.class</code> is <code>Class&amp;lt;String&amp;gt;</code>.</p>
<p>So, whenever you call the constructor for <code>GenSet</code>, you pass in a class literal for the first argument representing an array of the <code>GenSet</code> instance’s declared type (e.g. <code>String[].class</code> for <code>GenSet&amp;lt;String&amp;gt;</code>). Note that you won’t be able to get an array of primitives, since primitives can’t be used for type variables.</p>
<p>Inside the constructor, calling the method <code>cast</code> returns the passed <code>Object</code> argument cast to the class represented by the <code>Class</code> object on which the method was called. Calling the static method <code>newInstance</code> in <code>java.lang.reflect.Array</code> returns as an <code>Object</code> an array of the type represented by the <code>Class</code> object passed as the first argument and of the length specified by the <code>int</code> passed as the second argument. Calling the method <code>getComponentType</code> returns a <code>Class</code> object representing the component type of the array represented by the <code>Class</code> object on which the method was called (e.g. <code>String.class</code> for <code>String[].class</code>, <code>null</code> if the <code>Class</code> object doesn’t represent an array).</p>
<p>That last sentence isn’t entirely accurate. Calling <code>String[].class.getComponentType()</code> returns a <code>Class</code> object representing the class <code>String</code>, but its type is <code>Class&amp;lt;?&amp;gt;</code>, not <code>Class&amp;lt;String&amp;gt;</code>, which is why you can’t do something like the following.</p>
<div class="sourceCode" id="cb344"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb344-1"><a href="#cb344-1" aria-hidden="true"></a><span class="bu">String</span> foo = <span class="bu">String</span>[].<span class="fu">class</span>.<span class="fu">getComponentType</span>().<span class="fu">cast</span>(<span class="st">&quot;bar&quot;</span>); <span class="co">// won&#39;t compile</span></span></code></pre></div>
<p>Same goes for every method in <code>Class</code> that returns a <code>Class</code> object.</p>
<p>Regarding Joachim Sauer’s comment on <a href="https://stackoverflow.com/questions/529085/java-how-to-generic-array-creation/529094
#529094">this answer</a> (I don’t have enough reputation to comment on it myself), the example using the cast to <code>T[]</code> will result in a warning because the compiler can’t guarantee type safety in that case.</p>
<hr>
<p>Edit regarding Ingo’s comments:</p>
<div class="sourceCode" id="cb345"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb345-1"><a href="#cb345-1" aria-hidden="true"></a><span class="kw">public</span> <span class="dt">static</span> &lt;T&gt; T[] <span class="fu">newArray</span>(<span class="bu">Class</span>&lt;T[]&gt; type, <span class="dt">int</span> size) {</span>
<span id="cb345-2"><a href="#cb345-2" aria-hidden="true"></a>   <span class="kw">return</span> type.<span class="fu">cast</span>(<span class="bu">Array</span>.<span class="fu">newInstance</span>(type.<span class="fu">getComponentType</span>(), size));</span>
<span id="cb345-3"><a href="#cb345-3" aria-hidden="true"></a>}</span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="java-inner-class-and-static-nested-class-score-695972-in-2019" class="level3">
<h3>47: Java inner class and static nested class (score <a href="https://stackoverflow.com/q/70324.html">695972</a> in 2019)</h3>
<section id="question-45" class="level4">
<h4>Question</h4>
<p>What is the main difference between an inner class and a static nested class in Java? Does design / implementation play a role in choosing one of these?</p>
</section>
<section id="answer-accepted-score-1632" class="level4">
<h4>Answer accepted (score 1632)</h4>
<p>From the <a href="http://java.sun.com/docs/books/tutorial/java/javaOO/nested.html" rel="noreferrer">Java Tutorial</a>:</p>
<blockquote>
Nested classes are divided into two categories: static and non-static. Nested classes that are declared static are simply called static nested classes. Non-static nested classes are called inner classes.
</blockquote>
<p>Static nested classes are accessed using the enclosing class name:</p>
<div class="sourceCode" id="cb346"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb346-1"><a href="#cb346-1" aria-hidden="true"></a>OuterClass.<span class="fu">StaticNestedClass</span></span></code></pre></div>
<p>For example, to create an object for the static nested class, use this syntax:</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb347-1"><a href="#cb347-1" aria-hidden="true"></a>OuterClass.<span class="fu">StaticNestedClass</span> nestedObject = <span class="kw">new</span> OuterClass.<span class="fu">StaticNestedClass</span>();</span></code></pre></div>
<p>Objects that are instances of an inner class exist within an instance of the outer class. Consider the following classes:</p>
<div class="sourceCode" id="cb348"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb348-1"><a href="#cb348-1" aria-hidden="true"></a><span class="kw">class</span> OuterClass {</span>
<span id="cb348-2"><a href="#cb348-2" aria-hidden="true"></a>    ...</span>
<span id="cb348-3"><a href="#cb348-3" aria-hidden="true"></a>    <span class="kw">class</span> InnerClass {</span>
<span id="cb348-4"><a href="#cb348-4" aria-hidden="true"></a>        ...</span>
<span id="cb348-5"><a href="#cb348-5" aria-hidden="true"></a>    }</span>
<span id="cb348-6"><a href="#cb348-6" aria-hidden="true"></a>}</span></code></pre></div>
<p>An instance of InnerClass can exist only within an instance of OuterClass and has direct access to the methods and fields of its enclosing instance.</p>
<p>To instantiate an inner class, you must first instantiate the outer class. Then, create the inner object within the outer object with this syntax:</p>
<div class="sourceCode" id="cb349"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb349-1"><a href="#cb349-1" aria-hidden="true"></a>OuterClass.<span class="fu">InnerClass</span> innerObject = outerObject.<span class="fu">new</span> <span class="fu">InnerClass</span>();</span></code></pre></div>
<p>see: <a href="http://download.oracle.com/javase/tutorial/java/javaOO/nested.html" rel="noreferrer">Java Tutorial - Nested Classes</a></p>
<p>For completeness note that there is also such a thing as an <a href="https://stackoverflow.com/questions/20468856/is-it-true-that-every-inner-class-requires-an-enclosing-instance">inner class <em>without</em> an enclosing instance</a>:</p>
<div class="sourceCode" id="cb350"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb350-1"><a href="#cb350-1" aria-hidden="true"></a><span class="kw">class</span> A {</span>
<span id="cb350-2"><a href="#cb350-2" aria-hidden="true"></a>  <span class="dt">int</span> <span class="fu">t</span>() { <span class="kw">return</span> <span class="dv">1</span>; }</span>
<span id="cb350-3"><a href="#cb350-3" aria-hidden="true"></a>  <span class="dt">static</span> A a =  <span class="kw">new</span> <span class="fu">A</span>() { <span class="dt">int</span> <span class="fu">t</span>() { <span class="kw">return</span> <span class="dv">2</span>; } };</span>
<span id="cb350-4"><a href="#cb350-4" aria-hidden="true"></a>}</span></code></pre></div>
<p>Here, <code>new A() { ... }</code> is an <em>inner class defined in a static context</em> and does not have an enclosing instance.</p>
</section>
<section id="answer-2-score-575" class="level4">
<h4>Answer 2 (score 575)</h4>
<p>The <a href="http://java.sun.com/docs/books/tutorial/java/javaOO/nested.html" rel="noreferrer">Java tutorial says</a>:</p>
<blockquote>
<p>
Terminology: Nested classes are divided into two categories: static and non-static. Nested classes that are declared static are simply called static nested classes. Non-static nested classes are called inner classes.
</p>
</blockquote>
<p>In common parlance, the terms “nested” and “inner” are used interchangeably by most programmers, but I’ll use the correct term “nested class” which covers both inner and static.</p>
<p>Classes can be nested <em>ad infinitum</em>, e.g. class A can contain class B which contains class C which contains class D, etc. However, more than one level of class nesting is rare, as it is generally bad design.</p>
<p>There are three reasons you might create a nested class:</p>
<ul>
<li>
organization: sometimes it seems most sensible to sort a class into the namespace of another class, especially when it won’t be used in any other context
</li>
<li>
access: nested classes have special access to the variables/fields of their containing classes (precisely which variables/fields depends on the kind of nested class, whether inner or static).
</li>
<li>
convenience: having to create a new file for every new type is bothersome, again, especially when the type will only be used in one context
</li>
</ul>
<p>There are <strong>four kinds of nested class in Java</strong>. In brief, they are:</p>
<ul>
<li>
<strong>static class</strong>: declared as a static member of another class
</li>
<li>
<strong>inner class</strong>: declared as an instance member of another class
</li>
<li>
<strong>local inner class</strong>: declared inside an instance method of another class
</li>
<li>
<strong>anonymous inner class</strong>: like a local inner class, but written as an expression which returns a one-off object
</li>
</ul>
<p>Let me elaborate in more details.</p>
<p><br></p>
<h5>
Static Classes
</h2>
<p>Static classes are the easiest kind to understand because they have nothing to do with instances of the containing class.</p>
<p>A static class is a class declared as a static member of another class. Just like other static members, such a class is really just a hanger on that uses the containing class as its namespace, <em>e.g.</em> the class <em>Goat</em> declared as a static member of class <em>Rhino</em> in the package <em>pizza</em> is known by the name <em>pizza.Rhino.Goat</em>.</p>
<div class="sourceCode" id="cb351"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb351-1"><a href="#cb351-1" aria-hidden="true"></a><span class="kw">package</span><span class="im"> pizza;</span></span>
<span id="cb351-2"><a href="#cb351-2" aria-hidden="true"></a></span>
<span id="cb351-3"><a href="#cb351-3" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">class</span> Rhino {</span>
<span id="cb351-4"><a href="#cb351-4" aria-hidden="true"></a></span>
<span id="cb351-5"><a href="#cb351-5" aria-hidden="true"></a>    ...</span>
<span id="cb351-6"><a href="#cb351-6" aria-hidden="true"></a></span>
<span id="cb351-7"><a href="#cb351-7" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="kw">class</span> Goat {</span>
<span id="cb351-8"><a href="#cb351-8" aria-hidden="true"></a>        ...</span>
<span id="cb351-9"><a href="#cb351-9" aria-hidden="true"></a>    }</span>
<span id="cb351-10"><a href="#cb351-10" aria-hidden="true"></a>}</span></code></pre></div>
<p>Frankly, static classes are a pretty worthless feature because classes are already divided into namespaces by packages. The only real conceivable reason to create a static class is that such a class has access to its containing class’s private static members, but I find this to be a pretty lame justification for the static class feature to exist.</p>
<p><br></p>
<h5>
Inner Classes
</h2>
<p>An inner class is a class declared as a non-static member of another class:</p>
<div class="sourceCode" id="cb352"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb352-1"><a href="#cb352-1" aria-hidden="true"></a><span class="kw">package</span><span class="im"> pizza;</span></span>
<span id="cb352-2"><a href="#cb352-2" aria-hidden="true"></a></span>
<span id="cb352-3"><a href="#cb352-3" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">class</span> Rhino {</span>
<span id="cb352-4"><a href="#cb352-4" aria-hidden="true"></a></span>
<span id="cb352-5"><a href="#cb352-5" aria-hidden="true"></a>    <span class="kw">public</span> <span class="kw">class</span> Goat {</span>
<span id="cb352-6"><a href="#cb352-6" aria-hidden="true"></a>        ...</span>
<span id="cb352-7"><a href="#cb352-7" aria-hidden="true"></a>    }</span>
<span id="cb352-8"><a href="#cb352-8" aria-hidden="true"></a></span>
<span id="cb352-9"><a href="#cb352-9" aria-hidden="true"></a>    <span class="kw">private</span> <span class="dt">void</span> <span class="fu">jerry</span>() {</span>
<span id="cb352-10"><a href="#cb352-10" aria-hidden="true"></a>        Goat g = <span class="kw">new</span> <span class="fu">Goat</span>();</span>
<span id="cb352-11"><a href="#cb352-11" aria-hidden="true"></a>    }</span>
<span id="cb352-12"><a href="#cb352-12" aria-hidden="true"></a>}</span></code></pre></div>
<p>Like with a static class, the inner class is known as qualified by its containing class name, <em>pizza.Rhino.Goat</em>, but inside the containing class, it can be known by its simple name. However, every instance of an inner class is tied to a particular instance of its containing class: above, the <em>Goat</em> created in <em>jerry</em>, is implicitly tied to the <em>Rhino</em> instance <em>this</em> in <em>jerry</em>. Otherwise, we make the associated <em>Rhino</em> instance explicit when we instantiate <em>Goat</em>:</p>
<div class="sourceCode" id="cb353"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb353-1"><a href="#cb353-1" aria-hidden="true"></a>Rhino rhino = <span class="kw">new</span> <span class="fu">Rhino</span>();</span>
<span id="cb353-2"><a href="#cb353-2" aria-hidden="true"></a>Rhino.<span class="fu">Goat</span> goat = rhino.<span class="fu">new</span> <span class="fu">Goat</span>();</span></code></pre></div>
<p>(Notice you refer to the inner type as just <em>Goat</em> in the weird <em>new</em> syntax: Java infers the containing type from the <em>rhino</em> part. And, yes <em>new rhino.Goat()</em> would have made more sense to me too.)</p>
<p>So what does this gain us? Well, the inner class instance has access to the instance members of the containing class instance. These enclosing instance members are referred to inside the inner class <em>via</em> just their simple names, not <em>via</em> <em>this</em> (<em>this</em> in the inner class refers to the inner class instance, not the associated containing class instance):</p>
<div class="sourceCode" id="cb354"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb354-1"><a href="#cb354-1" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">class</span> Rhino {</span>
<span id="cb354-2"><a href="#cb354-2" aria-hidden="true"></a></span>
<span id="cb354-3"><a href="#cb354-3" aria-hidden="true"></a>    <span class="kw">private</span> <span class="bu">String</span> barry;</span>
<span id="cb354-4"><a href="#cb354-4" aria-hidden="true"></a></span>
<span id="cb354-5"><a href="#cb354-5" aria-hidden="true"></a>    <span class="kw">public</span> <span class="kw">class</span> Goat {</span>
<span id="cb354-6"><a href="#cb354-6" aria-hidden="true"></a>        <span class="kw">public</span> <span class="dt">void</span> <span class="fu">colin</span>() {</span>
<span id="cb354-7"><a href="#cb354-7" aria-hidden="true"></a>            <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(barry);</span>
<span id="cb354-8"><a href="#cb354-8" aria-hidden="true"></a>        }</span>
<span id="cb354-9"><a href="#cb354-9" aria-hidden="true"></a>    }</span>
<span id="cb354-10"><a href="#cb354-10" aria-hidden="true"></a>}</span></code></pre></div>
<p>In the inner class, you can refer to <em>this</em> of the containing class as <em>Rhino.this</em>, and you can use <em>this</em> to refer to its members, <em>e.g. Rhino.this.barry</em>.</p>
<p><br></p>
<h5>
Local Inner Classes
</h2>
<p>A local inner class is a class declared in the body of a method. Such a class is only known within its containing method, so it can only be instantiated and have its members accessed within its containing method. The gain is that a local inner class instance is tied to and can access the final local variables of its containing method. When the instance uses a final local of its containing method, the variable retains the value it held at the time of the instance’s creation, even if the variable has gone out of scope (this is effectively Java’s crude, limited version of closures).</p>
<p>Because a local inner class is neither the member of a class or package, it is not declared with an access level. (Be clear, however, that its own members have access levels like in a normal class.)</p>
<p>If a local inner class is declared in an instance method, an instantiation of the inner class is tied to the instance held by the containing method’s <em>this</em> at the time of the instance’s creation, and so the containing class’s instance members are accessible like in an instance inner class. A local inner class is instantiated simply <em>via</em> its name, <em>e.g.</em> local inner class <em>Cat</em> is instantiated as <em>new Cat()</em>, not new this.Cat() as you might expect.</p>
<p><br></p>
<h5>
Anonymous Inner Classes
</h2>
<p>An anonymous inner class is a syntactically convenient way of writing a local inner class. Most commonly, a local inner class is instantiated at most just once each time its containing method is run. It would be nice, then, if we could combine the local inner class definition and its single instantiation into one convenient syntax form, and it would also be nice if we didn’t have to think up a name for the class (the fewer unhelpful names your code contains, the better). An anonymous inner class allows both these things:</p>
<div class="sourceCode" id="cb355"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb355-1"><a href="#cb355-1" aria-hidden="true"></a><span class="kw">new</span> *ParentClassName*(*constructorArgs*) {*members*}</span></code></pre></div>
<p>This is an expression returning a new instance of an unnamed class which extends <em>ParentClassName</em>. You cannot supply your own constructor; rather, one is implicitly supplied which simply calls the super constructor, so the arguments supplied must fit the super constructor. (If the parent contains multiple constructors, the “simplest” one is called, “simplest” as determined by a rather complex set of rules not worth bothering to learn in detail–just pay attention to what NetBeans or Eclipse tell you.)</p>
<p>Alternatively, you can specify an interface to implement:</p>
<div class="sourceCode" id="cb356"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb356-1"><a href="#cb356-1" aria-hidden="true"></a><span class="kw">new</span> *InterfaceName*() {*members*}</span></code></pre></div>
<p>Such a declaration creates a new instance of an unnamed class which extends Object and implements <em>InterfaceName</em>. Again, you cannot supply your own constructor; in this case, Java implicitly supplies a no-arg, do-nothing constructor (so there will never be constructor arguments in this case).</p>
<p>Even though you can’t give an anonymous inner class a constructor, you can still do any setup you want using an initializer block (a {} block placed outside any method).</p>
<p>Be clear that an anonymous inner class is simply a less flexible way of creating a local inner class with one instance. If you want a local inner class which implements multiple interfaces or which implements interfaces while extending some class other than <em>Object</em> or which specifies its own constructor, you’re stuck creating a regular named local inner class.</p>
</section>
<section id="answer-3-score-140" class="level4">
<h4>Answer 3 (score 140)</h4>
<p>I don’t think the real difference became clear in the above answers.</p>
<p>First to get the terms right:</p>
<ul>
<li>
A nested class is a class which is contained in another class at the source code level.
</li>
<li>
It is static if you declare it with the <strong>static</strong> modifier.
</li>
<li>
A non-static nested class is called inner class. (I stay with non-static nested class.)
</li>
</ul>
<p>Martin’s answer is right so far. However, the actual question is: What is the purpose of declaring a nested class static or not?</p>
<p>You use <strong>static nested classes</strong> if you just want to keep your classes together if they belong topically together or if the nested class is exclusively used in the enclosing class. There is no semantic difference between a static nested class and every other class.</p>
<p><strong>Non-static nested classes</strong> are a different beast. Similar to anonymous inner classes, such nested classes are actually closures. That means they capture their surrounding scope and their enclosing instance and make that accessible. Perhaps an example will clarify that. See this stub of a Container:</p>
<div class="sourceCode" id="cb357"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb357-1"><a href="#cb357-1" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">class</span> <span class="bu">Container</span> {</span>
<span id="cb357-2"><a href="#cb357-2" aria-hidden="true"></a>    <span class="kw">public</span> <span class="kw">class</span> Item{</span>
<span id="cb357-3"><a href="#cb357-3" aria-hidden="true"></a>        <span class="bu">Object</span> data;</span>
<span id="cb357-4"><a href="#cb357-4" aria-hidden="true"></a>        <span class="kw">public</span> <span class="bu">Container</span> <span class="fu">getContainer</span>(){</span>
<span id="cb357-5"><a href="#cb357-5" aria-hidden="true"></a>            <span class="kw">return</span> <span class="bu">Container</span>.<span class="fu">this</span>;</span>
<span id="cb357-6"><a href="#cb357-6" aria-hidden="true"></a>        }</span>
<span id="cb357-7"><a href="#cb357-7" aria-hidden="true"></a>        <span class="kw">public</span> <span class="fu">Item</span>(<span class="bu">Object</span> data) {</span>
<span id="cb357-8"><a href="#cb357-8" aria-hidden="true"></a>            <span class="kw">super</span>();</span>
<span id="cb357-9"><a href="#cb357-9" aria-hidden="true"></a>            <span class="kw">this</span>.<span class="fu">data</span> = data;</span>
<span id="cb357-10"><a href="#cb357-10" aria-hidden="true"></a>        }</span>
<span id="cb357-11"><a href="#cb357-11" aria-hidden="true"></a></span>
<span id="cb357-12"><a href="#cb357-12" aria-hidden="true"></a>    }</span>
<span id="cb357-13"><a href="#cb357-13" aria-hidden="true"></a></span>
<span id="cb357-14"><a href="#cb357-14" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">static</span> Item <span class="fu">create</span>(<span class="bu">Object</span> data){</span>
<span id="cb357-15"><a href="#cb357-15" aria-hidden="true"></a>        <span class="co">// does not compile since no instance of Container is available</span></span>
<span id="cb357-16"><a href="#cb357-16" aria-hidden="true"></a>        <span class="kw">return</span> <span class="kw">new</span> <span class="fu">Item</span>(data);</span>
<span id="cb357-17"><a href="#cb357-17" aria-hidden="true"></a>    }</span>
<span id="cb357-18"><a href="#cb357-18" aria-hidden="true"></a>    <span class="kw">public</span> Item <span class="fu">createSubItem</span>(<span class="bu">Object</span> data){</span>
<span id="cb357-19"><a href="#cb357-19" aria-hidden="true"></a>        <span class="co">// compiles, since &#39;this&#39; Container is available</span></span>
<span id="cb357-20"><a href="#cb357-20" aria-hidden="true"></a>        <span class="kw">return</span> <span class="kw">new</span> <span class="fu">Item</span>(data);</span>
<span id="cb357-21"><a href="#cb357-21" aria-hidden="true"></a>    }</span>
<span id="cb357-22"><a href="#cb357-22" aria-hidden="true"></a>}</span></code></pre></div>
<p>In this case you want to have a reference from a child item to the parent container. Using a non-static nested class, this works without some work. You can access the enclosing instance of Container with the syntax <code>Container.this</code>.</p>
<p>More hardcore explanations following:</p>
<p>If you look at the Java bytecodes the compiler generates for an (non-static) nested class it might become even clearer:</p>
<div class="sourceCode" id="cb358"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb358-1"><a href="#cb358-1" aria-hidden="true"></a><span class="co">// class version 49.0 (49)</span></span>
<span id="cb358-2"><a href="#cb358-2" aria-hidden="true"></a><span class="co">// access flags 33</span></span>
<span id="cb358-3"><a href="#cb358-3" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">class</span> Container$Item {</span>
<span id="cb358-4"><a href="#cb358-4" aria-hidden="true"></a></span>
<span id="cb358-5"><a href="#cb358-5" aria-hidden="true"></a>  <span class="co">// compiled from: Container.java</span></span>
<span id="cb358-6"><a href="#cb358-6" aria-hidden="true"></a>  <span class="co">// access flags 1</span></span>
<span id="cb358-7"><a href="#cb358-7" aria-hidden="true"></a>  <span class="kw">public</span> INNERCLASS Container$Item <span class="bu">Container</span> Item</span>
<span id="cb358-8"><a href="#cb358-8" aria-hidden="true"></a></span>
<span id="cb358-9"><a href="#cb358-9" aria-hidden="true"></a>  <span class="co">// access flags 0</span></span>
<span id="cb358-10"><a href="#cb358-10" aria-hidden="true"></a>  <span class="bu">Object</span> data</span>
<span id="cb358-11"><a href="#cb358-11" aria-hidden="true"></a></span>
<span id="cb358-12"><a href="#cb358-12" aria-hidden="true"></a>  <span class="co">// access flags 4112</span></span>
<span id="cb358-13"><a href="#cb358-13" aria-hidden="true"></a>  <span class="dt">final</span> <span class="bu">Container</span> this$<span class="dv">0</span></span>
<span id="cb358-14"><a href="#cb358-14" aria-hidden="true"></a></span>
<span id="cb358-15"><a href="#cb358-15" aria-hidden="true"></a>  <span class="co">// access flags 1</span></span>
<span id="cb358-16"><a href="#cb358-16" aria-hidden="true"></a>  <span class="kw">public</span> <span class="fu">getContainer</span>() : <span class="bu">Container</span></span>
<span id="cb358-17"><a href="#cb358-17" aria-hidden="true"></a>   L0</span>
<span id="cb358-18"><a href="#cb358-18" aria-hidden="true"></a>    LINENUMBER <span class="dv">7</span> L0</span>
<span id="cb358-19"><a href="#cb358-19" aria-hidden="true"></a>    ALOAD <span class="dv">0</span>: <span class="kw">this</span></span>
<span id="cb358-20"><a href="#cb358-20" aria-hidden="true"></a>    GETFIELD Container$Item.<span class="fu">this</span>$<span class="dv">0</span> : <span class="bu">Container</span></span>
<span id="cb358-21"><a href="#cb358-21" aria-hidden="true"></a>    ARETURN</span>
<span id="cb358-22"><a href="#cb358-22" aria-hidden="true"></a>   L1</span>
<span id="cb358-23"><a href="#cb358-23" aria-hidden="true"></a>    LOCALVARIABLE <span class="kw">this</span> Container$Item L0 L1 <span class="dv">0</span></span>
<span id="cb358-24"><a href="#cb358-24" aria-hidden="true"></a>    MAXSTACK = <span class="dv">1</span></span>
<span id="cb358-25"><a href="#cb358-25" aria-hidden="true"></a>    MAXLOCALS = <span class="dv">1</span></span>
<span id="cb358-26"><a href="#cb358-26" aria-hidden="true"></a></span>
<span id="cb358-27"><a href="#cb358-27" aria-hidden="true"></a>  <span class="co">// access flags 1</span></span>
<span id="cb358-28"><a href="#cb358-28" aria-hidden="true"></a>  <span class="kw">public</span> &lt;init&gt;(<span class="bu">Container</span>,<span class="bu">Object</span>) : <span class="dt">void</span></span>
<span id="cb358-29"><a href="#cb358-29" aria-hidden="true"></a>   L0</span>
<span id="cb358-30"><a href="#cb358-30" aria-hidden="true"></a>    LINENUMBER <span class="dv">12</span> L0</span>
<span id="cb358-31"><a href="#cb358-31" aria-hidden="true"></a>    ALOAD <span class="dv">0</span>: <span class="kw">this</span></span>
<span id="cb358-32"><a href="#cb358-32" aria-hidden="true"></a>    ALOAD <span class="dv">1</span></span>
<span id="cb358-33"><a href="#cb358-33" aria-hidden="true"></a>    PUTFIELD Container$Item.<span class="fu">this</span>$<span class="dv">0</span> : <span class="bu">Container</span></span>
<span id="cb358-34"><a href="#cb358-34" aria-hidden="true"></a>   L1</span>
<span id="cb358-35"><a href="#cb358-35" aria-hidden="true"></a>    LINENUMBER <span class="dv">10</span> L1</span>
<span id="cb358-36"><a href="#cb358-36" aria-hidden="true"></a>    ALOAD <span class="dv">0</span>: <span class="kw">this</span></span>
<span id="cb358-37"><a href="#cb358-37" aria-hidden="true"></a>    INVOKESPECIAL <span class="bu">Object</span>.&lt;init&gt;() : <span class="dt">void</span></span>
<span id="cb358-38"><a href="#cb358-38" aria-hidden="true"></a>   L2</span>
<span id="cb358-39"><a href="#cb358-39" aria-hidden="true"></a>    LINENUMBER <span class="dv">11</span> L2</span>
<span id="cb358-40"><a href="#cb358-40" aria-hidden="true"></a>    ALOAD <span class="dv">0</span>: <span class="kw">this</span></span>
<span id="cb358-41"><a href="#cb358-41" aria-hidden="true"></a>    ALOAD <span class="dv">2</span>: data</span>
<span id="cb358-42"><a href="#cb358-42" aria-hidden="true"></a>    PUTFIELD Container$Item.<span class="fu">data</span> : <span class="bu">Object</span></span>
<span id="cb358-43"><a href="#cb358-43" aria-hidden="true"></a>    RETURN</span>
<span id="cb358-44"><a href="#cb358-44" aria-hidden="true"></a>   L3</span>
<span id="cb358-45"><a href="#cb358-45" aria-hidden="true"></a>    LOCALVARIABLE <span class="kw">this</span> Container$Item L0 L3 <span class="dv">0</span></span>
<span id="cb358-46"><a href="#cb358-46" aria-hidden="true"></a>    LOCALVARIABLE data <span class="bu">Object</span> L0 L3 <span class="dv">2</span></span>
<span id="cb358-47"><a href="#cb358-47" aria-hidden="true"></a>    MAXSTACK = <span class="dv">2</span></span>
<span id="cb358-48"><a href="#cb358-48" aria-hidden="true"></a>    MAXLOCALS = <span class="dv">3</span></span>
<span id="cb358-49"><a href="#cb358-49" aria-hidden="true"></a>}</span></code></pre></div>
<p>As you can see the compiler creates a hidden field <code>Container this$0</code>. This is set in the constructor which has an additional parameter of type Container to specify the enclosing instance. You can’t see this parameter in the source but the compiler implicitly generates it for a nested class.</p>
<p>Martin’s example</p>
<div class="sourceCode" id="cb359"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb359-1"><a href="#cb359-1" aria-hidden="true"></a>OuterClass.<span class="fu">InnerClass</span> innerObject = outerObject.<span class="fu">new</span> <span class="fu">InnerClass</span>();</span></code></pre></div>
<p>would so be compiled to a call of something like (in bytecodes)</p>
<div class="sourceCode" id="cb360"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb360-1"><a href="#cb360-1" aria-hidden="true"></a><span class="kw">new</span> <span class="fu">InnerClass</span>(outerObject)</span></code></pre></div>
<p>For the sake of completeness:</p>
<p>An anonymous class <strong>is</strong> a perfect example of a non-static nested class which just has no name associated with it and can’t be referenced later.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="implements-runnable-vs-extends-thread-in-java-score-663876-in-2018" class="level3">
<h3>48: “implements Runnable” vs “extends Thread” in Java (score <a href="https://stackoverflow.com/q/541487.html">663876</a> in 2018)</h3>
<section id="question-46" class="level4">
<h4>Question</h4>
<p>From what time I’ve spent with threads in Java, I’ve found these two ways to write threads:</p>
<p>With <code>implements Runnable</code>:</p>
<div class="sourceCode" id="cb361"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb361-1"><a href="#cb361-1" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">class</span> MyRunnable <span class="kw">implements</span> <span class="bu">Runnable</span> {</span>
<span id="cb361-2"><a href="#cb361-2" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">void</span> <span class="fu">run</span>() {</span>
<span id="cb361-3"><a href="#cb361-3" aria-hidden="true"></a>        <span class="co">//Code</span></span>
<span id="cb361-4"><a href="#cb361-4" aria-hidden="true"></a>    }</span>
<span id="cb361-5"><a href="#cb361-5" aria-hidden="true"></a>}</span>
<span id="cb361-6"><a href="#cb361-6" aria-hidden="true"></a><span class="co">//Started with a &quot;new Thread(new MyRunnable()).start()&quot; call</span></span></code></pre></div>
<p>Or, with <code>extends Thread</code>:</p>
<div class="sourceCode" id="cb362"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb362-1"><a href="#cb362-1" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">class</span> MyThread <span class="kw">extends</span> <span class="bu">Thread</span> {</span>
<span id="cb362-2"><a href="#cb362-2" aria-hidden="true"></a>    <span class="kw">public</span> <span class="fu">MyThread</span>() {</span>
<span id="cb362-3"><a href="#cb362-3" aria-hidden="true"></a>        <span class="kw">super</span>(<span class="st">&quot;MyThread&quot;</span>);</span>
<span id="cb362-4"><a href="#cb362-4" aria-hidden="true"></a>    }</span>
<span id="cb362-5"><a href="#cb362-5" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">void</span> <span class="fu">run</span>() {</span>
<span id="cb362-6"><a href="#cb362-6" aria-hidden="true"></a>        <span class="co">//Code</span></span>
<span id="cb362-7"><a href="#cb362-7" aria-hidden="true"></a>    }</span>
<span id="cb362-8"><a href="#cb362-8" aria-hidden="true"></a>}</span>
<span id="cb362-9"><a href="#cb362-9" aria-hidden="true"></a><span class="co">//Started with a &quot;new MyThread().start()&quot; call</span></span></code></pre></div>
<p>Is there any significant difference in these two blocks of code ?</p>
</section>
<section id="answer-accepted-score-1597" class="level4">
<h4>Answer accepted (score 1597)</h4>
<p>Yes: implements <code>Runnable</code> is the preferred way to do it, IMO. You’re not really specialising the thread’s behaviour. You’re just giving it something to run. That means <a href="http://en.wikipedia.org/wiki/Object_composition" rel="noreferrer">composition</a> is the <em>philosophically</em> “purer” way to go.</p>
<p>In <em>practical</em> terms, it means you can implement <code>Runnable</code> and extend from another class as well.</p>
</section>
<section id="answer-2-score-545" class="level4">
<h4>Answer 2 (score 545)</h4>
<p><strong>tl;dr: implements Runnable is better. However, the caveat is important</strong></p>
<p>In general, I would recommend using something like <code>Runnable</code> rather than <code>Thread</code> because it allows you to keep your work only loosely coupled with your choice of concurrency. For example, if you use a <code>Runnable</code> and decide later on that this doesn’t in fact require it’s own <code>Thread</code>, you can just call threadA.run().</p>
<p><strong>Caveat:</strong> Around here, I strongly discourage the use of raw Threads. I much prefer the use of <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Callable.html" rel="noreferrer">Callables</a> and <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/FutureTask.html" rel="noreferrer">FutureTasks</a> (From the javadoc: “A cancellable asynchronous computation”). The integration of timeouts, proper cancelling and the thread pooling of the modern concurrency support are all much more useful to me than piles of raw Threads.</p>
<p><strong>Follow-up:</strong> there is a <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/FutureTask.html
#FutureTask-java.lang.Runnable-V-" rel="noreferrer"><code>FutureTask</code> constructor</a> that allows you to use Runnables (if that’s what you are most comfortable with) and still get the benefit of the modern concurrency tools. <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/FutureTask.html#FutureTask-java.lang.Runnable-V-" rel="noreferrer">To quote the javadoc</a>:</p>
<p>If you don’t need a particular result, consider using constructions of the form:</p>
<div class="sourceCode" id="cb363"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb363-1"><a href="#cb363-1" aria-hidden="true"></a><span class="bu">Future</span>&lt;?&gt; f = <span class="kw">new</span> <span class="bu">FutureTask</span>&lt;<span class="bu">Object</span>&gt;(runnable, <span class="kw">null</span>)</span></code></pre></div>
<p>So, if we replace their <code>runnable</code> with your <code>threadA</code>, we get the following:</p>
<div class="sourceCode" id="cb364"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb364-1"><a href="#cb364-1" aria-hidden="true"></a><span class="kw">new</span> <span class="bu">FutureTask</span>&lt;<span class="bu">Object</span>&gt;(threadA, <span class="kw">null</span>)</span></code></pre></div>
<p>Another option that allows you to stay closer to Runnables is a <a href="http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ThreadPoolExecutor.html" rel="noreferrer">ThreadPoolExecutor</a>. You can use the <a href="http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ThreadPoolExecutor.html
#execute%28java.lang.Runnable%29" rel="noreferrer">execute</a> method to pass in a Runnable to execute “the given task sometime in the future.”</p>
<p>If you’d like to try using a thread pool, the code fragment above would become something like the following (using the <a href="http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Executors.html
#newCachedThreadPool%28%29" rel="noreferrer">Executors.newCachedThreadPool()</a> factory method):</p>
<div class="sourceCode" id="cb365"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb365-1"><a href="#cb365-1" aria-hidden="true"></a><span class="bu">ExecutorService</span> es = <span class="bu">Executors</span>.<span class="fu">newCachedThreadPool</span>();</span>
<span id="cb365-2"><a href="#cb365-2" aria-hidden="true"></a>es.<span class="fu">execute</span>(<span class="kw">new</span> <span class="fu">ThreadA</span>());</span></code></pre></div>
</section>
<section id="answer-3-score-251" class="level4">
<h4>Answer 3 (score 251)</h4>
<p>Moral of the story:</p>
<p><em>Inherit only if you want to override some behavior.</em></p>
<p>Or rather it should be read as:</p>
<p><em>Inherit less, interface more.</em></p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="why-does-java-have-transient-fields-score-663871-in-2016" class="level3">
<h3>49: Why does Java have transient fields? (score <a href="https://stackoverflow.com/q/910374.html">663871</a> in 2016)</h3>
<section id="question-47" class="level4">
<h4>Question</h4>
<p>Why does Java have <strong>transient</strong> fields?</p>
</section>
<section id="answer-accepted-score-1602" class="level4">
<h4>Answer accepted (score 1602)</h4>
<p>The <code>transient</code> keyword in Java is used to indicate that a field should not be part of the serialization (which means saved, <em>like</em> to a file) process.</p>
<p>From the <a href="http://docs.oracle.com/javase/specs/jls/se7/html/index.html" rel="noreferrer">Java Language Specification, Java SE 7 Edition</a>, <a href="http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html
#jls-8.3.1.3" rel="noreferrer">Section 8.3.1.3. <code>transient</code> Fields</a>:</p>
<blockquote>
<p>
Variables may be marked <code>transient</code> to indicate that they are not part of the persistent state of an object.
</p>
</blockquote>
<p>For example, you may have fields that are derived from other fields, and should only be done so programmatically, rather than having the state be persisted via serialization.</p>
<p>Here’s a <code>GalleryImage</code> class which contains an image and a thumbnail derived from the image:</p>
<div class="sourceCode" id="cb366"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb366-1"><a href="#cb366-1" aria-hidden="true"></a><span class="kw">class</span> GalleryImage <span class="kw">implements</span> <span class="bu">Serializable</span></span>
<span id="cb366-2"><a href="#cb366-2" aria-hidden="true"></a>{</span>
<span id="cb366-3"><a href="#cb366-3" aria-hidden="true"></a>    <span class="kw">private</span> <span class="bu">Image</span> image;</span>
<span id="cb366-4"><a href="#cb366-4" aria-hidden="true"></a>    <span class="kw">private</span> <span class="kw">transient</span> <span class="bu">Image</span> thumbnailImage;</span>
<span id="cb366-5"><a href="#cb366-5" aria-hidden="true"></a></span>
<span id="cb366-6"><a href="#cb366-6" aria-hidden="true"></a>    <span class="kw">private</span> <span class="dt">void</span> <span class="fu">generateThumbnail</span>()</span>
<span id="cb366-7"><a href="#cb366-7" aria-hidden="true"></a>    {</span>
<span id="cb366-8"><a href="#cb366-8" aria-hidden="true"></a>        <span class="co">// Generate thumbnail.</span></span>
<span id="cb366-9"><a href="#cb366-9" aria-hidden="true"></a>    }</span>
<span id="cb366-10"><a href="#cb366-10" aria-hidden="true"></a></span>
<span id="cb366-11"><a href="#cb366-11" aria-hidden="true"></a>    <span class="kw">private</span> <span class="dt">void</span> <span class="fu">readObject</span>(<span class="bu">ObjectInputStream</span> inputStream)</span>
<span id="cb366-12"><a href="#cb366-12" aria-hidden="true"></a>            <span class="kw">throws</span> <span class="bu">IOException</span>, <span class="bu">ClassNotFoundException</span></span>
<span id="cb366-13"><a href="#cb366-13" aria-hidden="true"></a>    {</span>
<span id="cb366-14"><a href="#cb366-14" aria-hidden="true"></a>        inputStream.<span class="fu">defaultReadObject</span>();</span>
<span id="cb366-15"><a href="#cb366-15" aria-hidden="true"></a>        <span class="fu">generateThumbnail</span>();</span>
<span id="cb366-16"><a href="#cb366-16" aria-hidden="true"></a>    }    </span>
<span id="cb366-17"><a href="#cb366-17" aria-hidden="true"></a>}</span></code></pre></div>
<p>In this example, the <code>thumbnailImage</code> is a thumbnail image that is generated by invoking the <code>generateThumbnail</code> method.</p>
<p>The <code>thumbnailImage</code> field is marked as <code>transient</code>, so only the original <code>image</code> is serialized rather than persisting both the original image and the thumbnail image. This means that less storage would be needed to save the serialized object. (Of course, this may or may not be desirable depending on the requirements of the system – this is just an example.)</p>
<p>At the time of deserialization, the <a href="http://java.sun.com/javase/6/docs/api/java/io/ObjectInputStream.html
#readObject()" rel="noreferrer"><code>readObject</code></a> method is called to perform any operations necessary to restore the state of the object back to the state at which the serialization occurred. Here, the thumbnail needs to be generated, so the <code>readObject</code> method is overridden so that the thumbnail will be generated by calling the <code>generateThumbnail</code> method.</p>
<p>For additional information, the <a href="http://www.oracle.com/technetwork/articles/java/javaserial-1536170.html" rel="noreferrer">Discover the secrets of the Java Serialization API</a> article (which was originally available on the Sun Developer Network) has a section which discusses the use of and presents a scenario where the <code>transient</code> keyword is used to prevent serialization of certain fields.</p>
</section>
<section id="answer-2-score-414" class="level4">
<h4>Answer 2 (score 414)</h4>
<p>Before understanding the <code>transient</code> keyword, one has to understand the concept of serialization. If the reader knows about serialization, please skip the first point.</p>
<h5>
What is serialization?
</h3>
<p>Serialization is the process of making the object’s state persistent. That means the state of the object is converted into a stream of bytes to be used for persisting (e.g. storing bytes in a file) or transferring (e.g. sending bytes across a network). In the same way, we can use the deserialization to bring back the object’s state from bytes. This is one of the important concepts in Java programming because serialization is mostly used in networking programming. The objects that need to be transmitted through the network have to be converted into bytes. For that purpose, every class or interface must implement the <a href="https://docs.oracle.com/javase/8/docs/api/java/io/Serializable.html" rel="noreferrer"><code>Serializable</code></a> interface. It is a marker interface without any methods.</p>
<h5>
Now what is the <code>transient</code> keyword and its purpose?
</h3>
<p>By default, all of object’s variables get converted into a persistent state. In some cases, you may want to avoid persisting some variables because you don’t have the need to persist those variables. So you can declare those variables as <code>transient</code>. If the variable is declared as <code>transient</code>, then it will not be persisted. That is the main purpose of the <code>transient</code> keyword.</p>
<p>I want to explain the above two points with the following example:</p>
<div class="sourceCode" id="cb367"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb367-1"><a href="#cb367-1" aria-hidden="true"></a><span class="kw">package</span><span class="im"> javabeat.samples;</span></span>
<span id="cb367-2"><a href="#cb367-2" aria-hidden="true"></a></span>
<span id="cb367-3"><a href="#cb367-3" aria-hidden="true"></a><span class="kw">import</span><span class="im"> java.io.FileInputStream;</span></span>
<span id="cb367-4"><a href="#cb367-4" aria-hidden="true"></a><span class="kw">import</span><span class="im"> java.io.FileOutputStream;</span></span>
<span id="cb367-5"><a href="#cb367-5" aria-hidden="true"></a><span class="kw">import</span><span class="im"> java.io.IOException;</span></span>
<span id="cb367-6"><a href="#cb367-6" aria-hidden="true"></a><span class="kw">import</span><span class="im"> java.io.ObjectInputStream;</span></span>
<span id="cb367-7"><a href="#cb367-7" aria-hidden="true"></a><span class="kw">import</span><span class="im"> java.io.ObjectOutputStream;</span></span>
<span id="cb367-8"><a href="#cb367-8" aria-hidden="true"></a><span class="kw">import</span><span class="im"> java.io.Serializable;</span></span>
<span id="cb367-9"><a href="#cb367-9" aria-hidden="true"></a></span>
<span id="cb367-10"><a href="#cb367-10" aria-hidden="true"></a><span class="kw">class</span> NameStore <span class="kw">implements</span> <span class="bu">Serializable</span>{</span>
<span id="cb367-11"><a href="#cb367-11" aria-hidden="true"></a>    <span class="kw">private</span> <span class="bu">String</span> firstName;</span>
<span id="cb367-12"><a href="#cb367-12" aria-hidden="true"></a>    <span class="kw">private</span> <span class="kw">transient</span> <span class="bu">String</span> middleName;</span>
<span id="cb367-13"><a href="#cb367-13" aria-hidden="true"></a>    <span class="kw">private</span> <span class="bu">String</span> lastName;</span>
<span id="cb367-14"><a href="#cb367-14" aria-hidden="true"></a></span>
<span id="cb367-15"><a href="#cb367-15" aria-hidden="true"></a>    <span class="kw">public</span> <span class="fu">NameStore</span> (<span class="bu">String</span> fName, <span class="bu">String</span> mName, <span class="bu">String</span> lName){</span>
<span id="cb367-16"><a href="#cb367-16" aria-hidden="true"></a>        <span class="kw">this</span>.<span class="fu">firstName</span> = fName;</span>
<span id="cb367-17"><a href="#cb367-17" aria-hidden="true"></a>        <span class="kw">this</span>.<span class="fu">middleName</span> = mName;</span>
<span id="cb367-18"><a href="#cb367-18" aria-hidden="true"></a>        <span class="kw">this</span>.<span class="fu">lastName</span> = lName;</span>
<span id="cb367-19"><a href="#cb367-19" aria-hidden="true"></a>    }</span>
<span id="cb367-20"><a href="#cb367-20" aria-hidden="true"></a></span>
<span id="cb367-21"><a href="#cb367-21" aria-hidden="true"></a>    <span class="kw">public</span> <span class="bu">String</span> <span class="fu">toString</span>(){</span>
<span id="cb367-22"><a href="#cb367-22" aria-hidden="true"></a>        <span class="bu">StringBuffer</span> sb = <span class="kw">new</span> <span class="bu">StringBuffer</span>(<span class="dv">40</span>);</span>
<span id="cb367-23"><a href="#cb367-23" aria-hidden="true"></a>        sb.<span class="fu">append</span>(<span class="st">&quot;First Name : &quot;</span>);</span>
<span id="cb367-24"><a href="#cb367-24" aria-hidden="true"></a>        sb.<span class="fu">append</span>(<span class="kw">this</span>.<span class="fu">firstName</span>);</span>
<span id="cb367-25"><a href="#cb367-25" aria-hidden="true"></a>        sb.<span class="fu">append</span>(<span class="st">&quot;Middle Name : &quot;</span>);</span>
<span id="cb367-26"><a href="#cb367-26" aria-hidden="true"></a>        sb.<span class="fu">append</span>(<span class="kw">this</span>.<span class="fu">middleName</span>);</span>
<span id="cb367-27"><a href="#cb367-27" aria-hidden="true"></a>        sb.<span class="fu">append</span>(<span class="st">&quot;Last Name : &quot;</span>);</span>
<span id="cb367-28"><a href="#cb367-28" aria-hidden="true"></a>        sb.<span class="fu">append</span>(<span class="kw">this</span>.<span class="fu">lastName</span>);</span>
<span id="cb367-29"><a href="#cb367-29" aria-hidden="true"></a>        <span class="kw">return</span> sb.<span class="fu">toString</span>();</span>
<span id="cb367-30"><a href="#cb367-30" aria-hidden="true"></a>    }</span>
<span id="cb367-31"><a href="#cb367-31" aria-hidden="true"></a>}</span>
<span id="cb367-32"><a href="#cb367-32" aria-hidden="true"></a></span>
<span id="cb367-33"><a href="#cb367-33" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">class</span> TransientExample{</span>
<span id="cb367-34"><a href="#cb367-34" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span>(<span class="bu">String</span> args[]) <span class="kw">throws</span> <span class="bu">Exception</span> {</span>
<span id="cb367-35"><a href="#cb367-35" aria-hidden="true"></a>        NameStore nameStore = <span class="kw">new</span> <span class="fu">NameStore</span>(<span class="st">&quot;Steve&quot;</span>, <span class="st">&quot;Middle&quot;</span>,<span class="st">&quot;Jobs&quot;</span>);</span>
<span id="cb367-36"><a href="#cb367-36" aria-hidden="true"></a>        <span class="bu">ObjectOutputStream</span> o = <span class="kw">new</span> <span class="bu">ObjectOutputStream</span>(<span class="kw">new</span> <span class="bu">FileOutputStream</span>(<span class="st">&quot;nameStore&quot;</span>));</span>
<span id="cb367-37"><a href="#cb367-37" aria-hidden="true"></a>        <span class="co">// writing to object</span></span>
<span id="cb367-38"><a href="#cb367-38" aria-hidden="true"></a>        o.<span class="fu">writeObject</span>(nameStore);</span>
<span id="cb367-39"><a href="#cb367-39" aria-hidden="true"></a>        o.<span class="fu">close</span>();</span>
<span id="cb367-40"><a href="#cb367-40" aria-hidden="true"></a></span>
<span id="cb367-41"><a href="#cb367-41" aria-hidden="true"></a>        <span class="co">// reading from object</span></span>
<span id="cb367-42"><a href="#cb367-42" aria-hidden="true"></a>        <span class="bu">ObjectInputStream</span> in = <span class="kw">new</span> <span class="bu">ObjectInputStream</span>(<span class="kw">new</span> <span class="bu">FileInputStream</span>(<span class="st">&quot;nameStore&quot;</span>));</span>
<span id="cb367-43"><a href="#cb367-43" aria-hidden="true"></a>        NameStore nameStore1 = (NameStore)in.<span class="fu">readObject</span>();</span>
<span id="cb367-44"><a href="#cb367-44" aria-hidden="true"></a>        <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(nameStore1);</span>
<span id="cb367-45"><a href="#cb367-45" aria-hidden="true"></a>    }</span>
<span id="cb367-46"><a href="#cb367-46" aria-hidden="true"></a>}</span></code></pre></div>
<p>And the output will be the following:</p>
<div class="sourceCode" id="cb368"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb368-1"><a href="#cb368-1" aria-hidden="true"></a>First <span class="bu">Name</span> : Steve</span>
<span id="cb368-2"><a href="#cb368-2" aria-hidden="true"></a>Middle <span class="bu">Name</span> : <span class="kw">null</span></span>
<span id="cb368-3"><a href="#cb368-3" aria-hidden="true"></a>Last <span class="bu">Name</span> : Jobs</span></code></pre></div>
<p><em>Middle Name</em> is declared as <code>transient</code>, so it will not be stored in the persistent storage.</p>
<p><a href="http://www.javabeat.net/what-is-transient-keyword-in-java/" rel="noreferrer">Source</a></p>
</section>
<section id="answer-3-score-82" class="level4">
<h4>Answer 3 (score 82)</h4>
<p>To allow you to define variables that you don’t want to serialize.</p>
<p>In an object you may have information that you don’t want to serialize/persist (perhaps a reference to a parent factory object), or perhaps it doesn’t make sense to serialize. Marking these as ‘transient’ means the serialization mechanism will ignore these fields.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="why-is-subtracting-these-two-times-in-1927-giving-a-strange-result-score-620541-in-2018" class="level3">
<h3>50: Why is subtracting these two times (in 1927) giving a strange result? (score <a href="https://stackoverflow.com/q/6841333.html">620541</a> in 2018)</h3>
<section id="question-48" class="level4">
<h4>Question</h4>
<p>If I run the following program, which parses two date strings referencing times 1 second apart and compares them:</p>
<div class="sourceCode" id="cb369"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb369-1"><a href="#cb369-1" aria-hidden="true"></a><span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span>(<span class="bu">String</span>[] args) <span class="kw">throws</span> <span class="bu">ParseException</span> {</span>
<span id="cb369-2"><a href="#cb369-2" aria-hidden="true"></a>    <span class="bu">SimpleDateFormat</span> sf = <span class="kw">new</span> <span class="bu">SimpleDateFormat</span>(<span class="st">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>);  </span>
<span id="cb369-3"><a href="#cb369-3" aria-hidden="true"></a>    <span class="bu">String</span> str3 = <span class="st">&quot;1927-12-31 23:54:07&quot;</span>;  </span>
<span id="cb369-4"><a href="#cb369-4" aria-hidden="true"></a>    <span class="bu">String</span> str4 = <span class="st">&quot;1927-12-31 23:54:08&quot;</span>;  </span>
<span id="cb369-5"><a href="#cb369-5" aria-hidden="true"></a>    <span class="bu">Date</span> sDt3 = sf.<span class="fu">parse</span>(str3);  </span>
<span id="cb369-6"><a href="#cb369-6" aria-hidden="true"></a>    <span class="bu">Date</span> sDt4 = sf.<span class="fu">parse</span>(str4);  </span>
<span id="cb369-7"><a href="#cb369-7" aria-hidden="true"></a>    <span class="dt">long</span> ld3 = sDt3.<span class="fu">getTime</span>() /<span class="dv">1000</span>;  </span>
<span id="cb369-8"><a href="#cb369-8" aria-hidden="true"></a>    <span class="dt">long</span> ld4 = sDt4.<span class="fu">getTime</span>() /<span class="dv">1000</span>;</span>
<span id="cb369-9"><a href="#cb369-9" aria-hidden="true"></a>    <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(ld4-ld3);</span>
<span id="cb369-10"><a href="#cb369-10" aria-hidden="true"></a>}</span></code></pre></div>
<p><strong>The output is:</strong></p>
<blockquote>
353
</blockquote>
<p>Why is <code>ld4-ld3</code> not <code>1</code> (as I would expect from the one-second difference in the times), but <code>353</code>?</p>
<p>If I change the dates to times 1 second later:</p>
<div class="sourceCode" id="cb370"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb370-1"><a href="#cb370-1" aria-hidden="true"></a><span class="bu">String</span> str3 = <span class="st">&quot;1927-12-31 23:54:08&quot;</span>;  </span>
<span id="cb370-2"><a href="#cb370-2" aria-hidden="true"></a><span class="bu">String</span> str4 = <span class="st">&quot;1927-12-31 23:54:09&quot;</span>;  </span></code></pre></div>
<p>Then <code>ld4-ld3</code> will be <code>1</code>.</p>
<hr>
<p><strong>Java version:</strong></p>
<div class="sourceCode" id="cb371"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb371-1"><a href="#cb371-1" aria-hidden="true"></a>java version <span class="st">&quot;1.6.0_22&quot;</span></span>
<span id="cb371-2"><a href="#cb371-2" aria-hidden="true"></a><span class="fu">Java</span>(TM) SE <span class="bu">Runtime</span> <span class="bu">Environment</span> (build <span class="fl">1.6.</span>0_<span class="dv">22</span>-b04)</span>
<span id="cb371-3"><a href="#cb371-3" aria-hidden="true"></a>Dynamic Code Evolution Client <span class="fu">VM</span> (build <span class="fl">0.</span><span class="dv">2</span>-b02-internal, <span class="fl">19.</span><span class="dv">0</span>-b04-internal, mixed mode)</span>
<span id="cb371-4"><a href="#cb371-4" aria-hidden="true"></a></span>
<span id="cb371-5"><a href="#cb371-5" aria-hidden="true"></a><span class="fu">Timezone</span>(`TimeZone.<span class="fu">getDefault</span>()`):</span>
<span id="cb371-6"><a href="#cb371-6" aria-hidden="true"></a></span>
<span id="cb371-7"><a href="#cb371-7" aria-hidden="true"></a>sun.<span class="fu">util</span>.<span class="fu">calendar</span>.<span class="fu">ZoneInfo</span>[id=<span class="st">&quot;Asia/Shanghai&quot;</span>,</span>
<span id="cb371-8"><a href="#cb371-8" aria-hidden="true"></a>offset=<span class="dv">28800000</span>,dstSavings=<span class="dv">0</span>,</span>
<span id="cb371-9"><a href="#cb371-9" aria-hidden="true"></a>useDaylight=<span class="kw">false</span>,</span>
<span id="cb371-10"><a href="#cb371-10" aria-hidden="true"></a>transitions=<span class="dv">19</span>,</span>
<span id="cb371-11"><a href="#cb371-11" aria-hidden="true"></a>lastRule=<span class="kw">null</span>]</span>
<span id="cb371-12"><a href="#cb371-12" aria-hidden="true"></a></span>
<span id="cb371-13"><a href="#cb371-13" aria-hidden="true"></a><span class="bu">Locale</span>(<span class="bu">Locale</span>.<span class="fu">getDefault</span>()): zh_CN</span></code></pre></div>
</section>
<section id="answer-accepted-score-10528" class="level4">
<h4>Answer accepted (score 10528)</h4>
<p>It’s a time zone change on December 31st in Shanghai.</p>
<p>See <a href="http://www.timeanddate.com/worldclock/clockchange.html?n=237&amp;year=1927" rel="noreferrer">this page</a> for details of 1927 in Shanghai. Basically at midnight at the end of 1927, the clocks went back 5 minutes and 52 seconds. So “1927-12-31 23:54:08” actually happened twice, and it looks like Java is parsing it as the <em>later</em> possible instant for that local date/time - hence the difference.</p>
<p>Just another episode in the often weird and wonderful world of time zones.</p>
<p><strong>EDIT:</strong> Stop press! History changes…</p>
<p>The original question would no longer demonstrate quite the same behaviour, if rebuilt with version 2013a of <a href="https://github.com/nodatime/nodatime/blob/master/src/NodaTime.Demo/StackOverflowExamples.cs
#L68" rel="noreferrer">TZDB</a>. In 2013a, the result would be 358 seconds, with a transition time of 23:54:03 instead of 23:54:08.</p>
<p>I only noticed this because I’m collecting questions like this in Noda Time, in the form of <a href="https://github.com/nodatime/nodatime/blob/master/src/NodaTime.Demo/StackOverflowExamples.cs
#L68" rel="noreferrer">unit tests</a>… The test has now been changed, but it just goes to show - not even historical data is safe.</p>
<p><strong>EDIT:</strong> History has changed again…</p>
<p>In TZDB 2014f, the time of the change has moved to 1900-12-31, and it’s now a mere 343 second change (so the time between <code>t</code> and <code>t+1</code> is 344 seconds, if you see what I mean).</p>
<p><strong>EDIT:</strong> To answer a question around a transition at 1900… it looks like the Java timezone implementation treats <em>all</em> time zones as simply being in their standard time for any instant before the start of 1900 UTC:</p>
<div class="sourceCode" id="cb372"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb372-1"><a href="#cb372-1" aria-hidden="true"></a><span class="kw">import</span><span class="im"> java.util.TimeZone;</span></span>
<span id="cb372-2"><a href="#cb372-2" aria-hidden="true"></a></span>
<span id="cb372-3"><a href="#cb372-3" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">class</span> Test {</span>
<span id="cb372-4"><a href="#cb372-4" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span>(<span class="bu">String</span>[] args) <span class="kw">throws</span> <span class="bu">Exception</span> {</span>
<span id="cb372-5"><a href="#cb372-5" aria-hidden="true"></a>        <span class="dt">long</span> startOf1900Utc = -<span class="dv">2208988800000L</span>;</span>
<span id="cb372-6"><a href="#cb372-6" aria-hidden="true"></a>        <span class="kw">for</span> (<span class="bu">String</span> id : <span class="bu">TimeZone</span>.<span class="fu">getAvailableIDs</span>()) {</span>
<span id="cb372-7"><a href="#cb372-7" aria-hidden="true"></a>            <span class="bu">TimeZone</span> zone = <span class="bu">TimeZone</span>.<span class="fu">getTimeZone</span>(id);</span>
<span id="cb372-8"><a href="#cb372-8" aria-hidden="true"></a>            <span class="kw">if</span> (zone.<span class="fu">getRawOffset</span>() != zone.<span class="fu">getOffset</span>(startOf1900Utc - <span class="dv">1</span>)) {</span>
<span id="cb372-9"><a href="#cb372-9" aria-hidden="true"></a>                <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(id);</span>
<span id="cb372-10"><a href="#cb372-10" aria-hidden="true"></a>            }</span>
<span id="cb372-11"><a href="#cb372-11" aria-hidden="true"></a>        }</span>
<span id="cb372-12"><a href="#cb372-12" aria-hidden="true"></a>    }</span>
<span id="cb372-13"><a href="#cb372-13" aria-hidden="true"></a>}</span></code></pre></div>
<p>The code above produces no output on my Windows machine. So any time zone which has any offset other than its standard one at the start of 1900 will count that as a transition. TZDB itself has some data going back earlier than that, and doesn’t rely on any idea of a “fixed” standard time (which is what <code>getRawOffset</code> assumes to be a valid concept) so other libraries needn’t introduce this artificial transition.</p>
</section>
<section id="answer-2-score-1553" class="level4">
<h4>Answer 2 (score 1553)</h4>
<p>You’ve encountered a <a href="http://timeanddate.com/worldclock/clockchange.html?n=237&amp;year=1927" rel="noreferrer">local time discontinuity</a>:</p>
<blockquote>
<p>
When local standard time was about to reach Sunday, 1. January 1928, 00:00:00 clocks were turned backward 0:05:52 hours to Saturday, 31. December 1927, 23:54:08 local standard time instead
</p>
</blockquote>
<p>This is not particularly strange and has happened pretty much everywhere at one time or another as timezones were switched or changed due to political or administrative actions.</p>
</section>
<section id="answer-3-score-634" class="level4">
<h4>Answer 3 (score 634)</h4>
<p>The moral of this strangeness is:</p>
<ul>
<li>
Use dates and times in UTC wherever possible.
</li>
<li>
If you can not display a date or time in UTC, always indicate the time-zone.
</li>
<li>
If you can not require an input date/time in UTC, require an explicitly indicated time-zone.
</li>
</ul>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="comparing-java-enum-members-or-equals-score-614360-in-2017" class="level3">
<h3>51: Comparing Java enum members: == or equals()? (score <a href="https://stackoverflow.com/q/1750435.html">614360</a> in 2017)</h3>
<section id="question-49" class="level4">
<h4>Question</h4>
<p>I know that Java enums are compiled to classes with private constructors and a bunch of public static members. When comparing two members of a given enum, I’ve always used <code>.equals()</code>, e.g. </p>
<div class="sourceCode" id="cb373"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb373-1"><a href="#cb373-1" aria-hidden="true"></a><span class="kw">public</span> <span class="fu">useEnums</span>(SomeEnum a)</span>
<span id="cb373-2"><a href="#cb373-2" aria-hidden="true"></a>{</span>
<span id="cb373-3"><a href="#cb373-3" aria-hidden="true"></a>    <span class="kw">if</span>(a.<span class="fu">equals</span>(SomeEnum.<span class="fu">SOME_ENUM_VALUE</span>))</span>
<span id="cb373-4"><a href="#cb373-4" aria-hidden="true"></a>    {</span>
<span id="cb373-5"><a href="#cb373-5" aria-hidden="true"></a>        ...</span>
<span id="cb373-6"><a href="#cb373-6" aria-hidden="true"></a>    }</span>
<span id="cb373-7"><a href="#cb373-7" aria-hidden="true"></a>    ...</span>
<span id="cb373-8"><a href="#cb373-8" aria-hidden="true"></a>}</span></code></pre></div>
<p>However, I just came across some code that uses the equals operator <code>==</code> instead of .equals():</p>
<div class="sourceCode" id="cb374"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb374-1"><a href="#cb374-1" aria-hidden="true"></a><span class="kw">public</span> <span class="fu">useEnums2</span>(SomeEnum a)</span>
<span id="cb374-2"><a href="#cb374-2" aria-hidden="true"></a>{</span>
<span id="cb374-3"><a href="#cb374-3" aria-hidden="true"></a>    <span class="kw">if</span>(a == SomeEnum.<span class="fu">SOME_ENUM_VALUE</span>)</span>
<span id="cb374-4"><a href="#cb374-4" aria-hidden="true"></a>    {</span>
<span id="cb374-5"><a href="#cb374-5" aria-hidden="true"></a>        ...</span>
<span id="cb374-6"><a href="#cb374-6" aria-hidden="true"></a>    }</span>
<span id="cb374-7"><a href="#cb374-7" aria-hidden="true"></a>    ...</span>
<span id="cb374-8"><a href="#cb374-8" aria-hidden="true"></a>}</span></code></pre></div>
<p>Which operator is the one I should be using?</p>
</section>
<section id="answer-accepted-score-1455" class="level4">
<h4>Answer accepted (score 1455)</h4>
<p>Both are technically correct. If you look at the source code for <code>.equals()</code>, it simply defers to <code>==</code>.</p>
<p>I use <code>==</code>, however, as that will be null safe.</p>
</section>
<section id="answer-2-score-1052" class="level4">
<h4>Answer 2 (score 1052)</h4>
<h5>
Can <code>==</code> be used on <code>enum</code>?
</h2>
<p>Yes: enums have tight instance controls that allows you to use <code>==</code> to compare instances. Here’s the guarantee provided by the language specification (emphasis by me):</p>
<blockquote>
<h5>
<a href="https://docs.oracle.com/javase/specs/jls/se9/html/jls-8.html
#jls-8.9" rel="noreferrer">JLS 8.9 Enums</a>
</h3>
<p>An enum type has no instances other than those defined by its enum constants.</p>
<p>It is a compile-time error to attempt to explicitly instantiate an enum type. The <code>final clone</code> method in <code>Enum</code> ensures that <code>enum</code> constants can never be cloned, and the special treatment by the serialization mechanism ensures that duplicate instances are never created as a result of deserialization. Reflective instantiation of enum types is prohibited. Together, these four things ensure that no instances of an <code>enum</code> type exist beyond those defined by the <code>enum</code> constants.</p>
Because there is only one instance of each <code>enum</code> constant, <strong>it is permissible to use the <code>==</code> operator in place of the <code>equals</code> method when comparing two object references if it is known that at least one of them refers to an <code>enum</code> constant</strong>. (The <code>equals</code> method in <code>Enum</code> is a <code>final</code> method that merely invokes <code>super.equals</code> on its argument and returns the result, thus performing an identity comparison.)<br />

</blockquote>
<p>This guarantee is strong enough that Josh Bloch recommends, that if you insist on using the singleton pattern, the best way to implement it is to use a single-element <code>enum</code> (see: <em>Effective Java 2nd Edition, Item 3: Enforce the singleton property with a private constructor or an enum type</em>; also <a href="https://stackoverflow.com/questions/2912281/thread-safety-in-singleton/">Thread safety in Singleton</a>)</p>
<hr>
<h5>
What are the differences between <code>==</code> and <code>equals</code>?
</h2>
<p>As a reminder, it needs to be said that generally, <code>==</code> is NOT a viable alternative to <code>equals</code>. When it is, however (such as with <code>enum</code>), there are two important differences to consider:</p>
<h5>
<code>==</code> never throws <code>NullPointerException</code>
</h3>
<div class="sourceCode" id="cb375"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb375-1"><a href="#cb375-1" aria-hidden="true"></a><span class="kw">enum</span> <span class="bu">Color</span> { BLACK, WHITE };</span>
<span id="cb375-2"><a href="#cb375-2" aria-hidden="true"></a></span>
<span id="cb375-3"><a href="#cb375-3" aria-hidden="true"></a><span class="bu">Color</span> nothing = <span class="kw">null</span>;</span>
<span id="cb375-4"><a href="#cb375-4" aria-hidden="true"></a><span class="kw">if</span> (nothing == <span class="bu">Color</span>.<span class="fu">BLACK</span>);      <span class="co">// runs fine</span></span>
<span id="cb375-5"><a href="#cb375-5" aria-hidden="true"></a><span class="kw">if</span> (nothing.<span class="fu">equals</span>(<span class="bu">Color</span>.<span class="fu">BLACK</span>)); <span class="co">// throws NullPointerException</span></span></code></pre></div>
<h5>
<code>==</code> is subject to type compatibility check at compile time
</h3>
<div class="sourceCode" id="cb376"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb376-1"><a href="#cb376-1" aria-hidden="true"></a><span class="kw">enum</span> <span class="bu">Color</span> { BLACK, WHITE };</span>
<span id="cb376-2"><a href="#cb376-2" aria-hidden="true"></a><span class="kw">enum</span> Chiral { LEFT, RIGHT };</span>
<span id="cb376-3"><a href="#cb376-3" aria-hidden="true"></a></span>
<span id="cb376-4"><a href="#cb376-4" aria-hidden="true"></a><span class="kw">if</span> (<span class="bu">Color</span>.<span class="fu">BLACK</span>.<span class="fu">equals</span>(Chiral.<span class="fu">LEFT</span>)); <span class="co">// compiles fine</span></span>
<span id="cb376-5"><a href="#cb376-5" aria-hidden="true"></a><span class="kw">if</span> (<span class="bu">Color</span>.<span class="fu">BLACK</span> == Chiral.<span class="fu">LEFT</span>);      <span class="co">// DOESN&#39;T COMPILE!!! Incompatible types!</span></span></code></pre></div>
<hr>
<h5>
Should <code>==</code> be used when applicable?
</h2>
<p>Bloch specifically mentions that immutable classes that have proper control over their instances can guarantee to their clients that <code>==</code> is usable. <code>enum</code> is specifically mentioned to exemplify.</p>
<blockquote>
<p><em>Item 1: Consider static factory methods instead of constructors</em></p>
[…] it allows an immutable class to make the guarantee that no two equal instances exist: <code>a.equals(b)</code> if and only if <code>a==b</code>. If a class makes this guarantee, then its clients can use the <code>==</code> operator instead of the <code>equals(Object)</code> method, which may result in improved performance. Enum types provide this guarantee.
</blockquote>
<p>To summarize, the arguments for using <code>==</code> on <code>enum</code> are:</p>
<ul>
<li>
It works.
</li>
<li>
It’s faster.
</li>
<li>
It’s safer at run-time.
</li>
<li>
It’s safer at compile-time.
</li>
</ul>
</section>
<section id="answer-3-score-79" class="level4">
<h4>Answer 3 (score 79)</h4>
<p>Using <code>==</code> to compare two enum values works because there is only one object for each enum constant.</p>
<p>On a side note, there is actually no need to use <code>==</code> to write null safe code if you write your <code>equals()</code> like this:</p>
<div class="sourceCode" id="cb377"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb377-1"><a href="#cb377-1" aria-hidden="true"></a><span class="kw">public</span> <span class="fu">useEnums</span>(SomeEnum a)</span>
<span id="cb377-2"><a href="#cb377-2" aria-hidden="true"></a>{</span>
<span id="cb377-3"><a href="#cb377-3" aria-hidden="true"></a>    <span class="kw">if</span>(SomeEnum.<span class="fu">SOME_ENUM_VALUE</span>.<span class="fu">equals</span>(a))</span>
<span id="cb377-4"><a href="#cb377-4" aria-hidden="true"></a>    {</span>
<span id="cb377-5"><a href="#cb377-5" aria-hidden="true"></a>        ...</span>
<span id="cb377-6"><a href="#cb377-6" aria-hidden="true"></a>    }</span>
<span id="cb377-7"><a href="#cb377-7" aria-hidden="true"></a>    ...</span>
<span id="cb377-8"><a href="#cb377-8" aria-hidden="true"></a>}</span></code></pre></div>
<p>This is a best practice known as <a href="http://c2.com/cgi/wiki?CompareConstantsFromTheLeft" rel="noreferrer">Compare Constants From The Left</a> that you definitely should follow.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="creating-a-memory-leak-with-java-score-610179-in-2019" class="level3">
<h3>52: Creating a memory leak with Java (score <a href="https://stackoverflow.com/q/6470651.html">610179</a> in 2019)</h3>
<section id="question-50" class="level4">
<h4>Question</h4>
<p>
I just had an interview, and I was asked to create a <strong><em>memory leak</em></strong> with Java.<br> Needless to say, I felt pretty dumb having no clue on how to even start creating one.
</p>
<p>What would an example be?</p>
</section>
<section id="answer-accepted-score-2210" class="level4">
<h4>Answer accepted (score 2210)</h4>
<p>Here’s a good way to create a true memory leak (objects inaccessible by running code but still stored in memory) in pure Java:</p>
<ol>
<li>
The application creates a long-running thread (or use a thread pool to leak even faster).
</li>
<li>
The thread loads a class via an (optionally custom) ClassLoader.
</li>
<li>
The class allocates a large chunk of memory (e.g. <code>new byte[1000000]</code>), stores a strong reference to it in a static field, and then stores a reference to itself in a ThreadLocal. Allocating the extra memory is optional (leaking the Class instance is enough), but it will make the leak work that much faster.
</li>
<li>
The thread clears all references to the custom class or the ClassLoader it was loaded from.
</li>
<li>
Repeat.
</li>
</ol>
<p>This works because the ThreadLocal keeps a reference to the object, which keeps a reference to its Class, which in turn keeps a reference to its ClassLoader. The ClassLoader, in turn, keeps a reference to all the Classes it has loaded.</p>
<p>(It was worse in many JVM implementations, especially prior to Java 7, because Classes and ClassLoaders were allocated straight into permgen and were never GC’d at all. However, regardless of how the JVM handles class unloading, a ThreadLocal will still prevent a Class object from being reclaimed.)</p>
<p>A variation on this pattern is why application containers (like Tomcat) can leak memory like a sieve if you frequently redeploy applications that happen to use ThreadLocals in any way. (Since the application container uses Threads as described, and each time you redeploy the application a new ClassLoader is used.)</p>
<p><strong>Update</strong>: Since lots of people keep asking for it, <a href="https://gist.github.com/dpryden/b2bb29ee2d146901b4ae" rel="noreferrer">here’s some example code that shows this behavior in action</a>.</p>
</section>
<section id="answer-2-score-1176" class="level4">
<h4>Answer 2 (score 1176)</h4>
<p><strong>Static field holding object reference [esp final field]</strong></p>
<div class="sourceCode" id="cb378"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb378-1"><a href="#cb378-1" aria-hidden="true"></a><span class="kw">class</span> MemorableClass {</span>
<span id="cb378-2"><a href="#cb378-2" aria-hidden="true"></a>    <span class="dt">static</span> <span class="dt">final</span> <span class="bu">ArrayList</span> list = <span class="kw">new</span> <span class="bu">ArrayList</span>(<span class="dv">100</span>);</span>
<span id="cb378-3"><a href="#cb378-3" aria-hidden="true"></a>}</span></code></pre></div>
<p><strong>Calling <a href="http://download.oracle.com/javase/6/docs/api/java/lang/String.html
#intern%28%29" rel="noreferrer"><code>String.intern()</code></a> on lengthy String</strong></p>
<div class="sourceCode" id="cb379"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb379-1"><a href="#cb379-1" aria-hidden="true"></a><span class="bu">String</span> str=<span class="fu">readString</span>(); <span class="co">// read lengthy string any source db,textbox/jsp etc..</span></span>
<span id="cb379-2"><a href="#cb379-2" aria-hidden="true"></a><span class="co">// This will place the string in memory pool from which you can&#39;t remove</span></span>
<span id="cb379-3"><a href="#cb379-3" aria-hidden="true"></a>str.<span class="fu">intern</span>();</span></code></pre></div>
<p><strong>(Unclosed) open streams ( file , network etc… )</strong></p>
<div class="sourceCode" id="cb380"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb380-1"><a href="#cb380-1" aria-hidden="true"></a><span class="kw">try</span> {</span>
<span id="cb380-2"><a href="#cb380-2" aria-hidden="true"></a>    <span class="bu">BufferedReader</span> br = <span class="kw">new</span> <span class="bu">BufferedReader</span>(<span class="kw">new</span> <span class="bu">FileReader</span>(inputFile));</span>
<span id="cb380-3"><a href="#cb380-3" aria-hidden="true"></a>    ...</span>
<span id="cb380-4"><a href="#cb380-4" aria-hidden="true"></a>    ...</span>
<span id="cb380-5"><a href="#cb380-5" aria-hidden="true"></a>} <span class="kw">catch</span> (<span class="bu">Exception</span> e) {</span>
<span id="cb380-6"><a href="#cb380-6" aria-hidden="true"></a>    e.<span class="fu">printStacktrace</span>();</span>
<span id="cb380-7"><a href="#cb380-7" aria-hidden="true"></a>}</span></code></pre></div>
<p><strong>Unclosed connections</strong></p>
<div class="sourceCode" id="cb381"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb381-1"><a href="#cb381-1" aria-hidden="true"></a><span class="kw">try</span> {</span>
<span id="cb381-2"><a href="#cb381-2" aria-hidden="true"></a>    <span class="bu">Connection</span> conn = ConnectionFactory.<span class="fu">getConnection</span>();</span>
<span id="cb381-3"><a href="#cb381-3" aria-hidden="true"></a>    ...</span>
<span id="cb381-4"><a href="#cb381-4" aria-hidden="true"></a>    ...</span>
<span id="cb381-5"><a href="#cb381-5" aria-hidden="true"></a>} <span class="kw">catch</span> (<span class="bu">Exception</span> e) {</span>
<span id="cb381-6"><a href="#cb381-6" aria-hidden="true"></a>    e.<span class="fu">printStacktrace</span>();</span>
<span id="cb381-7"><a href="#cb381-7" aria-hidden="true"></a>}</span></code></pre></div>
<p><strong>Areas that are unreachable from JVM’s garbage collector</strong>, such as memory allocated through native methods</p>
<p>In web applications, some objects are stored in application scope until the application is explicitly stopped or removed.</p>
<div class="sourceCode" id="cb382"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb382-1"><a href="#cb382-1" aria-hidden="true"></a><span class="fu">getServletContext</span>().<span class="fu">setAttribute</span>(<span class="st">&quot;SOME_MAP&quot;</span>, map);</span></code></pre></div>
<p><strong>Incorrect or inappropriate JVM options</strong>, such as the <code>noclassgc</code> option on IBM JDK that prevents unused class garbage collection</p>
<p>See <a href="http://publib.boulder.ibm.com/infocenter/wasinfo/v6r0/index.jsp?topic=/com.ibm.websphere.express.doc/info/exp/ae/tprf_tunejvm.html" rel="noreferrer">IBM jdk settings</a>.</p>
</section>
<section id="answer-3-score-448" class="level4">
<h4>Answer 3 (score 448)</h4>
<p>A simple thing to do is to use a HashSet with an incorrect (or non-existent) <code>hashCode()</code> or <code>equals()</code>, and then keep adding “duplicates”. Instead of ignoring duplicates as it should, the set will only ever grow and you won’t be able to remove them.</p>
<p>If you want these bad keys/elements to hang around you can use a static field like</p>
<div class="sourceCode" id="cb383"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb383-1"><a href="#cb383-1" aria-hidden="true"></a><span class="kw">class</span> BadKey {</span>
<span id="cb383-2"><a href="#cb383-2" aria-hidden="true"></a>   <span class="co">// no hashCode or equals();</span></span>
<span id="cb383-3"><a href="#cb383-3" aria-hidden="true"></a>   <span class="kw">public</span> <span class="dt">final</span> <span class="bu">String</span> key;</span>
<span id="cb383-4"><a href="#cb383-4" aria-hidden="true"></a>   <span class="kw">public</span> <span class="fu">BadKey</span>(<span class="bu">String</span> key) { <span class="kw">this</span>.<span class="fu">key</span> = key; }</span>
<span id="cb383-5"><a href="#cb383-5" aria-hidden="true"></a>}</span>
<span id="cb383-6"><a href="#cb383-6" aria-hidden="true"></a></span>
<span id="cb383-7"><a href="#cb383-7" aria-hidden="true"></a><span class="bu">Map</span> map = <span class="bu">System</span>.<span class="fu">getProperties</span>();</span>
<span id="cb383-8"><a href="#cb383-8" aria-hidden="true"></a>map.<span class="fu">put</span>(<span class="kw">new</span> <span class="fu">BadKey</span>(<span class="st">&quot;key&quot;</span>), <span class="st">&quot;value&quot;</span>); <span class="co">// Memory leak even if your threads die.</span></span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-can-i-convert-a-stack-trace-to-a-string-score-568558-in-2016" class="level3">
<h3>53: How can I convert a stack trace to a string? (score <a href="https://stackoverflow.com/q/1149703.html">568558</a> in 2016)</h3>
<section id="question-51" class="level4">
<h4>Question</h4>
<p>What is the easiest way to convert the result of <code>Throwable.getStackTrace()</code> to a string that depicts the stacktrace?</p>
</section>
<section id="answer-accepted-score-988" class="level4">
<h4>Answer accepted (score 988)</h4>
<p>One can use the following method to convert an <code>Exception</code> stack trace to <code>String</code>. This class is available in <em>Apache commons-lang which is most common dependent library with many popular open sources</em></p>
<p><a href="http://commons.apache.org/proper/commons-lang/javadocs/api-2.6/org/apache/commons/lang/exception/ExceptionUtils.html
#getStackTrace(java.lang.Throwable)" rel="noreferrer"><code>org.apache.commons.lang.exception.ExceptionUtils.getStackTrace(Throwable)</code></a></p>
</section>
<section id="answer-2-score-2127" class="level4">
<h4>Answer 2 (score 2127)</h4>
<p>Use <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Throwable.html
#printStackTrace-java.io.PrintWriter-" rel="noreferrer"><code>Throwable.printStackTrace(PrintWriter pw)</code></a> to send the stack trace to an appropriate writer.</p>
<div class="sourceCode" id="cb384"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb384-1"><a href="#cb384-1" aria-hidden="true"></a><span class="kw">import</span><span class="im"> java.io.StringWriter;</span></span>
<span id="cb384-2"><a href="#cb384-2" aria-hidden="true"></a><span class="kw">import</span><span class="im"> java.io.PrintWriter;</span></span>
<span id="cb384-3"><a href="#cb384-3" aria-hidden="true"></a></span>
<span id="cb384-4"><a href="#cb384-4" aria-hidden="true"></a><span class="co">// ...</span></span>
<span id="cb384-5"><a href="#cb384-5" aria-hidden="true"></a></span>
<span id="cb384-6"><a href="#cb384-6" aria-hidden="true"></a><span class="bu">StringWriter</span> sw = <span class="kw">new</span> <span class="bu">StringWriter</span>();</span>
<span id="cb384-7"><a href="#cb384-7" aria-hidden="true"></a><span class="bu">PrintWriter</span> pw = <span class="kw">new</span> <span class="bu">PrintWriter</span>(sw);</span>
<span id="cb384-8"><a href="#cb384-8" aria-hidden="true"></a>e.<span class="fu">printStackTrace</span>(pw);</span>
<span id="cb384-9"><a href="#cb384-9" aria-hidden="true"></a><span class="bu">String</span> sStackTrace = sw.<span class="fu">toString</span>(); <span class="co">// stack trace as a string</span></span>
<span id="cb384-10"><a href="#cb384-10" aria-hidden="true"></a><span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(sStackTrace);</span></code></pre></div>
</section>
<section id="answer-3-score-442-1" class="level4">
<h4>Answer 3 (score 442)</h4>
<p>This should work:</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb385-1"><a href="#cb385-1" aria-hidden="true"></a><span class="bu">StringWriter</span> sw = <span class="kw">new</span> <span class="bu">StringWriter</span>();</span>
<span id="cb385-2"><a href="#cb385-2" aria-hidden="true"></a>e.<span class="fu">printStackTrace</span>(<span class="kw">new</span> <span class="bu">PrintWriter</span>(sw));</span>
<span id="cb385-3"><a href="#cb385-3" aria-hidden="true"></a><span class="bu">String</span> exceptionAsString = sw.<span class="fu">toString</span>();</span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="what-exactly-is-apache-camel-score-533978-in-2016" class="level3">
<h3>54: What exactly is Apache Camel? (score <a href="https://stackoverflow.com/q/8845186.html">533978</a> in 2016)</h3>
<section id="question-52" class="level4">
<h4>Question</h4>
<p>I don’t understand what exactly <a href="http://camel.apache.org/index.html" rel="noreferrer">Camel</a> does.</p>
<p>If you could give in 101 words an introduction to Camel:</p>
<ul>
<li>
What exactly is it?
</li>
<li>
How does it interact with an application written in Java?
</li>
<li>
Is it something that goes together with the server?
</li>
<li>
Is it an independent program?
</li>
</ul>
<p><strong>Please explain what Camel is.</strong></p>
</section>
<section id="answer-accepted-score-678" class="level4">
<h4>Answer accepted (score 678)</h4>
<p>If you have 5 to 10 minutes, I generally recommend people to read this <a href="http://java.dzone.com/articles/open-source-integration-apache">Integration with Apache Camel</a> by Jonathan Anstey. It’s a well written piece which gives a brief introduction to and overview of some of Camel’s concepts, and it implements a use case with code samples. In it, Jonathan writes:</p>
<blockquote>
<p>Apache Camel is an open source Java framework that focuses on making integration easier and more accessible to developers. It does this by providing:</p>
<ul>
<li>
concrete implementations of all the widely used <a href="http://www.enterpriseintegrationpatterns.com/">Enterprise Integration Patterns</a> (EIPs)
</li>
<li>
connectivity to a great variety of transports and APIs
</li>
<li>
easy to use Domain Specific Languages (DSLs) to wire EIPs and transports together
</li>
</ul>
</blockquote>
<p>There is also a free chapter of <a href="http://manning.com/ibsen/">Camel in Action</a> which introduces Camel in the first chapter. Jonathan is a co-author on that book with me.</p>
</section>
<section id="answer-2-score-1082" class="level4">
<h4>Answer 2 (score 1082)</h4>
<p>My take to describe this in a more accessible way…</p>
<p>In order to understand what Apache Camel is, you need to understand what Enterprise Integration Patterns are.</p>
<p>Let’s start with what we presumably already know: The Singleton pattern, the Factory pattern, etc; They are merely ways of organizing your solution to the problem, but they are not solutions themselves. These patterns were analyzed and extracted for the rest of us by the Gang of Four, when they published their book: <a href="http://en.wikipedia.org/wiki/Design_Patterns">Design Patterns</a>. They saved some of us tremendous effort in thinking of how to best structure our code.</p>
<p>Much like the Gang of Four, Gregor Hohpe and Bobby Woolf authored the book <a href="http://www.eaipatterns.com/">Enterprise Integration Patterns</a> (EIP) in which they propose and document a set of new patterns and <em>blueprints</em> for how we could <em>best</em> design large component-based systems, where components can be running on the same process or in a different machine.</p>
<p>They basically propose that we structure our system to be <em>message</em> oriented – where components communicate with each others using messages as inputs and outputs and absolutely nothing else. They show us a complete set of patterns that we may choose from and implement in our different components that will together form the whole system.</p>
<p><strong>So what is Apache Camel?</strong></p>
<p>Apache Camel offers you the interfaces for the EIPs, the base objects, commonly needed implementations, debugging tools, a configuration system, and many other helpers which will save you a ton of time when you want to implement your solution to follow the EIPs.</p>
<p>Take MVC. MVC is pretty simple in theory and we could implement it without any framework help. But good MVC frameworks provide us with the structure ready-to-use and have gone the extra mile and thought out all the other “side” things you need when you create a large MVC project and that’s why we use them most of the time.</p>
<p>That’s exactly what Apache Camel is for EIPs. <strong>It’s a complete production-ready framework for people who want to implement their solution to follow the EIPs.</strong></p>
</section>
<section id="answer-3-score-652" class="level4">
<h4>Answer 3 (score 652)</h4>
<p>Creating a <a href="http://www.bigsoft.co.uk/blog/index.php/2010/10/18/the-whats-and-whys-to-creating-project-descriptions">project description</a> should not be complicated.</p>
<p>I say:</p>
<blockquote>
Apache Camel is messaging technology glue with routing. It joins together messaging start and end points allowing the transference of messages from different sources to different destinations. For example: JMS -&gt; JSON, HTTP -&gt; JMS or funneling FTP -&gt; JMS, HTTP -&gt; JMS, JSON -&gt; JMS
</blockquote>
<p>Wikipedia says:</p>
<blockquote>
Apache Camel is a rule-based routing and mediation engine which provides a Java object based implementation of the Enterprise Integration Patterns using an API (or declarative Java Domain Specific Language) to configure routing and mediation rules. The domain specific language means that Apache Camel can support type-safe smart completion of routing rules in your IDE using regular Java code without huge amounts of XML configuration files; though XML configuration inside Spring is also supported.
</blockquote>
<p>See? That wasn’t hard was it?</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="what-is-a-javabean-exactly-score-528745-in-2019" class="level3">
<h3>55: What is a JavaBean exactly? (score <a href="https://stackoverflow.com/q/3295496.html">528745</a> in 2019)</h3>
<section id="question-53" class="level4">
<h4>Question</h4>
<p>I understood, I think, that a “Bean” is a Java class with properties and getters/setters. As much as I understand, it is the equivalent of a C struct. Is that true?</p>
<p>Also, is there a real <em>syntactic</em> difference between a bean and a regular class? Is there any special definition or an interface?</p>
<p>Basically, why is there a term for this?</p>
<p>Also what does the <code>Serializable</code> interface mean?</p>
</section>
<section id="answer-accepted-score-1852" class="level4">
<h4>Answer accepted (score 1852)</h4>
<p>A JavaBean is just a <a href="http://www.oracle.com/technetwork/java/javase/documentation/spec-136004.html" rel="noreferrer">standard</a></p>
<ol>
<li>
All properties private (use <a href="http://en.wikipedia.org/wiki/Mutator_method" rel="noreferrer">getters/setters</a>)
</li>
<li>
A public <a href="http://en.wikipedia.org/wiki/Nullary_constructor" rel="noreferrer">no-argument constructor</a>
</li>
<li>
Implements <a href="http://docs.oracle.com/javase/8/docs/api/java/io/Serializable.html" rel="noreferrer"><code>Serializable</code></a>.
</li>
</ol>
<p>That’s it. It’s just a convention. Lots of libraries depend on it though.</p>
<p>With respect to <code>Serializable</code>, from the <a href="http://docs.oracle.com/javase/8/docs/api/java/io/Serializable.html" rel="noreferrer">API documentation</a>:</p>
<blockquote>
<p>
Serializability of a class is enabled by the class implementing the java.io.Serializable interface. Classes that do not implement this interface will not have any of their state serialized or deserialized. All subtypes of a serializable class are themselves serializable. The serialization interface has no methods or fields and serves only to identify the semantics of being serializable.
</p>
</blockquote>
<p>In other words, serializable objects can be written to streams, and hence files, object databases, anything really.</p>
<p>Also, there is no syntactic difference between a JavaBean and another class – a class is a JavaBean if it follows the standards.</p>
<p>There is a term for it because the standard allows libraries to programmatically do things with class instances you define in a predefined way. For example, if a library wants to stream any object you pass into it, it knows it can because your object is serializable (assuming the lib requires your objects be proper JavaBeans).</p>
</section>
<section id="answer-2-score-271" class="level4">
<h4>Answer 2 (score 271)</h4>
<p>There’s a term for it to make it sound special. The reality is nowhere near so mysterious.</p>
<p>Basically, a “Bean”:</p>
<ul>
<li>
is a serializable object (that is, it implements <a href="http://docs.oracle.com/javase/8/docs/api/java/io/Serializable.html" rel="noreferrer"><code>java.io.Serializable</code></a>, and does so correctly), that
</li>
<li>
has “properties” whose getters and setters are just methods with certain names (like, say, <code>getFoo()</code> is the getter for the “Foo” property), and
</li>
<li>
has a public 0-arg constructor (so it can be created at will and configured by setting its properties).
</li>
</ul>
<p>Update:</p>
<p>As for <code>Serializable</code>: That is nothing but a “marker interface” (an interface that doesn’t declare any functions) that tells Java that the implementing class consents to (and implies that it is capable of) “serialization” – a process that converts an instance into a stream of bytes. Those bytes can be stored in files, sent over a network connection, etc, and have enough info to allow a JVM (at least, one that knows about the object’s type) to reconstruct the object later – possibly in a different instance of the application, or even on a whole other machine!</p>
<p>Of course, in order to do that, the class has to abide by certain limitations. Chief among them is that all instance fields must be either primitive types (int, bool, etc), instances of some class that is also serializable, or marked as <code>transient</code> so that Java won’t try to include them. (This of course means that <code>transient</code> fields will not survive the trip over a stream. A class that has <code>transient</code> fields should be prepared to reinitialize them if necessary.)</p>
<p>A class that can not abide by those limitations should not implement <code>Serializable</code> (and, IIRC, the Java compiler won’t even <em>let</em> it do so.)</p>
</section>
<section id="answer-3-score-89" class="level4">
<h4>Answer 3 (score 89)</h4>
<p>
JavaBeans are Java classes which adhere to an extremely simple coding convention. All you have to do is to
</p>
<ol>
<li>
implement <code>java.io.Serializable</code> interface - to save the state of an object
</li>
<li>
use a public empty argument constructor - to instantiate the object
</li>
<li>
provide public getter/setter methods - to get and set the values of private variables (properties ).
</li>
</ol>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="download-a-file-with-android-and-showing-the-progress-in-a-progressdialog-score-518763-in-2014" class="level3">
<h3>56: Download a file with Android, and showing the progress in a ProgressDialog (score <a href="https://stackoverflow.com/q/3028306.html">518763</a> in 2014)</h3>
<section id="question-54" class="level4">
<h4>Question</h4>
<p>I am trying to write a simple application that gets updated. For this I need a simple function that can download a file and <em>show the current progress</em> in a <code>ProgressDialog</code>. I know how to do the <code>ProgressDialog</code>, but I’m not sure how to display the current progress and how to download the file in the first place.</p>
</section>
<section id="answer-accepted-score-1828" class="level4">
<h4>Answer accepted (score 1828)</h4>
<p>There are many ways to download files. Following I will post most common ways; it is up to you to decide which method is better for your app.</p>
<h5>
<ol type="1">
<li>Use <code>AsyncTask</code> and show the download progress in a dialog
</h1></li>
</ol>
<p>This method will allow you to execute some background processes and update the UI at the same time (in this case, we’ll update a progress bar).</p>
<p>This is an example code:</p>
<div class="sourceCode" id="cb386"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb386-1"><a href="#cb386-1" aria-hidden="true"></a><span class="co">// declare the dialog as a member field of your activity</span></span>
<span id="cb386-2"><a href="#cb386-2" aria-hidden="true"></a>ProgressDialog mProgressDialog;</span>
<span id="cb386-3"><a href="#cb386-3" aria-hidden="true"></a></span>
<span id="cb386-4"><a href="#cb386-4" aria-hidden="true"></a><span class="co">// instantiate it within the onCreate method</span></span>
<span id="cb386-5"><a href="#cb386-5" aria-hidden="true"></a>mProgressDialog = <span class="kw">new</span> <span class="fu">ProgressDialog</span>(YourActivity.<span class="fu">this</span>);</span>
<span id="cb386-6"><a href="#cb386-6" aria-hidden="true"></a>mProgressDialog.<span class="fu">setMessage</span>(<span class="st">&quot;A message&quot;</span>);</span>
<span id="cb386-7"><a href="#cb386-7" aria-hidden="true"></a>mProgressDialog.<span class="fu">setIndeterminate</span>(<span class="kw">true</span>);</span>
<span id="cb386-8"><a href="#cb386-8" aria-hidden="true"></a>mProgressDialog.<span class="fu">setProgressStyle</span>(ProgressDialog.<span class="fu">STYLE_HORIZONTAL</span>);</span>
<span id="cb386-9"><a href="#cb386-9" aria-hidden="true"></a>mProgressDialog.<span class="fu">setCancelable</span>(<span class="kw">true</span>);</span>
<span id="cb386-10"><a href="#cb386-10" aria-hidden="true"></a></span>
<span id="cb386-11"><a href="#cb386-11" aria-hidden="true"></a><span class="co">// execute this when the downloader must be fired</span></span>
<span id="cb386-12"><a href="#cb386-12" aria-hidden="true"></a><span class="dt">final</span> DownloadTask downloadTask = <span class="kw">new</span> <span class="fu">DownloadTask</span>(YourActivity.<span class="fu">this</span>);</span>
<span id="cb386-13"><a href="#cb386-13" aria-hidden="true"></a>downloadTask.<span class="fu">execute</span>(<span class="st">&quot;the url to the file you want to download&quot;</span>);</span>
<span id="cb386-14"><a href="#cb386-14" aria-hidden="true"></a></span>
<span id="cb386-15"><a href="#cb386-15" aria-hidden="true"></a>mProgressDialog.<span class="fu">setOnCancelListener</span>(<span class="kw">new</span> DialogInterface.<span class="fu">OnCancelListener</span>() {</span>
<span id="cb386-16"><a href="#cb386-16" aria-hidden="true"></a></span>
<span id="cb386-17"><a href="#cb386-17" aria-hidden="true"></a>    <span class="at">@Override</span></span>
<span id="cb386-18"><a href="#cb386-18" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">void</span> <span class="fu">onCancel</span>(DialogInterface dialog) {</span>
<span id="cb386-19"><a href="#cb386-19" aria-hidden="true"></a>        downloadTask.<span class="fu">cancel</span>(<span class="kw">true</span>); <span class="co">//cancel the task</span></span>
<span id="cb386-20"><a href="#cb386-20" aria-hidden="true"></a>    }</span>
<span id="cb386-21"><a href="#cb386-21" aria-hidden="true"></a>});</span></code></pre></div>
<p>The <code>AsyncTask</code> will look like this:</p>
<div class="sourceCode" id="cb387"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb387-1"><a href="#cb387-1" aria-hidden="true"></a><span class="co">// usually, subclasses of AsyncTask are declared inside the activity class.</span></span>
<span id="cb387-2"><a href="#cb387-2" aria-hidden="true"></a><span class="co">// that way, you can easily modify the UI thread from here</span></span>
<span id="cb387-3"><a href="#cb387-3" aria-hidden="true"></a><span class="kw">private</span> <span class="kw">class</span> DownloadTask <span class="kw">extends</span> AsyncTask&lt;<span class="bu">String</span>, <span class="bu">Integer</span>, <span class="bu">String</span>&gt; {</span>
<span id="cb387-4"><a href="#cb387-4" aria-hidden="true"></a></span>
<span id="cb387-5"><a href="#cb387-5" aria-hidden="true"></a>    <span class="kw">private</span> <span class="bu">Context</span> context;</span>
<span id="cb387-6"><a href="#cb387-6" aria-hidden="true"></a>    <span class="kw">private</span> PowerManager.<span class="fu">WakeLock</span> mWakeLock;</span>
<span id="cb387-7"><a href="#cb387-7" aria-hidden="true"></a></span>
<span id="cb387-8"><a href="#cb387-8" aria-hidden="true"></a>    <span class="kw">public</span> <span class="fu">DownloadTask</span>(<span class="bu">Context</span> context) {</span>
<span id="cb387-9"><a href="#cb387-9" aria-hidden="true"></a>        <span class="kw">this</span>.<span class="fu">context</span> = context;</span>
<span id="cb387-10"><a href="#cb387-10" aria-hidden="true"></a>    }</span>
<span id="cb387-11"><a href="#cb387-11" aria-hidden="true"></a></span>
<span id="cb387-12"><a href="#cb387-12" aria-hidden="true"></a>    <span class="at">@Override</span></span>
<span id="cb387-13"><a href="#cb387-13" aria-hidden="true"></a>    <span class="kw">protected</span> <span class="bu">String</span> <span class="fu">doInBackground</span>(<span class="bu">String</span><span class="kw">... </span>sUrl) {</span>
<span id="cb387-14"><a href="#cb387-14" aria-hidden="true"></a>        <span class="bu">InputStream</span> input = <span class="kw">null</span>;</span>
<span id="cb387-15"><a href="#cb387-15" aria-hidden="true"></a>        <span class="bu">OutputStream</span> output = <span class="kw">null</span>;</span>
<span id="cb387-16"><a href="#cb387-16" aria-hidden="true"></a>        <span class="bu">HttpURLConnection</span> connection = <span class="kw">null</span>;</span>
<span id="cb387-17"><a href="#cb387-17" aria-hidden="true"></a>        <span class="kw">try</span> {</span>
<span id="cb387-18"><a href="#cb387-18" aria-hidden="true"></a>            <span class="bu">URL</span> url = <span class="kw">new</span> <span class="bu">URL</span>(sUrl[<span class="dv">0</span>]);</span>
<span id="cb387-19"><a href="#cb387-19" aria-hidden="true"></a>            connection = (<span class="bu">HttpURLConnection</span>) url.<span class="fu">openConnection</span>();</span>
<span id="cb387-20"><a href="#cb387-20" aria-hidden="true"></a>            connection.<span class="fu">connect</span>();</span>
<span id="cb387-21"><a href="#cb387-21" aria-hidden="true"></a></span>
<span id="cb387-22"><a href="#cb387-22" aria-hidden="true"></a>            <span class="co">// expect HTTP 200 OK, so we don&#39;t mistakenly save error report</span></span>
<span id="cb387-23"><a href="#cb387-23" aria-hidden="true"></a>            <span class="co">// instead of the file</span></span>
<span id="cb387-24"><a href="#cb387-24" aria-hidden="true"></a>            <span class="kw">if</span> (connection.<span class="fu">getResponseCode</span>() != <span class="bu">HttpURLConnection</span>.<span class="fu">HTTP_OK</span>) {</span>
<span id="cb387-25"><a href="#cb387-25" aria-hidden="true"></a>                <span class="kw">return</span> <span class="st">&quot;Server returned HTTP &quot;</span> + connection.<span class="fu">getResponseCode</span>()</span>
<span id="cb387-26"><a href="#cb387-26" aria-hidden="true"></a>                        + <span class="st">&quot; &quot;</span> + connection.<span class="fu">getResponseMessage</span>();</span>
<span id="cb387-27"><a href="#cb387-27" aria-hidden="true"></a>            }</span>
<span id="cb387-28"><a href="#cb387-28" aria-hidden="true"></a></span>
<span id="cb387-29"><a href="#cb387-29" aria-hidden="true"></a>            <span class="co">// this will be useful to display download percentage</span></span>
<span id="cb387-30"><a href="#cb387-30" aria-hidden="true"></a>            <span class="co">// might be -1: server did not report the length</span></span>
<span id="cb387-31"><a href="#cb387-31" aria-hidden="true"></a>            <span class="dt">int</span> fileLength = connection.<span class="fu">getContentLength</span>();</span>
<span id="cb387-32"><a href="#cb387-32" aria-hidden="true"></a></span>
<span id="cb387-33"><a href="#cb387-33" aria-hidden="true"></a>            <span class="co">// download the file</span></span>
<span id="cb387-34"><a href="#cb387-34" aria-hidden="true"></a>            input = connection.<span class="fu">getInputStream</span>();</span>
<span id="cb387-35"><a href="#cb387-35" aria-hidden="true"></a>            output = <span class="kw">new</span> <span class="bu">FileOutputStream</span>(<span class="st">&quot;/sdcard/file_name.extension&quot;</span>);</span>
<span id="cb387-36"><a href="#cb387-36" aria-hidden="true"></a></span>
<span id="cb387-37"><a href="#cb387-37" aria-hidden="true"></a>            <span class="dt">byte</span> data[] = <span class="kw">new</span> <span class="dt">byte</span>[<span class="dv">4096</span>];</span>
<span id="cb387-38"><a href="#cb387-38" aria-hidden="true"></a>            <span class="dt">long</span> total = <span class="dv">0</span>;</span>
<span id="cb387-39"><a href="#cb387-39" aria-hidden="true"></a>            <span class="dt">int</span> count;</span>
<span id="cb387-40"><a href="#cb387-40" aria-hidden="true"></a>            <span class="kw">while</span> ((count = input.<span class="fu">read</span>(data)) != -<span class="dv">1</span>) {</span>
<span id="cb387-41"><a href="#cb387-41" aria-hidden="true"></a>                <span class="co">// allow canceling with back button</span></span>
<span id="cb387-42"><a href="#cb387-42" aria-hidden="true"></a>                <span class="kw">if</span> (<span class="fu">isCancelled</span>()) {</span>
<span id="cb387-43"><a href="#cb387-43" aria-hidden="true"></a>                    input.<span class="fu">close</span>();</span>
<span id="cb387-44"><a href="#cb387-44" aria-hidden="true"></a>                    <span class="kw">return</span> <span class="kw">null</span>;</span>
<span id="cb387-45"><a href="#cb387-45" aria-hidden="true"></a>                }</span>
<span id="cb387-46"><a href="#cb387-46" aria-hidden="true"></a>                total += count;</span>
<span id="cb387-47"><a href="#cb387-47" aria-hidden="true"></a>                <span class="co">// publishing the progress....</span></span>
<span id="cb387-48"><a href="#cb387-48" aria-hidden="true"></a>                <span class="kw">if</span> (fileLength &gt; <span class="dv">0</span>) <span class="co">// only if total length is known</span></span>
<span id="cb387-49"><a href="#cb387-49" aria-hidden="true"></a>                    <span class="fu">publishProgress</span>((<span class="dt">int</span>) (total * <span class="dv">100</span> / fileLength));</span>
<span id="cb387-50"><a href="#cb387-50" aria-hidden="true"></a>                output.<span class="fu">write</span>(data, <span class="dv">0</span>, count);</span>
<span id="cb387-51"><a href="#cb387-51" aria-hidden="true"></a>            }</span>
<span id="cb387-52"><a href="#cb387-52" aria-hidden="true"></a>        } <span class="kw">catch</span> (<span class="bu">Exception</span> e) {</span>
<span id="cb387-53"><a href="#cb387-53" aria-hidden="true"></a>            <span class="kw">return</span> e.<span class="fu">toString</span>();</span>
<span id="cb387-54"><a href="#cb387-54" aria-hidden="true"></a>        } <span class="kw">finally</span> {</span>
<span id="cb387-55"><a href="#cb387-55" aria-hidden="true"></a>            <span class="kw">try</span> {</span>
<span id="cb387-56"><a href="#cb387-56" aria-hidden="true"></a>                <span class="kw">if</span> (output != <span class="kw">null</span>)</span>
<span id="cb387-57"><a href="#cb387-57" aria-hidden="true"></a>                    output.<span class="fu">close</span>();</span>
<span id="cb387-58"><a href="#cb387-58" aria-hidden="true"></a>                <span class="kw">if</span> (input != <span class="kw">null</span>)</span>
<span id="cb387-59"><a href="#cb387-59" aria-hidden="true"></a>                    input.<span class="fu">close</span>();</span>
<span id="cb387-60"><a href="#cb387-60" aria-hidden="true"></a>            } <span class="kw">catch</span> (<span class="bu">IOException</span> ignored) {</span>
<span id="cb387-61"><a href="#cb387-61" aria-hidden="true"></a>            }</span>
<span id="cb387-62"><a href="#cb387-62" aria-hidden="true"></a></span>
<span id="cb387-63"><a href="#cb387-63" aria-hidden="true"></a>            <span class="kw">if</span> (connection != <span class="kw">null</span>)</span>
<span id="cb387-64"><a href="#cb387-64" aria-hidden="true"></a>                connection.<span class="fu">disconnect</span>();</span>
<span id="cb387-65"><a href="#cb387-65" aria-hidden="true"></a>        }</span>
<span id="cb387-66"><a href="#cb387-66" aria-hidden="true"></a>        <span class="kw">return</span> <span class="kw">null</span>;</span>
<span id="cb387-67"><a href="#cb387-67" aria-hidden="true"></a>    }</span></code></pre></div>
<p>The method above (<code>doInBackground</code>) runs always on a background thread. You shouldn’t do any UI tasks there. On the other hand, the <code>onProgressUpdate</code> and <code>onPreExecute</code> run on the UI thread, so there you can change the progress bar:</p>
<div class="sourceCode" id="cb388"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb388-1"><a href="#cb388-1" aria-hidden="true"></a>    <span class="at">@Override</span></span>
<span id="cb388-2"><a href="#cb388-2" aria-hidden="true"></a>    <span class="kw">protected</span> <span class="dt">void</span> <span class="fu">onPreExecute</span>() {</span>
<span id="cb388-3"><a href="#cb388-3" aria-hidden="true"></a>        <span class="kw">super</span>.<span class="fu">onPreExecute</span>();</span>
<span id="cb388-4"><a href="#cb388-4" aria-hidden="true"></a>        <span class="co">// take CPU lock to prevent CPU from going off if the user </span></span>
<span id="cb388-5"><a href="#cb388-5" aria-hidden="true"></a>        <span class="co">// presses the power button during download</span></span>
<span id="cb388-6"><a href="#cb388-6" aria-hidden="true"></a>        PowerManager pm = (PowerManager) context.<span class="fu">getSystemService</span>(<span class="bu">Context</span>.<span class="fu">POWER_SERVICE</span>);</span>
<span id="cb388-7"><a href="#cb388-7" aria-hidden="true"></a>        mWakeLock = pm.<span class="fu">newWakeLock</span>(PowerManager.<span class="fu">PARTIAL_WAKE_LOCK</span>,</span>
<span id="cb388-8"><a href="#cb388-8" aria-hidden="true"></a>             <span class="fu">getClass</span>().<span class="fu">getName</span>());</span>
<span id="cb388-9"><a href="#cb388-9" aria-hidden="true"></a>        mWakeLock.<span class="fu">acquire</span>();</span>
<span id="cb388-10"><a href="#cb388-10" aria-hidden="true"></a>        mProgressDialog.<span class="fu">show</span>();</span>
<span id="cb388-11"><a href="#cb388-11" aria-hidden="true"></a>    }</span>
<span id="cb388-12"><a href="#cb388-12" aria-hidden="true"></a></span>
<span id="cb388-13"><a href="#cb388-13" aria-hidden="true"></a>    <span class="at">@Override</span></span>
<span id="cb388-14"><a href="#cb388-14" aria-hidden="true"></a>    <span class="kw">protected</span> <span class="dt">void</span> <span class="fu">onProgressUpdate</span>(<span class="bu">Integer</span><span class="kw">... </span>progress) {</span>
<span id="cb388-15"><a href="#cb388-15" aria-hidden="true"></a>        <span class="kw">super</span>.<span class="fu">onProgressUpdate</span>(progress);</span>
<span id="cb388-16"><a href="#cb388-16" aria-hidden="true"></a>        <span class="co">// if we get here, length is known, now set indeterminate to false</span></span>
<span id="cb388-17"><a href="#cb388-17" aria-hidden="true"></a>        mProgressDialog.<span class="fu">setIndeterminate</span>(<span class="kw">false</span>);</span>
<span id="cb388-18"><a href="#cb388-18" aria-hidden="true"></a>        mProgressDialog.<span class="fu">setMax</span>(<span class="dv">100</span>);</span>
<span id="cb388-19"><a href="#cb388-19" aria-hidden="true"></a>        mProgressDialog.<span class="fu">setProgress</span>(progress[<span class="dv">0</span>]);</span>
<span id="cb388-20"><a href="#cb388-20" aria-hidden="true"></a>    }</span>
<span id="cb388-21"><a href="#cb388-21" aria-hidden="true"></a></span>
<span id="cb388-22"><a href="#cb388-22" aria-hidden="true"></a>    <span class="at">@Override</span></span>
<span id="cb388-23"><a href="#cb388-23" aria-hidden="true"></a>    <span class="kw">protected</span> <span class="dt">void</span> <span class="fu">onPostExecute</span>(<span class="bu">String</span> result) {</span>
<span id="cb388-24"><a href="#cb388-24" aria-hidden="true"></a>        mWakeLock.<span class="fu">release</span>();</span>
<span id="cb388-25"><a href="#cb388-25" aria-hidden="true"></a>        mProgressDialog.<span class="fu">dismiss</span>();</span>
<span id="cb388-26"><a href="#cb388-26" aria-hidden="true"></a>        <span class="kw">if</span> (result != <span class="kw">null</span>)</span>
<span id="cb388-27"><a href="#cb388-27" aria-hidden="true"></a>            Toast.<span class="fu">makeText</span>(context,<span class="st">&quot;Download error: &quot;</span>+result, Toast.<span class="fu">LENGTH_LONG</span>).<span class="fu">show</span>();</span>
<span id="cb388-28"><a href="#cb388-28" aria-hidden="true"></a>        <span class="kw">else</span></span>
<span id="cb388-29"><a href="#cb388-29" aria-hidden="true"></a>            Toast.<span class="fu">makeText</span>(context,<span class="st">&quot;File downloaded&quot;</span>, Toast.<span class="fu">LENGTH_SHORT</span>).<span class="fu">show</span>();</span>
<span id="cb388-30"><a href="#cb388-30" aria-hidden="true"></a>    }</span></code></pre></div>
<p>For this to run, you need the WAKE_LOCK permission.</p>
<div class="sourceCode" id="cb389"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb389-1"><a href="#cb389-1" aria-hidden="true"></a>&lt;uses-permission android:name=<span class="st">&quot;android.permission.WAKE_LOCK&quot;</span> /&gt;</span></code></pre></div>
<h5>
<ol start="2" type="1">
<li>Download from Service
</h1></li>
</ol>
<p>The big question here is: <em>how do I update my activity from a service?</em>. In the next example we are going to use two classes you may not be aware of: <code>ResultReceiver</code> and <code>IntentService</code>. <code>ResultReceiver</code> is the one that will allow us to update our thread from a service; <code>IntentService</code> is a subclass of <code>Service</code> which spawns a thread to do background work from there (you should know that a <code>Service</code> runs actually in the same thread of your app; when you extends <code>Service</code>, you must manually spawn new threads to run CPU blocking operations).</p>
<p>Download service can look like this:</p>
<div class="sourceCode" id="cb390"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb390-1"><a href="#cb390-1" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">class</span> DownloadService <span class="kw">extends</span> IntentService {</span>
<span id="cb390-2"><a href="#cb390-2" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">final</span> <span class="dt">int</span> UPDATE_PROGRESS = <span class="dv">8344</span>;</span>
<span id="cb390-3"><a href="#cb390-3" aria-hidden="true"></a></span>
<span id="cb390-4"><a href="#cb390-4" aria-hidden="true"></a>    <span class="kw">public</span> <span class="fu">DownloadService</span>() {</span>
<span id="cb390-5"><a href="#cb390-5" aria-hidden="true"></a>        <span class="kw">super</span>(<span class="st">&quot;DownloadService&quot;</span>);</span>
<span id="cb390-6"><a href="#cb390-6" aria-hidden="true"></a>    }</span>
<span id="cb390-7"><a href="#cb390-7" aria-hidden="true"></a>    <span class="at">@Override</span></span>
<span id="cb390-8"><a href="#cb390-8" aria-hidden="true"></a>    <span class="kw">protected</span> <span class="dt">void</span> <span class="fu">onHandleIntent</span>(Intent intent) {</span>
<span id="cb390-9"><a href="#cb390-9" aria-hidden="true"></a></span>
<span id="cb390-10"><a href="#cb390-10" aria-hidden="true"></a>        <span class="bu">String</span> urlToDownload = intent.<span class="fu">getStringExtra</span>(<span class="st">&quot;url&quot;</span>);</span>
<span id="cb390-11"><a href="#cb390-11" aria-hidden="true"></a>        ResultReceiver receiver = (ResultReceiver) intent.<span class="fu">getParcelableExtra</span>(<span class="st">&quot;receiver&quot;</span>);</span>
<span id="cb390-12"><a href="#cb390-12" aria-hidden="true"></a>        <span class="kw">try</span> {</span>
<span id="cb390-13"><a href="#cb390-13" aria-hidden="true"></a></span>
<span id="cb390-14"><a href="#cb390-14" aria-hidden="true"></a>            <span class="co">//create url and connect</span></span>
<span id="cb390-15"><a href="#cb390-15" aria-hidden="true"></a>            <span class="bu">URL</span> url = <span class="kw">new</span> <span class="bu">URL</span>(urlToDownload);</span>
<span id="cb390-16"><a href="#cb390-16" aria-hidden="true"></a>            <span class="bu">URLConnection</span> connection = url.<span class="fu">openConnection</span>();</span>
<span id="cb390-17"><a href="#cb390-17" aria-hidden="true"></a>            connection.<span class="fu">connect</span>();</span>
<span id="cb390-18"><a href="#cb390-18" aria-hidden="true"></a></span>
<span id="cb390-19"><a href="#cb390-19" aria-hidden="true"></a>            <span class="co">// this will be useful so that you can show a typical 0-100% progress bar</span></span>
<span id="cb390-20"><a href="#cb390-20" aria-hidden="true"></a>            <span class="dt">int</span> fileLength = connection.<span class="fu">getContentLength</span>();</span>
<span id="cb390-21"><a href="#cb390-21" aria-hidden="true"></a></span>
<span id="cb390-22"><a href="#cb390-22" aria-hidden="true"></a>            <span class="co">// download the file</span></span>
<span id="cb390-23"><a href="#cb390-23" aria-hidden="true"></a>            <span class="bu">InputStream</span> input = <span class="kw">new</span> <span class="bu">BufferedInputStream</span>(connection.<span class="fu">getInputStream</span>());</span>
<span id="cb390-24"><a href="#cb390-24" aria-hidden="true"></a></span>
<span id="cb390-25"><a href="#cb390-25" aria-hidden="true"></a>            <span class="bu">String</span> path = <span class="st">&quot;/sdcard/BarcodeScanner-debug.apk&quot;</span> ;</span>
<span id="cb390-26"><a href="#cb390-26" aria-hidden="true"></a>            <span class="bu">OutputStream</span> output = <span class="kw">new</span> <span class="bu">FileOutputStream</span>(path);</span>
<span id="cb390-27"><a href="#cb390-27" aria-hidden="true"></a></span>
<span id="cb390-28"><a href="#cb390-28" aria-hidden="true"></a>            <span class="dt">byte</span> data[] = <span class="kw">new</span> <span class="dt">byte</span>[<span class="dv">1024</span>];</span>
<span id="cb390-29"><a href="#cb390-29" aria-hidden="true"></a>            <span class="dt">long</span> total = <span class="dv">0</span>;</span>
<span id="cb390-30"><a href="#cb390-30" aria-hidden="true"></a>            <span class="dt">int</span> count;</span>
<span id="cb390-31"><a href="#cb390-31" aria-hidden="true"></a>            <span class="kw">while</span> ((count = input.<span class="fu">read</span>(data)) != -<span class="dv">1</span>) {</span>
<span id="cb390-32"><a href="#cb390-32" aria-hidden="true"></a>                total += count;</span>
<span id="cb390-33"><a href="#cb390-33" aria-hidden="true"></a></span>
<span id="cb390-34"><a href="#cb390-34" aria-hidden="true"></a>                <span class="co">// publishing the progress....</span></span>
<span id="cb390-35"><a href="#cb390-35" aria-hidden="true"></a>                Bundle resultData = <span class="kw">new</span> <span class="fu">Bundle</span>();</span>
<span id="cb390-36"><a href="#cb390-36" aria-hidden="true"></a>                resultData.<span class="fu">putInt</span>(<span class="st">&quot;progress&quot;</span> ,(<span class="dt">int</span>) (total * <span class="dv">100</span> / fileLength));</span>
<span id="cb390-37"><a href="#cb390-37" aria-hidden="true"></a>                receiver.<span class="fu">send</span>(UPDATE_PROGRESS, resultData);</span>
<span id="cb390-38"><a href="#cb390-38" aria-hidden="true"></a>                output.<span class="fu">write</span>(data, <span class="dv">0</span>, count);</span>
<span id="cb390-39"><a href="#cb390-39" aria-hidden="true"></a>            }</span>
<span id="cb390-40"><a href="#cb390-40" aria-hidden="true"></a></span>
<span id="cb390-41"><a href="#cb390-41" aria-hidden="true"></a>            <span class="co">// close streams </span></span>
<span id="cb390-42"><a href="#cb390-42" aria-hidden="true"></a>            output.<span class="fu">flush</span>();</span>
<span id="cb390-43"><a href="#cb390-43" aria-hidden="true"></a>            output.<span class="fu">close</span>();</span>
<span id="cb390-44"><a href="#cb390-44" aria-hidden="true"></a>            input.<span class="fu">close</span>();</span>
<span id="cb390-45"><a href="#cb390-45" aria-hidden="true"></a></span>
<span id="cb390-46"><a href="#cb390-46" aria-hidden="true"></a>        } <span class="kw">catch</span> (<span class="bu">IOException</span> e) {</span>
<span id="cb390-47"><a href="#cb390-47" aria-hidden="true"></a>            e.<span class="fu">printStackTrace</span>();</span>
<span id="cb390-48"><a href="#cb390-48" aria-hidden="true"></a>        }</span>
<span id="cb390-49"><a href="#cb390-49" aria-hidden="true"></a></span>
<span id="cb390-50"><a href="#cb390-50" aria-hidden="true"></a>        Bundle resultData = <span class="kw">new</span> <span class="fu">Bundle</span>();</span>
<span id="cb390-51"><a href="#cb390-51" aria-hidden="true"></a>        resultData.<span class="fu">putInt</span>(<span class="st">&quot;progress&quot;</span> ,<span class="dv">100</span>);</span>
<span id="cb390-52"><a href="#cb390-52" aria-hidden="true"></a></span>
<span id="cb390-53"><a href="#cb390-53" aria-hidden="true"></a>        receiver.<span class="fu">send</span>(UPDATE_PROGRESS, resultData);</span>
<span id="cb390-54"><a href="#cb390-54" aria-hidden="true"></a>    }</span>
<span id="cb390-55"><a href="#cb390-55" aria-hidden="true"></a>}</span></code></pre></div>
<p>Add the service to your manifest:</p>
<div class="sourceCode" id="cb391"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb391-1"><a href="#cb391-1" aria-hidden="true"></a>&lt;service android:name=<span class="st">&quot;.DownloadService&quot;</span>/&gt;</span></code></pre></div>
<p>And the activity will look like this:</p>
<div class="sourceCode" id="cb392"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb392-1"><a href="#cb392-1" aria-hidden="true"></a><span class="co">// initialize the progress dialog like in the first example</span></span>
<span id="cb392-2"><a href="#cb392-2" aria-hidden="true"></a></span>
<span id="cb392-3"><a href="#cb392-3" aria-hidden="true"></a><span class="co">// this is how you fire the downloader</span></span>
<span id="cb392-4"><a href="#cb392-4" aria-hidden="true"></a>mProgressDialog.<span class="fu">show</span>();</span>
<span id="cb392-5"><a href="#cb392-5" aria-hidden="true"></a>Intent intent = <span class="kw">new</span> <span class="fu">Intent</span>(<span class="kw">this</span>, DownloadService.<span class="fu">class</span>);</span>
<span id="cb392-6"><a href="#cb392-6" aria-hidden="true"></a>intent.<span class="fu">putExtra</span>(<span class="st">&quot;url&quot;</span>, <span class="st">&quot;url of the file to download&quot;</span>);</span>
<span id="cb392-7"><a href="#cb392-7" aria-hidden="true"></a>intent.<span class="fu">putExtra</span>(<span class="st">&quot;receiver&quot;</span>, <span class="kw">new</span> <span class="fu">DownloadReceiver</span>(<span class="kw">new</span> <span class="bu">Handler</span>()));</span>
<span id="cb392-8"><a href="#cb392-8" aria-hidden="true"></a><span class="fu">startService</span>(intent);</span></code></pre></div>
<p>Here is were <code>ResultReceiver</code> comes to play:</p>
<div class="sourceCode" id="cb393"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb393-1"><a href="#cb393-1" aria-hidden="true"></a><span class="kw">private</span> <span class="kw">class</span> DownloadReceiver <span class="kw">extends</span> ResultReceiver{</span>
<span id="cb393-2"><a href="#cb393-2" aria-hidden="true"></a></span>
<span id="cb393-3"><a href="#cb393-3" aria-hidden="true"></a>    <span class="kw">public</span> <span class="fu">DownloadReceiver</span>(<span class="bu">Handler</span> handler) {</span>
<span id="cb393-4"><a href="#cb393-4" aria-hidden="true"></a>        <span class="kw">super</span>(handler);</span>
<span id="cb393-5"><a href="#cb393-5" aria-hidden="true"></a>    }</span>
<span id="cb393-6"><a href="#cb393-6" aria-hidden="true"></a></span>
<span id="cb393-7"><a href="#cb393-7" aria-hidden="true"></a>    <span class="at">@Override</span></span>
<span id="cb393-8"><a href="#cb393-8" aria-hidden="true"></a>    <span class="kw">protected</span> <span class="dt">void</span> <span class="fu">onReceiveResult</span>(<span class="dt">int</span> resultCode, Bundle resultData) {</span>
<span id="cb393-9"><a href="#cb393-9" aria-hidden="true"></a></span>
<span id="cb393-10"><a href="#cb393-10" aria-hidden="true"></a>        <span class="kw">super</span>.<span class="fu">onReceiveResult</span>(resultCode, resultData);</span>
<span id="cb393-11"><a href="#cb393-11" aria-hidden="true"></a></span>
<span id="cb393-12"><a href="#cb393-12" aria-hidden="true"></a>        <span class="kw">if</span> (resultCode == DownloadService.<span class="fu">UPDATE_PROGRESS</span>) {</span>
<span id="cb393-13"><a href="#cb393-13" aria-hidden="true"></a></span>
<span id="cb393-14"><a href="#cb393-14" aria-hidden="true"></a>            <span class="dt">int</span> progress = resultData.<span class="fu">getInt</span>(<span class="st">&quot;progress&quot;</span>); <span class="co">//get the progress</span></span>
<span id="cb393-15"><a href="#cb393-15" aria-hidden="true"></a>            dialog.<span class="fu">setProgress</span>(progress);</span>
<span id="cb393-16"><a href="#cb393-16" aria-hidden="true"></a></span>
<span id="cb393-17"><a href="#cb393-17" aria-hidden="true"></a>            <span class="kw">if</span> (progress == <span class="dv">100</span>) {</span>
<span id="cb393-18"><a href="#cb393-18" aria-hidden="true"></a>                dialog.<span class="fu">dismiss</span>();</span>
<span id="cb393-19"><a href="#cb393-19" aria-hidden="true"></a>            }</span>
<span id="cb393-20"><a href="#cb393-20" aria-hidden="true"></a>        }</span>
<span id="cb393-21"><a href="#cb393-21" aria-hidden="true"></a>    }</span>
<span id="cb393-22"><a href="#cb393-22" aria-hidden="true"></a>}</span></code></pre></div>
<h5>
2.1 Use Groundy library
</h2>
<p><a href="http://github.com/casidiablo/groundy" rel="noreferrer"><strong>Groundy</strong></a> is a library that basically helps you run pieces of code in a background service, and it is based on the <code>ResultReceiver</code> concept shown above. This library is <strong>deprecated</strong> at the moment. This is how the <strong>whole</strong> code would look like:</p>
<p>The activity where you are showing the dialog…</p>
<div class="sourceCode" id="cb394"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb394-1"><a href="#cb394-1" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">class</span> MainActivity <span class="kw">extends</span> Activity {</span>
<span id="cb394-2"><a href="#cb394-2" aria-hidden="true"></a></span>
<span id="cb394-3"><a href="#cb394-3" aria-hidden="true"></a>    <span class="kw">private</span> ProgressDialog mProgressDialog;</span>
<span id="cb394-4"><a href="#cb394-4" aria-hidden="true"></a></span>
<span id="cb394-5"><a href="#cb394-5" aria-hidden="true"></a>    <span class="at">@Override</span></span>
<span id="cb394-6"><a href="#cb394-6" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">void</span> <span class="fu">onCreate</span>(Bundle savedInstanceState) {</span>
<span id="cb394-7"><a href="#cb394-7" aria-hidden="true"></a>        <span class="kw">super</span>.<span class="fu">onCreate</span>(savedInstanceState);</span>
<span id="cb394-8"><a href="#cb394-8" aria-hidden="true"></a>        <span class="fu">setContentView</span>(R.<span class="fu">layout</span>.<span class="fu">main</span>);</span>
<span id="cb394-9"><a href="#cb394-9" aria-hidden="true"></a></span>
<span id="cb394-10"><a href="#cb394-10" aria-hidden="true"></a>        <span class="fu">findViewById</span>(R.<span class="fu">id</span>.<span class="fu">btn_download</span>).<span class="fu">setOnClickListener</span>(<span class="kw">new</span> <span class="bu">View</span>.<span class="fu">OnClickListener</span>() {</span>
<span id="cb394-11"><a href="#cb394-11" aria-hidden="true"></a>            <span class="kw">public</span> <span class="dt">void</span> <span class="fu">onClick</span>(<span class="bu">View</span> view) {</span>
<span id="cb394-12"><a href="#cb394-12" aria-hidden="true"></a>                <span class="bu">String</span> url = ((EditText) <span class="fu">findViewById</span>(R.<span class="fu">id</span>.<span class="fu">edit_url</span>)).<span class="fu">getText</span>().<span class="fu">toString</span>().<span class="fu">trim</span>();</span>
<span id="cb394-13"><a href="#cb394-13" aria-hidden="true"></a>                Bundle extras = <span class="kw">new</span> <span class="fu">Bundler</span>().<span class="fu">add</span>(DownloadTask.<span class="fu">PARAM_URL</span>, url).<span class="fu">build</span>();</span>
<span id="cb394-14"><a href="#cb394-14" aria-hidden="true"></a>                Groundy.<span class="fu">create</span>(DownloadExample.<span class="fu">this</span>, DownloadTask.<span class="fu">class</span>)</span>
<span id="cb394-15"><a href="#cb394-15" aria-hidden="true"></a>                        .<span class="fu">receiver</span>(mReceiver)</span>
<span id="cb394-16"><a href="#cb394-16" aria-hidden="true"></a>                        .<span class="fu">params</span>(extras)</span>
<span id="cb394-17"><a href="#cb394-17" aria-hidden="true"></a>                        .<span class="fu">queue</span>();</span>
<span id="cb394-18"><a href="#cb394-18" aria-hidden="true"></a></span>
<span id="cb394-19"><a href="#cb394-19" aria-hidden="true"></a>                mProgressDialog = <span class="kw">new</span> <span class="fu">ProgressDialog</span>(MainActivity.<span class="fu">this</span>);</span>
<span id="cb394-20"><a href="#cb394-20" aria-hidden="true"></a>                mProgressDialog.<span class="fu">setProgressStyle</span>(ProgressDialog.<span class="fu">STYLE_HORIZONTAL</span>);</span>
<span id="cb394-21"><a href="#cb394-21" aria-hidden="true"></a>                mProgressDialog.<span class="fu">setCancelable</span>(<span class="kw">false</span>);</span>
<span id="cb394-22"><a href="#cb394-22" aria-hidden="true"></a>                mProgressDialog.<span class="fu">show</span>();</span>
<span id="cb394-23"><a href="#cb394-23" aria-hidden="true"></a>            }</span>
<span id="cb394-24"><a href="#cb394-24" aria-hidden="true"></a>        });</span>
<span id="cb394-25"><a href="#cb394-25" aria-hidden="true"></a>    }</span>
<span id="cb394-26"><a href="#cb394-26" aria-hidden="true"></a></span>
<span id="cb394-27"><a href="#cb394-27" aria-hidden="true"></a>    <span class="kw">private</span> ResultReceiver mReceiver = <span class="kw">new</span> <span class="fu">ResultReceiver</span>(<span class="kw">new</span> <span class="bu">Handler</span>()) {</span>
<span id="cb394-28"><a href="#cb394-28" aria-hidden="true"></a>        <span class="at">@Override</span></span>
<span id="cb394-29"><a href="#cb394-29" aria-hidden="true"></a>        <span class="kw">protected</span> <span class="dt">void</span> <span class="fu">onReceiveResult</span>(<span class="dt">int</span> resultCode, Bundle resultData) {</span>
<span id="cb394-30"><a href="#cb394-30" aria-hidden="true"></a>            <span class="kw">super</span>.<span class="fu">onReceiveResult</span>(resultCode, resultData);</span>
<span id="cb394-31"><a href="#cb394-31" aria-hidden="true"></a>            <span class="kw">switch</span> (resultCode) {</span>
<span id="cb394-32"><a href="#cb394-32" aria-hidden="true"></a>                <span class="kw">case</span> Groundy.<span class="fu">STATUS_PROGRESS</span>:</span>
<span id="cb394-33"><a href="#cb394-33" aria-hidden="true"></a>                    mProgressDialog.<span class="fu">setProgress</span>(resultData.<span class="fu">getInt</span>(Groundy.<span class="fu">KEY_PROGRESS</span>));</span>
<span id="cb394-34"><a href="#cb394-34" aria-hidden="true"></a>                    <span class="kw">break</span>;</span>
<span id="cb394-35"><a href="#cb394-35" aria-hidden="true"></a>                <span class="kw">case</span> Groundy.<span class="fu">STATUS_FINISHED</span>:</span>
<span id="cb394-36"><a href="#cb394-36" aria-hidden="true"></a>                    Toast.<span class="fu">makeText</span>(DownloadExample.<span class="fu">this</span>, R.<span class="fu">string</span>.<span class="fu">file_downloaded</span>, Toast.<span class="fu">LENGTH_LONG</span>);</span>
<span id="cb394-37"><a href="#cb394-37" aria-hidden="true"></a>                    mProgressDialog.<span class="fu">dismiss</span>();</span>
<span id="cb394-38"><a href="#cb394-38" aria-hidden="true"></a>                    <span class="kw">break</span>;</span>
<span id="cb394-39"><a href="#cb394-39" aria-hidden="true"></a>                <span class="kw">case</span> Groundy.<span class="fu">STATUS_ERROR</span>:</span>
<span id="cb394-40"><a href="#cb394-40" aria-hidden="true"></a>                    Toast.<span class="fu">makeText</span>(DownloadExample.<span class="fu">this</span>, resultData.<span class="fu">getString</span>(Groundy.<span class="fu">KEY_ERROR</span>), Toast.<span class="fu">LENGTH_LONG</span>).<span class="fu">show</span>();</span>
<span id="cb394-41"><a href="#cb394-41" aria-hidden="true"></a>                    mProgressDialog.<span class="fu">dismiss</span>();</span>
<span id="cb394-42"><a href="#cb394-42" aria-hidden="true"></a>                    <span class="kw">break</span>;</span>
<span id="cb394-43"><a href="#cb394-43" aria-hidden="true"></a>            }</span>
<span id="cb394-44"><a href="#cb394-44" aria-hidden="true"></a>        }</span>
<span id="cb394-45"><a href="#cb394-45" aria-hidden="true"></a>    };</span>
<span id="cb394-46"><a href="#cb394-46" aria-hidden="true"></a>}</span></code></pre></div>
<p>A <code>GroundyTask</code> implementation used by <strong>Groundy</strong> to download the file and show the progress:</p>
<div class="sourceCode" id="cb395"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb395-1"><a href="#cb395-1" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">class</span> DownloadTask <span class="kw">extends</span> GroundyTask {    </span>
<span id="cb395-2"><a href="#cb395-2" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">final</span> <span class="bu">String</span> PARAM_URL = <span class="st">&quot;com.groundy.sample.param.url&quot;</span>;</span>
<span id="cb395-3"><a href="#cb395-3" aria-hidden="true"></a></span>
<span id="cb395-4"><a href="#cb395-4" aria-hidden="true"></a>    <span class="at">@Override</span></span>
<span id="cb395-5"><a href="#cb395-5" aria-hidden="true"></a>    <span class="kw">protected</span> <span class="dt">boolean</span> <span class="fu">doInBackground</span>() {</span>
<span id="cb395-6"><a href="#cb395-6" aria-hidden="true"></a>        <span class="kw">try</span> {</span>
<span id="cb395-7"><a href="#cb395-7" aria-hidden="true"></a>            <span class="bu">String</span> url = <span class="fu">getParameters</span>().<span class="fu">getString</span>(PARAM_URL);</span>
<span id="cb395-8"><a href="#cb395-8" aria-hidden="true"></a>            <span class="bu">File</span> dest = <span class="kw">new</span> <span class="bu">File</span>(<span class="fu">getContext</span>().<span class="fu">getFilesDir</span>(), <span class="kw">new</span> <span class="bu">File</span>(url).<span class="fu">getName</span>());</span>
<span id="cb395-9"><a href="#cb395-9" aria-hidden="true"></a>            DownloadUtils.<span class="fu">downloadFile</span>(<span class="fu">getContext</span>(), url, dest, DownloadUtils.<span class="fu">getDownloadListenerForTask</span>(<span class="kw">this</span>));</span>
<span id="cb395-10"><a href="#cb395-10" aria-hidden="true"></a>            <span class="kw">return</span> <span class="kw">true</span>;</span>
<span id="cb395-11"><a href="#cb395-11" aria-hidden="true"></a>        } <span class="kw">catch</span> (<span class="bu">Exception</span> pokemon) {</span>
<span id="cb395-12"><a href="#cb395-12" aria-hidden="true"></a>            <span class="kw">return</span> <span class="kw">false</span>;</span>
<span id="cb395-13"><a href="#cb395-13" aria-hidden="true"></a>        }</span>
<span id="cb395-14"><a href="#cb395-14" aria-hidden="true"></a>    }</span>
<span id="cb395-15"><a href="#cb395-15" aria-hidden="true"></a>}</span></code></pre></div>
<p>And just add this to the manifest:</p>
<div class="sourceCode" id="cb396"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb396-1"><a href="#cb396-1" aria-hidden="true"></a>&lt;service android:name=<span class="st">&quot;com.codeslap.groundy.GroundyService&quot;</span>/&gt;</span></code></pre></div>
<p>It couldn’t be easier I think. Just grab the latest jar <a href="https://github.com/casidiablo/groundy/downloads" rel="noreferrer">from Github</a> and you are ready to go. Keep in mind that <strong>Groundy</strong>’s main purpose is to make calls to external REST apis in a background service and post results to the UI with easily. If you are doing something like that in your app, it could be really useful.</p>
<h5>
2.2 Use <a href="https://github.com/koush/ion" rel="noreferrer">https://github.com/koush/ion</a>
</h2>
<h5>
<ol start="3" type="1">
<li>Use <code>DownloadManager</code> class (<code>GingerBread</code> and newer only)
</h1></li>
</ol>
<p>GingerBread brought a new feature, <code>DownloadManager</code>, which allows you to download files easily and delegate the hard work of handling threads, streams, etc. to the system.</p>
<p>First, let’s see a utility method:</p>
<div class="sourceCode" id="cb397"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb397-1"><a href="#cb397-1" aria-hidden="true"></a><span class="co">/**</span></span>
<span id="cb397-2"><a href="#cb397-2" aria-hidden="true"></a> <span class="co">* </span><span class="an">@param context </span>used to check the device version and DownloadManager information</span>
<span id="cb397-3"><a href="#cb397-3" aria-hidden="true"></a> <span class="co">*</span> <span class="an">@return </span>true if the download manager is available</span>
<span id="cb397-4"><a href="#cb397-4" aria-hidden="true"></a> <span class="co">*/</span></span>
<span id="cb397-5"><a href="#cb397-5" aria-hidden="true"></a><span class="kw">public</span> <span class="dt">static</span> <span class="dt">boolean</span> <span class="fu">isDownloadManagerAvailable</span>(<span class="bu">Context</span> context) {</span>
<span id="cb397-6"><a href="#cb397-6" aria-hidden="true"></a></span>
<span id="cb397-7"><a href="#cb397-7" aria-hidden="true"></a>    <span class="kw">if</span> (Build.<span class="fu">VERSION</span>.<span class="fu">SDK_INT</span> &gt;= Build.<span class="fu">VERSION_CODES</span>.<span class="fu">GINGERBREAD</span>) {</span>
<span id="cb397-8"><a href="#cb397-8" aria-hidden="true"></a>        <span class="kw">return</span> <span class="kw">true</span>;</span>
<span id="cb397-9"><a href="#cb397-9" aria-hidden="true"></a>    }</span>
<span id="cb397-10"><a href="#cb397-10" aria-hidden="true"></a>    <span class="kw">return</span> <span class="kw">false</span>;</span>
<span id="cb397-11"><a href="#cb397-11" aria-hidden="true"></a>}</span></code></pre></div>
<p>Method’s name explains it all. Once you are sure <code>DownloadManager</code> is available, you can do something like this:</p>
<div class="sourceCode" id="cb398"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb398-1"><a href="#cb398-1" aria-hidden="true"></a><span class="bu">String</span> url = <span class="st">&quot;url you want to download&quot;</span>;</span>
<span id="cb398-2"><a href="#cb398-2" aria-hidden="true"></a>DownloadManager.<span class="fu">Request</span> request = <span class="kw">new</span> DownloadManager.<span class="fu">Request</span>(Uri.<span class="fu">parse</span>(url));</span>
<span id="cb398-3"><a href="#cb398-3" aria-hidden="true"></a>request.<span class="fu">setDescription</span>(<span class="st">&quot;Some descrition&quot;</span>);</span>
<span id="cb398-4"><a href="#cb398-4" aria-hidden="true"></a>request.<span class="fu">setTitle</span>(<span class="st">&quot;Some title&quot;</span>);</span>
<span id="cb398-5"><a href="#cb398-5" aria-hidden="true"></a><span class="co">// in order for this if to run, you must use the android 3.2 to compile your app</span></span>
<span id="cb398-6"><a href="#cb398-6" aria-hidden="true"></a><span class="kw">if</span> (Build.<span class="fu">VERSION</span>.<span class="fu">SDK_INT</span> &gt;= Build.<span class="fu">VERSION_CODES</span>.<span class="fu">HONEYCOMB</span>) {</span>
<span id="cb398-7"><a href="#cb398-7" aria-hidden="true"></a>    request.<span class="fu">allowScanningByMediaScanner</span>();</span>
<span id="cb398-8"><a href="#cb398-8" aria-hidden="true"></a>    request.<span class="fu">setNotificationVisibility</span>(DownloadManager.<span class="fu">Request</span>.<span class="fu">VISIBILITY_VISIBLE_NOTIFY_COMPLETED</span>);</span>
<span id="cb398-9"><a href="#cb398-9" aria-hidden="true"></a>}</span>
<span id="cb398-10"><a href="#cb398-10" aria-hidden="true"></a>request.<span class="fu">setDestinationInExternalPublicDir</span>(<span class="bu">Environment</span>.<span class="fu">DIRECTORY_DOWNLOADS</span>, <span class="st">&quot;name-of-the-file.ext&quot;</span>);</span>
<span id="cb398-11"><a href="#cb398-11" aria-hidden="true"></a></span>
<span id="cb398-12"><a href="#cb398-12" aria-hidden="true"></a><span class="co">// get download service and enqueue file</span></span>
<span id="cb398-13"><a href="#cb398-13" aria-hidden="true"></a>DownloadManager manager = (DownloadManager) <span class="fu">getSystemService</span>(<span class="bu">Context</span>.<span class="fu">DOWNLOAD_SERVICE</span>);</span>
<span id="cb398-14"><a href="#cb398-14" aria-hidden="true"></a>manager.<span class="fu">enqueue</span>(request);</span></code></pre></div>
<p>Download progress will be showing in the notification bar.</p>
<h5>
Final thoughts
</h1>
<p>First and second methods are just the tip of the iceberg. There are lots of things you have to keep in mind if you want your app to be robust. Here is a brief list:</p>
<ul>
<li>
You must check whether user has an internet connection available
</li>
<li>
Make sure you have the right permissions (<code>INTERNET</code> and <code>WRITE_EXTERNAL_STORAGE</code>); also <code>ACCESS_NETWORK_STATE</code> if you want to check internet availability.
</li>
<li>
Make sure the directory were you are going to download files exist and has write permissions.
</li>
<li>
If download is too big you may want to implement a way to resume the download if previous attempts failed.
</li>
<li>
Users will be grateful if you allow them to interrupt the download.
</li>
</ul>
<p>Unless you need detailed control of the download process, then consider using <code>DownloadManager</code> (3) because it already handles most of the items listed above.</p>
<p>But also consider that your needs may change. For example, <code>DownloadManager</code> <a href="https://stackoverflow.com/questions/35191718">does no response caching</a>. It will blindly download the same big file multiple times. There’s no easy way to fix it after the fact. Where if you start with a basic <code>HttpURLConnection</code> (1, 2), then all you need is to add an <code>HttpResponseCache</code>. So the initial effort of learning the basic, standard tools can be a good investment.</p>
<blockquote>
<p>
This class was deprecated in API level 26. ProgressDialog is a modal dialog, which prevents the user from interacting with the app. Instead of using this class, you should use a progress indicator like ProgressBar, which can be embedded in your app’s UI. Alternatively, you can use a notification to inform the user of the task’s progress. For more details <a href="https://developer.android.com/reference/android/app/ProgressDialog" rel="noreferrer">Link</a>
</p>
</blockquote>
</section>
<section id="answer-2-score-105" class="level4">
<h4>Answer 2 (score 105)</h4>
<p>Don’t forget to add permissions to your manifest file if you’re gonna be downloading stuff from the internet!</p>
<div class="sourceCode" id="cb399"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb399-1"><a href="#cb399-1" aria-hidden="true"></a>&lt;manifest xmlns:android=<span class="st">&quot;http://schemas.android.com/apk/res/android&quot;</span></span>
<span id="cb399-2"><a href="#cb399-2" aria-hidden="true"></a>    <span class="kw">package</span>=&quot;com.example.helloandroid&quot;</span>
<span id="cb399-3"><a href="#cb399-3" aria-hidden="true"></a>    android:versionCode=<span class="st">&quot;1&quot;</span></span>
<span id="cb399-4"><a href="#cb399-4" aria-hidden="true"></a>    android:versionName=<span class="st">&quot;1.0&quot;</span>&gt;</span>
<span id="cb399-5"><a href="#cb399-5" aria-hidden="true"></a></span>
<span id="cb399-6"><a href="#cb399-6" aria-hidden="true"></a>        &lt;uses-sdk android:minSdkVersion=<span class="st">&quot;10&quot;</span> /&gt;</span>
<span id="cb399-7"><a href="#cb399-7" aria-hidden="true"></a></span>
<span id="cb399-8"><a href="#cb399-8" aria-hidden="true"></a>        &lt;uses-permission android:name=<span class="st">&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot;</span>&gt;&lt;/uses-permission&gt;</span>
<span id="cb399-9"><a href="#cb399-9" aria-hidden="true"></a>        &lt;uses-permission android:name=<span class="st">&quot;android.permission.INTERNET&quot;</span>&gt;&lt;/uses-permission&gt;</span>
<span id="cb399-10"><a href="#cb399-10" aria-hidden="true"></a>        &lt;uses-permission android:name=<span class="st">&quot;android.permission.ACCESS_NETWORK_STATE&quot;</span>&gt;&lt;/uses-permission&gt;</span>
<span id="cb399-11"><a href="#cb399-11" aria-hidden="true"></a>        &lt;uses-permission android:name=<span class="st">&quot;android.permission.READ_PHONE_STATE&quot;</span>&gt;&lt;/uses-permission&gt;</span>
<span id="cb399-12"><a href="#cb399-12" aria-hidden="true"></a></span>
<span id="cb399-13"><a href="#cb399-13" aria-hidden="true"></a>        &lt;application </span>
<span id="cb399-14"><a href="#cb399-14" aria-hidden="true"></a>            android:icon=<span class="st">&quot;@drawable/icon&quot;</span> </span>
<span id="cb399-15"><a href="#cb399-15" aria-hidden="true"></a>            android:label=<span class="st">&quot;@string/app_name&quot;</span> </span>
<span id="cb399-16"><a href="#cb399-16" aria-hidden="true"></a>            android:debuggable=<span class="st">&quot;true&quot;</span>&gt;</span>
<span id="cb399-17"><a href="#cb399-17" aria-hidden="true"></a></span>
<span id="cb399-18"><a href="#cb399-18" aria-hidden="true"></a>        &lt;/application&gt;</span>
<span id="cb399-19"><a href="#cb399-19" aria-hidden="true"></a></span>
<span id="cb399-20"><a href="#cb399-20" aria-hidden="true"></a>&lt;/manifest&gt;</span></code></pre></div>
</section>
<section id="answer-3-score-31" class="level4">
<h4>Answer 3 (score 31)</h4>
<p>Yes the code above will work .But if you are updating your <code>progressbar</code> in <code>onProgressUpdate</code> of <code>Asynctask</code> and you press back button or finish your activity <code>AsyncTask</code> looses its track with your UI .And when you go back to your activity, even if download is running in background you will see no update on progressbar. So on <code>OnResume()</code> try to run a thread like <code>runOnUIThread</code> with a timer task that updates ur <code>progressbar</code> with values updating from the <code>AsyncTask</code> running background.</p>
<div class="sourceCode" id="cb400"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb400-1"><a href="#cb400-1" aria-hidden="true"></a><span class="kw">private</span> <span class="dt">void</span> <span class="fu">updateProgressBar</span>(){</span>
<span id="cb400-2"><a href="#cb400-2" aria-hidden="true"></a>    <span class="bu">Runnable</span> runnable = <span class="kw">new</span> <span class="fu">updateProgress</span>();</span>
<span id="cb400-3"><a href="#cb400-3" aria-hidden="true"></a>    background = <span class="kw">new</span> <span class="bu">Thread</span>(runnable);</span>
<span id="cb400-4"><a href="#cb400-4" aria-hidden="true"></a>    background.<span class="fu">start</span>();</span>
<span id="cb400-5"><a href="#cb400-5" aria-hidden="true"></a>}</span>
<span id="cb400-6"><a href="#cb400-6" aria-hidden="true"></a></span>
<span id="cb400-7"><a href="#cb400-7" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">class</span> updateProgress <span class="kw">implements</span> <span class="bu">Runnable</span> {</span>
<span id="cb400-8"><a href="#cb400-8" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">void</span> <span class="fu">run</span>() {</span>
<span id="cb400-9"><a href="#cb400-9" aria-hidden="true"></a>        <span class="kw">while</span>(<span class="bu">Thread</span>.<span class="fu">currentThread</span>()==background)</span>
<span id="cb400-10"><a href="#cb400-10" aria-hidden="true"></a>            <span class="co">//while (!Thread.currentThread().isInterrupted()) {</span></span>
<span id="cb400-11"><a href="#cb400-11" aria-hidden="true"></a>            <span class="kw">try</span> {</span>
<span id="cb400-12"><a href="#cb400-12" aria-hidden="true"></a>                <span class="bu">Thread</span>.<span class="fu">sleep</span>(<span class="dv">1000</span>); </span>
<span id="cb400-13"><a href="#cb400-13" aria-hidden="true"></a>                Message msg = <span class="kw">new</span> <span class="fu">Message</span>();</span>
<span id="cb400-14"><a href="#cb400-14" aria-hidden="true"></a>                progress = <span class="fu">getProgressPercentage</span>();        </span>
<span id="cb400-15"><a href="#cb400-15" aria-hidden="true"></a>                handler.<span class="fu">sendMessage</span>(msg);</span>
<span id="cb400-16"><a href="#cb400-16" aria-hidden="true"></a>            } <span class="kw">catch</span> (<span class="bu">InterruptedException</span> e) {</span>
<span id="cb400-17"><a href="#cb400-17" aria-hidden="true"></a>                <span class="bu">Thread</span>.<span class="fu">currentThread</span>().<span class="fu">interrupt</span>();</span>
<span id="cb400-18"><a href="#cb400-18" aria-hidden="true"></a>            } <span class="kw">catch</span> (<span class="bu">Exception</span> e) {</span>
<span id="cb400-19"><a href="#cb400-19" aria-hidden="true"></a>        }</span>
<span id="cb400-20"><a href="#cb400-20" aria-hidden="true"></a>    }</span>
<span id="cb400-21"><a href="#cb400-21" aria-hidden="true"></a>}</span>
<span id="cb400-22"><a href="#cb400-22" aria-hidden="true"></a></span>
<span id="cb400-23"><a href="#cb400-23" aria-hidden="true"></a><span class="kw">private</span> <span class="bu">Handler</span> handler = <span class="kw">new</span> <span class="bu">Handler</span>(){</span>
<span id="cb400-24"><a href="#cb400-24" aria-hidden="true"></a>    <span class="at">@Override</span></span>
<span id="cb400-25"><a href="#cb400-25" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">void</span> <span class="fu">handleMessage</span>(Message msg) {</span>
<span id="cb400-26"><a href="#cb400-26" aria-hidden="true"></a>        progress.<span class="fu">setProgress</span>(msg.<span class="fu">what</span>);</span>
<span id="cb400-27"><a href="#cb400-27" aria-hidden="true"></a>    }</span>
<span id="cb400-28"><a href="#cb400-28" aria-hidden="true"></a>};</span></code></pre></div>
<p>Don’t forget to <strong>Destroy</strong> the thread when ur activity is not visible.</p>
<div class="sourceCode" id="cb401"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb401-1"><a href="#cb401-1" aria-hidden="true"></a><span class="kw">private</span> <span class="dt">void</span> <span class="fu">destroyRunningThreads</span>() {</span>
<span id="cb401-2"><a href="#cb401-2" aria-hidden="true"></a>    <span class="kw">if</span> (background != <span class="kw">null</span>) {</span>
<span id="cb401-3"><a href="#cb401-3" aria-hidden="true"></a>        background.<span class="fu">interrupt</span>();</span>
<span id="cb401-4"><a href="#cb401-4" aria-hidden="true"></a>        background=<span class="kw">null</span>;</span>
<span id="cb401-5"><a href="#cb401-5" aria-hidden="true"></a>    }</span>
<span id="cb401-6"><a href="#cb401-6" aria-hidden="true"></a>}</span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="does-a-finally-block-always-get-executed-in-java-score-471713-in-2019" class="level3">
<h3>57: Does a finally block always get executed in Java? (score <a href="https://stackoverflow.com/q/65035.html">471713</a> in 2019)</h3>
<section id="question-55" class="level4">
<h4>Question</h4>
<p>Considering this code, can I be <em>absolutely sure</em> that the <code>finally</code> block always executes, no matter what <code>something()</code> is?</p>
<div class="sourceCode" id="cb402"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb402-1"><a href="#cb402-1" aria-hidden="true"></a><span class="kw">try</span> {  </span>
<span id="cb402-2"><a href="#cb402-2" aria-hidden="true"></a>    <span class="fu">something</span>();  </span>
<span id="cb402-3"><a href="#cb402-3" aria-hidden="true"></a>    <span class="kw">return</span> success;  </span>
<span id="cb402-4"><a href="#cb402-4" aria-hidden="true"></a>}  </span>
<span id="cb402-5"><a href="#cb402-5" aria-hidden="true"></a><span class="kw">catch</span> (<span class="bu">Exception</span> e) {   </span>
<span id="cb402-6"><a href="#cb402-6" aria-hidden="true"></a>    <span class="kw">return</span> failure;  </span>
<span id="cb402-7"><a href="#cb402-7" aria-hidden="true"></a>}  </span>
<span id="cb402-8"><a href="#cb402-8" aria-hidden="true"></a><span class="kw">finally</span> {  </span>
<span id="cb402-9"><a href="#cb402-9" aria-hidden="true"></a>    <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;I don&#39;t know if this will get printed out&quot;</span>);</span>
<span id="cb402-10"><a href="#cb402-10" aria-hidden="true"></a>}</span></code></pre></div>
</section>
<section id="answer-accepted-score-2534" class="level4">
<h4>Answer accepted (score 2534)</h4>
<p>Yes, <code>finally</code> will be called after the execution of the <code>try</code> or <code>catch</code> code blocks.</p>
<p>The only times <code>finally</code> won’t be called are:</p>
<ol>
<li>
If you invoke <code>System.exit()</code>
</li>
<li>
If the JVM crashes first
</li>
<li>
If the JVM reaches an infinite loop (or some other non-interruptable, non-terminating statement) in the <code>try</code> or <code>catch</code> block
</li>
<li>
If the OS forcibly terminates the JVM process; e.g., <code>kill -9 &amp;lt;pid&amp;gt;</code> on UNIX
</li>
<li>
If the host system dies; e.g., power failure, hardware error, OS panic, et cetera
</li>
<li>
If the <code>finally</code> block is going to be executed by a daemon thread and all other non-daemon threads exit before <code>finally</code> is called
</li>
</ol>
</section>
<section id="answer-2-score-527" class="level4">
<h4>Answer 2 (score 527)</h4>
<p>Example code:</p>
<div class="sourceCode" id="cb403"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb403-1"><a href="#cb403-1" aria-hidden="true"></a><span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span>(<span class="bu">String</span>[] args) {</span>
<span id="cb403-2"><a href="#cb403-2" aria-hidden="true"></a>    <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(Test.<span class="fu">test</span>());</span>
<span id="cb403-3"><a href="#cb403-3" aria-hidden="true"></a>}</span>
<span id="cb403-4"><a href="#cb403-4" aria-hidden="true"></a></span>
<span id="cb403-5"><a href="#cb403-5" aria-hidden="true"></a><span class="kw">public</span> <span class="dt">static</span> <span class="dt">int</span> <span class="fu">test</span>() {</span>
<span id="cb403-6"><a href="#cb403-6" aria-hidden="true"></a>    <span class="kw">try</span> {</span>
<span id="cb403-7"><a href="#cb403-7" aria-hidden="true"></a>        <span class="kw">return</span> <span class="dv">0</span>;</span>
<span id="cb403-8"><a href="#cb403-8" aria-hidden="true"></a>    }</span>
<span id="cb403-9"><a href="#cb403-9" aria-hidden="true"></a>    <span class="kw">finally</span> {</span>
<span id="cb403-10"><a href="#cb403-10" aria-hidden="true"></a>        <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;finally trumps return.&quot;</span>);</span>
<span id="cb403-11"><a href="#cb403-11" aria-hidden="true"></a>    }</span>
<span id="cb403-12"><a href="#cb403-12" aria-hidden="true"></a>}</span></code></pre></div>
<p>Output:</p>
<div class="sourceCode" id="cb404"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb404-1"><a href="#cb404-1" aria-hidden="true"></a><span class="kw">finally</span> trumps <span class="kw">return</span>. </span>
<span id="cb404-2"><a href="#cb404-2" aria-hidden="true"></a><span class="dv">0</span></span></code></pre></div>
</section>
<section id="answer-3-score-371" class="level4">
<h4>Answer 3 (score 371)</h4>
<p>Also, although it’s bad practice, if there is a return statement within the finally block, it will trump any other return from the regular block. That is, the following block would return false:</p>
<div class="sourceCode" id="cb405"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb405-1"><a href="#cb405-1" aria-hidden="true"></a><span class="kw">try</span> { <span class="kw">return</span> <span class="kw">true</span>; } <span class="kw">finally</span> { <span class="kw">return</span> <span class="kw">false</span>; }</span></code></pre></div>
<p>Same thing with throwing exceptions from the finally block.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="iterating-through-a-collection-avoiding-concurrentmodificationexception-when-removing-objects-in-a-loop-score-461129-in-2019" class="level3">
<h3>58: Iterating through a Collection, avoiding ConcurrentModificationException when removing objects in a loop (score <a href="https://stackoverflow.com/q/223918.html">461129</a> in 2019)</h3>
<section id="question-56" class="level4">
<h4>Question</h4>
<p>We all know you can’t do this:</p>
<div class="sourceCode" id="cb406"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb406-1"><a href="#cb406-1" aria-hidden="true"></a><span class="kw">for</span> (<span class="bu">Object</span> i : l) {</span>
<span id="cb406-2"><a href="#cb406-2" aria-hidden="true"></a>    <span class="kw">if</span> (<span class="fu">condition</span>(i)) {</span>
<span id="cb406-3"><a href="#cb406-3" aria-hidden="true"></a>        l.<span class="fu">remove</span>(i);</span>
<span id="cb406-4"><a href="#cb406-4" aria-hidden="true"></a>    }</span>
<span id="cb406-5"><a href="#cb406-5" aria-hidden="true"></a>}</span></code></pre></div>
<p><code>ConcurrentModificationException</code> etc… this apparently works sometimes, but not always. Here’s some specific code:</p>
<div class="sourceCode" id="cb407"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb407-1"><a href="#cb407-1" aria-hidden="true"></a><span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span>(<span class="bu">String</span>[] args) {</span>
<span id="cb407-2"><a href="#cb407-2" aria-hidden="true"></a>    <span class="bu">Collection</span>&lt;<span class="bu">Integer</span>&gt; l = <span class="kw">new</span> <span class="bu">ArrayList</span>&lt;&gt;();</span>
<span id="cb407-3"><a href="#cb407-3" aria-hidden="true"></a></span>
<span id="cb407-4"><a href="#cb407-4" aria-hidden="true"></a>    <span class="kw">for</span> (<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; <span class="dv">10</span>; ++i) {</span>
<span id="cb407-5"><a href="#cb407-5" aria-hidden="true"></a>        l.<span class="fu">add</span>(<span class="dv">4</span>);</span>
<span id="cb407-6"><a href="#cb407-6" aria-hidden="true"></a>        l.<span class="fu">add</span>(<span class="dv">5</span>);</span>
<span id="cb407-7"><a href="#cb407-7" aria-hidden="true"></a>        l.<span class="fu">add</span>(<span class="dv">6</span>);</span>
<span id="cb407-8"><a href="#cb407-8" aria-hidden="true"></a>    }</span>
<span id="cb407-9"><a href="#cb407-9" aria-hidden="true"></a></span>
<span id="cb407-10"><a href="#cb407-10" aria-hidden="true"></a>    <span class="kw">for</span> (<span class="dt">int</span> i : l) {</span>
<span id="cb407-11"><a href="#cb407-11" aria-hidden="true"></a>        <span class="kw">if</span> (i == <span class="dv">5</span>) {</span>
<span id="cb407-12"><a href="#cb407-12" aria-hidden="true"></a>            l.<span class="fu">remove</span>(i);</span>
<span id="cb407-13"><a href="#cb407-13" aria-hidden="true"></a>        }</span>
<span id="cb407-14"><a href="#cb407-14" aria-hidden="true"></a>    }</span>
<span id="cb407-15"><a href="#cb407-15" aria-hidden="true"></a></span>
<span id="cb407-16"><a href="#cb407-16" aria-hidden="true"></a>    <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(l);</span>
<span id="cb407-17"><a href="#cb407-17" aria-hidden="true"></a>}</span></code></pre></div>
<p>This, of course, results in:</p>
<div class="sourceCode" id="cb408"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb408-1"><a href="#cb408-1" aria-hidden="true"></a><span class="bu">Exception</span> in thread <span class="st">&quot;main&quot;</span> java.<span class="fu">util</span>.<span class="fu">ConcurrentModificationException</span></span></code></pre></div>
<p>… even though multiple threads aren’t doing it… Anyway.</p>
<p>What’s the best solution to this problem? How can I remove an item from the collection in a loop without throwing this exception?</p>
<p>I’m also using an arbitrary <code>Collection</code> here, not necessarily an <code>ArrayList</code>, so you can’t rely on <code>get</code>.</p>
</section>
<section id="answer-accepted-score-1563" class="level4">
<h4>Answer accepted (score 1563)</h4>
<p><a href="https://docs.oracle.com/javase/9/docs/api/java/util/Iterator.html
#remove--" rel="noreferrer"><code>Iterator.remove()</code></a> is safe, you can use it like this:</p>
<div class="sourceCode" id="cb409"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb409-1"><a href="#cb409-1" aria-hidden="true"></a><span class="bu">List</span>&lt;<span class="bu">String</span>&gt; list = <span class="kw">new</span> <span class="bu">ArrayList</span>&lt;&gt;();</span>
<span id="cb409-2"><a href="#cb409-2" aria-hidden="true"></a></span>
<span id="cb409-3"><a href="#cb409-3" aria-hidden="true"></a><span class="co">// This is a clever way to create the iterator and call iterator.hasNext() like</span></span>
<span id="cb409-4"><a href="#cb409-4" aria-hidden="true"></a><span class="co">// you would do in a while-loop. It would be the same as doing:</span></span>
<span id="cb409-5"><a href="#cb409-5" aria-hidden="true"></a><span class="co">//     Iterator&lt;String&gt; iterator = list.iterator();</span></span>
<span id="cb409-6"><a href="#cb409-6" aria-hidden="true"></a><span class="co">//     while (iterator.hasNext()) {</span></span>
<span id="cb409-7"><a href="#cb409-7" aria-hidden="true"></a><span class="kw">for</span> (<span class="bu">Iterator</span>&lt;<span class="bu">String</span>&gt; iterator = list.<span class="fu">iterator</span>(); iterator.<span class="fu">hasNext</span>();) {</span>
<span id="cb409-8"><a href="#cb409-8" aria-hidden="true"></a>    <span class="bu">String</span> string = iterator.<span class="fu">next</span>();</span>
<span id="cb409-9"><a href="#cb409-9" aria-hidden="true"></a>    <span class="kw">if</span> (string.<span class="fu">isEmpty</span>()) {</span>
<span id="cb409-10"><a href="#cb409-10" aria-hidden="true"></a>        <span class="co">// Remove the current element from the iterator and the list.</span></span>
<span id="cb409-11"><a href="#cb409-11" aria-hidden="true"></a>        iterator.<span class="fu">remove</span>();</span>
<span id="cb409-12"><a href="#cb409-12" aria-hidden="true"></a>    }</span>
<span id="cb409-13"><a href="#cb409-13" aria-hidden="true"></a>}</span></code></pre></div>
<p>Note that <a href="https://docs.oracle.com/javase/9/docs/api/java/util/Iterator.html
#remove--" rel="noreferrer"><code>Iterator.remove()</code></a> is the only safe way to modify a collection during iteration; the behavior is unspecified if the underlying collection is modified <strong>in any other way</strong> while the iteration is in progress.</p>
<p>Source:<a href="http://docs.oracle.com/javase/tutorial/collections/interfaces/collection.html" rel="noreferrer"> docs.oracle &gt; The Collection Interface</a></p>
<hr>
<p>And similarly, if you have a <code>ListIterator</code> and want to <em>add</em> items, you can use <a href="http://docs.oracle.com/javase/8/docs/api/java/util/ListIterator.html
#add-E-" rel="noreferrer"><code>ListIterator#add</code></a>, for the same reason you can use <code>Iterator#remove</code> — it’s designed to allow it.</p>
<hr>
<p>In your case you tried to remove from a list, but the same restriction applies if trying to <code>put</code> into a <code>Map</code> while iterating its content.</p>
</section>
<section id="answer-2-score-336" class="level4">
<h4>Answer 2 (score 336)</h4>
<p>This works:</p>
<div class="sourceCode" id="cb410"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb410-1"><a href="#cb410-1" aria-hidden="true"></a><span class="bu">Iterator</span>&lt;<span class="bu">Integer</span>&gt; iter = l.<span class="fu">iterator</span>();</span>
<span id="cb410-2"><a href="#cb410-2" aria-hidden="true"></a><span class="kw">while</span> (iter.<span class="fu">hasNext</span>()) {</span>
<span id="cb410-3"><a href="#cb410-3" aria-hidden="true"></a>    <span class="kw">if</span> (iter.<span class="fu">next</span>() == <span class="dv">5</span>) {</span>
<span id="cb410-4"><a href="#cb410-4" aria-hidden="true"></a>        iter.<span class="fu">remove</span>();</span>
<span id="cb410-5"><a href="#cb410-5" aria-hidden="true"></a>    }</span>
<span id="cb410-6"><a href="#cb410-6" aria-hidden="true"></a>}</span></code></pre></div>
<p>I assumed that since a foreach loop is syntactic sugar for iterating, using an iterator wouldn’t help… but it gives you this <code>.remove()</code> functionality.</p>
</section>
<section id="answer-3-score-193" class="level4">
<h4>Answer 3 (score 193)</h4>
<p>With Java 8 you can use <a href="http://docs.oracle.com/javase/8/docs/api/java/util/Collection.html
#removeIf-java.util.function.Predicate-" rel="noreferrer">the new <code>removeIf</code> method</a>. Applied to your example:</p>
<div class="sourceCode" id="cb411"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb411-1"><a href="#cb411-1" aria-hidden="true"></a><span class="bu">Collection</span>&lt;<span class="bu">Integer</span>&gt; coll = <span class="kw">new</span> <span class="bu">ArrayList</span>&lt;&gt;();</span>
<span id="cb411-2"><a href="#cb411-2" aria-hidden="true"></a><span class="co">//populate</span></span>
<span id="cb411-3"><a href="#cb411-3" aria-hidden="true"></a></span>
<span id="cb411-4"><a href="#cb411-4" aria-hidden="true"></a>coll.<span class="fu">removeIf</span>(i -&gt; i == <span class="dv">5</span>);</span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="android-sdk-installation-doesnt-find-jdk-score-435935-in-2018" class="level3">
<h3>59: Android SDK installation doesn’t find JDK (score <a href="https://stackoverflow.com/q/4382178.html">435935</a> in 2018)</h3>
<section id="question-57" class="level4">
<h4>Question</h4>
<p>I’m trying to install the Android SDK on my Windows 7 x64 System. <code>jdk-6u23-windows-x64.exe</code> is installed, but the Android SDK setup refuses to proceed because it doesn’t find the JDK installation.</p>
<p>Is this a known issue? And is there a solution?</p>
<p><img src="https://i.stack.imgur.com/pZjuL.jpg" alt="SDK Error"></p>
</section>
<section id="answer-2-score-1253" class="level4">
<h4>Answer 2 (score 1253)</h4>
<p>Press <strong><em>Back</em></strong> when you get the notification and then <strong><em>Next</em></strong>. This time it will find the <code>JDK</code>.</p>
</section>
<section id="answer-3-score-280" class="level4">
<h4>Answer 3 (score 280)</h4>
<p>Actual SETUP:</p>
<ul>
<li>
<strong>OS</strong>: Windows 8.1
</li>
<li>
<strong>JDK</strong> file: jdk-8u11-windows-x64.exe
</li>
<li>
<strong>ADT</strong> file: installer_r23.0.2-windows.exe
</li>
</ul>
<p>Install the <code>x64 JDK</code>, and try the back-next option first, and then try setting <code>JAVA_HOME</code> like the error message says, but if that doesn’t work for you either, then try this:</p>
<p>Do as it says, set <code>JAVA_HOME</code> in your environment variables, but in the path use forward slashes instead of backslashes.</p>
<p>Seriously.</p>
<p>For me it failed when <code>JAVA_HOME</code> was <code>C:\Program Files\Java\jdk1.6.0_31</code> but worked fine when it was <code>C:/Program Files/Java/jdk1.6.0_31</code> - drove me nuts!</p>
<p>If this is not enough, also add to the beginning of the Environment Variable <code>Path</code> <strong>%JAVA_HOME%;</strong></p>
<p>Updated values in System Environment Variables:</p>
<ul>
<li>
<code>JAVA_HOME=C:/Program Files/Java/jdk1.8.0_11</code>
</li>
<li>
<code>JRE_HOME=C:/Program Files/Java/jre8</code>
</li>
<li>
<code>Path=%JAVA_HOME%;C:...</code>
</li>
</ul>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="why-is-char-preferred-over-string-for-passwords-score-373132-in-2017" class="level3">
<h3>60: Why is char[] preferred over String for passwords? (score <a href="https://stackoverflow.com/q/8881291.html">373132</a> in 2017)</h3>
<section id="question-58" class="level4">
<h4>Question</h4>
<p>In Swing, the password field has a <code>getPassword()</code> (returns <code>char[]</code>) method instead of the usual <code>getText()</code> (returns <code>String</code>) method. Similarly, I have come across a suggestion not to use <code>String</code> to handle passwords.</p>
<p>
Why does <code>String</code> pose a threat to security when it comes to passwords? It feels inconvenient to use <code>char[]</code>.
</p>
</section>
<section id="answer-accepted-score-4140" class="level4">
<h4>Answer accepted (score 4140)</h4>
<p><strong>Strings are immutable</strong>. That means once you’ve created the <code>String</code>, if another process can dump memory, there’s no way (aside from <a href="https://en.wikipedia.org/wiki/Reflection_%28computer_programming%29" rel="noreferrer">reflection</a>) you can get rid of the data before <a href="https://en.wikipedia.org/wiki/Garbage_collection_%28computer_science%29" rel="noreferrer">garbage collection</a> kicks in.</p>
<p>With an array, you can explicitly wipe the data after you’re done with it. You can overwrite the array with anything you like, and the password won’t be present anywhere in the system, even before garbage collection.</p>
<p>So yes, this <em>is</em> a security concern - but even using <code>char[]</code> only reduces the window of opportunity for an attacker, and it’s only for this specific type of attack.</p>
<p>As noted in the comments, it’s possible that arrays being moved by the garbage collector will leave stray copies of the data in memory. I believe this is implementation-specific - the garbage collector <em>may</em> clear all memory as it goes, to avoid this sort of thing. Even if it does, there’s still the time during which the <code>char[]</code> contains the actual characters as an attack window.</p>
</section>
<section id="answer-2-score-1182" class="level4">
<h4>Answer 2 (score 1182)</h4>
<p>While other suggestions here seem valid, there is one other good reason. With plain <code>String</code> you have much higher chances of <strong>accidentally printing the password to logs</strong>, monitors or some other insecure place. <code>char[]</code> is less vulnerable.</p>
<p>Consider this:</p>
<div class="sourceCode" id="cb412"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb412-1"><a href="#cb412-1" aria-hidden="true"></a><span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span>(<span class="bu">String</span>[] args) {</span>
<span id="cb412-2"><a href="#cb412-2" aria-hidden="true"></a>    <span class="bu">Object</span> pw = <span class="st">&quot;Password&quot;</span>;</span>
<span id="cb412-3"><a href="#cb412-3" aria-hidden="true"></a>    <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;String: &quot;</span> + pw);</span>
<span id="cb412-4"><a href="#cb412-4" aria-hidden="true"></a></span>
<span id="cb412-5"><a href="#cb412-5" aria-hidden="true"></a>    pw = <span class="st">&quot;Password&quot;</span>.<span class="fu">toCharArray</span>();</span>
<span id="cb412-6"><a href="#cb412-6" aria-hidden="true"></a>    <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;Array: &quot;</span> + pw);</span>
<span id="cb412-7"><a href="#cb412-7" aria-hidden="true"></a>}</span></code></pre></div>
<p>Prints:</p>
<div class="sourceCode" id="cb413"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb413-1"><a href="#cb413-1" aria-hidden="true"></a><span class="bu">String</span>: Password</span>
<span id="cb413-2"><a href="#cb413-2" aria-hidden="true"></a><span class="bu">Array</span>: [C<span class="at">@5829428e</span></span></code></pre></div>
</section>
<section id="answer-3-score-665" class="level4">
<h4>Answer 3 (score 665)</h4>
<p>To quote an official document, the <a href="http://docs.oracle.com/javase/6/docs/technotes/guides/security/crypto/CryptoSpec.html
#PBEEx">Java Cryptography Architecture guide</a> says this about <code>char[]</code> vs. <code>String</code> passwords (about password-based encryption, but this is more generally about passwords of course):</p>
<blockquote>
<p>
It would seem logical to collect and store the password in an object of type <code>java.lang.String</code>. However, here’s the caveat: <code>Object</code>s of type <code>String</code> are immutable, i.e., there are no methods defined that allow you to change (overwrite) or zero out the contents of a <code>String</code> after usage. This feature makes <code>String</code> objects unsuitable for storing security sensitive information such as user passwords. You should always collect and store security sensitive information in a <code>char</code> array instead.
</p>
</blockquote>
<p><a href="http://www.oracle.com/technetwork/java/seccodeguide-139067.html
#2">Guideline 2-2 of the Secure Coding Guidelines for the Java Programming Language, Version 4.0</a> also says something similar (although it is originally in the context of logging):</p>
<blockquote>
<p><em>Guideline 2-2: Do not log highly sensitive information</em></p>
<p>
Some information, such as Social Security numbers (SSNs) and passwords, is highly sensitive. This information should not be kept for longer than necessary nor where it may be seen, even by administrators. For instance, it should not be sent to log files and its presence should not be detectable through searches. Some transient data may be kept in mutable data structures, such as char arrays, and cleared immediately after use. Clearing data structures has reduced effectiveness on typical Java runtime systems as objects are moved in memory transparently to the programmer.
</p>
<p>
This guideline also has implications for implementation and use of lower-level libraries that do not have semantic knowledge of the data they are dealing with. As an example, a low-level string parsing library may log the text it works on. An application may parse an SSN with the library. This creates a situation where the SSNs are available to administrators with access to the log files.
</p>
</blockquote>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="why-use-getters-and-settersaccessors-score-367892-in-2017" class="level3">
<h3>61: Why use getters and setters/accessors? (score <a href="https://stackoverflow.com/q/1568091.html">367892</a> in 2017)</h3>
<section id="question-59" class="level4">
<h4>Question</h4>
<p>What’s the advantage of using getters and setters - that only get and set - instead of simply using public fields for those variables?</p>
<p>If getters and setters are ever doing more than just the simple get/set, I can figure this one out very quickly, but I’m not 100% clear on how:</p>
<div class="sourceCode" id="cb414"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb414-1"><a href="#cb414-1" aria-hidden="true"></a><span class="kw">public</span> <span class="bu">String</span> foo;</span></code></pre></div>
<p>is any worse than:</p>
<div class="sourceCode" id="cb415"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb415-1"><a href="#cb415-1" aria-hidden="true"></a><span class="kw">private</span> <span class="bu">String</span> foo;</span>
<span id="cb415-2"><a href="#cb415-2" aria-hidden="true"></a><span class="kw">public</span> <span class="dt">void</span> <span class="fu">setFoo</span>(<span class="bu">String</span> foo) { <span class="kw">this</span>.<span class="fu">foo</span> = foo; }</span>
<span id="cb415-3"><a href="#cb415-3" aria-hidden="true"></a><span class="kw">public</span> <span class="bu">String</span> <span class="fu">getFoo</span>() { <span class="kw">return</span> foo; }</span></code></pre></div>
<p>Whereas the former takes a lot less boilerplate code.</p>
</section>
<section id="answer-accepted-score-915" class="level4">
<h4>Answer accepted (score 915)</h4>
<p><strong>There are actually <em>many good reasons</em> to consider using accessors</strong> rather than directly exposing fields of a class - beyond just the argument of encapsulation and making future changes easier.</p>
<p><em>Here are the some of the reasons I am aware of:</em></p>
<ul>
<li>
Encapsulation of behavior associated with getting or setting the property - this allows additional functionality (like validation) to be added more easily later.
</li>
<li>
Hiding the internal representation of the property while exposing a property using an alternative representation.
</li>
<li>
Insulating your public interface from change - allowing the public interface to remain constant while the implementation changes without affecting existing consumers.
</li>
<li>
Controlling the lifetime and memory management (disposal) semantics of the property - particularly important in non-managed memory environments (like C++ or Objective-C).
</li>
<li>
Providing a debugging interception point for when a property changes at runtime - debugging when and where a property changed to a particular value can be quite difficult without this in some languages.
</li>
<li>
Improved interoperability with libraries that are designed to operate against property getter/setters - Mocking, Serialization, and WPF come to mind.
</li>
<li>
Allowing inheritors to change the semantics of how the property behaves and is exposed by overriding the getter/setter methods.
</li>
<li>
Allowing the getter/setter to be passed around as lambda expressions rather than values.
</li>
<li>
Getters and setters can allow different access levels - for example the get may be public, but the set could be protected.
</li>
</ul>
</section>
<section id="answer-2-score-445" class="level4">
<h4>Answer 2 (score 445)</h4>
<p>Because 2 weeks (months, years) from now when you realize that your setter needs to do <strong>more</strong> than just set the value, you’ll also realize that the property has been used directly in 238 other classes :-)</p>
</section>
<section id="answer-3-score-344" class="level4">
<h4>Answer 3 (score 344)</h4>
<p>A public field is not worse than a getter/setter pair that does nothing except returning the field and assigning to it. First, it’s clear that (in most languages) there is no functional difference. Any difference must be in other factors, like maintainability or readability.</p>
<p>An oft-mentioned advantage of getter/setter pairs, isn’t. There’s this claim that you can change the implementation and your clients don’t have to be recompiled. Supposedly, setters let you add functionality like validation later on and your clients don’t even need to know about it. However, adding validation to a setter is a change to its preconditions, <strong>a violation of the previous contract</strong>, which was, quite simply, “you can put anything in here, and you can get that same thing later from the getter”.</p>
<p>So, now that you broke the contract, changing every file in the codebase is something you should want to do, not avoid. If you avoid it you’re making the assumption that all the code assumed the contract for those methods was different.</p>
<p>If that should not have been the contract, then the interface was allowing clients to put the object in invalid states. <em>That’s the exact opposite of encapsulation</em> If that field could not really be set to anything from the start, why wasn’t the validation there from the start?</p>
<p>This same argument applies to other supposed advantages of these pass-through getter/setter pairs: if you later decide to change the value being set, you’re breaking the contract. If you override the default functionality in a derived class, in a way beyond a few harmless modifications (like logging or other non-observable behaviour), you’re breaking the contract of the base class. That is a violation of the Liskov Substitutability Principle, which is seen as one of the tenets of OO.</p>
<p>If a class has these dumb getters and setters for every field, then it is a class that has no invariants whatsoever, <em>no contract</em>. Is that really object-oriented design? If all the class has is those getters and setters, it’s just a dumb data holder, and dumb data holders should look like dumb data holders:</p>
<div class="sourceCode" id="cb416"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb416-1"><a href="#cb416-1" aria-hidden="true"></a><span class="kw">class</span> Foo {</span>
<span id="cb416-2"><a href="#cb416-2" aria-hidden="true"></a><span class="kw">public</span>:</span>
<span id="cb416-3"><a href="#cb416-3" aria-hidden="true"></a>    <span class="dt">int</span> DaysLeft;</span>
<span id="cb416-4"><a href="#cb416-4" aria-hidden="true"></a>    <span class="dt">int</span> ContestantNumber;</span>
<span id="cb416-5"><a href="#cb416-5" aria-hidden="true"></a>};</span></code></pre></div>
<p>Adding pass-through getter/setter pairs to such a class adds no value. Other classes should provide meaningful operations, not just operations that fields already provide. That’s how you can define and maintain useful invariants.</p>
<blockquote>
<p>
<strong>Client</strong>: “What can I do with an object of this class?”<br> <strong>Designer</strong>: “You can read and write several variables.”<br> <strong>Client</strong>: “Oh… cool, I guess?”
</p>
</blockquote>
<p>There are reasons to use getters and setters, but if those reasons don’t exist, making getter/setter pairs in the name of false encapsulation gods is not a good thing. Valid reasons to make getters or setters include the things often mentioned as the potential changes you can make later, like validation or different internal representations. Or maybe the value should be readable by clients but not writable (for example, reading the size of a dictionary), so a simple getter is a nice choice. But those reasons should be there when you make the choice, and not just as a potential thing you may want later. This is an instance of YAGNI (<em>You Ain’t Gonna Need It</em>).</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="proper-use-cases-for-android-usermanager.isuseragoat-score-301207-in-2018" class="level3">
<h3>62: Proper use cases for Android UserManager.isUserAGoat()? (score <a href="https://stackoverflow.com/q/13375357.html">301207</a> in 2018)</h3>
<section id="question-60" class="level4">
<h4>Question</h4>
<p>
I was looking at the new APIs introduced in <a href="http://en.wikipedia.org/wiki/Android_version_history
#Android_4.1.2F4.2_Jelly_Bean" rel="noreferrer">Android 4.2</a>. While looking at the <a href="http://developer.android.com/reference/android/os/UserManager.html" rel="noreferrer"><code>UserManager</code></a> class I came across the following method:
</p>
<blockquote>
<div class="sourceCode" id="cb417"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb417-1"><a href="#cb417-1" aria-hidden="true"></a><span class="kw">public</span> <span class="dt">boolean</span> <span class="fu">isUserAGoat</span>()</span></code></pre></div>
<p>Used to determine whether the user making this call is subject to teleportations.</p>
Returns whether the user making this call is a goat.
</blockquote>
<p>How and when should this be used?</p>
</section>
<section id="answer-accepted-score-1710" class="level4">
<h4>Answer accepted (score 1710)</h4>
<p>From their <strong><a href="https://android.googlesource.com/platform/frameworks/base/+/android-5.0.0_r6/core/java/android/os/UserManager.java
#433" rel="noreferrer">source</a></strong>, the method used to return <code>false</code> until it was changed in API 21.</p>
<div class="sourceCode" id="cb418"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb418-1"><a href="#cb418-1" aria-hidden="true"></a><span class="co">/**</span></span>
<span id="cb418-2"><a href="#cb418-2" aria-hidden="true"></a> <span class="co">*</span> Used to determine whether the user making this call is subject to</span>
<span id="cb418-3"><a href="#cb418-3" aria-hidden="true"></a> <span class="co">*</span> teleportations<span class="co">.</span></span>
<span id="cb418-4"><a href="#cb418-4" aria-hidden="true"></a> <span class="co">*</span> <span class="an">@return </span>whether the user making this call is a goat </span>
<span id="cb418-5"><a href="#cb418-5" aria-hidden="true"></a> <span class="co">*/</span></span>
<span id="cb418-6"><a href="#cb418-6" aria-hidden="true"></a><span class="kw">public</span> <span class="dt">boolean</span> <span class="fu">isUserAGoat</span>() {</span>
<span id="cb418-7"><a href="#cb418-7" aria-hidden="true"></a>    <span class="kw">return</span> <span class="kw">false</span>;</span>
<span id="cb418-8"><a href="#cb418-8" aria-hidden="true"></a>}</span></code></pre></div>
<p>It looks like the method has no real use for us as developers. Someone has previously stated that it might be an <strong><a href="http://en.wikipedia.org/wiki/Easter_egg_(media)" rel="noreferrer">Easter egg</a></strong>.</p>
<p>In API 21 the implementation was changed to check if there is an installed app with the package <code>com.coffeestainstudios.goatsimulator</code></p>
<div class="sourceCode" id="cb419"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb419-1"><a href="#cb419-1" aria-hidden="true"></a><span class="co">/**</span></span>
<span id="cb419-2"><a href="#cb419-2" aria-hidden="true"></a> <span class="co">*</span> Used to determine whether the user making this call is subject to</span>
<span id="cb419-3"><a href="#cb419-3" aria-hidden="true"></a> <span class="co">*</span> teleportations<span class="co">.</span></span>
<span id="cb419-4"><a href="#cb419-4" aria-hidden="true"></a> <span class="co">*</span></span>
<span id="cb419-5"><a href="#cb419-5" aria-hidden="true"></a> <span class="co">*</span> <span class="kw">&lt;p&gt;</span>As of <span class="an">{@link </span>android<span class="an">.</span>os<span class="an">.</span>Build<span class="an">.</span>VERSION_CODES</span>
<span id="cb419-6"><a href="#cb419-6" aria-hidden="true"></a><span class="an">#</span>LOLLIPOP<span class="an">}</span><span class="co">,</span> this method can</span>
<span id="cb419-7"><a href="#cb419-7" aria-hidden="true"></a> <span class="co">*</span> now automatically identify goats using advanced goat recognition technology<span class="co">.</span><span class="kw">&lt;/p&gt;</span></span>
<span id="cb419-8"><a href="#cb419-8" aria-hidden="true"></a> <span class="co">*</span></span>
<span id="cb419-9"><a href="#cb419-9" aria-hidden="true"></a> <span class="co">*</span> <span class="an">@return </span>Returns true if the user making this call is a goat<span class="co">.</span></span>
<span id="cb419-10"><a href="#cb419-10" aria-hidden="true"></a> <span class="co">*/</span></span>
<span id="cb419-11"><a href="#cb419-11" aria-hidden="true"></a><span class="kw">public</span> <span class="dt">boolean</span> <span class="fu">isUserAGoat</span>() {</span>
<span id="cb419-12"><a href="#cb419-12" aria-hidden="true"></a>    <span class="kw">return</span> mContext.<span class="fu">getPackageManager</span>()</span>
<span id="cb419-13"><a href="#cb419-13" aria-hidden="true"></a>            .<span class="fu">isPackageAvailable</span>(<span class="st">&quot;com.coffeestainstudios.goatsimulator&quot;</span>);</span>
<span id="cb419-14"><a href="#cb419-14" aria-hidden="true"></a>}</span></code></pre></div>
<p>Here is the <a href="https://android.googlesource.com/platform/frameworks/base/+/android-5.0.0_r6/core/java/android/os/UserManager.java
#442" rel="noreferrer">source</a> and the <a href="https://android.googlesource.com/platform/frameworks/base/+/e4ab16ad98b183afbf7a21ad7314372de41a8b57%5E%21/#F1" rel="noreferrer">change</a>.</p>
</section>
<section id="answer-2-score-961" class="level4">
<h4>Answer 2 (score 961)</h4>
<p>I don’t know if this was “the” official use case, but the following produces a warning in Java (that can further produce compile errors if mixed with <code>return</code> statements, leading to unreachable code):</p>
<div class="sourceCode" id="cb420"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb420-1"><a href="#cb420-1" aria-hidden="true"></a><span class="kw">while</span> (<span class="dv">1</span> == <span class="dv">2</span>) { <span class="co">// Note that &quot;if&quot; is treated differently</span></span>
<span id="cb420-2"><a href="#cb420-2" aria-hidden="true"></a>    <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;Unreachable code&quot;</span>);</span>
<span id="cb420-3"><a href="#cb420-3" aria-hidden="true"></a>}</span></code></pre></div>
<p>However this is legal:</p>
<div class="sourceCode" id="cb421"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb421-1"><a href="#cb421-1" aria-hidden="true"></a><span class="kw">while</span> (<span class="fu">isUserAGoat</span>()) {</span>
<span id="cb421-2"><a href="#cb421-2" aria-hidden="true"></a>    <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;Unreachable but determined at runtime, not at compile time&quot;</span>);</span>
<span id="cb421-3"><a href="#cb421-3" aria-hidden="true"></a>}</span></code></pre></div>
<p>So I often find myself writing a silly utility method for the quickest way to dummy out a code block, then in completing debugging find all calls to it, so provided the implementation doesn’t change this can be used for that.</p>
<p><a href="http://docs.oracle.com/javase/specs/jls/se7/html/jls-14.html
#jls-14.21" rel="noreferrer">JLS</a> points out <code>if (false)</code> does not trigger “unreachable code” for the specific reason that this would break support for debug flags, i.e., basically this use case (h/t <span class="citation" data-cites="auselen">@auselen</span>). (<code>static final boolean DEBUG = false;</code> for instance).</p>
<p>I replaced <code>while</code> for <code>if</code>, producing a more obscure use case. I <em>believe</em> you can trip up your IDE, like Eclipse, with this behavior, but this edit is 4 years into the future, and I don’t have an Eclipse environment to play with.</p>
</section>
<section id="answer-3-score-745" class="level4">
<h4>Answer 3 (score 745)</h4>
<p>This appears to be an inside joke at Google. It’s also featured in the Google Chrome task manager. It has no purpose, other than some engineers finding it amusing. Which is a purpose by itself, if you will.</p>
<ol>
<li>
In Chrome, open the Task Manager with <kbd>Shift</kbd>+<kbd>Esc</kbd>.
</li>
<li>
Right click to add the <code>Goats Teleported</code> column.
</li>
<li>
Wonder.
</li>
</ol>
<p>There is even a huge Chromium bug report about <a href="http://code.google.com/p/chromium/issues/detail?id=31482">too many teleported goats</a>.</p>
<p><img src="https://i.stack.imgur.com/1nwdC.png" alt="chrome"></p>
<p>The following Chromium <a href="http://git.chromium.org/gitweb/?p=chromium.git;a=blob;f=chrome/browser/task_manager/task_manager.cc;h=ad46354259ec8687c8665820f9f53bf89ccc715d;hb=HEAD
#l599">source code snippet</a> is stolen from the <a href="http://news.ycombinator.com/item?id=4782574">HN</a> comments.</p>
<div class="sourceCode" id="cb422"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb422-1"><a href="#cb422-1" aria-hidden="true"></a><span class="dt">int</span> TaskManagerModel::<span class="fu">GetGoatsTeleported</span>(<span class="dt">int</span> index) <span class="dt">const</span> {</span>
<span id="cb422-2"><a href="#cb422-2" aria-hidden="true"></a>  <span class="dt">int</span> seed = goat_salt_ * (index + <span class="dv">1</span>);</span>
<span id="cb422-3"><a href="#cb422-3" aria-hidden="true"></a>  <span class="kw">return</span> (seed &gt;&gt; <span class="dv">16</span>) &amp; <span class="dv">255</span>;</span>
<span id="cb422-4"><a href="#cb422-4" aria-hidden="true"></a>}</span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-do-servlets-work-instantiation-sessions-shared-variables-and-multithreading-score-282529-in-2017" class="level3">
<h3>63: How do servlets work? Instantiation, sessions, shared variables and multithreading (score <a href="https://stackoverflow.com/q/3106452.html">282529</a> in 2017)</h3>
<section id="question-61" class="level4">
<h4>Question</h4>
<p>Suppose, I have a webserver which holds numerous servlets. For information passing among those servlets I am setting session and instance variables.</p>
<p>Now, if 2 or more users send request to this server then what happens to the session variables? Will they all be common for all the users or they will be different for each user. If they are different, then how was the server able to differentiate between different users?</p>
<p>One more similar question, if there are <code>n</code> users accessing a particular servlet, then this servlet gets instantiated only the first time the first user accessed it or does it get instantiated for all the users separately? In other words, what happens to the instance variables?</p>
</section>
<section id="answer-accepted-score-1770" class="level4">
<h4>Answer accepted (score 1770)</h4>
<h5>
ServletContext
</h2>
<p>When the servlet container (like <a href="http://tomcat.apache.org" rel="noreferrer">Apache Tomcat</a>) starts up, it will deploy and load all its web applications. When a web application is loaded, the servlet container creates the <a href="https://javaee.github.io/javaee-spec/javadocs/javax/servlet/ServletContext.html" rel="noreferrer"><code>ServletContext</code></a> once and keeps it in the server’s memory. The web app’s <code>web.xml</code> and all of included <code>web-fragment.xml</code> files is parsed, and each <code>&amp;lt;servlet&amp;gt;</code>, <code>&amp;lt;filter&amp;gt;</code> and <code>&amp;lt;listener&amp;gt;</code> found (or each class annotated with <code>@WebServlet</code>, <code>@WebFilter</code> and <code>@WebListener</code> respectively) is instantiated once and kept in the server’s memory as well. For each instantiated filter, its <code>init()</code> method is invoked with a new <a href="https://javaee.github.io/javaee-spec/javadocs/javax/servlet/FilterConfig.html" rel="noreferrer"><code>FilterConfig</code></a>.</p>
<p>When a <code>Servlet</code> has a <code>&amp;lt;servlet&amp;gt;&amp;lt;load-on-startup&amp;gt;</code> or <code>@WebServlet(loadOnStartup)</code> value greater than <code>0</code>, then its <code>init()</code> method is also invoked during startup with a new <a href="https://javaee.github.io/javaee-spec/javadocs/javax/servlet/ServletConfig.html" rel="noreferrer"><code>ServletConfig</code></a>. Those servlets are initialized in the same order specified by that value (<code>1</code> is 1st, <code>2</code> is 2nd, etc). If the same value is specified for more than one servlet, then each of those servlets is loaded in the same order as they appear in the <code>web.xml</code>, <code>web-fragment.xml</code>, or <code>@WebServlet</code> classloading. In the event the “load-on-startup” value is absent, the <code>init()</code> method will be invoked whenever the HTTP request hits that servlet for the very first time.</p>
<p>When the servlet container is finished with all of the above described initialization steps, then the <a href="https://javaee.github.io/javaee-spec/javadocs/javax/servlet/ServletContextListener.html
#contextInitialized-javax.servlet.ServletContextEvent-" rel="noreferrer"><code>ServletContextListener#contextInitialized()</code></a> will be invoked.</p>
<p>When the servlet container shuts down, it unloads all web applications, invokes the <code>destroy()</code> method of all its initialized servlets and filters, and all <code>ServletContext</code>, <code>Servlet</code>, <code>Filter</code> and <code>Listener</code> instances are trashed. Finally the <a href="https://javaee.github.io/javaee-spec/javadocs/javax/servlet/ServletContextListener.html
#contextDestroyed-javax.servlet.ServletContextEvent-" rel="noreferrer"><code>ServletContextListener#contextDestroyed()</code></a> will be invoked.</p>
<h5>
HttpServletRequest and HttpServletResponse
</h2>
<p>The servlet container is attached to a web server that listens for HTTP requests on a certain port number (port 8080 is usually used during development and port 80 in production). When a client (e.g. user with a web browser, or <a href="https://stackoverflow.com/questions/2793150/how-to-use-java-net-urlconnection-to-fire-and-handle-http-requests">programmatically using <code>URLConnection</code></a>) sends an HTTP request, the servlet container creates new <a href="https://javaee.github.io/javaee-spec/javadocs/javax/servlet/http/HttpServletRequest.html" rel="noreferrer"><code>HttpServletRequest</code></a> and <a href="https://javaee.github.io/javaee-spec/javadocs/javax/servlet/http/HttpServletResponse.html" rel="noreferrer"><code>HttpServletResponse</code></a> objects and passes them through any defined <code>Filter</code> in the chain and, eventually, the <code>Servlet</code> instance.</p>
<p>In the case of <a href="https://stackoverflow.com/tags/servlet-filters/info">filters</a>, the <code>doFilter()</code> method is invoked. When the servlet container’s code calls <code>chain.doFilter(request, response)</code>, the request and response continue on to the next filter, or hit the servlet if there are no remaining filters.</p>
<p>In the case of <a href="https://stackoverflow.com/tags/servlets/info">servlets</a>, the <code>service()</code> method is invoked. By default, this method determines which one of the <code>doXxx()</code> methods to invoke based off of <code>request.getMethod()</code>. If the determined method is absent from the servlet, then an HTTP 405 error is returned in the response.</p>
<p>The request object provides access to all of the information about the HTTP request, such as its URL, headers, query string and body. The response object provides the ability to control and send the HTTP response the way you want by, for instance, allowing you to set the headers and the body (usually with generated HTML content from a JSP file). When the HTTP response is committed and finished, both the request and response objects are recycled and made available for reuse.</p>
<h5>
HttpSession
</h2>
<p>When a client visits the webapp for the first time and/or the <a href="https://javaee.github.io/javaee-spec/javadocs/javax/servlet/http/HttpSession.html" rel="noreferrer"><code>HttpSession</code></a> is obtained for the first time via <code>request.getSession()</code>, the servlet container creates a new <code>HttpSession</code> object, generates a long and unique ID (which you can get by <code>session.getId()</code>), and stores it in the server’s memory. The servlet container also sets a <a href="https://javaee.github.io/javaee-spec/javadocs/javax/servlet/http/Cookie.html" rel="noreferrer"><code>Cookie</code></a> in the <code>Set-Cookie</code> header of the HTTP response with <code>JSESSIONID</code> as its name and the unique session ID as its value.</p>
<p>As per the <a href="http://www.faqs.org/rfcs/rfc2965.html" rel="noreferrer">HTTP cookie specification</a> (a contract any decent web browser and web server must adhere to), the client (the web browser) is required to send this cookie back in subsequent requests in the <code>Cookie</code> header for as long as the cookie is valid (i.e. the unique ID must refer to an unexpired session and the domain and path are correct). Using your browser’s built-in HTTP traffic monitor, you can verify that the cookie is valid (press F12 in Chrome / Firefox 23+ / IE9+, and check the <em>Net/Network</em> tab). The servlet container will check the <code>Cookie</code> header of every incoming HTTP request for the presence of the cookie with the name <code>JSESSIONID</code> and use its value (the session ID) to get the associated <code>HttpSession</code> from server’s memory.</p>
<p>The <code>HttpSession</code> stays alive until it has been idle (i.e. not used in a request) for more than the timeout value specified in <code>&amp;lt;session-timeout&amp;gt;</code>, a setting in <code>web.xml</code>. The timeout value defaults to 30 minutes. So, when the client doesn’t visit the web app for longer than the time specified, the servlet container trashes the session. Every subsequent request, even with the cookie specified, will not have access to the same session anymore; the servlet container will create a new session.</p>
<p>On the client side, the session cookie stays alive for as long as the browser instance is running. So, if the client closes the browser instance (all tabs/windows), then the session is trashed on the client’s side. In a new browser instance, the cookie associated with the session wouldn’t exist, so it would no longer be sent. This causes an entirely new <code>HttpSession</code> to be created, with an entirely new session cookie being used.</p>
<h5>
In a nutshell
</h2>
<ul>
<li>
The <code>ServletContext</code> lives for as long as the web app lives. It is shared among <em>all</em> requests in <em>all</em> sessions.
</li>
<li>
The <code>HttpSession</code> lives for as long as the client is interacting with the web app with the same browser instance, and the session hasn’t timed out at the server side. It is shared among <em>all</em> requests in the <em>same</em> session.
</li>
<li>
The <code>HttpServletRequest</code> and <code>HttpServletResponse</code> live from the time the servlet receives an HTTP request from the client, until the complete response (the web page) has arrived. It is <em>not</em> shared elsewhere.
</li>
<li>
All <code>Servlet</code>, <code>Filter</code> and <code>Listener</code> instances live as long as the web app lives. They are shared among <em>all</em> requests in <em>all</em> sessions.
</li>
<li>
Any <code>attribute</code> that is defined in <code>ServletContext</code>, <code>HttpServletRequest</code> and <code>HttpSession</code> will live as long as the object in question lives. The object itself represents the “scope” in bean management frameworks such as JSF, CDI, Spring, etc. Those frameworks store their scoped beans as an <code>attribute</code> of its closest matching scope.
</li>
</ul>
<h5>
Thread Safety
</h2>
<p>That said, your major concern is possibly <em>thread safety</em>. You should now know that servlets and filters are shared among all requests. That’s the nice thing about Java, it’s multithreaded and different threads (read: HTTP requests) can make use of the same instance. It would otherwise be too expensive to recreate, <code>init()</code> and <code>destroy()</code> them for every single request.</p>
<p>You should also realize that you should <strong>never</strong> assign any request or session scoped data as an <em>instance</em> variable of a servlet or filter. It will be shared among all other requests in other sessions. That’s <strong>not</strong> thread-safe! The below example illustrates this:</p>
<div class="sourceCode" id="cb423"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb423-1"><a href="#cb423-1" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">class</span> ExampleServlet <span class="kw">extends</span> HttpServlet {</span>
<span id="cb423-2"><a href="#cb423-2" aria-hidden="true"></a></span>
<span id="cb423-3"><a href="#cb423-3" aria-hidden="true"></a>    <span class="kw">private</span> <span class="bu">Object</span> thisIsNOTThreadSafe;</span>
<span id="cb423-4"><a href="#cb423-4" aria-hidden="true"></a></span>
<span id="cb423-5"><a href="#cb423-5" aria-hidden="true"></a>    <span class="kw">protected</span> <span class="dt">void</span> <span class="fu">doGet</span>(HttpServletRequest request, HttpServletResponse response) <span class="kw">throws</span> ServletException, <span class="bu">IOException</span> {</span>
<span id="cb423-6"><a href="#cb423-6" aria-hidden="true"></a>        <span class="bu">Object</span> thisIsThreadSafe;</span>
<span id="cb423-7"><a href="#cb423-7" aria-hidden="true"></a></span>
<span id="cb423-8"><a href="#cb423-8" aria-hidden="true"></a>        thisIsNOTThreadSafe = request.<span class="fu">getParameter</span>(<span class="st">&quot;foo&quot;</span>); <span class="co">// BAD!! Shared among all requests!</span></span>
<span id="cb423-9"><a href="#cb423-9" aria-hidden="true"></a>        thisIsThreadSafe = request.<span class="fu">getParameter</span>(<span class="st">&quot;foo&quot;</span>); <span class="co">// OK, this is thread safe.</span></span>
<span id="cb423-10"><a href="#cb423-10" aria-hidden="true"></a>    } </span>
<span id="cb423-11"><a href="#cb423-11" aria-hidden="true"></a>}</span></code></pre></div>
<h5>
See also:
</h3>
<ul>
<li>
<a href="https://stackoverflow.com/questions/2095397/what-is-the-difference-between-jsf-servlet-and-jsp">What is the difference between JSF, Servlet and JSP?</a>
</li>
<li>
<a href="https://stackoverflow.com/questions/1700390/best-option-for-session-management-in-java">Best option for Session management in Java</a>
</li>
<li>
<a href="https://stackoverflow.com/questions/4140448/difference-between-and-in-servlet-mapping-url-pattern">Difference between / and /* in servlet mapping url pattern</a>
</li>
<li>
<a href="https://stackoverflow.com/questions/2349633/doget-and-dopost-in-servlets">doGet and doPost in Servlets</a>
</li>
<li>
<a href="https://stackoverflow.com/questions/8011138/servlet-seems-to-handle-multiple-concurrent-requests-synchronously/">Servlet seems to handle multiple concurrent browser requests synchronously</a>
</li>
<li>
<a href="https://stackoverflow.com/questions/9555842/why-servlets-are-not-thread-safe/">Why Servlets are not thread Safe?</a>
</li>
</ul>
</section>
<section id="answer-2-score-424" class="level4">
<h4>Answer 2 (score 424)</h4>
<h5>
Sessions
</h2>
<p>
<img src="https://i.stack.imgur.com/ABDSX.png" alt="enter image description here"> <img src="https://i.stack.imgur.com/IWAF3.png" alt="enter image description here">
</p>
<p>In short: the web server issues a unique identifier to <em>each visitor</em> on his <em>first</em> visit. The visitor must bring back that ID for him to be recognised next time around. This identifier also allows the server to properly segregate objects owned by one session against that of another.</p>
<h5>
Servlet Instantiation
</h2>
<p>If <strong>load-on-startup</strong> is <strong>false</strong>:</p>
<p>
<img src="https://i.stack.imgur.com/Jjvcb.png" alt="enter image description here"> <img src="https://i.stack.imgur.com/7Bw3x.png" alt="enter image description here">
</p>
<p>If <strong>load-on-startup</strong> is <strong>true</strong>:</p>
<p>
<img src="https://i.stack.imgur.com/t33bd.png" alt="enter image description here"> <img src="https://i.stack.imgur.com/e7BB7.png" alt="enter image description here">
</p>
<p>Once he’s on the service mode and on the groove, the <em>same</em> servlet will work on the requests from all other clients.</p>
<p><img src="https://i.stack.imgur.com/gqoR4.png" alt="enter image description here"></p>
<p>Why isn’t it a good idea to have one instance per client? Think about this: Will you hire one pizza guy for every order that came? Do that and you’d be out of business in no time.</p>
<p>It comes with a small risk though. Remember: this single guy holds all the order information in his pocket: so if you’re not cautious about <a href="http://tutorials.jenkov.com/java-servlets/servlet-concurrency.html" rel="noreferrer">thread safety on servlets</a>, he may end up giving the wrong order to a certain client.</p>
</section>
<section id="answer-3-score-42" class="level4">
<h4>Answer 3 (score 42)</h4>
<p>Session in Java servlets is the same as session in other languages such as PHP. It is unique to the user. The server can keep track of it in different ways such as cookies, url rewriting etc. This <a href="http://java.sun.com/products/servlet/2.2/javadoc/javax/servlet/http/HttpSession.html" rel="noreferrer">Java doc</a> article explains it in the context of Java servlets and indicates that exactly how session is maintained is an implementation detail left to the designers of the server. The specification only stipulates that it must be maintained as unique to a user across multiple connections to the server. Check out <a href="http://download.oracle.com/docs/cd/A97336_01/buslog.102/a83726/tecbkgn2.htm" rel="noreferrer">this article from Oracle</a> for more information about both of your questions.</p>
<p><strong>Edit</strong> There is an excellent tutorial <a href="http://www.apl.jhu.edu/~hall/java/Servlet-Tutorial/Servlet-Tutorial-Session-Tracking.html" rel="noreferrer">here</a> on how to work with session inside of servlets. And <a href="http://docs.oracle.com/javaee/5/tutorial/doc/bnafd.html" rel="noreferrer">here</a> is a chapter from Sun about Java Servlets, what they are and how to use them. Between those two articles, you should be able to answer all of your questions.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="why-dont-javas---compound-assignment-operators-require-casting-score-275111-in-2018" class="level3">
<h3>64: Why don’t Java’s +=, -=, *=, /= compound assignment operators require casting? (score <a href="https://stackoverflow.com/q/8710619.html">275111</a> in 2018)</h3>
<section id="question-62" class="level4">
<h4>Question</h4>
<p>Until today, I thought that for example:</p>
<div class="sourceCode" id="cb424"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb424-1"><a href="#cb424-1" aria-hidden="true"></a>i += j;</span></code></pre></div>
<p>Was just a shortcut for:</p>
<div class="sourceCode" id="cb425"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb425-1"><a href="#cb425-1" aria-hidden="true"></a>i = i + j;</span></code></pre></div>
<p>But if we try this:</p>
<div class="sourceCode" id="cb426"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb426-1"><a href="#cb426-1" aria-hidden="true"></a><span class="dt">int</span> i = <span class="dv">5</span>;</span>
<span id="cb426-2"><a href="#cb426-2" aria-hidden="true"></a><span class="dt">long</span> j = <span class="dv">8</span>;</span></code></pre></div>
<p>Then <code>i = i + j;</code> will not compile but <code>i += j;</code> will compile fine.</p>
<p>
Does it mean that in fact <code>i += j;</code> is a shortcut for something like this <code>i = (type of i) (i + j)</code>?
</p>
</section>
<section id="answer-accepted-score-2385" class="level4">
<h4>Answer accepted (score 2385)</h4>
<p>As always with these questions, the JLS holds the answer. In this case <a href="http://docs.oracle.com/javase/specs/jls/se8/html/jls-15.html
#jls-15.26.2">§15.26.2 Compound Assignment Operators</a>. An extract:</p>
<blockquote>
A compound assignment expression of the form <code>E1&amp;nbsp;op=&amp;nbsp;E2</code> is equivalent to <code>E1&amp;nbsp;=&amp;nbsp;(T)((E1)&amp;nbsp;op&amp;nbsp;(E2))</code>, where <code>T</code> is the type of <code>E1</code>, except that <code>E1</code> is evaluated only once.
</blockquote>
<p>An example cited from <a href="http://docs.oracle.com/javase/specs/jls/se8/html/jls-15.html
#jls-15.26.2">§15.26.2</a></p>
<blockquote>
<p>[…] the following code is correct:</p>
<div class="sourceCode" id="cb427"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb427-1"><a href="#cb427-1" aria-hidden="true"></a><span class="dt">short</span> x = <span class="dv">3</span>;</span>
<span id="cb427-2"><a href="#cb427-2" aria-hidden="true"></a>x += <span class="fl">4.</span><span class="dv">6</span>;</span></code></pre></div>
<p>and results in x having the value 7 because it is equivalent to:</p>
<div class="sourceCode" id="cb428"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb428-1"><a href="#cb428-1" aria-hidden="true"></a><span class="dt">short</span> x = <span class="dv">3</span>;</span>
<span id="cb428-2"><a href="#cb428-2" aria-hidden="true"></a>x = (<span class="dt">short</span>)(x + <span class="fl">4.</span><span class="dv">6</span>);</span></code></pre></div>
</blockquote>
<p>In other words, your assumption is correct.</p>
</section>
<section id="answer-2-score-471" class="level4">
<h4>Answer 2 (score 471)</h4>
<p>A good example of this casting is using *= or /=</p>
<div class="sourceCode" id="cb429"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb429-1"><a href="#cb429-1" aria-hidden="true"></a><span class="dt">byte</span> b = <span class="dv">10</span>;</span>
<span id="cb429-2"><a href="#cb429-2" aria-hidden="true"></a>b *= <span class="fl">5.</span><span class="dv">7</span>;</span>
<span id="cb429-3"><a href="#cb429-3" aria-hidden="true"></a><span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(b); <span class="co">// prints 57</span></span></code></pre></div>
<p>or</p>
<div class="sourceCode" id="cb430"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb430-1"><a href="#cb430-1" aria-hidden="true"></a><span class="dt">byte</span> b = <span class="dv">100</span>;</span>
<span id="cb430-2"><a href="#cb430-2" aria-hidden="true"></a>b /= <span class="fl">2.</span><span class="dv">5</span>;</span>
<span id="cb430-3"><a href="#cb430-3" aria-hidden="true"></a><span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(b); <span class="co">// prints 40</span></span></code></pre></div>
<p>or</p>
<div class="sourceCode" id="cb431"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb431-1"><a href="#cb431-1" aria-hidden="true"></a><span class="dt">char</span> ch = <span class="ch">&#39;0&#39;</span>;</span>
<span id="cb431-2"><a href="#cb431-2" aria-hidden="true"></a>ch *= <span class="fl">1.</span><span class="dv">1</span>;</span>
<span id="cb431-3"><a href="#cb431-3" aria-hidden="true"></a><span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(ch); <span class="co">// prints &#39;4&#39;</span></span></code></pre></div>
<p>or</p>
<div class="sourceCode" id="cb432"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb432-1"><a href="#cb432-1" aria-hidden="true"></a><span class="dt">char</span> ch = <span class="ch">&#39;A&#39;</span>;</span>
<span id="cb432-2"><a href="#cb432-2" aria-hidden="true"></a>ch *= <span class="fl">1.</span><span class="dv">5</span>;</span>
<span id="cb432-3"><a href="#cb432-3" aria-hidden="true"></a><span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(ch); <span class="co">// prints &#39;a&#39;</span></span></code></pre></div>
</section>
<section id="answer-3-score-243" class="level4">
<h4>Answer 3 (score 243)</h4>
<p>Very good question. The <a href="http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html
#jls-15.26.2" rel="noreferrer">Java Language specification</a> confirms your suggestion.</p>
<blockquote>
<p>For example, the following code is correct:</p>
<div class="sourceCode" id="cb433"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb433-1"><a href="#cb433-1" aria-hidden="true"></a><span class="dt">short</span> x = <span class="dv">3</span>;</span>
<span id="cb433-2"><a href="#cb433-2" aria-hidden="true"></a>x += <span class="fl">4.</span><span class="dv">6</span>;</span></code></pre></div>
<p>and results in x having the value 7 because it is equivalent to:</p>
<div class="sourceCode" id="cb434"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb434-1"><a href="#cb434-1" aria-hidden="true"></a><span class="dt">short</span> x = <span class="dv">3</span>;</span>
<span id="cb434-2"><a href="#cb434-2" aria-hidden="true"></a>x = (<span class="dt">short</span>)(x + <span class="fl">4.</span><span class="dv">6</span>);</span></code></pre></div>
</blockquote>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-to-avoid-java-code-in-jsp-files-score-274966-in-2015" class="level3">
<h3>65: How to avoid Java code in JSP files? (score <a href="https://stackoverflow.com/q/3177733.html">274966</a> in 2015)</h3>
<section id="question-63" class="level4">
<h4>Question</h4>
<p>I’m new to Java EE and I know that something like the following three lines</p>
<div class="sourceCode" id="cb435"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb435-1"><a href="#cb435-1" aria-hidden="true"></a>&lt;%= x+<span class="dv">1</span> %&gt;</span>
<span id="cb435-2"><a href="#cb435-2" aria-hidden="true"></a>&lt;%= request.<span class="fu">getParameter</span>(<span class="st">&quot;name&quot;</span>) %&gt;</span>
<span id="cb435-3"><a href="#cb435-3" aria-hidden="true"></a>&lt;%! counter++; %&gt;</span></code></pre></div>
<p>is an old school way of coding and in JSP version 2 there exists a method to avoid Java code in JSP files. Can someone please tell me the alternative JSP 2 lines, and what this technique is called?</p>
</section>
<section id="answer-accepted-score-1943" class="level4">
<h4>Answer accepted (score 1943)</h4>
<p>The use of <em>scriptlets</em> (those <code>&amp;lt;% %&amp;gt;</code> things) in <a href="https://stackoverflow.com/tags/jsp/info">JSP</a> is indeed highly discouraged since the birth of <em>taglibs</em> (like <a href="https://stackoverflow.com/tags/jstl/info">JSTL</a>) and <a href="https://stackoverflow.com/tags/el/info">EL</a> (<a href="https://stackoverflow.com/tags/el/info">Expression Language</a>, those <code>${}</code> things) way back in 2001.</p>
<p>The major disadvantages of <em>scriptlets</em> are:</p>
<ol>
<li>
<strong>Reusability:</strong> you can’t reuse scriptlets.
</li>
<li>
<strong>Replaceability:</strong> you can’t make scriptlets abstract.
</li>
<li>
<strong>OO-ability:</strong> you can’t make use of inheritance/composition.
</li>
<li>
<strong>Debuggability:</strong> if scriptlet throws an exception halfway, all you get is a blank page.
</li>
<li>
<strong>Testability:</strong> scriptlets are not unit-testable.
</li>
<li>
<strong>Maintainability:</strong> per saldo more time is needed to maintain mingled/cluttered/duplicated code logic.
</li>
</ol>
<p><strike>Sun</strike> Oracle itself also recommends in the <a href="http://www.oracle.com/technetwork/articles/javase/code-convention-138726.html" rel="noreferrer">JSP coding conventions</a> to avoid use of <em>scriptlets</em> whenever the same functionality is possible by (tag) classes. Here are several cites of relevance:</p>
<blockquote>
<p>From JSP 1.2 Specification, it is highly recommended that the JSP Standard Tag Library (JSTL) be used in your web application to help <strong>reduce the need for JSP scriptlets</strong> in your pages. Pages that use JSTL are, in general, easier to read and maintain.</p>
<p>…</p>
<p>Where possible, <strong>avoid JSP scriptlets</strong> whenever tag libraries provide equivalent functionality. This makes pages easier to read and maintain, helps to separate business logic from presentation logic, and will make your pages easier to evolve into JSP 2.0-style pages (JSP 2.0 Specification supports but de-emphasizes the use of scriptlets).</p>
<p>…</p>
In the spirit of adopting the model-view-controller (MVC) design pattern to reduce coupling between the presentation tier from the business logic, <strong>JSP scriptlets should not be used</strong> for writing business logic. Rather, JSP scriptlets are used if necessary to transform data (also called “value objects”) returned from processing the client’s requests into a proper client-ready format. Even then, this would be better done with a front controller servlet or a custom tag.
</blockquote>
<hr>
<p><strong>How to replace <em>scriptlets</em> entirely depends on the sole purpose of the code/logic. More than often this code is to be placed in a fullworthy Java class:</strong></p>
<ul>
<li>
<p>
If you want to invoke the <strong>same</strong> Java code on <em>every</em> request, less-or-more regardless of the requested page, e.g. checking if a user is logged in, then implement a <a href="https://stackoverflow.com/tags/servlet-filters/info">filter</a> and write code accordingly in <a href="http://docs.oracle.com/javaee/7/api/javax/servlet/Filter.html
#doFilter%28javax.servlet.ServletRequest,%20javax.servlet.ServletResponse,%20javax.servlet.FilterChain%29" rel="noreferrer"><code>doFilter()</code></a> method. E.g.:
</p>
<div class="sourceCode" id="cb436"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb436-1"><a href="#cb436-1" aria-hidden="true"></a><span class="kw">public</span> <span class="dt">void</span> <span class="fu">doFilter</span>(ServletRequest request, ServletResponse response, FilterChain chain) <span class="kw">throws</span> ServletException, <span class="bu">IOException</span> {</span>
<span id="cb436-2"><a href="#cb436-2" aria-hidden="true"></a>    <span class="kw">if</span> (((HttpServletRequest) request).<span class="fu">getSession</span>().<span class="fu">getAttribute</span>(<span class="st">&quot;user&quot;</span>) == <span class="kw">null</span>) {</span>
<span id="cb436-3"><a href="#cb436-3" aria-hidden="true"></a>        ((HttpServletResponse) response).<span class="fu">sendRedirect</span>(<span class="st">&quot;login&quot;</span>); <span class="co">// Not logged in, redirect to login page.</span></span>
<span id="cb436-4"><a href="#cb436-4" aria-hidden="true"></a>    } <span class="kw">else</span> {</span>
<span id="cb436-5"><a href="#cb436-5" aria-hidden="true"></a>        chain.<span class="fu">doFilter</span>(request, response); <span class="co">// Logged in, just continue request.</span></span>
<span id="cb436-6"><a href="#cb436-6" aria-hidden="true"></a>    }</span>
<span id="cb436-7"><a href="#cb436-7" aria-hidden="true"></a>}</span></code></pre></div>
<p>When mapped on an appropriate <code>&amp;lt;url-pattern&amp;gt;</code> covering the JSP pages of interest, then you don’t need to copypaste the same piece of code overall JSP pages.</p>
<hr>
</li>
<li>
<p>
If you want to invoke some Java code to <strong>preprocess</strong> a request, e.g. preloading some list from a database to display in some table, if necessary based on some query parameters, then implement a <a href="https://stackoverflow.com/tags/servlets/info">servlet</a> and write code accordingly in <a href="http://docs.oracle.com/javaee/7/api/javax/servlet/http/HttpServlet.html
#doGet%28javax.servlet.http.HttpServletRequest,%20javax.servlet.http.HttpServletResponse%29" rel="noreferrer"><code>doGet()</code></a> method. E.g.:
</p>
<div class="sourceCode" id="cb437"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb437-1"><a href="#cb437-1" aria-hidden="true"></a><span class="kw">protected</span> <span class="dt">void</span> <span class="fu">doGet</span>(HttpServletRequest request, HttpServletResponse response) <span class="kw">throws</span> ServletException, <span class="bu">IOException</span> {</span>
<span id="cb437-2"><a href="#cb437-2" aria-hidden="true"></a>    <span class="kw">try</span> {</span>
<span id="cb437-3"><a href="#cb437-3" aria-hidden="true"></a>        <span class="bu">List</span>&lt;Product&gt; products = productService.<span class="fu">list</span>(); <span class="co">// Obtain all products.</span></span>
<span id="cb437-4"><a href="#cb437-4" aria-hidden="true"></a>        request.<span class="fu">setAttribute</span>(<span class="st">&quot;products&quot;</span>, products); <span class="co">// Store products in request scope.</span></span>
<span id="cb437-5"><a href="#cb437-5" aria-hidden="true"></a>        request.<span class="fu">getRequestDispatcher</span>(<span class="st">&quot;/WEB-INF/products.jsp&quot;</span>).<span class="fu">forward</span>(request, response); <span class="co">// Forward to JSP page to display them in a HTML table.</span></span>
<span id="cb437-6"><a href="#cb437-6" aria-hidden="true"></a>    } <span class="kw">catch</span> (<span class="bu">SQLException</span> e) {</span>
<span id="cb437-7"><a href="#cb437-7" aria-hidden="true"></a>        <span class="kw">throw</span> <span class="kw">new</span> <span class="fu">ServletException</span>(<span class="st">&quot;Retrieving products failed!&quot;</span>, e);</span>
<span id="cb437-8"><a href="#cb437-8" aria-hidden="true"></a>    }</span>
<span id="cb437-9"><a href="#cb437-9" aria-hidden="true"></a>}</span></code></pre></div>
<p>This way dealing with exceptions is easier. The DB is not accessed in the midst of JSP rendering, but far before the JSP is been displayed. You still have the possibility to change the response whenever the DB access throws an exception. In the above example, the default error 500 page will be displayed which you can anyway customize by an <code>&amp;lt;error-page&amp;gt;</code> in <code>web.xml</code>.</p>
<hr>
</li>
<li>
<p>
If you want to invoke some Java code to <strong>postprocess</strong> a request, e.g. processing a form submit, then implement a <a href="https://stackoverflow.com/tags/servlets/info">servlet</a> and write code accordingly in <a href="http://docs.oracle.com/javaee/7/api/javax/servlet/http/HttpServlet.html
#doPost%28javax.servlet.http.HttpServletRequest,%20javax.servlet.http.HttpServletResponse%29" rel="noreferrer"><code>doPost()</code></a> method. E.g.:
</p>
<div class="sourceCode" id="cb438"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb438-1"><a href="#cb438-1" aria-hidden="true"></a><span class="kw">protected</span> <span class="dt">void</span> <span class="fu">doPost</span>(HttpServletRequest request, HttpServletResponse response) <span class="kw">throws</span> ServletException, <span class="bu">IOException</span> {</span>
<span id="cb438-2"><a href="#cb438-2" aria-hidden="true"></a>    <span class="bu">String</span> username = request.<span class="fu">getParameter</span>(<span class="st">&quot;username&quot;</span>);</span>
<span id="cb438-3"><a href="#cb438-3" aria-hidden="true"></a>    <span class="bu">String</span> password = request.<span class="fu">getParameter</span>(<span class="st">&quot;password&quot;</span>);</span>
<span id="cb438-4"><a href="#cb438-4" aria-hidden="true"></a>    User user = userService.<span class="fu">find</span>(username, password);</span>
<span id="cb438-5"><a href="#cb438-5" aria-hidden="true"></a></span>
<span id="cb438-6"><a href="#cb438-6" aria-hidden="true"></a>    <span class="kw">if</span> (user != <span class="kw">null</span>) {</span>
<span id="cb438-7"><a href="#cb438-7" aria-hidden="true"></a>        request.<span class="fu">getSession</span>().<span class="fu">setAttribute</span>(<span class="st">&quot;user&quot;</span>, user); <span class="co">// Login user.</span></span>
<span id="cb438-8"><a href="#cb438-8" aria-hidden="true"></a>        response.<span class="fu">sendRedirect</span>(<span class="st">&quot;home&quot;</span>); <span class="co">// Redirect to home page.</span></span>
<span id="cb438-9"><a href="#cb438-9" aria-hidden="true"></a>    } <span class="kw">else</span> {</span>
<span id="cb438-10"><a href="#cb438-10" aria-hidden="true"></a>        request.<span class="fu">setAttribute</span>(<span class="st">&quot;message&quot;</span>, <span class="st">&quot;Unknown username/password. Please retry.&quot;</span>); <span class="co">// Store error message in request scope.</span></span>
<span id="cb438-11"><a href="#cb438-11" aria-hidden="true"></a>        request.<span class="fu">getRequestDispatcher</span>(<span class="st">&quot;/WEB-INF/login.jsp&quot;</span>).<span class="fu">forward</span>(request, response); <span class="co">// Forward to JSP page to redisplay login form with error.</span></span>
<span id="cb438-12"><a href="#cb438-12" aria-hidden="true"></a>    }</span>
<span id="cb438-13"><a href="#cb438-13" aria-hidden="true"></a>}</span></code></pre></div>
<p>This way dealing with different result page destinations is easier: redisplaying the form with validation errors in case of an error (in this particular example you can redisplay it using <code>${message}</code> in <a href="https://stackoverflow.com/tags/el/info">EL</a>), or just taking to the desired target page in case of success.</p>
<hr>
</li>
<li>
<p>
If you want to invoke some Java code to <strong>control</strong> the execution plan and/or the destination of the request and the response, then implement a <a href="https://stackoverflow.com/tags/servlets/info">servlet</a> according to the <a href="https://stackoverflow.com/questions/3541077/design-patterns-web-based-applications/3542297
#3542297">MVC’s Front Controller Pattern</a>. E.g.:
</p>
<div class="sourceCode" id="cb439"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb439-1"><a href="#cb439-1" aria-hidden="true"></a><span class="kw">protected</span> <span class="dt">void</span> <span class="fu">service</span>(HttpServletRequest request, HttpServletResponse response) <span class="kw">throws</span> ServletException, <span class="bu">IOException</span> {</span>
<span id="cb439-2"><a href="#cb439-2" aria-hidden="true"></a>    <span class="kw">try</span> {</span>
<span id="cb439-3"><a href="#cb439-3" aria-hidden="true"></a>        <span class="bu">Action</span> action = ActionFactory.<span class="fu">getAction</span>(request);</span>
<span id="cb439-4"><a href="#cb439-4" aria-hidden="true"></a>        <span class="bu">String</span> view = action.<span class="fu">execute</span>(request, response);</span>
<span id="cb439-5"><a href="#cb439-5" aria-hidden="true"></a></span>
<span id="cb439-6"><a href="#cb439-6" aria-hidden="true"></a>        <span class="kw">if</span> (view.<span class="fu">equals</span>(request.<span class="fu">getPathInfo</span>().<span class="fu">substring</span>(<span class="dv">1</span>)) {</span>
<span id="cb439-7"><a href="#cb439-7" aria-hidden="true"></a>            request.<span class="fu">getRequestDispatcher</span>(<span class="st">&quot;/WEB-INF/&quot;</span> + view + <span class="st">&quot;.jsp&quot;</span>).<span class="fu">forward</span>(request, response);</span>
<span id="cb439-8"><a href="#cb439-8" aria-hidden="true"></a>        } <span class="kw">else</span> {</span>
<span id="cb439-9"><a href="#cb439-9" aria-hidden="true"></a>            response.<span class="fu">sendRedirect</span>(view);</span>
<span id="cb439-10"><a href="#cb439-10" aria-hidden="true"></a>        }</span>
<span id="cb439-11"><a href="#cb439-11" aria-hidden="true"></a>    } <span class="kw">catch</span> (<span class="bu">Exception</span> e) {</span>
<span id="cb439-12"><a href="#cb439-12" aria-hidden="true"></a>        <span class="kw">throw</span> <span class="kw">new</span> <span class="fu">ServletException</span>(<span class="st">&quot;Executing action failed.&quot;</span>, e);</span>
<span id="cb439-13"><a href="#cb439-13" aria-hidden="true"></a>    }</span>
<span id="cb439-14"><a href="#cb439-14" aria-hidden="true"></a>}</span></code></pre></div>
<p>Or just adopt an MVC framework like <a href="https://stackoverflow.com/tags/jsf/info">JSF</a>, <a href="https://stackoverflow.com/tags/spring-mvc/info">Spring MVC</a>, <a href="https://stackoverflow.com/tags/wicket/info">Wicket</a>, etc so that you end up with just a JSP/Facelets page and a JavaBean class without the need for a custom servlet.</p>
<hr>
</li>
<li>
<p>
If you want to invoke some Java code to <strong>control the flow</strong> inside a JSP page, then you need to grab an (existing) flow control taglib like <a href="http://docs.oracle.com/javaee/5/jstl/1.1/docs/tlddocs/c/tld-summary.html" rel="noreferrer">JSTL core</a>. E.g. displaying <code>List&amp;lt;Product&amp;gt;</code> in a table:
</p>
<div class="sourceCode" id="cb440"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb440-1"><a href="#cb440-1" aria-hidden="true"></a>&lt;%@ taglib uri=<span class="st">&quot;http://java.sun.com/jsp/jstl/core&quot;</span> prefix=<span class="st">&quot;c&quot;</span> %&gt;</span>
<span id="cb440-2"><a href="#cb440-2" aria-hidden="true"></a>...</span>
<span id="cb440-3"><a href="#cb440-3" aria-hidden="true"></a>&lt;table&gt;</span>
<span id="cb440-4"><a href="#cb440-4" aria-hidden="true"></a>    &lt;c:forEach items=<span class="st">&quot;${products}&quot;</span> var=<span class="st">&quot;product&quot;</span>&gt;</span>
<span id="cb440-5"><a href="#cb440-5" aria-hidden="true"></a>        &lt;tr&gt;</span>
<span id="cb440-6"><a href="#cb440-6" aria-hidden="true"></a>            &lt;td&gt;${product.<span class="fu">name</span>}&lt;/td&gt;</span>
<span id="cb440-7"><a href="#cb440-7" aria-hidden="true"></a>            &lt;td&gt;${product.<span class="fu">description</span>}&lt;/td&gt;</span>
<span id="cb440-8"><a href="#cb440-8" aria-hidden="true"></a>            &lt;td&gt;${product.<span class="fu">price</span>}&lt;/td&gt;</span>
<span id="cb440-9"><a href="#cb440-9" aria-hidden="true"></a>        &lt;/tr&gt;</span>
<span id="cb440-10"><a href="#cb440-10" aria-hidden="true"></a>    &lt;/c:forEach&gt;</span>
<span id="cb440-11"><a href="#cb440-11" aria-hidden="true"></a>&lt;/table&gt;</span></code></pre></div>
<p>With XML-style tags which fit nicely among all that HTML, the code is better readable (and thus better maintainable) than a bunch of scriptlets with various opening and closing braces (<em>“Where the heck does this closing brace belong to?”</em>). An easy aid is to configure your web application to throw an exception whenever <em>scriptlets</em> are still been used by adding the following piece to <code>web.xml</code>:</p>
<div class="sourceCode" id="cb441"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb441-1"><a href="#cb441-1" aria-hidden="true"></a>&lt;jsp-config&gt;</span>
<span id="cb441-2"><a href="#cb441-2" aria-hidden="true"></a>    &lt;jsp-property-group&gt;</span>
<span id="cb441-3"><a href="#cb441-3" aria-hidden="true"></a>        &lt;url-pattern&gt;*.<span class="fu">jsp</span>&lt;/url-pattern&gt;</span>
<span id="cb441-4"><a href="#cb441-4" aria-hidden="true"></a>        &lt;scripting-invalid&gt;<span class="kw">true</span>&lt;/scripting-invalid&gt;</span>
<span id="cb441-5"><a href="#cb441-5" aria-hidden="true"></a>    &lt;/jsp-property-group&gt;</span>
<span id="cb441-6"><a href="#cb441-6" aria-hidden="true"></a>&lt;/jsp-config&gt;</span></code></pre></div>
<p>In <a href="https://stackoverflow.com/tags/facelets/info">Facelets</a>, the successor of JSP, which is part of the Java EE provided MVC framework <a href="https://stackoverflow.com/tags/jsf/info">JSF</a>, it is already <strong>not</strong> possible to use <em>scriptlets</em>. This way you’re automatically forced to do things “the right way”.</p>
<hr>
</li>
<li>
<p>
If you want to invoke some Java code to <strong>access and display</strong> “backend” data inside a JSP page, then you need to use EL (Expression Language), those <code>${}</code> things. E.g. redisplaying submitted input values:
</p>
<div class="sourceCode" id="cb442"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb442-1"><a href="#cb442-1" aria-hidden="true"></a>&lt;input type=<span class="st">&quot;text&quot;</span> name=<span class="st">&quot;foo&quot;</span> value=<span class="st">&quot;${param.foo}&quot;</span> /&gt;</span></code></pre></div>
<p>The <code>${param.foo}</code> displays the outcome of <code>request.getParameter("foo")</code>.</p>
<hr>
</li>
<li>
<p>
If you want to invoke some <strong>utility</strong> Java code directly in the JSP page (typically <code>public static</code> methods), then you need to define them as EL functions. There’s a standard <a href="http://docs.oracle.com/javaee/5/jstl/1.1/docs/tlddocs/fn/tld-summary.html" rel="noreferrer">functions taglib</a> in JSTL, but <a href="http://docs.oracle.com/javaee/5/tutorial/doc/bnahq.html
#bnaiq" rel="noreferrer">you can also easily create functions yourself</a>. Here’s an example how JSTL <code>fn:escapeXml</code> is useful to prevent <a href="http://en.wikipedia.org/wiki/Cross-site_scripting" rel="noreferrer">XSS</a> <a href="http://ha.ckers.org/xss.html" rel="noreferrer">attacks</a>.
</p>
<div class="sourceCode" id="cb443"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb443-1"><a href="#cb443-1" aria-hidden="true"></a>&lt;%@ taglib uri=<span class="st">&quot;http://java.sun.com/jsp/jstl/functions&quot;</span> prefix=<span class="st">&quot;fn&quot;</span> %&gt;</span>
<span id="cb443-2"><a href="#cb443-2" aria-hidden="true"></a>...</span>
<span id="cb443-3"><a href="#cb443-3" aria-hidden="true"></a>&lt;input type=<span class="st">&quot;text&quot;</span> name=<span class="st">&quot;foo&quot;</span> value=<span class="st">&quot;${fn:escapeXml(param.foo)}&quot;</span> /&gt;</span></code></pre></div>
Note that the XSS sensitivity is in no way specifically related to Java/JSP/JSTL/EL/whatever, this problem needs to be taken into account in <strong>every</strong> web application you develop. The problem of <em>scriptlets</em> is that it provides no way of builtin preventions, at least not using the standard Java API. JSP’s successor Facelets has already implicit HTML escaping, so you don’t need to worry about XSS holes in Facelets.
</li>
</ul>
<h5>
See also:
</h3>
<ul>
<li>
<a href="https://stackoverflow.com/questions/2095397/what-is-the-difference-between-jsf-servlet-and-jsp/2097732
#2097732">What’s the difference between JSP, Servlet and JSF?</a>
</li>
<li>
<a href="https://stackoverflow.com/questions/3106452/java-servlet-instantiation-and-session-variables/3106909
#3106909">How does Servlet, ServletContext, HttpSession and HttpServletRequest/Response work?</a>
</li>
<li>
<a href="https://stackoverflow.com/questions/5003142/jsp-using-mvc-and-jdbc">Basic MVC example with JSP, Servlet and JDBC</a>
</li>
<li>
<a href="https://stackoverflow.com/questions/3541077/design-patterns-web-based-applications/">Design patterns in Java web applications</a>
</li>
<li>
<a href="http://balusc.blogspot.com/2010/01/hidden-features-of-jspservlet.html" rel="noreferrer">Hidden features of JSP/Servlet</a>
</li>
</ul>
</section>
<section id="answer-2-score-223" class="level4">
<h4>Answer 2 (score 223)</h4>
<p><strong>As a Safeguard: Disable Scriptlets For Good</strong></p>
<p>As <a href="https://stackoverflow.com/questions/2188706/how-to-avoid-using-scriptlets-in-my-jsp-page">another question</a> is discussing, you can and always should disable scriptlets in your <code>web.xml</code> web application descriptor.</p>
<p>I would always do that in order to prevent any developer adding scriptlets, especially in bigger companies where you will lose overview sooner or later. The <code>web.xml</code> settings look like this:</p>
<div class="sourceCode" id="cb444"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb444-1"><a href="#cb444-1" aria-hidden="true"></a>&lt;jsp-config&gt;</span>
<span id="cb444-2"><a href="#cb444-2" aria-hidden="true"></a>  &lt;jsp-property-group&gt;</span>
<span id="cb444-3"><a href="#cb444-3" aria-hidden="true"></a>    &lt;url-pattern&gt;*.<span class="fu">jsp</span>&lt;/url-pattern&gt;</span>
<span id="cb444-4"><a href="#cb444-4" aria-hidden="true"></a>     &lt;scripting-invalid&gt;<span class="kw">true</span>&lt;/scripting-invalid&gt;</span>
<span id="cb444-5"><a href="#cb444-5" aria-hidden="true"></a>  &lt;/jsp-property-group&gt;</span>
<span id="cb444-6"><a href="#cb444-6" aria-hidden="true"></a>&lt;/jsp-config&gt;</span></code></pre></div>
</section>
<section id="answer-3-score-107" class="level4">
<h4>Answer 3 (score 107)</h4>
<p><a href="https://jstl.java.net/" rel="noreferrer">JSTL</a> offers tags for conditionals, loops, sets, gets, etc. For example:</p>
<div class="sourceCode" id="cb445"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb445-1"><a href="#cb445-1" aria-hidden="true"></a>&lt;c:<span class="kw">if</span> test=<span class="st">&quot;${someAttribute == &#39;something&#39;}&quot;</span>&gt;</span>
<span id="cb445-2"><a href="#cb445-2" aria-hidden="true"></a>   ...</span>
<span id="cb445-3"><a href="#cb445-3" aria-hidden="true"></a>&lt;/c:<span class="kw">if</span>&gt;</span></code></pre></div>
<p>JSTL works with request attributes - they are most often set in the request by a Servlet, which <em>forwards</em> to the JSP.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="fastest-way-to-determine-if-an-integers-square-root-is-an-integer-score-262060-in-2018" class="level3">
<h3>66: Fastest way to determine if an integer’s square root is an integer (score <a href="https://stackoverflow.com/q/295579.html">262060</a> in 2018)</h3>
<section id="question-64" class="level4">
<h4>Question</h4>
<p>I’m looking for the fastest way to determine if a <code>long</code> value is a perfect square (i.e. its square root is another integer):</p>
<ol>
<li>
I’ve done it the easy way, by using the built-in <code>Math.sqrt()</code> function, but I’m wondering if there is a way to do it faster by restricting yourself to integer-only domain.
</li>
<li>
Maintaining a lookup table is impractical (since there are about 2<sup>31.5</sup> integers whose square is less than 2<sup>63</sup>).
</li>
</ol>
<p>Here is the very simple and straightforward way I’m doing it now:</p>
<div class="sourceCode" id="cb446"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb446-1"><a href="#cb446-1" aria-hidden="true"></a><span class="kw">public</span> <span class="dt">final</span> <span class="dt">static</span> <span class="dt">boolean</span> <span class="fu">isPerfectSquare</span>(<span class="dt">long</span> n)</span>
<span id="cb446-2"><a href="#cb446-2" aria-hidden="true"></a>{</span>
<span id="cb446-3"><a href="#cb446-3" aria-hidden="true"></a>  <span class="kw">if</span> (n &lt; <span class="dv">0</span>)</span>
<span id="cb446-4"><a href="#cb446-4" aria-hidden="true"></a>    <span class="kw">return</span> <span class="kw">false</span>;</span>
<span id="cb446-5"><a href="#cb446-5" aria-hidden="true"></a></span>
<span id="cb446-6"><a href="#cb446-6" aria-hidden="true"></a>  <span class="dt">long</span> tst = (<span class="dt">long</span>)(<span class="bu">Math</span>.<span class="fu">sqrt</span>(n) + <span class="fl">0.</span><span class="dv">5</span>);</span>
<span id="cb446-7"><a href="#cb446-7" aria-hidden="true"></a>  <span class="kw">return</span> tst*tst == n;</span>
<span id="cb446-8"><a href="#cb446-8" aria-hidden="true"></a>}</span></code></pre></div>
<p><sub>Note: I’m using this function in many <a href="http://projecteuler.net/" rel="noreferrer">Project Euler</a> problems. So no one else will ever have to maintain this code. And this kind of micro-optimization could actually make a difference, since part of the challenge is to do every algorithm in less than a minute, and this function will need to be called millions of times in some problems.</sub></p>
<hr>
<p>I’ve tried the different solutions to the problem:</p>
<ul>
<li>
After exhaustive testing, I found that adding <code>0.5</code> to the result of Math.sqrt() is not necessary, at least not on my machine.
</li>
<li>
The <a href="https://en.wikipedia.org/wiki/Fast_inverse_square_root" rel="noreferrer">fast inverse square root</a> was faster, but it gave incorrect results for n &gt;= 410881. However, as suggested by <a href="https://stackoverflow.com/users/38426/bobbyshaftoe">BobbyShaftoe</a>, we can use the FISR hack for n &lt; 410881.
</li>
<li>
Newton’s method was a good bit slower than <code>Math.sqrt()</code>. This is probably because <code>Math.sqrt()</code> uses something similar to Newton’s Method, but implemented in the hardware so it’s much faster than in Java. Also, Newton’s Method still required use of doubles.
</li>
<li>
A modified Newton’s method, which used a few tricks so that only integer math was involved, required some hacks to avoid overflow (I want this function to work with all positive 64-bit signed integers), and it was still slower than <code>Math.sqrt()</code>.
</li>
<li>
Binary chop was even slower. This makes sense because the binary chop will on average require 16 passes to find the square root of a 64-bit number.
</li>
<li>
According to John’s tests, using <code>or</code> statements is faster in C++ than using a <code>switch</code>, but in Java and C # there appears to be no difference between <code>or</code> and <code>switch</code>.
</li>
<li>
I also tried making a lookup table (as a private static array of 64 boolean values). Then instead of either switch or <code>or</code> statement, I would just say <code>if(lookup[(int)(n&amp;amp;0x3F)]) { test } else return false;</code>. To my surprise, this was (just slightly) slower. This is because <a href="https://stackoverflow.com/questions/299079/why-is-this-code-with-several-or-statements-slightly-faster-than-using-a-lookup-t
#299205">array bounds are checked in Java</a>.
</li>
</ul>
</section>
<section id="answer-accepted-score-686" class="level4">
<h4>Answer accepted (score 686)</h4>
<p>I figured out a method that works ~35% faster than your 6bits+Carmack+sqrt code, at least with my CPU (x86) and programming language (C/C++). Your results may vary, especially because I don’t know how the Java factor will play out.</p>
<p>My approach is threefold:</p>
<ol>
<li>
<p>First, filter out obvious answers. This includes negative numbers and looking at the last 4 bits. (I found looking at the last six didn’t help.) I also answer yes for 0. (In reading the code below, note that my input is <code>int64 x</code>.)</p>
<div class="sourceCode" id="cb447"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb447-1"><a href="#cb447-1" aria-hidden="true"></a><span class="kw">if</span>( x &lt; <span class="dv">0</span> || (x&amp;<span class="dv">2</span>) || ((x &amp; <span class="dv">7</span>) == <span class="dv">5</span>) || ((x &amp; <span class="dv">11</span>) == <span class="dv">8</span>) )</span>
<span id="cb447-2"><a href="#cb447-2" aria-hidden="true"></a>    <span class="kw">return</span> <span class="kw">false</span>;</span>
<span id="cb447-3"><a href="#cb447-3" aria-hidden="true"></a><span class="kw">if</span>( x == <span class="dv">0</span> )</span>
<span id="cb447-4"><a href="#cb447-4" aria-hidden="true"></a>    <span class="kw">return</span> <span class="kw">true</span>;```</span>
<span id="cb447-5"><a href="#cb447-5" aria-hidden="true"></a>&lt;/li&gt;</span>
<span id="cb447-6"><a href="#cb447-6" aria-hidden="true"></a>&lt;li&gt;Next, check <span class="kw">if</span> it&#39;s a square modulo <span class="dv">255</span> = <span class="dv">3</span> * <span class="dv">5</span> * <span class="fl">17.</span>  Because that&#39;s a product of three distinct primes, only about <span class="dv">1</span>/<span class="dv">8</span> of the residues mod <span class="dv">255</span> are squares.  However, in my experience, calling the modulo <span class="fu">operator</span> (%) costs more than the benefit one gets, so I use bit tricks involving <span class="dv">255</span> = <span class="dv">2</span>^<span class="dv">8</span>-<span class="dv">1</span> to compute the residue.  (For better or worse, I am not using the trick of reading individual bytes out of a word, only bitwise-and and shifts.)</span>
<span id="cb447-7"><a href="#cb447-7" aria-hidden="true"></a>```java</span>
<span id="cb447-8"><a href="#cb447-8" aria-hidden="true"></a>int64 y = x;</span>
<span id="cb447-9"><a href="#cb447-9" aria-hidden="true"></a>y = (y &amp; 4294967295LL) + (y &gt;&gt; <span class="dv">32</span>); </span>
<span id="cb447-10"><a href="#cb447-10" aria-hidden="true"></a>y = (y &amp; <span class="dv">65535</span>) + (y &gt;&gt; <span class="dv">16</span>);</span>
<span id="cb447-11"><a href="#cb447-11" aria-hidden="true"></a>y = (y &amp; <span class="dv">255</span>) + ((y &gt;&gt; <span class="dv">8</span>) &amp; <span class="dv">255</span>) + (y &gt;&gt; <span class="dv">16</span>);</span>
<span id="cb447-12"><a href="#cb447-12" aria-hidden="true"></a><span class="co">// At this point, y is between 0 and 511.  More code can reduce it farther.</span></span>
<span id="cb447-13"><a href="#cb447-13" aria-hidden="true"></a>&lt;/pre&gt;&lt;/code&gt;</span>
<span id="cb447-14"><a href="#cb447-14" aria-hidden="true"></a>To actually check <span class="kw">if</span> the residue is a square, I look up the answer in a precomputed table.</span>
<span id="cb447-15"><a href="#cb447-15" aria-hidden="true"></a>```java</span>
<span id="cb447-16"><a href="#cb447-16" aria-hidden="true"></a><span class="kw">if</span>( bad255[y] )</span>
<span id="cb447-17"><a href="#cb447-17" aria-hidden="true"></a>    <span class="kw">return</span> <span class="kw">false</span>;</span>
<span id="cb447-18"><a href="#cb447-18" aria-hidden="true"></a><span class="co">// However, I just use a table of size 512</span></span></code></pre></div>
</li>
<li>
<p>Finally, try to compute the square root using a method similar to <a href="http://en.wikipedia.org/wiki/Hensel%27s_lemma" rel="noreferrer">Hensel’s lemma</a>. (I don’t think it’s applicable directly, but it works with some modifications.) Before doing that, I divide out all powers of 2 with a binary search:</p>
<div class="sourceCode" id="cb448"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb448-1"><a href="#cb448-1" aria-hidden="true"></a><span class="kw">if</span>((x &amp; 4294967295LL) == <span class="dv">0</span>)</span>
<span id="cb448-2"><a href="#cb448-2" aria-hidden="true"></a>    x &gt;&gt;= <span class="dv">32</span>;</span>
<span id="cb448-3"><a href="#cb448-3" aria-hidden="true"></a><span class="kw">if</span>((x &amp; <span class="dv">65535</span>) == <span class="dv">0</span>)</span>
<span id="cb448-4"><a href="#cb448-4" aria-hidden="true"></a>    x &gt;&gt;= <span class="dv">16</span>;</span>
<span id="cb448-5"><a href="#cb448-5" aria-hidden="true"></a><span class="kw">if</span>((x &amp; <span class="dv">255</span>) == <span class="dv">0</span>)</span>
<span id="cb448-6"><a href="#cb448-6" aria-hidden="true"></a>    x &gt;&gt;= <span class="dv">8</span>;</span>
<span id="cb448-7"><a href="#cb448-7" aria-hidden="true"></a><span class="kw">if</span>((x &amp; <span class="dv">15</span>) == <span class="dv">0</span>)</span>
<span id="cb448-8"><a href="#cb448-8" aria-hidden="true"></a>    x &gt;&gt;= <span class="dv">4</span>;</span>
<span id="cb448-9"><a href="#cb448-9" aria-hidden="true"></a><span class="kw">if</span>((x &amp; <span class="dv">3</span>) == <span class="dv">0</span>)</span>
<span id="cb448-10"><a href="#cb448-10" aria-hidden="true"></a>    x &gt;&gt;= <span class="dv">2</span>;```</span>
<span id="cb448-11"><a href="#cb448-11" aria-hidden="true"></a>At <span class="kw">this</span> point, <span class="kw">for</span> our number to be a square, it must be <span class="dv">1</span> mod <span class="fl">8.</span></span>
<span id="cb448-12"><a href="#cb448-12" aria-hidden="true"></a>```java</span>
<span id="cb448-13"><a href="#cb448-13" aria-hidden="true"></a><span class="kw">if</span>((x &amp; <span class="dv">7</span>) != <span class="dv">1</span>)</span>
<span id="cb448-14"><a href="#cb448-14" aria-hidden="true"></a>    <span class="kw">return</span> <span class="kw">false</span>;```</span>
<span id="cb448-15"><a href="#cb448-15" aria-hidden="true"></a>The basic structure of Hensel&#39;s lemma is the following.  (Note: untested code; <span class="kw">if</span> it doesn&#39;t work, <span class="kw">try</span> t=<span class="dv">2</span> or <span class="fl">8.</span>)</span>
<span id="cb448-16"><a href="#cb448-16" aria-hidden="true"></a>```java</span>
<span id="cb448-17"><a href="#cb448-17" aria-hidden="true"></a>int64 t = <span class="dv">4</span>, r = <span class="dv">1</span>;</span>
<span id="cb448-18"><a href="#cb448-18" aria-hidden="true"></a>t &lt;&lt;= <span class="dv">1</span>; r += ((x - r * r) &amp; t) &gt;&gt; <span class="dv">1</span>;</span>
<span id="cb448-19"><a href="#cb448-19" aria-hidden="true"></a>t &lt;&lt;= <span class="dv">1</span>; r += ((x - r * r) &amp; t) &gt;&gt; <span class="dv">1</span>;</span>
<span id="cb448-20"><a href="#cb448-20" aria-hidden="true"></a>t &lt;&lt;= <span class="dv">1</span>; r += ((x - r * r) &amp; t) &gt;&gt; <span class="dv">1</span>;</span>
<span id="cb448-21"><a href="#cb448-21" aria-hidden="true"></a><span class="co">// Repeat until t is 2^33 or so.  Use a loop if you want.```</span></span>
<span id="cb448-22"><a href="#cb448-22" aria-hidden="true"></a>The idea is that at each iteration, you add one bit onto r, the <span class="st">&quot;current&quot;</span> square root of x; each square root is accurate modulo a larger and larger power of <span class="dv">2</span>, namely t/<span class="fl">2.</span>  At the end, r and t/<span class="dv">2</span>-r will be square roots of x modulo t/<span class="fl">2.</span>  (Note that <span class="kw">if</span> r is a square root of x, then so is -r.  This is <span class="kw">true</span> even modulo numbers, but beware, modulo some numbers, things can have even more than <span class="dv">2</span> square roots; notably, <span class="kw">this</span> includes powers of <span class="fl">2.</span>)  Because our actual square root is less than <span class="dv">2</span>^<span class="dv">32</span>, at that point we can actually just check <span class="kw">if</span> r or t/<span class="dv">2</span>-r are real square roots.  In my actual code, I use the following modified loop:</span>
<span id="cb448-23"><a href="#cb448-23" aria-hidden="true"></a>```java</span>
<span id="cb448-24"><a href="#cb448-24" aria-hidden="true"></a>int64 r, t, z;</span>
<span id="cb448-25"><a href="#cb448-25" aria-hidden="true"></a>r = start[(x &gt;&gt; <span class="dv">3</span>) &amp; <span class="dv">1023</span>];</span>
<span id="cb448-26"><a href="#cb448-26" aria-hidden="true"></a><span class="kw">do</span> {</span>
<span id="cb448-27"><a href="#cb448-27" aria-hidden="true"></a>    z = x - r * r;</span>
<span id="cb448-28"><a href="#cb448-28" aria-hidden="true"></a>    <span class="kw">if</span>( z == <span class="dv">0</span> )</span>
<span id="cb448-29"><a href="#cb448-29" aria-hidden="true"></a>        <span class="kw">return</span> <span class="kw">true</span>;</span>
<span id="cb448-30"><a href="#cb448-30" aria-hidden="true"></a>    <span class="kw">if</span>( z &lt; <span class="dv">0</span> )</span>
<span id="cb448-31"><a href="#cb448-31" aria-hidden="true"></a>        <span class="kw">return</span> <span class="kw">false</span>;</span>
<span id="cb448-32"><a href="#cb448-32" aria-hidden="true"></a>    t = z &amp; (-z);</span>
<span id="cb448-33"><a href="#cb448-33" aria-hidden="true"></a>    r += (z &amp; t) &gt;&gt; <span class="dv">1</span>;</span>
<span id="cb448-34"><a href="#cb448-34" aria-hidden="true"></a>    <span class="kw">if</span>( r &gt; (t &gt;&gt; <span class="dv">1</span>) )</span>
<span id="cb448-35"><a href="#cb448-35" aria-hidden="true"></a>        r = t - r;</span>
<span id="cb448-36"><a href="#cb448-36" aria-hidden="true"></a>} <span class="kw">while</span>( t &lt;= (1LL &lt;&lt; <span class="dv">33</span>) );```</span>
<span id="cb448-37"><a href="#cb448-37" aria-hidden="true"></a>The speedup here is obtained in three ways: precomputed start <span class="fu">value</span> (equivalent to ~<span class="dv">10</span> iterations of the loop), earlier exit of the loop, and skipping some t values.  For the last part, I look at `z = r - x * x`, and set t to be the largest power of <span class="dv">2</span> dividing z with a bit trick.  This allows me to skip t values that wouldn&#39;t have affected the value of r anyway.  The precomputed start value in my <span class="kw">case</span> picks out the <span class="st">&quot;smallest positive&quot;</span> square root modulo <span class="fl">8192.</span></span>
<span id="cb448-38"><a href="#cb448-38" aria-hidden="true"></a>&lt;/li&gt;</span>
<span id="cb448-39"><a href="#cb448-39" aria-hidden="true"></a>&lt;/ol&gt;</span>
<span id="cb448-40"><a href="#cb448-40" aria-hidden="true"></a></span>
<span id="cb448-41"><a href="#cb448-41" aria-hidden="true"></a>Even <span class="kw">if</span> <span class="kw">this</span> code doesn&#39;t work faster <span class="kw">for</span> you, I hope you enjoy some of the ideas it contains.  Complete, tested code follows, including the precomputed tables.  </span>
<span id="cb448-42"><a href="#cb448-42" aria-hidden="true"></a></span>
<span id="cb448-43"><a href="#cb448-43" aria-hidden="true"></a>```java</span>
<span id="cb448-44"><a href="#cb448-44" aria-hidden="true"></a>typedef signed <span class="dt">long</span> <span class="dt">long</span> <span class="dt">int</span> int64;</span>
<span id="cb448-45"><a href="#cb448-45" aria-hidden="true"></a></span>
<span id="cb448-46"><a href="#cb448-46" aria-hidden="true"></a><span class="dt">int</span> start[<span class="dv">1024</span>] =</span>
<span id="cb448-47"><a href="#cb448-47" aria-hidden="true"></a>{<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1769</span>,<span class="dv">5</span>,<span class="dv">1937</span>,<span class="dv">1741</span>,<span class="dv">7</span>,<span class="dv">1451</span>,<span class="dv">479</span>,<span class="dv">157</span>,<span class="dv">9</span>,<span class="dv">91</span>,<span class="dv">945</span>,<span class="dv">659</span>,<span class="dv">1817</span>,<span class="dv">11</span>,</span>
<span id="cb448-48"><a href="#cb448-48" aria-hidden="true"></a><span class="dv">1983</span>,<span class="dv">707</span>,<span class="dv">1321</span>,<span class="dv">1211</span>,<span class="dv">1071</span>,<span class="dv">13</span>,<span class="dv">1479</span>,<span class="dv">405</span>,<span class="dv">415</span>,<span class="dv">1501</span>,<span class="dv">1609</span>,<span class="dv">741</span>,<span class="dv">15</span>,<span class="dv">339</span>,<span class="dv">1703</span>,<span class="dv">203</span>,</span>
<span id="cb448-49"><a href="#cb448-49" aria-hidden="true"></a><span class="dv">129</span>,<span class="dv">1411</span>,<span class="dv">873</span>,<span class="dv">1669</span>,<span class="dv">17</span>,<span class="dv">1715</span>,<span class="dv">1145</span>,<span class="dv">1835</span>,<span class="dv">351</span>,<span class="dv">1251</span>,<span class="dv">887</span>,<span class="dv">1573</span>,<span class="dv">975</span>,<span class="dv">19</span>,<span class="dv">1127</span>,<span class="dv">395</span>,</span>
<span id="cb448-50"><a href="#cb448-50" aria-hidden="true"></a><span class="dv">1855</span>,<span class="dv">1981</span>,<span class="dv">425</span>,<span class="dv">453</span>,<span class="dv">1105</span>,<span class="dv">653</span>,<span class="dv">327</span>,<span class="dv">21</span>,<span class="dv">287</span>,<span class="dv">93</span>,<span class="dv">713</span>,<span class="dv">1691</span>,<span class="dv">1935</span>,<span class="dv">301</span>,<span class="dv">551</span>,<span class="dv">587</span>,</span>
<span id="cb448-51"><a href="#cb448-51" aria-hidden="true"></a><span class="dv">257</span>,<span class="dv">1277</span>,<span class="dv">23</span>,<span class="dv">763</span>,<span class="dv">1903</span>,<span class="dv">1075</span>,<span class="dv">1799</span>,<span class="dv">1877</span>,<span class="dv">223</span>,<span class="dv">1437</span>,<span class="dv">1783</span>,<span class="dv">859</span>,<span class="dv">1201</span>,<span class="dv">621</span>,<span class="dv">25</span>,<span class="dv">779</span>,</span>
<span id="cb448-52"><a href="#cb448-52" aria-hidden="true"></a><span class="dv">1727</span>,<span class="dv">573</span>,<span class="dv">471</span>,<span class="dv">1979</span>,<span class="dv">815</span>,<span class="dv">1293</span>,<span class="dv">825</span>,<span class="dv">363</span>,<span class="dv">159</span>,<span class="dv">1315</span>,<span class="dv">183</span>,<span class="dv">27</span>,<span class="dv">241</span>,<span class="dv">941</span>,<span class="dv">601</span>,<span class="dv">971</span>,</span>
<span id="cb448-53"><a href="#cb448-53" aria-hidden="true"></a><span class="dv">385</span>,<span class="dv">131</span>,<span class="dv">919</span>,<span class="dv">901</span>,<span class="dv">273</span>,<span class="dv">435</span>,<span class="dv">647</span>,<span class="dv">1493</span>,<span class="dv">95</span>,<span class="dv">29</span>,<span class="dv">1417</span>,<span class="dv">805</span>,<span class="dv">719</span>,<span class="dv">1261</span>,<span class="dv">1177</span>,<span class="dv">1163</span>,</span>
<span id="cb448-54"><a href="#cb448-54" aria-hidden="true"></a><span class="dv">1599</span>,<span class="dv">835</span>,<span class="dv">1367</span>,<span class="dv">315</span>,<span class="dv">1361</span>,<span class="dv">1933</span>,<span class="dv">1977</span>,<span class="dv">747</span>,<span class="dv">31</span>,<span class="dv">1373</span>,<span class="dv">1079</span>,<span class="dv">1637</span>,<span class="dv">1679</span>,<span class="dv">1581</span>,<span class="dv">1753</span>,<span class="dv">1355</span>,</span>
<span id="cb448-55"><a href="#cb448-55" aria-hidden="true"></a><span class="dv">513</span>,<span class="dv">1539</span>,<span class="dv">1815</span>,<span class="dv">1531</span>,<span class="dv">1647</span>,<span class="dv">205</span>,<span class="dv">505</span>,<span class="dv">1109</span>,<span class="dv">33</span>,<span class="dv">1379</span>,<span class="dv">521</span>,<span class="dv">1627</span>,<span class="dv">1457</span>,<span class="dv">1901</span>,<span class="dv">1767</span>,<span class="dv">1547</span>,</span>
<span id="cb448-56"><a href="#cb448-56" aria-hidden="true"></a><span class="dv">1471</span>,<span class="dv">1853</span>,<span class="dv">1833</span>,<span class="dv">1349</span>,<span class="dv">559</span>,<span class="dv">1523</span>,<span class="dv">967</span>,<span class="dv">1131</span>,<span class="dv">97</span>,<span class="dv">35</span>,<span class="dv">1975</span>,<span class="dv">795</span>,<span class="dv">497</span>,<span class="dv">1875</span>,<span class="dv">1191</span>,<span class="dv">1739</span>,</span>
<span id="cb448-57"><a href="#cb448-57" aria-hidden="true"></a><span class="dv">641</span>,<span class="dv">1149</span>,<span class="dv">1385</span>,<span class="dv">133</span>,<span class="dv">529</span>,<span class="dv">845</span>,<span class="dv">1657</span>,<span class="dv">725</span>,<span class="dv">161</span>,<span class="dv">1309</span>,<span class="dv">375</span>,<span class="dv">37</span>,<span class="dv">463</span>,<span class="dv">1555</span>,<span class="dv">615</span>,<span class="dv">1931</span>,</span>
<span id="cb448-58"><a href="#cb448-58" aria-hidden="true"></a><span class="dv">1343</span>,<span class="dv">445</span>,<span class="dv">937</span>,<span class="dv">1083</span>,<span class="dv">1617</span>,<span class="dv">883</span>,<span class="dv">185</span>,<span class="dv">1515</span>,<span class="dv">225</span>,<span class="dv">1443</span>,<span class="dv">1225</span>,<span class="dv">869</span>,<span class="dv">1423</span>,<span class="dv">1235</span>,<span class="dv">39</span>,<span class="dv">1973</span>,</span>
<span id="cb448-59"><a href="#cb448-59" aria-hidden="true"></a><span class="dv">769</span>,<span class="dv">259</span>,<span class="dv">489</span>,<span class="dv">1797</span>,<span class="dv">1391</span>,<span class="dv">1485</span>,<span class="dv">1287</span>,<span class="dv">341</span>,<span class="dv">289</span>,<span class="dv">99</span>,<span class="dv">1271</span>,<span class="dv">1701</span>,<span class="dv">1713</span>,<span class="dv">915</span>,<span class="dv">537</span>,<span class="dv">1781</span>,</span>
<span id="cb448-60"><a href="#cb448-60" aria-hidden="true"></a><span class="dv">1215</span>,<span class="dv">963</span>,<span class="dv">41</span>,<span class="dv">581</span>,<span class="dv">303</span>,<span class="dv">243</span>,<span class="dv">1337</span>,<span class="dv">1899</span>,<span class="dv">353</span>,<span class="dv">1245</span>,<span class="dv">329</span>,<span class="dv">1563</span>,<span class="dv">753</span>,<span class="dv">595</span>,<span class="dv">1113</span>,<span class="dv">1589</span>,</span>
<span id="cb448-61"><a href="#cb448-61" aria-hidden="true"></a><span class="dv">897</span>,<span class="dv">1667</span>,<span class="dv">407</span>,<span class="dv">635</span>,<span class="dv">785</span>,<span class="dv">1971</span>,<span class="dv">135</span>,<span class="dv">43</span>,<span class="dv">417</span>,<span class="dv">1507</span>,<span class="dv">1929</span>,<span class="dv">731</span>,<span class="dv">207</span>,<span class="dv">275</span>,<span class="dv">1689</span>,<span class="dv">1397</span>,</span>
<span id="cb448-62"><a href="#cb448-62" aria-hidden="true"></a><span class="dv">1087</span>,<span class="dv">1725</span>,<span class="dv">855</span>,<span class="dv">1851</span>,<span class="dv">1873</span>,<span class="dv">397</span>,<span class="dv">1607</span>,<span class="dv">1813</span>,<span class="dv">481</span>,<span class="dv">163</span>,<span class="dv">567</span>,<span class="dv">101</span>,<span class="dv">1167</span>,<span class="dv">45</span>,<span class="dv">1831</span>,<span class="dv">1205</span>,</span>
<span id="cb448-63"><a href="#cb448-63" aria-hidden="true"></a><span class="dv">1025</span>,<span class="dv">1021</span>,<span class="dv">1303</span>,<span class="dv">1029</span>,<span class="dv">1135</span>,<span class="dv">1331</span>,<span class="dv">1017</span>,<span class="dv">427</span>,<span class="dv">545</span>,<span class="dv">1181</span>,<span class="dv">1033</span>,<span class="dv">933</span>,<span class="dv">1969</span>,<span class="dv">365</span>,<span class="dv">1255</span>,<span class="dv">1013</span>,</span>
<span id="cb448-64"><a href="#cb448-64" aria-hidden="true"></a><span class="dv">959</span>,<span class="dv">317</span>,<span class="dv">1751</span>,<span class="dv">187</span>,<span class="dv">47</span>,<span class="dv">1037</span>,<span class="dv">455</span>,<span class="dv">1429</span>,<span class="dv">609</span>,<span class="dv">1571</span>,<span class="dv">1463</span>,<span class="dv">1765</span>,<span class="dv">1009</span>,<span class="dv">685</span>,<span class="dv">679</span>,<span class="dv">821</span>,</span>
<span id="cb448-65"><a href="#cb448-65" aria-hidden="true"></a><span class="dv">1153</span>,<span class="dv">387</span>,<span class="dv">1897</span>,<span class="dv">1403</span>,<span class="dv">1041</span>,<span class="dv">691</span>,<span class="dv">1927</span>,<span class="dv">811</span>,<span class="dv">673</span>,<span class="dv">227</span>,<span class="dv">137</span>,<span class="dv">1499</span>,<span class="dv">49</span>,<span class="dv">1005</span>,<span class="dv">103</span>,<span class="dv">629</span>,</span>
<span id="cb448-66"><a href="#cb448-66" aria-hidden="true"></a><span class="dv">831</span>,<span class="dv">1091</span>,<span class="dv">1449</span>,<span class="dv">1477</span>,<span class="dv">1967</span>,<span class="dv">1677</span>,<span class="dv">697</span>,<span class="dv">1045</span>,<span class="dv">737</span>,<span class="dv">1117</span>,<span class="dv">1737</span>,<span class="dv">667</span>,<span class="dv">911</span>,<span class="dv">1325</span>,<span class="dv">473</span>,<span class="dv">437</span>,</span>
<span id="cb448-67"><a href="#cb448-67" aria-hidden="true"></a><span class="dv">1281</span>,<span class="dv">1795</span>,<span class="dv">1001</span>,<span class="dv">261</span>,<span class="dv">879</span>,<span class="dv">51</span>,<span class="dv">775</span>,<span class="dv">1195</span>,<span class="dv">801</span>,<span class="dv">1635</span>,<span class="dv">759</span>,<span class="dv">165</span>,<span class="dv">1871</span>,<span class="dv">1645</span>,<span class="dv">1049</span>,<span class="dv">245</span>,</span>
<span id="cb448-68"><a href="#cb448-68" aria-hidden="true"></a><span class="dv">703</span>,<span class="dv">1597</span>,<span class="dv">553</span>,<span class="dv">955</span>,<span class="dv">209</span>,<span class="dv">1779</span>,<span class="dv">1849</span>,<span class="dv">661</span>,<span class="dv">865</span>,<span class="dv">291</span>,<span class="dv">841</span>,<span class="dv">997</span>,<span class="dv">1265</span>,<span class="dv">1965</span>,<span class="dv">1625</span>,<span class="dv">53</span>,</span>
<span id="cb448-69"><a href="#cb448-69" aria-hidden="true"></a><span class="dv">1409</span>,<span class="dv">893</span>,<span class="dv">105</span>,<span class="dv">1925</span>,<span class="dv">1297</span>,<span class="dv">589</span>,<span class="dv">377</span>,<span class="dv">1579</span>,<span class="dv">929</span>,<span class="dv">1053</span>,<span class="dv">1655</span>,<span class="dv">1829</span>,<span class="dv">305</span>,<span class="dv">1811</span>,<span class="dv">1895</span>,<span class="dv">139</span>,</span>
<span id="cb448-70"><a href="#cb448-70" aria-hidden="true"></a><span class="dv">575</span>,<span class="dv">189</span>,<span class="dv">343</span>,<span class="dv">709</span>,<span class="dv">1711</span>,<span class="dv">1139</span>,<span class="dv">1095</span>,<span class="dv">277</span>,<span class="dv">993</span>,<span class="dv">1699</span>,<span class="dv">55</span>,<span class="dv">1435</span>,<span class="dv">655</span>,<span class="dv">1491</span>,<span class="dv">1319</span>,<span class="dv">331</span>,</span>
<span id="cb448-71"><a href="#cb448-71" aria-hidden="true"></a><span class="dv">1537</span>,<span class="dv">515</span>,<span class="dv">791</span>,<span class="dv">507</span>,<span class="dv">623</span>,<span class="dv">1229</span>,<span class="dv">1529</span>,<span class="dv">1963</span>,<span class="dv">1057</span>,<span class="dv">355</span>,<span class="dv">1545</span>,<span class="dv">603</span>,<span class="dv">1615</span>,<span class="dv">1171</span>,<span class="dv">743</span>,<span class="dv">523</span>,</span>
<span id="cb448-72"><a href="#cb448-72" aria-hidden="true"></a><span class="dv">447</span>,<span class="dv">1219</span>,<span class="dv">1239</span>,<span class="dv">1723</span>,<span class="dv">465</span>,<span class="dv">499</span>,<span class="dv">57</span>,<span class="dv">107</span>,<span class="dv">1121</span>,<span class="dv">989</span>,<span class="dv">951</span>,<span class="dv">229</span>,<span class="dv">1521</span>,<span class="dv">851</span>,<span class="dv">167</span>,<span class="dv">715</span>,</span>
<span id="cb448-73"><a href="#cb448-73" aria-hidden="true"></a><span class="dv">1665</span>,<span class="dv">1923</span>,<span class="dv">1687</span>,<span class="dv">1157</span>,<span class="dv">1553</span>,<span class="dv">1869</span>,<span class="dv">1415</span>,<span class="dv">1749</span>,<span class="dv">1185</span>,<span class="dv">1763</span>,<span class="dv">649</span>,<span class="dv">1061</span>,<span class="dv">561</span>,<span class="dv">531</span>,<span class="dv">409</span>,<span class="dv">907</span>,</span>
<span id="cb448-74"><a href="#cb448-74" aria-hidden="true"></a><span class="dv">319</span>,<span class="dv">1469</span>,<span class="dv">1961</span>,<span class="dv">59</span>,<span class="dv">1455</span>,<span class="dv">141</span>,<span class="dv">1209</span>,<span class="dv">491</span>,<span class="dv">1249</span>,<span class="dv">419</span>,<span class="dv">1847</span>,<span class="dv">1893</span>,<span class="dv">399</span>,<span class="dv">211</span>,<span class="dv">985</span>,<span class="dv">1099</span>,</span>
<span id="cb448-75"><a href="#cb448-75" aria-hidden="true"></a><span class="dv">1793</span>,<span class="dv">765</span>,<span class="dv">1513</span>,<span class="dv">1275</span>,<span class="dv">367</span>,<span class="dv">1587</span>,<span class="dv">263</span>,<span class="dv">1365</span>,<span class="dv">1313</span>,<span class="dv">925</span>,<span class="dv">247</span>,<span class="dv">1371</span>,<span class="dv">1359</span>,<span class="dv">109</span>,<span class="dv">1561</span>,<span class="dv">1291</span>,</span>
<span id="cb448-76"><a href="#cb448-76" aria-hidden="true"></a><span class="dv">191</span>,<span class="dv">61</span>,<span class="dv">1065</span>,<span class="dv">1605</span>,<span class="dv">721</span>,<span class="dv">781</span>,<span class="dv">1735</span>,<span class="dv">875</span>,<span class="dv">1377</span>,<span class="dv">1827</span>,<span class="dv">1353</span>,<span class="dv">539</span>,<span class="dv">1777</span>,<span class="dv">429</span>,<span class="dv">1959</span>,<span class="dv">1483</span>,</span>
<span id="cb448-77"><a href="#cb448-77" aria-hidden="true"></a><span class="dv">1921</span>,<span class="dv">643</span>,<span class="dv">617</span>,<span class="dv">389</span>,<span class="dv">1809</span>,<span class="dv">947</span>,<span class="dv">889</span>,<span class="dv">981</span>,<span class="dv">1441</span>,<span class="dv">483</span>,<span class="dv">1143</span>,<span class="dv">293</span>,<span class="dv">817</span>,<span class="dv">749</span>,<span class="dv">1383</span>,<span class="dv">1675</span>,</span>
<span id="cb448-78"><a href="#cb448-78" aria-hidden="true"></a><span class="dv">63</span>,<span class="dv">1347</span>,<span class="dv">169</span>,<span class="dv">827</span>,<span class="dv">1199</span>,<span class="dv">1421</span>,<span class="dv">583</span>,<span class="dv">1259</span>,<span class="dv">1505</span>,<span class="dv">861</span>,<span class="dv">457</span>,<span class="dv">1125</span>,<span class="dv">143</span>,<span class="dv">1069</span>,<span class="dv">807</span>,<span class="dv">1867</span>,</span>
<span id="cb448-79"><a href="#cb448-79" aria-hidden="true"></a><span class="dv">2047</span>,<span class="dv">2045</span>,<span class="dv">279</span>,<span class="dv">2043</span>,<span class="dv">111</span>,<span class="dv">307</span>,<span class="dv">2041</span>,<span class="dv">597</span>,<span class="dv">1569</span>,<span class="dv">1891</span>,<span class="dv">2039</span>,<span class="dv">1957</span>,<span class="dv">1103</span>,<span class="dv">1389</span>,<span class="dv">231</span>,<span class="dv">2037</span>,</span>
<span id="cb448-80"><a href="#cb448-80" aria-hidden="true"></a><span class="dv">65</span>,<span class="dv">1341</span>,<span class="dv">727</span>,<span class="dv">837</span>,<span class="dv">977</span>,<span class="dv">2035</span>,<span class="dv">569</span>,<span class="dv">1643</span>,<span class="dv">1633</span>,<span class="dv">547</span>,<span class="dv">439</span>,<span class="dv">1307</span>,<span class="dv">2033</span>,<span class="dv">1709</span>,<span class="dv">345</span>,<span class="dv">1845</span>,</span>
<span id="cb448-81"><a href="#cb448-81" aria-hidden="true"></a><span class="dv">1919</span>,<span class="dv">637</span>,<span class="dv">1175</span>,<span class="dv">379</span>,<span class="dv">2031</span>,<span class="dv">333</span>,<span class="dv">903</span>,<span class="dv">213</span>,<span class="dv">1697</span>,<span class="dv">797</span>,<span class="dv">1161</span>,<span class="dv">475</span>,<span class="dv">1073</span>,<span class="dv">2029</span>,<span class="dv">921</span>,<span class="dv">1653</span>,</span>
<span id="cb448-82"><a href="#cb448-82" aria-hidden="true"></a><span class="dv">193</span>,<span class="dv">67</span>,<span class="dv">1623</span>,<span class="dv">1595</span>,<span class="dv">943</span>,<span class="dv">1395</span>,<span class="dv">1721</span>,<span class="dv">2027</span>,<span class="dv">1761</span>,<span class="dv">1955</span>,<span class="dv">1335</span>,<span class="dv">357</span>,<span class="dv">113</span>,<span class="dv">1747</span>,<span class="dv">1497</span>,<span class="dv">1461</span>,</span>
<span id="cb448-83"><a href="#cb448-83" aria-hidden="true"></a><span class="dv">1791</span>,<span class="dv">771</span>,<span class="dv">2025</span>,<span class="dv">1285</span>,<span class="dv">145</span>,<span class="dv">973</span>,<span class="dv">249</span>,<span class="dv">171</span>,<span class="dv">1825</span>,<span class="dv">611</span>,<span class="dv">265</span>,<span class="dv">1189</span>,<span class="dv">847</span>,<span class="dv">1427</span>,<span class="dv">2023</span>,<span class="dv">1269</span>,</span>
<span id="cb448-84"><a href="#cb448-84" aria-hidden="true"></a><span class="dv">321</span>,<span class="dv">1475</span>,<span class="dv">1577</span>,<span class="dv">69</span>,<span class="dv">1233</span>,<span class="dv">755</span>,<span class="dv">1223</span>,<span class="dv">1685</span>,<span class="dv">1889</span>,<span class="dv">733</span>,<span class="dv">1865</span>,<span class="dv">2021</span>,<span class="dv">1807</span>,<span class="dv">1107</span>,<span class="dv">1447</span>,<span class="dv">1077</span>,</span>
<span id="cb448-85"><a href="#cb448-85" aria-hidden="true"></a><span class="dv">1663</span>,<span class="dv">1917</span>,<span class="dv">1129</span>,<span class="dv">1147</span>,<span class="dv">1775</span>,<span class="dv">1613</span>,<span class="dv">1401</span>,<span class="dv">555</span>,<span class="dv">1953</span>,<span class="dv">2019</span>,<span class="dv">631</span>,<span class="dv">1243</span>,<span class="dv">1329</span>,<span class="dv">787</span>,<span class="dv">871</span>,<span class="dv">885</span>,</span>
<span id="cb448-86"><a href="#cb448-86" aria-hidden="true"></a><span class="dv">449</span>,<span class="dv">1213</span>,<span class="dv">681</span>,<span class="dv">1733</span>,<span class="dv">687</span>,<span class="dv">115</span>,<span class="dv">71</span>,<span class="dv">1301</span>,<span class="dv">2017</span>,<span class="dv">675</span>,<span class="dv">969</span>,<span class="dv">411</span>,<span class="dv">369</span>,<span class="dv">467</span>,<span class="dv">295</span>,<span class="dv">693</span>,</span>
<span id="cb448-87"><a href="#cb448-87" aria-hidden="true"></a><span class="dv">1535</span>,<span class="dv">509</span>,<span class="dv">233</span>,<span class="dv">517</span>,<span class="dv">401</span>,<span class="dv">1843</span>,<span class="dv">1543</span>,<span class="dv">939</span>,<span class="dv">2015</span>,<span class="dv">669</span>,<span class="dv">1527</span>,<span class="dv">421</span>,<span class="dv">591</span>,<span class="dv">147</span>,<span class="dv">281</span>,<span class="dv">501</span>,</span>
<span id="cb448-88"><a href="#cb448-88" aria-hidden="true"></a><span class="dv">577</span>,<span class="dv">195</span>,<span class="dv">215</span>,<span class="dv">699</span>,<span class="dv">1489</span>,<span class="dv">525</span>,<span class="dv">1081</span>,<span class="dv">917</span>,<span class="dv">1951</span>,<span class="dv">2013</span>,<span class="dv">73</span>,<span class="dv">1253</span>,<span class="dv">1551</span>,<span class="dv">173</span>,<span class="dv">857</span>,<span class="dv">309</span>,</span>
<span id="cb448-89"><a href="#cb448-89" aria-hidden="true"></a><span class="dv">1407</span>,<span class="dv">899</span>,<span class="dv">663</span>,<span class="dv">1915</span>,<span class="dv">1519</span>,<span class="dv">1203</span>,<span class="dv">391</span>,<span class="dv">1323</span>,<span class="dv">1887</span>,<span class="dv">739</span>,<span class="dv">1673</span>,<span class="dv">2011</span>,<span class="dv">1585</span>,<span class="dv">493</span>,<span class="dv">1433</span>,<span class="dv">117</span>,</span>
<span id="cb448-90"><a href="#cb448-90" aria-hidden="true"></a><span class="dv">705</span>,<span class="dv">1603</span>,<span class="dv">1111</span>,<span class="dv">965</span>,<span class="dv">431</span>,<span class="dv">1165</span>,<span class="dv">1863</span>,<span class="dv">533</span>,<span class="dv">1823</span>,<span class="dv">605</span>,<span class="dv">823</span>,<span class="dv">1179</span>,<span class="dv">625</span>,<span class="dv">813</span>,<span class="dv">2009</span>,<span class="dv">75</span>,</span>
<span id="cb448-91"><a href="#cb448-91" aria-hidden="true"></a><span class="dv">1279</span>,<span class="dv">1789</span>,<span class="dv">1559</span>,<span class="dv">251</span>,<span class="dv">657</span>,<span class="dv">563</span>,<span class="dv">761</span>,<span class="dv">1707</span>,<span class="dv">1759</span>,<span class="dv">1949</span>,<span class="dv">777</span>,<span class="dv">347</span>,<span class="dv">335</span>,<span class="dv">1133</span>,<span class="dv">1511</span>,<span class="dv">267</span>,</span>
<span id="cb448-92"><a href="#cb448-92" aria-hidden="true"></a><span class="dv">833</span>,<span class="dv">1085</span>,<span class="dv">2007</span>,<span class="dv">1467</span>,<span class="dv">1745</span>,<span class="dv">1805</span>,<span class="dv">711</span>,<span class="dv">149</span>,<span class="dv">1695</span>,<span class="dv">803</span>,<span class="dv">1719</span>,<span class="dv">485</span>,<span class="dv">1295</span>,<span class="dv">1453</span>,<span class="dv">935</span>,<span class="dv">459</span>,</span>
<span id="cb448-93"><a href="#cb448-93" aria-hidden="true"></a><span class="dv">1151</span>,<span class="dv">381</span>,<span class="dv">1641</span>,<span class="dv">1413</span>,<span class="dv">1263</span>,<span class="dv">77</span>,<span class="dv">1913</span>,<span class="dv">2005</span>,<span class="dv">1631</span>,<span class="dv">541</span>,<span class="dv">119</span>,<span class="dv">1317</span>,<span class="dv">1841</span>,<span class="dv">1773</span>,<span class="dv">359</span>,<span class="dv">651</span>,</span>
<span id="cb448-94"><a href="#cb448-94" aria-hidden="true"></a><span class="dv">961</span>,<span class="dv">323</span>,<span class="dv">1193</span>,<span class="dv">197</span>,<span class="dv">175</span>,<span class="dv">1651</span>,<span class="dv">441</span>,<span class="dv">235</span>,<span class="dv">1567</span>,<span class="dv">1885</span>,<span class="dv">1481</span>,<span class="dv">1947</span>,<span class="dv">881</span>,<span class="dv">2003</span>,<span class="dv">217</span>,<span class="dv">843</span>,</span>
<span id="cb448-95"><a href="#cb448-95" aria-hidden="true"></a><span class="dv">1023</span>,<span class="dv">1027</span>,<span class="dv">745</span>,<span class="dv">1019</span>,<span class="dv">913</span>,<span class="dv">717</span>,<span class="dv">1031</span>,<span class="dv">1621</span>,<span class="dv">1503</span>,<span class="dv">867</span>,<span class="dv">1015</span>,<span class="dv">1115</span>,<span class="dv">79</span>,<span class="dv">1683</span>,<span class="dv">793</span>,<span class="dv">1035</span>,</span>
<span id="cb448-96"><a href="#cb448-96" aria-hidden="true"></a><span class="dv">1089</span>,<span class="dv">1731</span>,<span class="dv">297</span>,<span class="dv">1861</span>,<span class="dv">2001</span>,<span class="dv">1011</span>,<span class="dv">1593</span>,<span class="dv">619</span>,<span class="dv">1439</span>,<span class="dv">477</span>,<span class="dv">585</span>,<span class="dv">283</span>,<span class="dv">1039</span>,<span class="dv">1363</span>,<span class="dv">1369</span>,<span class="dv">1227</span>,</span>
<span id="cb448-97"><a href="#cb448-97" aria-hidden="true"></a><span class="dv">895</span>,<span class="dv">1661</span>,<span class="dv">151</span>,<span class="dv">645</span>,<span class="dv">1007</span>,<span class="dv">1357</span>,<span class="dv">121</span>,<span class="dv">1237</span>,<span class="dv">1375</span>,<span class="dv">1821</span>,<span class="dv">1911</span>,<span class="dv">549</span>,<span class="dv">1999</span>,<span class="dv">1043</span>,<span class="dv">1945</span>,<span class="dv">1419</span>,</span>
<span id="cb448-98"><a href="#cb448-98" aria-hidden="true"></a><span class="dv">1217</span>,<span class="dv">957</span>,<span class="dv">599</span>,<span class="dv">571</span>,<span class="dv">81</span>,<span class="dv">371</span>,<span class="dv">1351</span>,<span class="dv">1003</span>,<span class="dv">1311</span>,<span class="dv">931</span>,<span class="dv">311</span>,<span class="dv">1381</span>,<span class="dv">1137</span>,<span class="dv">723</span>,<span class="dv">1575</span>,<span class="dv">1611</span>,</span>
<span id="cb448-99"><a href="#cb448-99" aria-hidden="true"></a><span class="dv">767</span>,<span class="dv">253</span>,<span class="dv">1047</span>,<span class="dv">1787</span>,<span class="dv">1169</span>,<span class="dv">1997</span>,<span class="dv">1273</span>,<span class="dv">853</span>,<span class="dv">1247</span>,<span class="dv">413</span>,<span class="dv">1289</span>,<span class="dv">1883</span>,<span class="dv">177</span>,<span class="dv">403</span>,<span class="dv">999</span>,<span class="dv">1803</span>,</span>
<span id="cb448-100"><a href="#cb448-100" aria-hidden="true"></a><span class="dv">1345</span>,<span class="dv">451</span>,<span class="dv">1495</span>,<span class="dv">1093</span>,<span class="dv">1839</span>,<span class="dv">269</span>,<span class="dv">199</span>,<span class="dv">1387</span>,<span class="dv">1183</span>,<span class="dv">1757</span>,<span class="dv">1207</span>,<span class="dv">1051</span>,<span class="dv">783</span>,<span class="dv">83</span>,<span class="dv">423</span>,<span class="dv">1995</span>,</span>
<span id="cb448-101"><a href="#cb448-101" aria-hidden="true"></a><span class="dv">639</span>,<span class="dv">1155</span>,<span class="dv">1943</span>,<span class="dv">123</span>,<span class="dv">751</span>,<span class="dv">1459</span>,<span class="dv">1671</span>,<span class="dv">469</span>,<span class="dv">1119</span>,<span class="dv">995</span>,<span class="dv">393</span>,<span class="dv">219</span>,<span class="dv">1743</span>,<span class="dv">237</span>,<span class="dv">153</span>,<span class="dv">1909</span>,</span>
<span id="cb448-102"><a href="#cb448-102" aria-hidden="true"></a><span class="dv">1473</span>,<span class="dv">1859</span>,<span class="dv">1705</span>,<span class="dv">1339</span>,<span class="dv">337</span>,<span class="dv">909</span>,<span class="dv">953</span>,<span class="dv">1771</span>,<span class="dv">1055</span>,<span class="dv">349</span>,<span class="dv">1993</span>,<span class="dv">613</span>,<span class="dv">1393</span>,<span class="dv">557</span>,<span class="dv">729</span>,<span class="dv">1717</span>,</span>
<span id="cb448-103"><a href="#cb448-103" aria-hidden="true"></a><span class="dv">511</span>,<span class="dv">1533</span>,<span class="dv">1257</span>,<span class="dv">1541</span>,<span class="dv">1425</span>,<span class="dv">819</span>,<span class="dv">519</span>,<span class="dv">85</span>,<span class="dv">991</span>,<span class="dv">1693</span>,<span class="dv">503</span>,<span class="dv">1445</span>,<span class="dv">433</span>,<span class="dv">877</span>,<span class="dv">1305</span>,<span class="dv">1525</span>,</span>
<span id="cb448-104"><a href="#cb448-104" aria-hidden="true"></a><span class="dv">1601</span>,<span class="dv">829</span>,<span class="dv">809</span>,<span class="dv">325</span>,<span class="dv">1583</span>,<span class="dv">1549</span>,<span class="dv">1991</span>,<span class="dv">1941</span>,<span class="dv">927</span>,<span class="dv">1059</span>,<span class="dv">1097</span>,<span class="dv">1819</span>,<span class="dv">527</span>,<span class="dv">1197</span>,<span class="dv">1881</span>,<span class="dv">1333</span>,</span>
<span id="cb448-105"><a href="#cb448-105" aria-hidden="true"></a><span class="dv">383</span>,<span class="dv">125</span>,<span class="dv">361</span>,<span class="dv">891</span>,<span class="dv">495</span>,<span class="dv">179</span>,<span class="dv">633</span>,<span class="dv">299</span>,<span class="dv">863</span>,<span class="dv">285</span>,<span class="dv">1399</span>,<span class="dv">987</span>,<span class="dv">1487</span>,<span class="dv">1517</span>,<span class="dv">1639</span>,<span class="dv">1141</span>,</span>
<span id="cb448-106"><a href="#cb448-106" aria-hidden="true"></a><span class="dv">1729</span>,<span class="dv">579</span>,<span class="dv">87</span>,<span class="dv">1989</span>,<span class="dv">593</span>,<span class="dv">1907</span>,<span class="dv">839</span>,<span class="dv">1557</span>,<span class="dv">799</span>,<span class="dv">1629</span>,<span class="dv">201</span>,<span class="dv">155</span>,<span class="dv">1649</span>,<span class="dv">1837</span>,<span class="dv">1063</span>,<span class="dv">949</span>,</span>
<span id="cb448-107"><a href="#cb448-107" aria-hidden="true"></a><span class="dv">255</span>,<span class="dv">1283</span>,<span class="dv">535</span>,<span class="dv">773</span>,<span class="dv">1681</span>,<span class="dv">461</span>,<span class="dv">1785</span>,<span class="dv">683</span>,<span class="dv">735</span>,<span class="dv">1123</span>,<span class="dv">1801</span>,<span class="dv">677</span>,<span class="dv">689</span>,<span class="dv">1939</span>,<span class="dv">487</span>,<span class="dv">757</span>,</span>
<span id="cb448-108"><a href="#cb448-108" aria-hidden="true"></a><span class="dv">1857</span>,<span class="dv">1987</span>,<span class="dv">983</span>,<span class="dv">443</span>,<span class="dv">1327</span>,<span class="dv">1267</span>,<span class="dv">313</span>,<span class="dv">1173</span>,<span class="dv">671</span>,<span class="dv">221</span>,<span class="dv">695</span>,<span class="dv">1509</span>,<span class="dv">271</span>,<span class="dv">1619</span>,<span class="dv">89</span>,<span class="dv">565</span>,</span>
<span id="cb448-109"><a href="#cb448-109" aria-hidden="true"></a><span class="dv">127</span>,<span class="dv">1405</span>,<span class="dv">1431</span>,<span class="dv">1659</span>,<span class="dv">239</span>,<span class="dv">1101</span>,<span class="dv">1159</span>,<span class="dv">1067</span>,<span class="dv">607</span>,<span class="dv">1565</span>,<span class="dv">905</span>,<span class="dv">1755</span>,<span class="dv">1231</span>,<span class="dv">1299</span>,<span class="dv">665</span>,<span class="dv">373</span>,</span>
<span id="cb448-110"><a href="#cb448-110" aria-hidden="true"></a><span class="dv">1985</span>,<span class="dv">701</span>,<span class="dv">1879</span>,<span class="dv">1221</span>,<span class="dv">849</span>,<span class="dv">627</span>,<span class="dv">1465</span>,<span class="dv">789</span>,<span class="dv">543</span>,<span class="dv">1187</span>,<span class="dv">1591</span>,<span class="dv">923</span>,<span class="dv">1905</span>,<span class="dv">979</span>,<span class="dv">1241</span>,<span class="dv">181</span>};</span>
<span id="cb448-111"><a href="#cb448-111" aria-hidden="true"></a></span>
<span id="cb448-112"><a href="#cb448-112" aria-hidden="true"></a>bool bad255[<span class="dv">512</span>] =</span>
<span id="cb448-113"><a href="#cb448-113" aria-hidden="true"></a>{<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,</span>
<span id="cb448-114"><a href="#cb448-114" aria-hidden="true"></a> <span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,</span>
<span id="cb448-115"><a href="#cb448-115" aria-hidden="true"></a> <span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,</span>
<span id="cb448-116"><a href="#cb448-116" aria-hidden="true"></a> <span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,</span>
<span id="cb448-117"><a href="#cb448-117" aria-hidden="true"></a> <span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,</span>
<span id="cb448-118"><a href="#cb448-118" aria-hidden="true"></a> <span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,</span>
<span id="cb448-119"><a href="#cb448-119" aria-hidden="true"></a> <span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,</span>
<span id="cb448-120"><a href="#cb448-120" aria-hidden="true"></a> <span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,</span>
<span id="cb448-121"><a href="#cb448-121" aria-hidden="true"></a> <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,</span>
<span id="cb448-122"><a href="#cb448-122" aria-hidden="true"></a> <span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,</span>
<span id="cb448-123"><a href="#cb448-123" aria-hidden="true"></a> <span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,</span>
<span id="cb448-124"><a href="#cb448-124" aria-hidden="true"></a> <span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,</span>
<span id="cb448-125"><a href="#cb448-125" aria-hidden="true"></a> <span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,</span>
<span id="cb448-126"><a href="#cb448-126" aria-hidden="true"></a> <span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,</span>
<span id="cb448-127"><a href="#cb448-127" aria-hidden="true"></a> <span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,</span>
<span id="cb448-128"><a href="#cb448-128" aria-hidden="true"></a> <span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,</span>
<span id="cb448-129"><a href="#cb448-129" aria-hidden="true"></a> <span class="dv">0</span>,<span class="dv">0</span>};</span>
<span id="cb448-130"><a href="#cb448-130" aria-hidden="true"></a></span>
<span id="cb448-131"><a href="#cb448-131" aria-hidden="true"></a>inline bool <span class="fu">square</span>( int64 x ) {</span>
<span id="cb448-132"><a href="#cb448-132" aria-hidden="true"></a>    <span class="co">// Quickfail</span></span>
<span id="cb448-133"><a href="#cb448-133" aria-hidden="true"></a>    <span class="kw">if</span>( x &lt; <span class="dv">0</span> || (x&amp;<span class="dv">2</span>) || ((x &amp; <span class="dv">7</span>) == <span class="dv">5</span>) || ((x &amp; <span class="dv">11</span>) == <span class="dv">8</span>) )</span>
<span id="cb448-134"><a href="#cb448-134" aria-hidden="true"></a>        <span class="kw">return</span> <span class="kw">false</span>;</span>
<span id="cb448-135"><a href="#cb448-135" aria-hidden="true"></a>    <span class="kw">if</span>( x == <span class="dv">0</span> )</span>
<span id="cb448-136"><a href="#cb448-136" aria-hidden="true"></a>        <span class="kw">return</span> <span class="kw">true</span>;</span>
<span id="cb448-137"><a href="#cb448-137" aria-hidden="true"></a></span>
<span id="cb448-138"><a href="#cb448-138" aria-hidden="true"></a>    <span class="co">// Check mod 255 = 3 * 5 * 17, for fun</span></span>
<span id="cb448-139"><a href="#cb448-139" aria-hidden="true"></a>    int64 y = x;</span>
<span id="cb448-140"><a href="#cb448-140" aria-hidden="true"></a>    y = (y &amp; 4294967295LL) + (y &gt;&gt; <span class="dv">32</span>);</span>
<span id="cb448-141"><a href="#cb448-141" aria-hidden="true"></a>    y = (y &amp; <span class="dv">65535</span>) + (y &gt;&gt; <span class="dv">16</span>);</span>
<span id="cb448-142"><a href="#cb448-142" aria-hidden="true"></a>    y = (y &amp; <span class="dv">255</span>) + ((y &gt;&gt; <span class="dv">8</span>) &amp; <span class="dv">255</span>) + (y &gt;&gt; <span class="dv">16</span>);</span>
<span id="cb448-143"><a href="#cb448-143" aria-hidden="true"></a>    <span class="kw">if</span>( bad255[y] )</span>
<span id="cb448-144"><a href="#cb448-144" aria-hidden="true"></a>        <span class="kw">return</span> <span class="kw">false</span>;</span>
<span id="cb448-145"><a href="#cb448-145" aria-hidden="true"></a></span>
<span id="cb448-146"><a href="#cb448-146" aria-hidden="true"></a>    <span class="co">// Divide out powers of 4 using binary search</span></span>
<span id="cb448-147"><a href="#cb448-147" aria-hidden="true"></a>    <span class="kw">if</span>((x &amp; 4294967295LL) == <span class="dv">0</span>)</span>
<span id="cb448-148"><a href="#cb448-148" aria-hidden="true"></a>        x &gt;&gt;= <span class="dv">32</span>;</span>
<span id="cb448-149"><a href="#cb448-149" aria-hidden="true"></a>    <span class="kw">if</span>((x &amp; <span class="dv">65535</span>) == <span class="dv">0</span>)</span>
<span id="cb448-150"><a href="#cb448-150" aria-hidden="true"></a>        x &gt;&gt;= <span class="dv">16</span>;</span>
<span id="cb448-151"><a href="#cb448-151" aria-hidden="true"></a>    <span class="kw">if</span>((x &amp; <span class="dv">255</span>) == <span class="dv">0</span>)</span>
<span id="cb448-152"><a href="#cb448-152" aria-hidden="true"></a>        x &gt;&gt;= <span class="dv">8</span>;</span>
<span id="cb448-153"><a href="#cb448-153" aria-hidden="true"></a>    <span class="kw">if</span>((x &amp; <span class="dv">15</span>) == <span class="dv">0</span>)</span>
<span id="cb448-154"><a href="#cb448-154" aria-hidden="true"></a>        x &gt;&gt;= <span class="dv">4</span>;</span>
<span id="cb448-155"><a href="#cb448-155" aria-hidden="true"></a>    <span class="kw">if</span>((x &amp; <span class="dv">3</span>) == <span class="dv">0</span>)</span>
<span id="cb448-156"><a href="#cb448-156" aria-hidden="true"></a>        x &gt;&gt;= <span class="dv">2</span>;</span>
<span id="cb448-157"><a href="#cb448-157" aria-hidden="true"></a></span>
<span id="cb448-158"><a href="#cb448-158" aria-hidden="true"></a>    <span class="kw">if</span>((x &amp; <span class="dv">7</span>) != <span class="dv">1</span>)</span>
<span id="cb448-159"><a href="#cb448-159" aria-hidden="true"></a>        <span class="kw">return</span> <span class="kw">false</span>;</span>
<span id="cb448-160"><a href="#cb448-160" aria-hidden="true"></a></span>
<span id="cb448-161"><a href="#cb448-161" aria-hidden="true"></a>    <span class="co">// Compute sqrt using something like Hensel&#39;s lemma</span></span>
<span id="cb448-162"><a href="#cb448-162" aria-hidden="true"></a>    int64 r, t, z;</span>
<span id="cb448-163"><a href="#cb448-163" aria-hidden="true"></a>    r = start[(x &gt;&gt; <span class="dv">3</span>) &amp; <span class="dv">1023</span>];</span>
<span id="cb448-164"><a href="#cb448-164" aria-hidden="true"></a>    <span class="kw">do</span> {</span>
<span id="cb448-165"><a href="#cb448-165" aria-hidden="true"></a>        z = x - r * r;</span>
<span id="cb448-166"><a href="#cb448-166" aria-hidden="true"></a>        <span class="kw">if</span>( z == <span class="dv">0</span> )</span>
<span id="cb448-167"><a href="#cb448-167" aria-hidden="true"></a>            <span class="kw">return</span> <span class="kw">true</span>;</span>
<span id="cb448-168"><a href="#cb448-168" aria-hidden="true"></a>        <span class="kw">if</span>( z &lt; <span class="dv">0</span> )</span>
<span id="cb448-169"><a href="#cb448-169" aria-hidden="true"></a>            <span class="kw">return</span> <span class="kw">false</span>;</span>
<span id="cb448-170"><a href="#cb448-170" aria-hidden="true"></a>        t = z &amp; (-z);</span>
<span id="cb448-171"><a href="#cb448-171" aria-hidden="true"></a>        r += (z &amp; t) &gt;&gt; <span class="dv">1</span>;</span>
<span id="cb448-172"><a href="#cb448-172" aria-hidden="true"></a>        <span class="kw">if</span>( r &gt; (t  &gt;&gt; <span class="dv">1</span>) )</span>
<span id="cb448-173"><a href="#cb448-173" aria-hidden="true"></a>            r = t - r;</span>
<span id="cb448-174"><a href="#cb448-174" aria-hidden="true"></a>    } <span class="kw">while</span>( t &lt;= (1LL &lt;&lt; <span class="dv">33</span>) );</span>
<span id="cb448-175"><a href="#cb448-175" aria-hidden="true"></a></span>
<span id="cb448-176"><a href="#cb448-176" aria-hidden="true"></a>    <span class="kw">return</span> <span class="kw">false</span>;</span>
<span id="cb448-177"><a href="#cb448-177" aria-hidden="true"></a>}```</span>
<span id="cb448-178"><a href="#cb448-178" aria-hidden="true"></a></span>
<span id="cb448-179"><a href="#cb448-179" aria-hidden="true"></a></span>
<span id="cb448-180"><a href="#cb448-180" aria-hidden="true"></a>#### Answer <span class="dv">2</span> (score <span class="dv">343</span>)</span>
<span id="cb448-181"><a href="#cb448-181" aria-hidden="true"></a>&lt;img src=<span class="st">&quot;https://i.stack.imgur.com/UDUNr.png&quot;</span> alt=<span class="st">&quot;&quot;</span>&gt;  </span>
<span id="cb448-182"><a href="#cb448-182" aria-hidden="true"></a></span>
<span id="cb448-183"><a href="#cb448-183" aria-hidden="true"></a>I&#39;m pretty late to the party, but I hope to provide a better answer; shorter <span class="fu">and</span> (assuming my &lt;a href=<span class="st">&quot;https://www.dropbox.com/s/ad4r6oxfcilqkch/IsSquareBenchmark.java?dl=0&quot;</span> rel=<span class="st">&quot;noreferrer&quot;</span>&gt;benchmark&lt;/a&gt; is correct) also much &lt;a href=<span class="st">&quot;https://microbenchmarks.appspot.com/runs/185f228a-fd9b-44b4-8a7a-48d12101aece&quot;</span> rel=<span class="st">&quot;noreferrer&quot;</span>&gt;faster&lt;/a&gt;.  </span>
<span id="cb448-184"><a href="#cb448-184" aria-hidden="true"></a></span>
<span id="cb448-185"><a href="#cb448-185" aria-hidden="true"></a>```java</span>
<span id="cb448-186"><a href="#cb448-186" aria-hidden="true"></a><span class="dt">long</span> goodMask; <span class="co">// 0xC840C04048404040 computed below</span></span>
<span id="cb448-187"><a href="#cb448-187" aria-hidden="true"></a>{</span>
<span id="cb448-188"><a href="#cb448-188" aria-hidden="true"></a>    <span class="kw">for</span> (<span class="dt">int</span> i=<span class="dv">0</span>; i&lt;<span class="dv">64</span>; ++i) goodMask |= <span class="bu">Long</span>.<span class="fu">MIN_VALUE</span> &gt;&gt;&gt; (i*i);</span>
<span id="cb448-189"><a href="#cb448-189" aria-hidden="true"></a>}</span>
<span id="cb448-190"><a href="#cb448-190" aria-hidden="true"></a></span>
<span id="cb448-191"><a href="#cb448-191" aria-hidden="true"></a><span class="kw">public</span> <span class="dt">boolean</span> <span class="fu">isSquare</span>(<span class="dt">long</span> x) {</span>
<span id="cb448-192"><a href="#cb448-192" aria-hidden="true"></a>    <span class="co">// This tests if the 6 least significant bits are right.</span></span>
<span id="cb448-193"><a href="#cb448-193" aria-hidden="true"></a>    <span class="co">// Moving the to be tested bit to the highest position saves us masking.</span></span>
<span id="cb448-194"><a href="#cb448-194" aria-hidden="true"></a>    <span class="kw">if</span> (goodMask &lt;&lt; x &gt;= <span class="dv">0</span>) <span class="kw">return</span> <span class="kw">false</span>;</span>
<span id="cb448-195"><a href="#cb448-195" aria-hidden="true"></a>    <span class="dt">final</span> <span class="dt">int</span> numberOfTrailingZeros = <span class="bu">Long</span>.<span class="fu">numberOfTrailingZeros</span>(x);</span>
<span id="cb448-196"><a href="#cb448-196" aria-hidden="true"></a>    <span class="co">// Each square ends with an even number of zeros.</span></span>
<span id="cb448-197"><a href="#cb448-197" aria-hidden="true"></a>    <span class="kw">if</span> ((numberOfTrailingZeros &amp; <span class="dv">1</span>) != <span class="dv">0</span>) <span class="kw">return</span> <span class="kw">false</span>;</span>
<span id="cb448-198"><a href="#cb448-198" aria-hidden="true"></a>    x &gt;&gt;= numberOfTrailingZeros;</span>
<span id="cb448-199"><a href="#cb448-199" aria-hidden="true"></a>    <span class="co">// Now x is either 0 or odd.</span></span>
<span id="cb448-200"><a href="#cb448-200" aria-hidden="true"></a>    <span class="co">// In binary each odd square ends with 001.</span></span>
<span id="cb448-201"><a href="#cb448-201" aria-hidden="true"></a>    <span class="co">// Postpone the sign test until now; handle zero in the branch.</span></span>
<span id="cb448-202"><a href="#cb448-202" aria-hidden="true"></a>    <span class="kw">if</span> ((x&amp;<span class="dv">7</span>) != <span class="dv">1</span> | x &lt;= <span class="dv">0</span>) <span class="kw">return</span> x == <span class="dv">0</span>;</span>
<span id="cb448-203"><a href="#cb448-203" aria-hidden="true"></a>    <span class="co">// Do it in the classical way.</span></span>
<span id="cb448-204"><a href="#cb448-204" aria-hidden="true"></a>    <span class="co">// The correctness is not trivial as the conversion from long to double is lossy!</span></span>
<span id="cb448-205"><a href="#cb448-205" aria-hidden="true"></a>    <span class="dt">final</span> <span class="dt">long</span> tst = (<span class="dt">long</span>) <span class="bu">Math</span>.<span class="fu">sqrt</span>(x);</span>
<span id="cb448-206"><a href="#cb448-206" aria-hidden="true"></a>    <span class="kw">return</span> tst * tst == x;</span>
<span id="cb448-207"><a href="#cb448-207" aria-hidden="true"></a>}</span></code></pre></div>
<p>The first test catches most non-squares quickly. It uses a 64-item table packed in a long, so there’s no array access cost (indirection and bounds checks). For a uniformly random <code>long</code>, there’s a 81.25% probability of ending here.</p>
<p>The second test catches all numbers having an odd number of twos in their factorization. The method <code>Long.numberOfTrailingZeros</code> is very fast as it gets JIT-ed into a single i86 instruction.</p>
<p>After dropping the trailing zeros, the third test handles numbers ending with 011, 101, or 111 in binary, which are no perfect squares. It also cares about negative numbers and also handles 0.</p>
<p>
The final test falls back to <code>double</code> arithmetic. As <code>double</code> has only 53 bits mantissa, the conversion from <code>long</code> to <code>double</code> includes rounding for big values. Nonetheless, the test is correct (unless the <a href="https://math.stackexchange.com/questions/237865/show-that-floating-point-sqrtx-cdot-x-geq-x-for-all-long-x">proof</a> is wrong).
</p>
<p>Trying to incorporate the mod255 idea wasn’t successful.</p>
</section>
<section id="answer-3-score-129" class="level4">
<h4>Answer 3 (score 129)</h4>
<p>You’ll have to do some benchmarking. The best algorithm will depend on the distribution of your inputs.</p>
<p>Your algorithm may be nearly optimal, but you might want to do a quick check to rule out some possibilities before calling your square root routine. For example, look at the last digit of your number in hex by doing a bit-wise “and.” Perfect squares can only end in 0, 1, 4, or 9 in base 16, So for 75% of your inputs (assuming they are uniformly distributed) you can avoid a call to the square root in exchange for some very fast bit twiddling.</p>
<p>Kip benchmarked the following code implementing the hex trick. When testing numbers 1 through 100,000,000, this code ran twice as fast as the original.</p>
<div class="sourceCode" id="cb449"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb449-1"><a href="#cb449-1" aria-hidden="true"></a><span class="kw">public</span> <span class="dt">final</span> <span class="dt">static</span> <span class="dt">boolean</span> <span class="fu">isPerfectSquare</span>(<span class="dt">long</span> n)</span>
<span id="cb449-2"><a href="#cb449-2" aria-hidden="true"></a>{</span>
<span id="cb449-3"><a href="#cb449-3" aria-hidden="true"></a>    <span class="kw">if</span> (n &lt; <span class="dv">0</span>)</span>
<span id="cb449-4"><a href="#cb449-4" aria-hidden="true"></a>        <span class="kw">return</span> <span class="kw">false</span>;</span>
<span id="cb449-5"><a href="#cb449-5" aria-hidden="true"></a></span>
<span id="cb449-6"><a href="#cb449-6" aria-hidden="true"></a>    <span class="kw">switch</span>((<span class="dt">int</span>)(n &amp; <span class="bn">0xF</span>))</span>
<span id="cb449-7"><a href="#cb449-7" aria-hidden="true"></a>    {</span>
<span id="cb449-8"><a href="#cb449-8" aria-hidden="true"></a>    <span class="kw">case</span> <span class="dv">0</span>: <span class="kw">case</span> <span class="dv">1</span>: <span class="kw">case</span> <span class="dv">4</span>: <span class="kw">case</span> <span class="dv">9</span>:</span>
<span id="cb449-9"><a href="#cb449-9" aria-hidden="true"></a>        <span class="dt">long</span> tst = (<span class="dt">long</span>)<span class="bu">Math</span>.<span class="fu">sqrt</span>(n);</span>
<span id="cb449-10"><a href="#cb449-10" aria-hidden="true"></a>        <span class="kw">return</span> tst*tst == n;</span>
<span id="cb449-11"><a href="#cb449-11" aria-hidden="true"></a></span>
<span id="cb449-12"><a href="#cb449-12" aria-hidden="true"></a>    <span class="kw">default</span>:</span>
<span id="cb449-13"><a href="#cb449-13" aria-hidden="true"></a>        <span class="kw">return</span> <span class="kw">false</span>;</span>
<span id="cb449-14"><a href="#cb449-14" aria-hidden="true"></a>    }</span>
<span id="cb449-15"><a href="#cb449-15" aria-hidden="true"></a>}</span></code></pre></div>
<p>When I tested the analogous code in C++, it actually ran slower than the original. However, when I eliminated the switch statement, the hex trick once again make the code twice as fast.</p>
<div class="sourceCode" id="cb450"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb450-1"><a href="#cb450-1" aria-hidden="true"></a><span class="dt">int</span> <span class="fu">isPerfectSquare</span>(<span class="dt">int</span> n)</span>
<span id="cb450-2"><a href="#cb450-2" aria-hidden="true"></a>{</span>
<span id="cb450-3"><a href="#cb450-3" aria-hidden="true"></a>    <span class="dt">int</span> h = n &amp; <span class="bn">0xF</span>;  <span class="co">// h is the last hex &quot;digit&quot;</span></span>
<span id="cb450-4"><a href="#cb450-4" aria-hidden="true"></a>    <span class="kw">if</span> (h &gt; <span class="dv">9</span>)</span>
<span id="cb450-5"><a href="#cb450-5" aria-hidden="true"></a>        <span class="kw">return</span> <span class="dv">0</span>;</span>
<span id="cb450-6"><a href="#cb450-6" aria-hidden="true"></a>    <span class="co">// Use lazy evaluation to jump out of the if statement as soon as possible</span></span>
<span id="cb450-7"><a href="#cb450-7" aria-hidden="true"></a>    <span class="kw">if</span> (h != <span class="dv">2</span> &amp;&amp; h != <span class="dv">3</span> &amp;&amp; h != <span class="dv">5</span> &amp;&amp; h != <span class="dv">6</span> &amp;&amp; h != <span class="dv">7</span> &amp;&amp; h != <span class="dv">8</span>)</span>
<span id="cb450-8"><a href="#cb450-8" aria-hidden="true"></a>    {</span>
<span id="cb450-9"><a href="#cb450-9" aria-hidden="true"></a>        <span class="dt">int</span> t = (<span class="dt">int</span>) <span class="fu">floor</span>( <span class="fu">sqrt</span>((<span class="dt">double</span>) n) + <span class="fl">0.</span><span class="dv">5</span> );</span>
<span id="cb450-10"><a href="#cb450-10" aria-hidden="true"></a>        <span class="kw">return</span> t*t == n;</span>
<span id="cb450-11"><a href="#cb450-11" aria-hidden="true"></a>    }</span>
<span id="cb450-12"><a href="#cb450-12" aria-hidden="true"></a>    <span class="kw">return</span> <span class="dv">0</span>;</span>
<span id="cb450-13"><a href="#cb450-13" aria-hidden="true"></a>}</span></code></pre></div>
<p>Eliminating the switch statement had little effect on the C # code.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="must-override-a-superclass-method-errors-after-importing-a-project-into-eclipse-score-250927-in-2019" class="level3">
<h3>67: ‘Must Override a Superclass Method’ Errors after importing a project into Eclipse (score <a href="https://stackoverflow.com/q/1678122.html">250927</a> in 2019)</h3>
<section id="question-65" class="level4">
<h4>Question</h4>
<p>Anytime I have to re-import my projects into Eclipse (if I reinstalled Eclipse, or changed the location of the projects), <strong>almost all</strong> of my overridden methods are not formatted correctly, causing the error:</p>
<blockquote>
The method must override a superclass method
</blockquote>
<p>It may be noteworthy to mention this is with Android projects - for whatever reason, the method argument values are not always populated, so I have to manually populate them myself. For instance:</p>
<div class="sourceCode" id="cb451"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb451-1"><a href="#cb451-1" aria-hidden="true"></a>list.<span class="fu">setOnCreateContextMenuListener</span>(<span class="kw">new</span> <span class="fu">OnCreateContextMenuListener</span>() {</span>
<span id="cb451-2"><a href="#cb451-2" aria-hidden="true"></a></span>
<span id="cb451-3"><a href="#cb451-3" aria-hidden="true"></a>    <span class="co">//These arguments have their correct names</span></span>
<span id="cb451-4"><a href="#cb451-4" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">void</span> <span class="fu">onCreateContextMenu</span>(ContextMenu menu, <span class="bu">View</span> v, </span>
<span id="cb451-5"><a href="#cb451-5" aria-hidden="true"></a>                                    ContextMenuInfo menuInfo) {                 </span>
<span id="cb451-6"><a href="#cb451-6" aria-hidden="true"></a>    }</span>
<span id="cb451-7"><a href="#cb451-7" aria-hidden="true"></a></span>
<span id="cb451-8"><a href="#cb451-8" aria-hidden="true"></a>});</span></code></pre></div>
<p>will be initially populated like this:</p>
<div class="sourceCode" id="cb452"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb452-1"><a href="#cb452-1" aria-hidden="true"></a>list.<span class="fu">setOnCreateContextMenuListener</span>(<span class="kw">new</span> <span class="fu">OnCreateContextMenuListener</span>() {</span>
<span id="cb452-2"><a href="#cb452-2" aria-hidden="true"></a></span>
<span id="cb452-3"><a href="#cb452-3" aria-hidden="true"></a>    <span class="co">//This methods arguments were not automatically provided    </span></span>
<span id="cb452-4"><a href="#cb452-4" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">void</span> <span class="fu">onCreateContextMenu</span>(ContextMenu arg1, <span class="bu">View</span> arg2,</span>
<span id="cb452-5"><a href="#cb452-5" aria-hidden="true"></a>                                    ContextMenuInfo arg3) {</span>
<span id="cb452-6"><a href="#cb452-6" aria-hidden="true"></a>    }</span>
<span id="cb452-7"><a href="#cb452-7" aria-hidden="true"></a></span>
<span id="cb452-8"><a href="#cb452-8" aria-hidden="true"></a>});</span></code></pre></div>
<p>The odd thing is, if I remove my code, and have Eclipse automatically recreate the method, it uses the same argument names I already had, so I don’t really know where the problem is, other then it auto-formatting the method for me.</p>
<p>This becomes quite a pain having to manually recreate ALL my overridden methods by hand. If anyone can explain why this happens or how to fix it .. I would be very happy.</p>
<p>Maybe it is due to the way I am formatting the methods, which are inside an argument of another method?</p>
</section>
<section id="answer-accepted-score-1416" class="level4">
<h4>Answer accepted (score 1416)</h4>
<p>Eclipse is defaulting to Java 1.5 and you have classes implementing interface methods (which in Java 1.6 can be annotated with <code>@Override</code>, but in Java 1.5 can only be applied to methods overriding a superclass method).</p>
<p>Go to your project/IDE preferences and set the Java compiler level to 1.6 and also make sure you select JRE 1.6 to execute your program from Eclipse.</p>
</section>
<section id="answer-2-score-306" class="level4">
<h4>Answer 2 (score 306)</h4>
<p>With <strong>Eclipse Galileo</strong> you go to Eclipse -&gt; Preferences menu item, then select Java and Compiler in the dialog.</p>
<p>Now it still may show compiler compliance level at 1.6, yet you still see this problem. So now select the link “<em>Configure Project Specific Settings…</em>” and in there you’ll see the project is set to 1.5, now change this to 1.6. You’ll need to do this for all affected projects.</p>
<p>This byzantine menu / dialog interface is typical of Eclipse’s poor UI design.</p>
</section>
<section id="answer-3-score-77" class="level4">
<h4>Answer 3 (score 77)</h4>
<p>In case this happens to anyone else who tried both alphazero and Paul’s method and still didn’t work.</p>
<p>For me, eclipse somehow ‘cached’ the compile errors even after doing a Project &gt; Clean…</p>
<p>I had to uncheck Project &gt; Build Automatically, then do a Project &gt; Clean, and then build again.</p>
<p><strong>Also, when in doubt, try restarting Eclipse</strong>. This can fix a lot of awkward, unexplainable errors.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="why-is-printing-b-dramatically-slower-than-printing-score-228782-in-2018" class="level3">
<h3>68: Why is printing “B” dramatically slower than printing “#”? (score <a href="https://stackoverflow.com/q/21947452.html">228782</a> in 2018)</h3>
<section id="question-66" class="level4">
<h4>Question</h4>
<p>I generated two matrices of <code>1000</code> x <code>1000</code>:</p>
<p>
First Matrix: <code>O</code> and <code>#</code>.<br> Second Matrix: <code>O</code> and <code>B</code>.
</p>
<p>Using the following code, the first matrix took 8.52 seconds to complete:</p>
<div class="sourceCode" id="cb453"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb453-1"><a href="#cb453-1" aria-hidden="true"></a><span class="bu">Random</span> r = <span class="kw">new</span> <span class="bu">Random</span>();</span>
<span id="cb453-2"><a href="#cb453-2" aria-hidden="true"></a><span class="kw">for</span> (<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; <span class="dv">1000</span>; i++) {</span>
<span id="cb453-3"><a href="#cb453-3" aria-hidden="true"></a>    <span class="kw">for</span> (<span class="dt">int</span> j = <span class="dv">0</span>; j &lt; <span class="dv">1000</span>; j++) {</span>
<span id="cb453-4"><a href="#cb453-4" aria-hidden="true"></a>        <span class="kw">if</span>(r.<span class="fu">nextInt</span>(<span class="dv">4</span>) == <span class="dv">0</span>) {</span>
<span id="cb453-5"><a href="#cb453-5" aria-hidden="true"></a>            <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">print</span>(<span class="st">&quot;O&quot;</span>);</span>
<span id="cb453-6"><a href="#cb453-6" aria-hidden="true"></a>        } <span class="kw">else</span> {</span>
<span id="cb453-7"><a href="#cb453-7" aria-hidden="true"></a>            <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">print</span>(<span class="st">&quot;</span></span>
<span id="cb453-8"><a href="#cb453-8" aria-hidden="true"></a>#<span class="st">&quot;);</span></span>
<span id="cb453-9"><a href="#cb453-9" aria-hidden="true"></a>        }</span>
<span id="cb453-10"><a href="#cb453-10" aria-hidden="true"></a>    }</span>
<span id="cb453-11"><a href="#cb453-11" aria-hidden="true"></a></span>
<span id="cb453-12"><a href="#cb453-12" aria-hidden="true"></a>   <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;&quot;</span>);</span>
<span id="cb453-13"><a href="#cb453-13" aria-hidden="true"></a> }</span></code></pre></div>
<p>With this code, the second matrix took 259.152 seconds to complete:</p>
<div class="sourceCode" id="cb454"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb454-1"><a href="#cb454-1" aria-hidden="true"></a><span class="bu">Random</span> r = <span class="kw">new</span> <span class="bu">Random</span>();</span>
<span id="cb454-2"><a href="#cb454-2" aria-hidden="true"></a><span class="kw">for</span> (<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; <span class="dv">1000</span>; i++) {</span>
<span id="cb454-3"><a href="#cb454-3" aria-hidden="true"></a>    <span class="kw">for</span> (<span class="dt">int</span> j = <span class="dv">0</span>; j &lt; <span class="dv">1000</span>; j++) {</span>
<span id="cb454-4"><a href="#cb454-4" aria-hidden="true"></a>        <span class="kw">if</span>(r.<span class="fu">nextInt</span>(<span class="dv">4</span>) == <span class="dv">0</span>) {</span>
<span id="cb454-5"><a href="#cb454-5" aria-hidden="true"></a>            <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">print</span>(<span class="st">&quot;O&quot;</span>);</span>
<span id="cb454-6"><a href="#cb454-6" aria-hidden="true"></a>        } <span class="kw">else</span> {</span>
<span id="cb454-7"><a href="#cb454-7" aria-hidden="true"></a>            <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">print</span>(<span class="st">&quot;B&quot;</span>); <span class="co">//only line changed</span></span>
<span id="cb454-8"><a href="#cb454-8" aria-hidden="true"></a>        }</span>
<span id="cb454-9"><a href="#cb454-9" aria-hidden="true"></a>    }</span>
<span id="cb454-10"><a href="#cb454-10" aria-hidden="true"></a></span>
<span id="cb454-11"><a href="#cb454-11" aria-hidden="true"></a>    <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;&quot;</span>);</span>
<span id="cb454-12"><a href="#cb454-12" aria-hidden="true"></a>}</span></code></pre></div>
<p>What is the reason behind the dramatically different run times?</p>
<hr>
<p>As suggested in the comments, printing only <code>System.out.print(" #");</code> takes <code>7.8871</code> seconds, whereas <code>System.out.print("B");</code> gives <code>still printing...</code>.</p>
<p>As others who pointed out that it works for them normally, I tried <a href="http://ideone.com" rel="noreferrer">Ideone.com</a> for instance, and both pieces of code execute at the same speed.</p>
<p>Test Conditions:</p>
<ul>
<li>
I ran this test from <em>Netbeans 7.2</em>, with the output into its console
</li>
<li>
I used <code>System.nanoTime()</code> for measurements
</li>
</ul>
</section>
<section id="answer-accepted-score-3978" class="level4">
<h4>Answer accepted (score 3978)</h4>
<p><em>Pure speculation</em> is that you’re using a terminal that attempts to do <a href="http://en.wikipedia.org/wiki/Word_wrap" rel="noreferrer">word-wrapping</a> rather than character-wrapping, and treats <code>B</code> as a word character but <code>#</code> as a non-word character. So when it reaches the end of a line and searches for a place to break the line, it sees a <code>#</code> almost immediately and happily breaks there; whereas with the <code>B</code>, it has to keep searching for longer, and may have more text to wrap (which may be expensive on some terminals, e.g., outputting backspaces, then outputting spaces to overwrite the letters being wrapped).</p>
<p>But that’s pure speculation.</p>
</section>
<section id="answer-2-score-190" class="level4">
<h4>Answer 2 (score 190)</h4>
<p>
I performed tests on Eclipse vs Netbeans 8.0.2, both with Java version 1.8; I used <code>System.nanoTime()</code> for measurements.
</p>
<h5>
Eclipse:
</h2>
<p>I got the <strong>same time on both cases</strong> - around <strong>1.564 seconds</strong>.</p>
<h5>
Netbeans:
</h2>
<ul>
<li>
Using " #": <strong>1.536 seconds</strong>
</li>
<li>
Using “B”: <strong>44.164 seconds</strong>
</li>
</ul>
<p>So, it looks like Netbeans has bad performance on print to console.</p>
<p>After more research I realized that the problem is <a href="http://en.wikipedia.org/wiki/Line_wrap_and_word_wrap" rel="noreferrer">line-wrapping</a> of the max buffer of Netbeans (it’s not restricted to <code>System.out.println</code> command), demonstrated by this code:</p>
<div class="sourceCode" id="cb455"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb455-1"><a href="#cb455-1" aria-hidden="true"></a><span class="kw">for</span> (<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; <span class="dv">1000</span>; i++) {</span>
<span id="cb455-2"><a href="#cb455-2" aria-hidden="true"></a>    <span class="dt">long</span> t1 = <span class="bu">System</span>.<span class="fu">nanoTime</span>();</span>
<span id="cb455-3"><a href="#cb455-3" aria-hidden="true"></a>    <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">print</span>(<span class="st">&quot;BBB......BBB&quot;</span>); \\&lt;-contain <span class="dv">1000</span> <span class="st">&quot;B&quot;</span></span>
<span id="cb455-4"><a href="#cb455-4" aria-hidden="true"></a>    <span class="dt">long</span> t2 = <span class="bu">System</span>.<span class="fu">nanoTime</span>();</span>
<span id="cb455-5"><a href="#cb455-5" aria-hidden="true"></a>    <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(t2-t1);</span>
<span id="cb455-6"><a href="#cb455-6" aria-hidden="true"></a>    <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;&quot;</span>);</span>
<span id="cb455-7"><a href="#cb455-7" aria-hidden="true"></a>}</span></code></pre></div>
<p>The time results are less then 1 millisecond every iteration except <strong>every fifth iteration</strong>, when the time result is around 225 millisecond. Something like (in nanoseconds):</p>
<div class="sourceCode" id="cb456"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb456-1"><a href="#cb456-1" aria-hidden="true"></a>BBB..<span class="fl">.31744</span></span>
<span id="cb456-2"><a href="#cb456-2" aria-hidden="true"></a>BBB..<span class="fl">.31744</span></span>
<span id="cb456-3"><a href="#cb456-3" aria-hidden="true"></a>BBB..<span class="fl">.31744</span></span>
<span id="cb456-4"><a href="#cb456-4" aria-hidden="true"></a>BBB..<span class="fl">.31744</span></span>
<span id="cb456-5"><a href="#cb456-5" aria-hidden="true"></a>BBB..<span class="fl">.226365807</span></span>
<span id="cb456-6"><a href="#cb456-6" aria-hidden="true"></a>BBB..<span class="fl">.31744</span></span>
<span id="cb456-7"><a href="#cb456-7" aria-hidden="true"></a>BBB..<span class="fl">.31744</span></span>
<span id="cb456-8"><a href="#cb456-8" aria-hidden="true"></a>BBB..<span class="fl">.31744</span></span>
<span id="cb456-9"><a href="#cb456-9" aria-hidden="true"></a>BBB..<span class="fl">.31744</span></span>
<span id="cb456-10"><a href="#cb456-10" aria-hidden="true"></a>BBB..<span class="fl">.226365807</span></span>
<span id="cb456-11"><a href="#cb456-11" aria-hidden="true"></a>.</span>
<span id="cb456-12"><a href="#cb456-12" aria-hidden="true"></a>.</span>
<span id="cb456-13"><a href="#cb456-13" aria-hidden="true"></a>.</span></code></pre></div>
<p>And so on..</p>
<h5>
Summary:
</h2>
<ol>
<li>
Eclipse works perfectly with “B”
</li>
<li>
Netbeans has a line-wrapping problem that can be solved (because the problem does not occur in eclipse)(without adding space after B (“B”)).
</li>
</ol>
</section>
<section id="answer-3-score-2" class="level4">
<h4>Answer 3 (score 2)</h4>
<p>Yes the culprit is definitely word-wrapping. When I tested your two programs, NetBeans IDE 8.2 gave me the following result.</p>
<ol>
<li>
First Matrix: O and # = <strong><em>6.03 seconds</em></strong>
</li>
<li>
Second Matrix: O and B = <strong><em>50.97 seconds</em></strong>
</li>
</ol>
<p>Looking at your code closely you have used a line break at the end of first loop. But you didn’t use any line break in second loop. So you are going to print a word with 1000 characters in the second loop. That causes a word-wrapping problem. If we use a non-word character " " after B, it takes only <strong><em>5.35 seconds</em></strong> to compile the program. And If we use a line break in the second loop after passing 100 values or 50 values, it takes only <strong><em>8.56 seconds</em></strong> and <strong><em>7.05 seconds</em></strong> respectively.</p>
<div class="sourceCode" id="cb457"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb457-1"><a href="#cb457-1" aria-hidden="true"></a><span class="bu">Random</span> r = <span class="kw">new</span> <span class="bu">Random</span>();</span>
<span id="cb457-2"><a href="#cb457-2" aria-hidden="true"></a><span class="kw">for</span> (<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; <span class="dv">1000</span>; i++) {</span>
<span id="cb457-3"><a href="#cb457-3" aria-hidden="true"></a>        <span class="kw">for</span> (<span class="dt">int</span> j = <span class="dv">0</span>; j &lt; <span class="dv">1000</span>; j++) {</span>
<span id="cb457-4"><a href="#cb457-4" aria-hidden="true"></a>            <span class="kw">if</span>(r.<span class="fu">nextInt</span>(<span class="dv">4</span>) == <span class="dv">0</span>) {</span>
<span id="cb457-5"><a href="#cb457-5" aria-hidden="true"></a>                <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">print</span>(<span class="st">&quot;O&quot;</span>);</span>
<span id="cb457-6"><a href="#cb457-6" aria-hidden="true"></a>            } <span class="kw">else</span> {</span>
<span id="cb457-7"><a href="#cb457-7" aria-hidden="true"></a>                <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">print</span>(<span class="st">&quot;B&quot;</span>);</span>
<span id="cb457-8"><a href="#cb457-8" aria-hidden="true"></a>            }</span>
<span id="cb457-9"><a href="#cb457-9" aria-hidden="true"></a>            <span class="kw">if</span>(j%<span class="dv">100</span>==<span class="dv">0</span>){               <span class="co">//Adding a line break in second loop      </span></span>
<span id="cb457-10"><a href="#cb457-10" aria-hidden="true"></a>                <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>();</span>
<span id="cb457-11"><a href="#cb457-11" aria-hidden="true"></a>            }                    </span>
<span id="cb457-12"><a href="#cb457-12" aria-hidden="true"></a>        }</span>
<span id="cb457-13"><a href="#cb457-13" aria-hidden="true"></a><span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;&quot;</span>);                </span>
<span id="cb457-14"><a href="#cb457-14" aria-hidden="true"></a>}</span></code></pre></div>
<p>Another advice is that to change settings of NetBeans IDE. First of all, go to NetBeans <strong>Tools</strong> and click <strong>Options</strong>. After that click <strong>Editor</strong> and go to <strong>Formatting</strong> tab. Then select <em>Anywhere</em> in <strong>Line Wrap</strong> Option. It will take almost 6.24% less time to compile the program.</p>
<p><a href="https://i.stack.imgur.com/yv2eL.jpg" rel="nofollow noreferrer"><img src="https://i.stack.imgur.com/yv2eL.jpg" alt="NetBeans Editor Settings"></a></p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="is-null-check-needed-before-calling-instanceof-score-219704-in-2017" class="level3">
<h3>69: Is null check needed before calling instanceof? (score <a href="https://stackoverflow.com/q/2950319.html">219704</a> in 2017)</h3>
<section id="question-67" class="level4">
<h4>Question</h4>
<p>Will <code>null instanceof SomeClass</code> return <code>false</code> or throw a <code>NullPointerException</code>?</p>
</section>
<section id="answer-accepted-score-1727" class="level4">
<h4>Answer accepted (score 1727)</h4>
<p>No, a null check is not needed before using instanceof.</p>
<p>The expression <code>x instanceof SomeClass</code> is <code>false</code> if <code>x</code> is <code>null</code>.</p>
<p>From the Java Language Specification, <a href="https://docs.oracle.com/javase/specs/jls/se11/html/jls-15.html
#jls-15.20.2" rel="noreferrer">section 15.20.2, “Type comparison operator instanceof”</a>:</p>
<blockquote>
<p>
“At run time, the result of the <code>instanceof</code> operator is <code>true</code> if the value of the <em>RelationalExpression</em> <strong>is not <code>null</code></strong> and the reference could be cast to the <em>ReferenceType</em> without raising a <code>ClassCastException</code>. Otherwise the result is <code>false</code>.”
</p>
</blockquote>
<p>So if the operand is null, the result is false.</p>
</section>
<section id="answer-2-score-257" class="level4">
<h4>Answer 2 (score 257)</h4>
<p>Using a null reference as the first operand to <code>instanceof</code> returns <code>false</code>.</p>
</section>
<section id="answer-3-score-71" class="level4">
<h4>Answer 3 (score 71)</h4>
<p>Very good question indeed. I just tried for myself.</p>
<div class="sourceCode" id="cb458"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb458-1"><a href="#cb458-1" aria-hidden="true"></a><span class="kw">public</span> <span class="kw">class</span> IsInstanceOfTest {</span>
<span id="cb458-2"><a href="#cb458-2" aria-hidden="true"></a></span>
<span id="cb458-3"><a href="#cb458-3" aria-hidden="true"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span>(<span class="dt">final</span> <span class="bu">String</span>[] args) {</span>
<span id="cb458-4"><a href="#cb458-4" aria-hidden="true"></a></span>
<span id="cb458-5"><a href="#cb458-5" aria-hidden="true"></a>        <span class="bu">String</span> s;</span>
<span id="cb458-6"><a href="#cb458-6" aria-hidden="true"></a></span>
<span id="cb458-7"><a href="#cb458-7" aria-hidden="true"></a>        s = <span class="st">&quot;&quot;</span>;</span>
<span id="cb458-8"><a href="#cb458-8" aria-hidden="true"></a></span>
<span id="cb458-9"><a href="#cb458-9" aria-hidden="true"></a>        <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>((s <span class="kw">instanceof</span> <span class="bu">String</span>));</span>
<span id="cb458-10"><a href="#cb458-10" aria-hidden="true"></a>        <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="bu">String</span>.<span class="fu">class</span>.<span class="fu">isInstance</span>(s));</span>
<span id="cb458-11"><a href="#cb458-11" aria-hidden="true"></a></span>
<span id="cb458-12"><a href="#cb458-12" aria-hidden="true"></a>        s = <span class="kw">null</span>;</span>
<span id="cb458-13"><a href="#cb458-13" aria-hidden="true"></a></span>
<span id="cb458-14"><a href="#cb458-14" aria-hidden="true"></a>        <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>((s <span class="kw">instanceof</span> <span class="bu">String</span>));</span>
<span id="cb458-15"><a href="#cb458-15" aria-hidden="true"></a>        <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="bu">String</span>.<span class="fu">class</span>.<span class="fu">isInstance</span>(s));</span>
<span id="cb458-16"><a href="#cb458-16" aria-hidden="true"></a>    }</span>
<span id="cb458-17"><a href="#cb458-17" aria-hidden="true"></a>}</span></code></pre></div>
<p>Prints</p>
<div class="sourceCode" id="cb459"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb459-1"><a href="#cb459-1" aria-hidden="true"></a><span class="kw">true</span></span>
<span id="cb459-2"><a href="#cb459-2" aria-hidden="true"></a><span class="kw">true</span></span>
<span id="cb459-3"><a href="#cb459-3" aria-hidden="true"></a><span class="kw">false</span></span>
<span id="cb459-4"><a href="#cb459-4" aria-hidden="true"></a><span class="kw">false</span></span></code></pre></div>
<p><strong><a href="http://docs.oracle.com/javase/specs/jls/se8/html/jls-15.html
#jls-15.20.2" rel="noreferrer">JLS / 15.20.2. Type Comparison Operator instanceof</a></strong></p>
<blockquote>
At run time, the result of the <code>instanceof</code> operator is <code>true</code> if the value of the <em>RelationalExpression</em> is not <code>null</code> and the reference could be cast to the <em>ReferenceType</em> without raising a <code>ClassCastException</code>. Otherwise the result is <code>false</code>.
</blockquote>
<p><strong><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Class.html
#isInstance-java.lang.Object-" rel="noreferrer">API / Class#isInstance(Object)</a></strong></p>
<blockquote>
If this <code>Class</code> object represents an interface, this method returns <code>true</code> if the class or any superclass of the specified <code>Object</code> argument implements this interface; it returns <code>false</code> otherwise. If this <code>Class</code> object represents a primitive type, this method returns <code>false</code>.
</blockquote>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="why-does-this-code-using-random-strings-print-hello-world-score-193430-in-2015" class="level3">
<h3>70: Why does this code using random strings print “hello world”? (score <a href="https://stackoverflow.com/q/15182496.html">193430</a> in 2015)</h3>
<section id="question-68" class="level4">
<h4>Question</h4>
<p>
The following print statement would print “hello world”. Could anyone explain this?
</p>
<div class="sourceCode" id="cb460"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb460-1"><a href="#cb460-1" aria-hidden="true"></a><span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="fu">randomString</span>(-<span class="dv">229985452</span>) + <span class="st">&quot; &quot;</span> + <span class="fu">randomString</span>(-<span class="dv">147909649</span>));</span></code></pre></div>
<p>And <code>randomString()</code> looks like this:</p>
<div class="sourceCode" id="cb461"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb461-1"><a href="#cb461-1" aria-hidden="true"></a><span class="kw">public</span> <span class="dt">static</span> <span class="bu">String</span> <span class="fu">randomString</span>(<span class="dt">int</span> i)</span>
<span id="cb461-2"><a href="#cb461-2" aria-hidden="true"></a>{</span>
<span id="cb461-3"><a href="#cb461-3" aria-hidden="true"></a>    <span class="bu">Random</span> ran = <span class="kw">new</span> <span class="bu">Random</span>(i);</span>
<span id="cb461-4"><a href="#cb461-4" aria-hidden="true"></a>    <span class="bu">StringBuilder</span> sb = <span class="kw">new</span> <span class="bu">StringBuilder</span>();</span>
<span id="cb461-5"><a href="#cb461-5" aria-hidden="true"></a>    <span class="kw">while</span> (<span class="kw">true</span>)</span>
<span id="cb461-6"><a href="#cb461-6" aria-hidden="true"></a>    {</span>
<span id="cb461-7"><a href="#cb461-7" aria-hidden="true"></a>        <span class="dt">int</span> k = ran.<span class="fu">nextInt</span>(<span class="dv">27</span>);</span>
<span id="cb461-8"><a href="#cb461-8" aria-hidden="true"></a>        <span class="kw">if</span> (k == <span class="dv">0</span>)</span>
<span id="cb461-9"><a href="#cb461-9" aria-hidden="true"></a>            <span class="kw">break</span>;</span>
<span id="cb461-10"><a href="#cb461-10" aria-hidden="true"></a></span>
<span id="cb461-11"><a href="#cb461-11" aria-hidden="true"></a>        sb.<span class="fu">append</span>((<span class="dt">char</span>)(<span class="ch">&#39;`&#39;</span> + k));</span>
<span id="cb461-12"><a href="#cb461-12" aria-hidden="true"></a>    }</span>
<span id="cb461-13"><a href="#cb461-13" aria-hidden="true"></a></span>
<span id="cb461-14"><a href="#cb461-14" aria-hidden="true"></a>    <span class="kw">return</span> sb.<span class="fu">toString</span>();</span>
<span id="cb461-15"><a href="#cb461-15" aria-hidden="true"></a>}</span></code></pre></div>
</section>
<section id="answer-accepted-score-901" class="level4">
<h4>Answer accepted (score 901)</h4>
<p>When an instance of <code>java.util.Random</code> is constructed with a specific seed parameter (in this case <code>-229985452</code> or <code>-147909649</code>), it follows the random number generation algorithm <em>beginning</em> with that seed value.</p>
<p>Every <code>Random</code> constructed with the same seed will generate the same pattern of numbers every time.</p>
</section>
<section id="answer-2-score-1127" class="level4">
<h4>Answer 2 (score 1127)</h4>
<p>The other answers explain why, but here is how.</p>
<p>Given an instance of <code>Random</code>:</p>
<div class="sourceCode" id="cb462"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb462-1"><a href="#cb462-1" aria-hidden="true"></a><span class="bu">Random</span> r = <span class="kw">new</span> <span class="bu">Random</span>(-<span class="dv">229985452</span>)</span></code></pre></div>
<p>The first 6 numbers that <code>r.nextInt(27)</code> generates are:</p>
<div class="sourceCode" id="cb463"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb463-1"><a href="#cb463-1" aria-hidden="true"></a><span class="dv">8</span></span>
<span id="cb463-2"><a href="#cb463-2" aria-hidden="true"></a><span class="dv">5</span></span>
<span id="cb463-3"><a href="#cb463-3" aria-hidden="true"></a><span class="dv">12</span></span>
<span id="cb463-4"><a href="#cb463-4" aria-hidden="true"></a><span class="dv">12</span></span>
<span id="cb463-5"><a href="#cb463-5" aria-hidden="true"></a><span class="dv">15</span></span>
<span id="cb463-6"><a href="#cb463-6" aria-hidden="true"></a><span class="dv">0</span></span></code></pre></div>
<p>and the first 6 numbers that <code>r.nextInt(27)</code> generates given <code>Random r = new Random(-147909649)</code> are:</p>
<div class="sourceCode" id="cb464"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb464-1"><a href="#cb464-1" aria-hidden="true"></a><span class="dv">23</span></span>
<span id="cb464-2"><a href="#cb464-2" aria-hidden="true"></a><span class="dv">15</span></span>
<span id="cb464-3"><a href="#cb464-3" aria-hidden="true"></a><span class="dv">18</span></span>
<span id="cb464-4"><a href="#cb464-4" aria-hidden="true"></a><span class="dv">12</span></span>
<span id="cb464-5"><a href="#cb464-5" aria-hidden="true"></a><span class="dv">4</span></span>
<span id="cb464-6"><a href="#cb464-6" aria-hidden="true"></a><span class="dv">0</span></span></code></pre></div>
<p>Then just add those numbers to the integer representation of the character ``` (which is 96):</p>
<div class="sourceCode" id="cb465"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb465-1"><a href="#cb465-1" aria-hidden="true"></a><span class="dv">8</span>  + <span class="dv">96</span> = <span class="dv">104</span> --&gt; h</span>
<span id="cb465-2"><a href="#cb465-2" aria-hidden="true"></a><span class="dv">5</span>  + <span class="dv">96</span> = <span class="dv">101</span> --&gt; e</span>
<span id="cb465-3"><a href="#cb465-3" aria-hidden="true"></a><span class="dv">12</span> + <span class="dv">96</span> = <span class="dv">108</span> --&gt; l</span>
<span id="cb465-4"><a href="#cb465-4" aria-hidden="true"></a><span class="dv">12</span> + <span class="dv">96</span> = <span class="dv">108</span> --&gt; l</span>
<span id="cb465-5"><a href="#cb465-5" aria-hidden="true"></a><span class="dv">15</span> + <span class="dv">96</span> = <span class="dv">111</span> --&gt; o</span>
<span id="cb465-6"><a href="#cb465-6" aria-hidden="true"></a></span>
<span id="cb465-7"><a href="#cb465-7" aria-hidden="true"></a><span class="dv">23</span> + <span class="dv">96</span> = <span class="dv">119</span> --&gt; w</span>
<span id="cb465-8"><a href="#cb465-8" aria-hidden="true"></a><span class="dv">15</span> + <span class="dv">96</span> = <span class="dv">111</span> --&gt; o</span>
<span id="cb465-9"><a href="#cb465-9" aria-hidden="true"></a><span class="dv">18</span> + <span class="dv">96</span> = <span class="dv">114</span> --&gt; r</span>
<span id="cb465-10"><a href="#cb465-10" aria-hidden="true"></a><span class="dv">12</span> + <span class="dv">96</span> = <span class="dv">108</span> --&gt; l</span>
<span id="cb465-11"><a href="#cb465-11" aria-hidden="true"></a><span class="dv">4</span>  + <span class="dv">96</span> = <span class="dv">100</span> --&gt; d</span></code></pre></div>
</section>
<section id="answer-3-score-276" class="level4">
<h4>Answer 3 (score 276)</h4>
<p>I’ll just leave it here. Whoever has a lot of (CPU) time to spare, feel free to experiment :) Also, if you have mastered some fork-join-fu to make this thing burn all CPU cores (just threads are boring, right?), please share your code. I would greatly appreciate it.</p>
<div class="sourceCode" id="cb466"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb466-1"><a href="#cb466-1" aria-hidden="true"></a><span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span>(<span class="bu">String</span>[] args) {</span>
<span id="cb466-2"><a href="#cb466-2" aria-hidden="true"></a>    <span class="dt">long</span> time = <span class="bu">System</span>.<span class="fu">currentTimeMillis</span>();</span>
<span id="cb466-3"><a href="#cb466-3" aria-hidden="true"></a>    <span class="fu">generate</span>(<span class="st">&quot;stack&quot;</span>);</span>
<span id="cb466-4"><a href="#cb466-4" aria-hidden="true"></a>    <span class="fu">generate</span>(<span class="st">&quot;over&quot;</span>);</span>
<span id="cb466-5"><a href="#cb466-5" aria-hidden="true"></a>    <span class="fu">generate</span>(<span class="st">&quot;flow&quot;</span>);</span>
<span id="cb466-6"><a href="#cb466-6" aria-hidden="true"></a>    <span class="fu">generate</span>(<span class="st">&quot;rulez&quot;</span>);</span>
<span id="cb466-7"><a href="#cb466-7" aria-hidden="true"></a></span>
<span id="cb466-8"><a href="#cb466-8" aria-hidden="true"></a>    <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;Took &quot;</span> + (<span class="bu">System</span>.<span class="fu">currentTimeMillis</span>() - time) + <span class="st">&quot; ms&quot;</span>);</span>
<span id="cb466-9"><a href="#cb466-9" aria-hidden="true"></a>}</span>
<span id="cb466-10"><a href="#cb466-10" aria-hidden="true"></a></span>
<span id="cb466-11"><a href="#cb466-11" aria-hidden="true"></a><span class="kw">private</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">generate</span>(<span class="bu">String</span> goal) {</span>
<span id="cb466-12"><a href="#cb466-12" aria-hidden="true"></a>    <span class="dt">long</span>[] seed = <span class="fu">generateSeed</span>(goal, <span class="bu">Long</span>.<span class="fu">MIN_VALUE</span>, <span class="bu">Long</span>.<span class="fu">MAX_VALUE</span>);</span>
<span id="cb466-13"><a href="#cb466-13" aria-hidden="true"></a>    <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(seed[<span class="dv">0</span>]);</span>
<span id="cb466-14"><a href="#cb466-14" aria-hidden="true"></a>    <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="fu">randomString</span>(seed[<span class="dv">0</span>], (<span class="dt">char</span>) seed[<span class="dv">1</span>]));</span>
<span id="cb466-15"><a href="#cb466-15" aria-hidden="true"></a>}</span>
<span id="cb466-16"><a href="#cb466-16" aria-hidden="true"></a></span>
<span id="cb466-17"><a href="#cb466-17" aria-hidden="true"></a><span class="kw">public</span> <span class="dt">static</span> <span class="dt">long</span>[] <span class="fu">generateSeed</span>(<span class="bu">String</span> goal, <span class="dt">long</span> start, <span class="dt">long</span> finish) {</span>
<span id="cb466-18"><a href="#cb466-18" aria-hidden="true"></a>    <span class="dt">char</span>[] input = goal.<span class="fu">toCharArray</span>();</span>
<span id="cb466-19"><a href="#cb466-19" aria-hidden="true"></a>    <span class="dt">char</span>[] pool = <span class="kw">new</span> <span class="dt">char</span>[input.<span class="fu">length</span>];</span>
<span id="cb466-20"><a href="#cb466-20" aria-hidden="true"></a>    label:</span>
<span id="cb466-21"><a href="#cb466-21" aria-hidden="true"></a>    <span class="kw">for</span> (<span class="dt">long</span> seed = start; seed &lt; finish; seed++) {</span>
<span id="cb466-22"><a href="#cb466-22" aria-hidden="true"></a>        <span class="bu">Random</span> random = <span class="kw">new</span> <span class="bu">Random</span>(seed);</span>
<span id="cb466-23"><a href="#cb466-23" aria-hidden="true"></a></span>
<span id="cb466-24"><a href="#cb466-24" aria-hidden="true"></a>        <span class="kw">for</span> (<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; input.<span class="fu">length</span>; i++)</span>
<span id="cb466-25"><a href="#cb466-25" aria-hidden="true"></a>            pool[i] = (<span class="dt">char</span>) random.<span class="fu">nextInt</span>(<span class="dv">27</span>);</span>
<span id="cb466-26"><a href="#cb466-26" aria-hidden="true"></a></span>
<span id="cb466-27"><a href="#cb466-27" aria-hidden="true"></a>        <span class="kw">if</span> (random.<span class="fu">nextInt</span>(<span class="dv">27</span>) == <span class="dv">0</span>) {</span>
<span id="cb466-28"><a href="#cb466-28" aria-hidden="true"></a>            <span class="dt">int</span> base = input[<span class="dv">0</span>] - pool[<span class="dv">0</span>];</span>
<span id="cb466-29"><a href="#cb466-29" aria-hidden="true"></a>            <span class="kw">for</span> (<span class="dt">int</span> i = <span class="dv">1</span>; i &lt; input.<span class="fu">length</span>; i++) {</span>
<span id="cb466-30"><a href="#cb466-30" aria-hidden="true"></a>                <span class="kw">if</span> (input[i] - pool[i] != base)</span>
<span id="cb466-31"><a href="#cb466-31" aria-hidden="true"></a>                    <span class="kw">continue</span> label;</span>
<span id="cb466-32"><a href="#cb466-32" aria-hidden="true"></a>            }</span>
<span id="cb466-33"><a href="#cb466-33" aria-hidden="true"></a>            <span class="kw">return</span> <span class="kw">new</span> <span class="dt">long</span>[]{seed, base};</span>
<span id="cb466-34"><a href="#cb466-34" aria-hidden="true"></a>        }</span>
<span id="cb466-35"><a href="#cb466-35" aria-hidden="true"></a></span>
<span id="cb466-36"><a href="#cb466-36" aria-hidden="true"></a>    }</span>
<span id="cb466-37"><a href="#cb466-37" aria-hidden="true"></a></span>
<span id="cb466-38"><a href="#cb466-38" aria-hidden="true"></a>    <span class="kw">throw</span> <span class="kw">new</span> <span class="bu">NoSuchElementException</span>(<span class="st">&quot;Sorry :/&quot;</span>);</span>
<span id="cb466-39"><a href="#cb466-39" aria-hidden="true"></a>}</span>
<span id="cb466-40"><a href="#cb466-40" aria-hidden="true"></a></span>
<span id="cb466-41"><a href="#cb466-41" aria-hidden="true"></a><span class="kw">public</span> <span class="dt">static</span> <span class="bu">String</span> <span class="fu">randomString</span>(<span class="dt">long</span> i, <span class="dt">char</span> base) {</span>
<span id="cb466-42"><a href="#cb466-42" aria-hidden="true"></a>    <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;Using base: &#39;&quot;</span> + base + <span class="st">&quot;&#39;&quot;</span>);</span>
<span id="cb466-43"><a href="#cb466-43" aria-hidden="true"></a>    <span class="bu">Random</span> ran = <span class="kw">new</span> <span class="bu">Random</span>(i);</span>
<span id="cb466-44"><a href="#cb466-44" aria-hidden="true"></a>    <span class="bu">StringBuilder</span> sb = <span class="kw">new</span> <span class="bu">StringBuilder</span>();</span>
<span id="cb466-45"><a href="#cb466-45" aria-hidden="true"></a>    <span class="kw">for</span> (<span class="dt">int</span> n = <span class="dv">0</span>; ; n++) {</span>
<span id="cb466-46"><a href="#cb466-46" aria-hidden="true"></a>        <span class="dt">int</span> k = ran.<span class="fu">nextInt</span>(<span class="dv">27</span>);</span>
<span id="cb466-47"><a href="#cb466-47" aria-hidden="true"></a>        <span class="kw">if</span> (k == <span class="dv">0</span>)</span>
<span id="cb466-48"><a href="#cb466-48" aria-hidden="true"></a>            <span class="kw">break</span>;</span>
<span id="cb466-49"><a href="#cb466-49" aria-hidden="true"></a></span>
<span id="cb466-50"><a href="#cb466-50" aria-hidden="true"></a>        sb.<span class="fu">append</span>((<span class="dt">char</span>) (base + k));</span>
<span id="cb466-51"><a href="#cb466-51" aria-hidden="true"></a>    }</span>
<span id="cb466-52"><a href="#cb466-52" aria-hidden="true"></a></span>
<span id="cb466-53"><a href="#cb466-53" aria-hidden="true"></a>    <span class="kw">return</span> sb.<span class="fu">toString</span>();</span>
<span id="cb466-54"><a href="#cb466-54" aria-hidden="true"></a>}</span></code></pre></div>
<p>Output:</p>
<div class="sourceCode" id="cb467"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb467-1"><a href="#cb467-1" aria-hidden="true"></a>-<span class="dv">9223372036808280701</span></span>
<span id="cb467-2"><a href="#cb467-2" aria-hidden="true"></a>Using base: <span class="ch">&#39;Z&#39;</span></span>
<span id="cb467-3"><a href="#cb467-3" aria-hidden="true"></a>stack</span>
<span id="cb467-4"><a href="#cb467-4" aria-hidden="true"></a>-<span class="dv">9223372036853943469</span></span>
<span id="cb467-5"><a href="#cb467-5" aria-hidden="true"></a>Using base: <span class="ch">&#39;b&#39;</span></span>
<span id="cb467-6"><a href="#cb467-6" aria-hidden="true"></a>over</span>
<span id="cb467-7"><a href="#cb467-7" aria-hidden="true"></a>-<span class="dv">9223372036852834412</span></span>
<span id="cb467-8"><a href="#cb467-8" aria-hidden="true"></a>Using base: <span class="ch">&#39;e&#39;</span></span>
<span id="cb467-9"><a href="#cb467-9" aria-hidden="true"></a>flow</span>
<span id="cb467-10"><a href="#cb467-10" aria-hidden="true"></a>-<span class="dv">9223372036838149518</span></span>
<span id="cb467-11"><a href="#cb467-11" aria-hidden="true"></a>Using base: <span class="ch">&#39;d&#39;</span></span>
<span id="cb467-12"><a href="#cb467-12" aria-hidden="true"></a>rulez</span>
<span id="cb467-13"><a href="#cb467-13" aria-hidden="true"></a>Took <span class="dv">7087</span> ms</span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="why-is-executing-java-code-in-comments-with-certain-unicode-characters-allowed-score-73395-in-2015" class="level3">
<h3>71: Why is executing Java code in comments with certain Unicode characters allowed? (score <a href="https://stackoverflow.com/q/30727515.html">73395</a> in 2015)</h3>
<section id="question-69" class="level4">
<h4>Question</h4>
<p>The following code produces the output “Hello World!” (no really, try it).</p>
<div class="sourceCode" id="cb468"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb468-1"><a href="#cb468-1" aria-hidden="true"></a><span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span>(<span class="bu">String</span><span class="kw">... </span>args) {</span>
<span id="cb468-2"><a href="#cb468-2" aria-hidden="true"></a></span>
<span id="cb468-3"><a href="#cb468-3" aria-hidden="true"></a>   <span class="co">// The comment below is not a typo.</span></span>
<span id="cb468-4"><a href="#cb468-4" aria-hidden="true"></a>   <span class="co">// \u000d System.out.println(&quot;Hello World!&quot;);</span></span>
<span id="cb468-5"><a href="#cb468-5" aria-hidden="true"></a>}</span></code></pre></div>
<p>The reason for this is that the Java compiler parses the Unicode character <code>\u000d</code> as a new line and gets transformed into:</p>
<div class="sourceCode" id="cb469"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb469-1"><a href="#cb469-1" aria-hidden="true"></a><span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span>(<span class="bu">String</span><span class="kw">... </span>args) {</span>
<span id="cb469-2"><a href="#cb469-2" aria-hidden="true"></a></span>
<span id="cb469-3"><a href="#cb469-3" aria-hidden="true"></a>   <span class="co">// The comment below is not a typo.</span></span>
<span id="cb469-4"><a href="#cb469-4" aria-hidden="true"></a>   <span class="co">//</span></span>
<span id="cb469-5"><a href="#cb469-5" aria-hidden="true"></a>   <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;Hello World!&quot;</span>);</span>
<span id="cb469-6"><a href="#cb469-6" aria-hidden="true"></a>}</span></code></pre></div>
<p>Thus resulting into a comment being “executed”.</p>
<p>Since this can be used to “hide” malicious code or whatever an evil programmer can conceive, <strong>why is it allowed in comments</strong>?</p>
<p>Why is this allowed by the Java specification?</p>
</section>
<section id="answer-accepted-score-727" class="level4">
<h4>Answer accepted (score 727)</h4>
<p>Unicode decoding takes place before any other lexical translation. The key benefit of this is that it makes it trivial to go back and forth between ASCII and any other encoding. You don’t even need to figure out where comments begin and end!</p>
<p>As stated in <a href="https://docs.oracle.com/javase/specs/jls/se8/html/jls-3.html
#jls-3.3">JLS Section 3.3</a> this allows any ASCII based tool to process the source files:</p>
<blockquote>
[…] The Java programming language specifies a standard way of transforming a program written in Unicode into ASCII that changes a program into a form that can be processed by ASCII-based tools. […]
</blockquote>
<p>This gives a fundamental guarantee for platform independence (independence of supported character sets) which has always been a key goal for the Java platform.</p>
<p>Being able to write any Unicode character anywhere in the file is a neat feature, and especially important in comments, when documenting code in non-latin languages. The fact that it can interfere with the semantics in such subtle ways is just an (unfortunate) side-effect.</p>
<p>There are many gotchas on this theme and <a href="http://www.javapuzzlers.com/"><em>Java Puzzlers</em></a> by Joshua Bloch and Neal Gafter included the following variant:</p>
<blockquote>
<p>Is this a legal Java program? If so, what does it print?</p>
<div class="sourceCode" id="cb470"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb470-1"><a href="#cb470-1" aria-hidden="true"></a>\u0070\u0075\u0062\u006c\u0069\u0063\u0020\u0020\u0020\u0020</span>
<span id="cb470-2"><a href="#cb470-2" aria-hidden="true"></a>\u0063\u006c\u0061\u0073\u0073\u0020\u0055\u0067\u006c\u0079</span>
<span id="cb470-3"><a href="#cb470-3" aria-hidden="true"></a>\u007b\u0070\u0075\u0062\u006c\u0069\u0063\u0020\u0020\u0020</span>
<span id="cb470-4"><a href="#cb470-4" aria-hidden="true"></a>\u0020\u0020\u0020\u0020\u0073\u0074\u0061\u0074\u0069\u0063</span>
<span id="cb470-5"><a href="#cb470-5" aria-hidden="true"></a>\u0076\u006f\u0069\u0064\u0020\u006d\u0061\u0069\u006e\u0028</span>
<span id="cb470-6"><a href="#cb470-6" aria-hidden="true"></a>\u0053\u0074\u0072\u0069\u006e\u0067\u005b\u005d\u0020\u0020</span>
<span id="cb470-7"><a href="#cb470-7" aria-hidden="true"></a>\u0020\u0020\u0020\u0020\u0061\u0072\u0067\u0073\u0029\u007b</span>
<span id="cb470-8"><a href="#cb470-8" aria-hidden="true"></a>\u0053\u0079\u0073\u0074\u0065\u006d\u002e\u006f\u0075\u0074</span>
<span id="cb470-9"><a href="#cb470-9" aria-hidden="true"></a>\u002e\u0070\u0072\u0069\u006e\u0074\u006c\u006e\u0028\u0020</span>
<span id="cb470-10"><a href="#cb470-10" aria-hidden="true"></a>\u0022\u0048\u0065\u006c\u006c\u006f\u0020\u0077\u0022\u002b</span>
<span id="cb470-11"><a href="#cb470-11" aria-hidden="true"></a>\u0022\u006f\u0072\u006c\u0064\u0022\u0029\u003b\u007d\u007d</span></code></pre></div>
</blockquote>
<p>(This program turns out to be a plain “Hello World” program.)</p>
<p>In the solution to the puzzler, they point out the following:</p>
<blockquote>
More seriously, this puzzle serves to reinforce the lessons of the previous three: <strong>Unicode escapes are essential when you need to insert characters that can’t be represented in any other way into your program. Avoid them in all other cases.</strong>
</blockquote>
<hr>
<p>Source: <a href="http://programming.guide/java/executing-code-in-comments.html">Java: Executing code in comments?!</a></p>
</section>
<section id="answer-2-score-137" class="level4">
<h4>Answer 2 (score 137)</h4>
<p>Since this hasn’t addressed yet, here an explanation, why the translation of Unicode escapes happens before any other source code processing:</p>
<p>The idea behind it was that it allows lossless translations of Java source code between different character encodings. Today, there is widespread Unicode support, and this doesn’t look like a problem, but back then it wasn’t easy for a developer from a western country to receive some source code from his Asian colleague containing Asian characters, make some changes (including compiling and testing it) and sending the result back, all without damaging something.</p>
<p>So, Java source code can be written in any encoding and allows a wide range of characters within identifiers, character and <code>String</code> literals and comments. Then, in order to transfer it losslessly, all characters not supported by the target encoding are replaced by their Unicode escapes.</p>
<p>This is a reversible process and the interesting point is that the translation can be done by a tool which doesn’t need to know anything about the Java source code syntax as the translation rule is not dependent on it. This works as the translation to their actual Unicode characters inside the compiler happens independently to the Java source code syntax as well. It implies that you can perform an arbitrary number of translation steps in both directions without ever changing the meaning of the source code.</p>
<p>This is the reason for another weird feature which hasn’t even mentioned: the <code>\uuuuuuxxxx</code> syntax:</p>
<p>When a translation tool is escaping characters and encounters a sequence that is already an escaped sequence, it should insert an additional <code>u</code> into the sequence, converting <code>\ucafe</code> to <code>\uucafe</code>. The meaning doesn’t change, but when converting into the other direction, the tool should just remove one <code>u</code> and replace only sequences containing a single <code>u</code> by their Unicode characters. That way, even Unicode escapes are retained in their original form when converting back and forth. I guess, no-one ever used that feature…</p>
</section>
<section id="answer-3-score-103" class="level4">
<h4>Answer 3 (score 103)</h4>
<p>I’m going to completely ineffectually add the point, just because I can’t help myself and I haven’t seen it made yet, that the question is invalid since it contains a hidden premise which is wrong, namely that the code is in a comment!</p>
<p>In Java source code  is equivalent in every way to an ASCII CR character. It is a line ending, plain and simple, wherever it occurs. The formatting in the question is misleading, what that sequence of characters actually syntactically corresponds to is:</p>
<div class="sourceCode" id="cb471"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb471-1"><a href="#cb471-1" aria-hidden="true"></a><span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span>(<span class="bu">String</span><span class="kw">... </span>args) {</span>
<span id="cb471-2"><a href="#cb471-2" aria-hidden="true"></a>   <span class="co">// The comment below is no typo. </span></span>
<span id="cb471-3"><a href="#cb471-3" aria-hidden="true"></a>   <span class="co">// </span></span>
<span id="cb471-4"><a href="#cb471-4" aria-hidden="true"></a> <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;Hello World!&quot;</span>);</span>
<span id="cb471-5"><a href="#cb471-5" aria-hidden="true"></a>}</span></code></pre></div>
<p>IMHO the most correct answer is therefore: the code executes because it isn’t in a comment; it’s on the next line. “Executing code in comments” is not allowed in Java, just like you would expect.</p>
<p>Much of the confusion stems from the fact that syntax highlighters and IDEs aren’t sophisticated enough to take this situation into account. They either don’t process the unicode escapes at all, or they do it after parsing the code instead of before, like <code>javac</code> does.</p>
</section>
</section>
</section>
</body>
</html>
