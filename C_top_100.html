<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>C_top_100.md – C &lt;- StackOverflow top 100</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        background-color: #232629;
        color: #7a7c7d;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #7a7c7d;  padding-left: 4px; }
    div.sourceCode
      { color: #cfcfc2; background-color: #232629; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #cfcfc2; } /* Normal */
    code span.al { color: #95da4c; background-color: #4d1f24; font-weight: bold; } /* Alert */
    code span.an { color: #3f8058; } /* Annotation */
    code span.at { color: #2980b9; } /* Attribute */
    code span.bn { color: #f67400; } /* BaseN */
    code span.bu { color: #7f8c8d; } /* BuiltIn */
    code span.cf { color: #fdbc4b; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #3daee9; } /* Char */
    code span.cn { color: #27aeae; font-weight: bold; } /* Constant */
    code span.co { color: #7a7c7d; } /* Comment */
    code span.cv { color: #7f8c8d; } /* CommentVar */
    code span.do { color: #a43340; } /* Documentation */
    code span.dt { color: #2980b9; } /* DataType */
    code span.dv { color: #f67400; } /* DecVal */
    code span.er { color: #da4453; text-decoration: underline; } /* Error */
    code span.ex { color: #0099ff; font-weight: bold; } /* Extension */
    code span.fl { color: #f67400; } /* Float */
    code span.fu { color: #8e44ad; } /* Function */
    code span.im { color: #27ae60; } /* Import */
    code span.in { color: #c45b00; } /* Information */
    code span.kw { color: #cfcfc2; font-weight: bold; } /* Keyword */
    code span.op { color: #cfcfc2; } /* Operator */
    code span.ot { color: #27ae60; } /* Other */
    code span.pp { color: #27ae60; } /* Preprocessor */
    code span.re { color: #2980b9; background-color: #153042; } /* RegionMarker */
    code span.sc { color: #3daee9; } /* SpecialChar */
    code span.ss { color: #da4453; } /* SpecialString */
    code span.st { color: #f44f4f; } /* String */
    code span.va { color: #27aeae; } /* Variable */
    code span.vs { color: #da4453; } /* VerbatimString */
    code span.wa { color: #da4453; } /* Warning */
  </style>
  <link rel="stylesheet" href=" https://raw.githubusercontent.com/tinmarino/wiki_html/master/Css/color_dark_solarized.css -c  https://raw.githubusercontent.com/tinmarino/wiki_html/master/Css/layout_toc.css" />
  <script type="text/javascript" src="https://raw.githubusercontent.com/tinmarino/wiki_html/master/Css/js_masonry_desandro.js"></script>
</head>
<body>
<header id="title-block-header">
<h1 class="title">C &lt;- StackOverflow top 100</h1>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#how-to-initialize-all-members-of-an-array-to-the-same-value-score-1778177-in-2017">1: How to initialize all members of an array to the same value? (score <span>1778177</span> in 2017)</a></li>
<li><a href="#how-do-i-determine-the-size-of-my-array-in-c-score-1765256-in-2013">2: How do I determine the size of my array in C? (score <span>1765256</span> in 2013)</a></li>
<li><a href="#convert-char-to-int-in-c-and-c-score-1516373-in-2011">3: Convert char to int in C and C++ (score <span>1516373</span> in 2011)</a></li>
<li><a href="#how-to-generate-a-random-int-in-c-score-1515123-in-2018">4: How to generate a random int in C? (score <span>1515123</span> in 2018)</a></li>
<li><a href="#using-boolean-values-in-c-score-1246473-in-2016">5: Using boolean values in C (score <span>1246473</span> in 2016)</a></li>
<li><a href="#how-do-you-set-clear-and-toggle-a-single-bit-score-1095506-in-2019">6: How do you set, clear, and toggle a single bit? (score <span>1095506</span> in 2019)</a></li>
<li><a href="#how-do-i-concatenate-constliteral-strings-in-c-score-964267-in-2017">7: How do I concatenate const/literal strings in C? (score <span>964267</span> in 2017)</a></li>
<li><a href="#how-to-convert-integer-to-string-in-c-score-945144-in-2018">8: How to convert integer to string in C? (score <span>945144</span> in 2018)</a></li>
<li><a href="#what-is-the-difference-between-float-and-double-score-936859-in-2018">9: What is the difference between float and double? (score <span>936859</span> in 2018)</a></li>
<li><a href="#correct-format-specifier-for-double-in-printf-score-936300-in-2019">10: Correct format specifier for double in printf (score <span>936300</span> in 2019)</a></li>
<li><a href="#c-what-is-the-difference-between-i-and-i-score-933182-in-2019">11: C: What is the difference between ++i and i++? (score <span>933182</span> in 2019)</a></li>
<li><a href="#how-do-i-create-an-array-of-strings-in-c-score-916965-in-2018">12: How do I create an array of strings in C? (score <span>916965</span> in 2018)</a></li>
<li><a href="#how-to-convert-a-string-to-integer-in-c-score-897704-in-2018">13: How to convert a string to integer in C? (score <span>897704</span> in 2018)</a></li>
<li><a href="#max-value-of-integer-score-847436-in-2017">14: max value of integer (score <span>847436</span> in 2017)</a></li>
<li><a href="#what-does-static-mean-in-c-score-846258-in-2017">15: What does “static” mean in C? (score <span>846258</span> in 2017)</a></li>
<li><a href="#how-can-i-get-the-list-of-files-in-a-directory-using-c-or-c-score-806406-in-2018">16: How can I get the list of files in a directory using C or C++? (score <span>806406</span> in 2018)</a></li>
<li><a href="#how-do-function-pointers-in-c-work-score-766864-in">17: How do function pointers in C work? (score <span>766864</span> in )</a></li>
<li><a href="#how-can-i-get-a-files-size-in-c-score-735156-in-2019">18: How can I get a file’s size in C? (score <span>735156</span> in 2019)</a></li>
<li><a href="#is-there-a-printf-converter-to-print-in-binary-format-score-717928-in">19: Is there a printf converter to print in binary format? (score <span>717928</span> in )</a></li>
<li><a href="#how-do-you-format-an-unsigned-long-long-int-using-printf-score-717617-in-2018">20: How do you format an unsigned long long int using printf? (score <span>717617</span> in 2018)</a></li>
<li><a href="#how-to-initialize-a-struct-in-accordance-with-c-programming-language-standards-score-712842-in-2018">21: How to initialize a struct in accordance with C programming language standards (score <span>712842</span> in 2018)</a></li>
<li><a href="#what-is-the-effect-of-extern-c-in-c-score-709916-in-2018">22: What is the effect of extern “C” in C++? (score <span>709916</span> in 2018)</a></li>
<li><a href="#c-read-file-line-by-line-score-708636-in">23: C read file line by line (score <span>708636</span> in )</a></li>
<li><a href="#what-is-the-argument-for-printf-that-formats-a-long-score-707746-in-2018">24: What is the argument for printf that formats a long? (score <span>707746</span> in 2018)</a></li>
<li><a href="#rounding-number-to-2-decimal-places-in-c-score-690219-in-2012">25: Rounding Number to 2 Decimal Places in C (score <span>690219</span> in 2012)</a></li>
<li><a href="#what-is-size_t-in-c-score-666997-in-2013">26: What is size_t in C? (score <span>666997</span> in 2013)</a></li>
<li><a href="#how-do-i-use-extern-to-share-variables-between-source-files-score-665535-in-2017">27: How do I use extern to share variables between source files? (score <span>665535</span> in 2017)</a></li>
<li><a href="#min-and-max-in-c-score-655315-in-2015">28: MIN and MAX in C (score <span>655315</span> in 2015)</a></li>
<li><a href="#typedef-struct-vs-struct-definitions-score-645139-in-2018">29: typedef struct vs struct definitions (score <span>645139</span> in 2018)</a></li>
<li><a href="#how-to-printf-unsigned-long-in-c-score-640953-in-2017">30: How to printf “unsigned long” in C? (score <span>640953</span> in 2017)</a></li>
<li><a href="#what-is-segmentation-fault-core-dumped-score-587699-in-2013">31: what is Segmentation fault (core dumped)? (score <span>587699</span> in 2013)</a></li>
<li><a href="#in-c-how-should-i-read-a-text-file-and-print-all-strings-score-582393-in-2010">32: In C, how should I read a text file and print all strings (score <span>582393</span> in 2010)</a></li>
<li><a href="#warning-implicit-declaration-of-function-score-575586-in-2011">33: warning: implicit declaration of function (score <span>575586</span> in 2011)</a></li>
<li><a href="#what-is-the-printf-format-specifier-for-bool-score-575382-in">34: What is the printf format specifier for bool? (score <span>575382</span> in )</a></li>
<li><a href="#how-to-convert-integer-to-char-in-c-score-574458-in-2015">35: How to convert integer to char in C? (score <span>574458</span> in 2015)</a></li>
<li><a href="#split-string-with-delimiters-in-c-score-572995-in-2013">36: Split string with delimiters in C (score <span>572995</span> in 2013)</a></li>
<li><a href="#how-to-convert-an-int-to-string-in-c-score-565158-in-2018">37: How to convert an int to string in C? (score <span>565158</span> in 2018)</a></li>
<li><a href="#write-to-.txt-file-score-558915-in-2014">38: Write to .txt file? (score <span>558915</span> in 2014)</a></li>
<li><a href="#undefined-reference-to-pthread_create-in-linux-score-550266-in-2017">39: Undefined reference to pthread_create in Linux (score <span>550266</span> in 2017)</a></li>
<li><a href="#fastest-way-to-check-if-a-file-exist-using-standard-cc11c-score-550079-in-2017">40: Fastest way to check if a file exist using standard C++/C++11/C? (score <span>550079</span> in 2017)</a></li>
<li><a href="#what-is-a-static-function-score-546371-in-2017">41: What is a “static” function? (score <span>546371</span> in 2017)</a></li>
<li><a href="#what-is-a-segmentation-fault-score-539500-in-2016">42: What is a segmentation fault? (score <span>539500</span> in 2016)</a></li>
<li><a href="#what-is-an-unsigned-char-score-539232-in-2016">43: What is an unsigned char? (score <span>539232</span> in 2016)</a></li>
<li><a href="#what-is-the-difference-between-include-and-include-filename-score-537618-in-2016">44: What is the difference between #include <filename> and #include “filename”? (score <span>537618</span> in 2016)</a></li>
<li><a href="#use-of-exit-function-score-533873-in-2013">45: Use of exit() function (score <span>533873</span> in 2013)</a></li>
<li><a href="#is-the-size-of-c-int-2-bytes-or-4-bytes-score-523652-in-2014">46: Is the size of C “int” 2 bytes or 4 bytes? (score <span>523652</span> in 2014)</a></li>
<li><a href="#c-char-array-initialization-score-523179-in-2015">47: C char array initialization (score <span>523179</span> in 2015)</a></li>
<li><a href="#printf-formatting-for-hex-score-506267-in">49: printf() formatting for hex (score <span>506267</span> in )</a></li>
<li><a href="#how-do-you-pass-a-function-as-a-parameter-in-c-score-506257-in-2016">50: How do you pass a function as a parameter in C? (score <span>506257</span> in 2016)</a></li>
<li><a href="#get-a-substring-of-a-char-score-504615-in-2015">51: Get a substring of a char* (score <span>504615</span> in 2015)</a></li>
<li><a href="#difference-between-malloc-and-calloc-score-499399-in-2013">52: Difference between malloc and calloc? (score <span>499399</span> in 2013)</a></li>
<li><a href="#how-to-compile-and-run-cc-in-a-unix-consolemac-terminal-score-496686-in-2018">53: How to compile and run C/C++ in a Unix console/Mac terminal? (score <span>496686</span> in 2018)</a></li>
<li><a href="#reading-string-from-input-with-space-character-score-492341-in-2018">54: Reading string from input with space character? (score <span>492341</span> in 2018)</a></li>
<li><a href="#reading-a-string-with-scanf-score-489645-in-2018">55: Reading a string with scanf (score <span>489645</span> in 2018)</a></li>
<li><a href="#why-should-we-typedef-a-struct-so-often-in-c-score-487703-in-2016">56: Why should we typedef a struct so often in C? (score <span>487703</span> in 2016)</a></li>
<li><a href="#how-to-convert-char-to-integer-in-c-score-487261-in-2017">57: How to convert char to integer in C? (score <span>487261</span> in 2017)</a></li>
<li><a href="#how-to-define-an-enumerated-type-enum-in-c-score-487173-in-2011">58: How to define an enumerated type (enum) in C? (score <span>487173</span> in 2011)</a></li>
<li><a href="#whats-the-best-way-to-check-if-a-file-exists-in-c-score-483699-in-2019">59: What’s the best way to check if a file exists in C? (score <span>483699</span> in 2019)</a></li>
<li><a href="#how-do-i-get-the-directory-that-a-program-is-running-from-score-477268-in-2013">60: How do I get the directory that a program is running from? (score <span>477268</span> in 2013)</a></li>
<li><a href="#regarding-mainint-argc-char-argv-score-474856-in-2018">61: Regarding ’main(int argc, char *argv[])’ (score <span>474856</span> in 2018)</a></li>
<li><a href="#easily-measure-elapsed-time-score-469449-in-2013">62: Easily measure elapsed time (score <span>469449</span> in 2013)</a></li>
<li><a href="#strings-and-character-with-printf-score-465676-in-2013">63: Strings and character with printf (score <span>465676</span> in 2013)</a></li>
<li><a href="#what-is-the-difference-between-const-int-const-int-const-and-int-const-score-459578-in-2017">64: What is the difference between const int<em>, const int </em> const, and int const *? (score <span>459578</span> in 2017)</a></li>
<li><a href="#float-vs.-double-precision-score-457932-in-2017">65: ‘float’ vs. ‘double’ precision (score <span>457932</span> in 2017)</a></li>
<li><a href="#how-do-you-make-an-array-of-structs-in-c-score-438475-in-2019">66: How do you make an array of structs in C? (score <span>438475</span> in 2019)</a></li>
<li><a href="#what-can-be-the-reasons-of-connection-refused-errors-score-436704-in-2017">67: What can be the reasons of connection refused errors? (score <span>436704</span> in 2017)</a></li>
<li><a href="#arrow-operator---usage-in-c-score-433083-in-2019">68: Arrow operator (-&gt;) usage in C (score <span>433083</span> in 2019)</a></li>
<li><a href="#preventing-console-window-from-closing-on-visual-studio-cc-console-application-score-425965-in-2013">69: Preventing console window from closing on Visual Studio C/C++ Console application (score <span>425965</span> in 2013)</a></li>
<li><a href="#how-to-declare-strings-in-c-score-424760-in-2017">70: How to declare strings in C (score <span>424760</span> in 2017)</a></li>
<li><a href="#how-to-print-the-array-score-420176-in-2012">71: How to print the array? (score <span>420176</span> in 2012)</a></li>
<li><a href="#convert-a-character-digit-to-the-corresponding-integer-in-c-score-415138-in-2017">72: Convert a character digit to the corresponding integer in C (score <span>415138</span> in 2017)</a></li>
<li><a href="#get-the-current-time-in-c-score-411745-in-2016">73: Get the current time in C (score <span>411745</span> in 2016)</a></li>
<li><a href="#c-compiler-for-windows-score-405559-in-2013">74: C compiler for Windows? (score <span>405559</span> in 2013)</a></li>
<li><a href="#how-do-i-properly-compare-strings-score-401772-in-2017">75: How do I properly compare strings? (score <span>401772</span> in 2017)</a></li>
<li><a href="#debug-vs-release-in-cmake-score-398790-in-2018">76: Debug vs Release in CMake (score <span>398790</span> in 2018)</a></li>
<li><a href="#the-definitive-c-book-guide-and-list-score-398612-in-2019">77: The Definitive C Book Guide and List (score <span>398612</span> in 2019)</a></li>
<li><a href="#execution-time-of-c-program-score-396880-in-2016">78: Execution time of C program (score <span>396880</span> in 2016)</a></li>
<li><a href="#makefile4-missing-separator.-stop-score-394642-in-2013">79: makefile:4: *** missing separator. Stop (score <span>394642</span> in 2013)</a></li>
<li><a href="#initialization-of-a-normal-array-with-one-default-value-score-390258-in-2016">80: Initialization of a normal array with one default value (score <span>390258</span> in 2016)</a></li>
<li><a href="#check-substring-exists-in-a-string-in-c-score-385439-in-2017">81: Check substring exists in a string in C (score <span>385439</span> in 2017)</a></li>
<li><a href="#how-do-i-concatenate-two-strings-in-c-score-384554-in-2017">82: How do I concatenate two strings in C? (score <span>384554</span> in 2017)</a></li>
<li><a href="#why-are-ifndef-and-define-used-in-c-header-files-score-381732-in-2019">83: Why are #ifndef and #define used in C++ header files? (score <span>381732</span> in 2019)</a></li>
<li><a href="#c-pointer-to-arrayarray-of-pointers-disambiguation-score-380998-in-2014">84: C pointer to array/array of pointers disambiguation (score <span>380998</span> in 2014)</a></li>
<li><a href="#calling-cc-from-python-score-380797-in-2017">85: Calling C/C++ from Python? (score <span>380797</span> in 2017)</a></li>
<li><a href="#improve-insert-per-second-performance-of-sqlite-score-379997-in-2019">86: Improve INSERT-per-second performance of SQLite? (score <span>379997</span> in 2019)</a></li>
<li><a href="#strdup---what-does-it-do-in-c-score-379908-in-2013">87: strdup() - what does it do in C? (score <span>379908</span> in 2013)</a></li>
<li><a href="#c-printf-a-float-value-score-379409-in-2012">88: C: printf a float value (score <span>379409</span> in 2012)</a></li>
<li><a href="#unit-testing-c-code-score-375093-in-2019">89: Unit Testing C Code (score <span>375093</span> in 2019)</a></li>
<li><a href="#typedef-function-pointer-score-373780-in-2019">90: Typedef function pointer? (score <span>373780</span> in 2019)</a></li>
<li><a href="#printing-prime-numbers-from-1-through-100-score-366862-in-2011">92: Printing prime numbers from 1 through 100 (score <span>366862</span> in 2011)</a></li>
<li><a href="#how-to-print-a-int64_t-type-in-c-score-365851-in-2013">93: How to print a int64_t type in C (score <span>365851</span> in 2013)</a></li>
<li><a href="#clearing-a-char-array-c-score-364411-in-2012">94: clearing a char array c (score <span>364411</span> in 2012)</a></li>
<li><a href="#how-to-open-read-and-write-from-serial-port-in-c-score-364263-in-2018">95: How to open, read, and write from serial port in C? (score <span>364263</span> in 2018)</a></li>
<li><a href="#what-does-void-mean-in-c-c-and-c-score-360403-in-2018">96: What does void mean in C, C++, and C#? (score <span>360403</span> in 2018)</a></li>
<li><a href="#stack-smashing-detected-score-356971-in-2012">97: Stack smashing detected (score <span>356971</span> in 2012)</a></li>
<li><a href="#how-to-do-scanf-for-single-char-in-c-score-356225-in-2014">98: How to do scanf for single char in C (score <span>356225</span> in 2014)</a></li>
<li><a href="#how-do-i-check-if-an-integer-is-even-or-odd-score-355377-in-2015">99: How do I check if an integer is even or odd? (score <span>355377</span> in 2015)</a></li>
<li><a href="#difference-between-while-loop-and-do-while-loop-score-349762-in-2010">100: Difference between “while” loop and “do while” loop (score <span>349762</span> in 2010)</a></li>
</ul>
</nav>
<section class="level2">
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
<section id="how-to-initialize-all-members-of-an-array-to-the-same-value-score-1778177-in-2017" class="level3">
<h3>1: How to initialize all members of an array to the same value? (score <a href="https://stackoverflow.com/q/201101.html">1778177</a> in 2017)</h3>
<section id="question" class="level4">
<h4>Question</h4>
<p>I have a large array in C (not C++ if that makes a difference). I want to initialize all members to the same value. I could swear I once knew a simple way to do this. I could use <code>memset()</code> in my case, but isn’t there a way to do this that is built right into the C syntax?</p>
</section>
<section id="answer-accepted-score-1184" class="level4">
<h4>Answer accepted (score 1184)</h4>
<p>
Unless that value is 0 (in which case you can omit some part of the initializer and the corresponding elements will be initialized to 0), there’s no easy way.
</p>
<p>Don’t overlook the obvious solution, though:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a><span class="dt">int</span> myArray[<span class="dv">10</span>] = { <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span> };</span></code></pre></div>
<p>Elements with missing values will be initialized to 0:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a><span class="dt">int</span> myArray[<span class="dv">10</span>] = { <span class="dv">1</span>, <span class="dv">2</span> }; <span class="co">// initialize to 1,2,0,0,0...</span></span></code></pre></div>
<p>So this will initialize all elements to 0:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="dt">int</span> myArray[<span class="dv">10</span>] = { <span class="dv">0</span> }; <span class="co">// all elements 0</span></span></code></pre></div>
<p>
In C++, an empty initialization list will also initialize every element to 0. This is <a href="https://stackoverflow.com/a/17589839">not allowed</a> with C:
</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a><span class="dt">int</span> myArray[<span class="dv">10</span>] = {}; <span class="co">// all elements 0 in C++</span></span></code></pre></div>
<p>
Remember that objects with static storage duration will initialize to 0 if no initializer is specified:
</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a><span class="dt">static</span> <span class="dt">int</span> myArray[<span class="dv">10</span>]; <span class="co">// all elements 0</span></span></code></pre></div>
<p>
And that “0” doesn’t necessarily mean “all-bits-zero”, so using the above is better and more portable than memset(). (Floating point values will be initialized to +0, pointers to null value, etc.)
</p>
</section>
<section id="answer-2-score-383" class="level4">
<h4>Answer 2 (score 383)</h4>
<p>If your compiler is GCC you can use following syntax:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="dt">int</span> array[<span class="dv">1024</span>] = {[<span class="dv">0</span> ... <span class="dv">1023</span>] = <span class="dv">5</span>};</span></code></pre></div>
<p>
Check out detailed description: <a href="http://gcc.gnu.org/onlinedocs/gcc-4.1.2/gcc/Designated-Inits.html" rel="noreferrer">http://gcc.gnu.org/onlinedocs/gcc-4.1.2/gcc/Designated-Inits.html</a>
</p>
</section>
<section id="answer-3-score-176" class="level4">
<h4>Answer 3 (score 176)</h4>
<p>For statically initializing a large array with the same value, without multiple copy-paste, you can use macros:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true"></a><span class="pp">#define VAL_1X     42</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true"></a><span class="pp">#define VAL_2X     VAL_1X,  VAL_1X</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true"></a><span class="pp">#define VAL_4X     VAL_2X,  VAL_2X</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true"></a><span class="pp">#define VAL_8X     VAL_4X,  VAL_4X</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true"></a><span class="pp">#define VAL_16X    VAL_8X,  VAL_8X</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true"></a><span class="pp">#define VAL_32X    VAL_16X, VAL_16X</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true"></a><span class="pp">#define VAL_64X    VAL_32X, VAL_32X</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true"></a><span class="dt">int</span> myArray[<span class="dv">53</span>] = { VAL_32X, VAL_16X, VAL_4X, VAL_1X };</span></code></pre></div>
<p>If you need to change the value, you have to do the replacement at only one place.</p>
<h5>
Edit: possible useful extensions
</h2>
<p>(courtesy of <a href="https://stackoverflow.com/users/15168/jonathan-leffler">Jonathan Leffler</a>)</p>
<p>You can easily generalize this with:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true"></a><span class="pp">#define VAL_1(X) X</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true"></a><span class="pp">#define VAL_2(X) VAL_1(X), VAL_1(X)</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true"></a><span class="co">/* etc. */</span></span></code></pre></div>
<p>A variant can be created using:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true"></a><span class="pp">#define STRUCTVAL_1(...) { __VA_ARGS__ }</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true"></a><span class="pp">#define STRUCTVAL_2(...) STRUCTVAL_1(__VA_ARGS__), STRUCTVAL_1(__VA_ARGS__)</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true"></a><span class="co">/*etc */</span> </span></code></pre></div>
<p>that works with structures or compound arrays.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true"></a></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true"></a><span class="pp">#define STRUCTVAL_48(...) STRUCTVAL_32(__VA_ARGS__), STRUCTVAL_16(__VA_ARGS__)</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true"></a><span class="kw">struct</span> Pair { <span class="dt">char</span> key[<span class="dv">16</span>]; <span class="dt">char</span> val[<span class="dv">32</span>]; };</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true"></a><span class="kw">struct</span> Pair p_data[] = { STRUCTVAL_48(<span class="st">&quot;Key&quot;</span>, <span class="st">&quot;Value&quot;</span>) };</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true"></a><span class="dt">int</span> a_data[][<span class="dv">4</span>] = { STRUCTVAL_48(<span class="dv">12</span>, <span class="dv">19</span>, <span class="dv">23</span>, <span class="dv">37</span>) };</span></code></pre></div>
<p>macro names are negotiable.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-do-i-determine-the-size-of-my-array-in-c-score-1765256-in-2013" class="level3">
<h3>2: How do I determine the size of my array in C? (score <a href="https://stackoverflow.com/q/37538.html">1765256</a> in 2013)</h3>
<section id="question-1" class="level4">
<h4>Question</h4>
<p>How do I determine the size of my array in C?</p>
<p>That is, the number of elements the array can hold?</p>
</section>
<section id="answer-accepted-score-1120" class="level4">
<h4>Answer accepted (score 1120)</h4>
<p><strong>Executive summary:</strong></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true"></a><span class="dt">int</span> a[<span class="dv">17</span>];</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true"></a><span class="dt">size_t</span> n = <span class="kw">sizeof</span>(a)/<span class="kw">sizeof</span>(a[<span class="dv">0</span>]);</span></code></pre></div>
<hr>
<p><strong>Full answer:</strong></p>
<p>
To determine the size of your array in bytes, you can use the <code>sizeof</code> operator:
</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true"></a><span class="dt">int</span> a[<span class="dv">17</span>];</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true"></a><span class="dt">size_t</span> n = <span class="kw">sizeof</span>(a);</span></code></pre></div>
<p>On my computer, ints are 4 bytes long, so n is 68.</p>
<p>
To determine the number of elements in the array, we can divide the total size of the array by the size of the array element. You could do this with the type, like this:
</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true"></a><span class="dt">int</span> a[<span class="dv">17</span>];</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true"></a><span class="dt">size_t</span> n = <span class="kw">sizeof</span>(a) / <span class="kw">sizeof</span>(<span class="dt">int</span>);</span></code></pre></div>
<p>
and get the proper answer (68 / 4 = 17), but if the type of <code>a</code> changed you would have a nasty bug if you forgot to change the <code>sizeof(int)</code> as well.
</p>
<p>
So the preferred divisor is <code>sizeof(a[0])</code>, the size of the zeroeth element of the array.
</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true"></a><span class="dt">int</span> a[<span class="dv">17</span>];</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true"></a><span class="dt">size_t</span> n = <span class="kw">sizeof</span>(a) / <span class="kw">sizeof</span>(a[<span class="dv">0</span>]);</span></code></pre></div>
<p>
Another advantage is that you can now easily parameterize the array name in a macro and get:
</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true"></a></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true"></a><span class="pp">#define NELEMS(x)  (sizeof(x) / sizeof((x)[0]))</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true"></a><span class="dt">int</span> a[<span class="dv">17</span>];</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true"></a><span class="dt">size_t</span> n = NELEMS(a);</span></code></pre></div>
</section>
<section id="answer-2-score-743" class="level4">
<h4>Answer 2 (score 743)</h4>
<p>The <code>sizeof</code> way is the right way <a href="https://en.wikipedia.org/wiki/If_and_only_if" rel="noreferrer"><em>iff</em></a> you are dealing with arrays not received as parameters. An array sent as a parameter to a function is treated as a pointer, so <code>sizeof</code> will return the pointer’s size, instead of the array’s.</p>
<p>Thus, inside functions this method does not work. Instead, always pass an additional parameter <code>size_t size</code> indicating the number of elements in the array.</p>
<p>Test:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true"></a></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdlib.h&gt;</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true"></a><span class="dt">void</span> printSizeOf(<span class="dt">int</span> intArray[]);</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true"></a><span class="dt">void</span> printLength(<span class="dt">int</span> intArray[]);</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true"></a><span class="dt">int</span> main(<span class="dt">int</span> argc, <span class="dt">char</span>* argv[])</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true"></a>{</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true"></a>    <span class="dt">int</span> array[] = { <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span> };</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true"></a></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true"></a>    printf(<span class="st">&quot;sizeof of array: %d</span><span class="sc">\n</span><span class="st">&quot;</span>, (<span class="dt">int</span>) <span class="kw">sizeof</span>(array));</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true"></a>    printSizeOf(array);</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true"></a></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true"></a>    printf(<span class="st">&quot;Length of array: %d</span><span class="sc">\n</span><span class="st">&quot;</span>, (<span class="dt">int</span>)( <span class="kw">sizeof</span>(array) / <span class="kw">sizeof</span>(array[<span class="dv">0</span>]) ));</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true"></a>    printLength(array);</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true"></a>}</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true"></a></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true"></a><span class="dt">void</span> printSizeOf(<span class="dt">int</span> intArray[])</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true"></a>{</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true"></a>    printf(<span class="st">&quot;sizeof of parameter: %d</span><span class="sc">\n</span><span class="st">&quot;</span>, (<span class="dt">int</span>) <span class="kw">sizeof</span>(intArray));</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true"></a>}</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true"></a></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true"></a><span class="dt">void</span> printLength(<span class="dt">int</span> intArray[])</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true"></a>{</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true"></a>    printf(<span class="st">&quot;Length of parameter: %d</span><span class="sc">\n</span><span class="st">&quot;</span>, (<span class="dt">int</span>)( <span class="kw">sizeof</span>(intArray) / <span class="kw">sizeof</span>(intArray[<span class="dv">0</span>]) ));</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true"></a>}</span></code></pre></div>
<p>Output (in a 64-bit Linux OS):</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true"></a><span class="kw">sizeof</span> of array: <span class="dv">28</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true"></a><span class="kw">sizeof</span> of parameter: <span class="dv">8</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true"></a>Length of array: <span class="dv">7</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true"></a>Length of parameter: <span class="dv">2</span></span></code></pre></div>
<p>Output (in a 32-bit windows OS):</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true"></a><span class="kw">sizeof</span> of array: <span class="dv">28</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true"></a><span class="kw">sizeof</span> of parameter: <span class="dv">4</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true"></a>Length of array: <span class="dv">7</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true"></a>Length of parameter: <span class="dv">1</span></span></code></pre></div>
</section>
<section id="answer-3-score-126" class="level4">
<h4>Answer 3 (score 126)</h4>
<p>It is worth noting that <code>sizeof</code> doesn’t help when dealing with an array value that has decayed to a pointer: even though it points to the start of an array, to the compiler it is the same as a pointer to a single element of that array. A pointer does not “remember” anything else about the array that was used to initialize it.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true"></a><span class="dt">int</span> a[<span class="dv">10</span>];</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true"></a><span class="dt">int</span>* p = a;</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true"></a>assert(<span class="kw">sizeof</span>(a) / <span class="kw">sizeof</span>(a[<span class="dv">0</span>]) == <span class="dv">10</span>);</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true"></a>assert(<span class="kw">sizeof</span>(p) == <span class="kw">sizeof</span>(<span class="dt">int</span>*));</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true"></a>assert(<span class="kw">sizeof</span>(*p) == <span class="kw">sizeof</span>(<span class="dt">int</span>));</span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="convert-char-to-int-in-c-and-c-score-1516373-in-2011" class="level3">
<h3>3: Convert char to int in C and C++ (score <a href="https://stackoverflow.com/q/5029840.html">1516373</a> in 2011)</h3>
<section id="question-2" class="level4">
<h4>Question</h4>
<p>How do I convert a <code>char</code> to an <code>int</code> in C and C++?</p>
</section>
<section id="answer-2-score-466" class="level4">
<h4>Answer 2 (score 466)</h4>
<p>Depends on what you want to do:</p>
<p>to read the value as an ascii code, you can write</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true"></a><span class="dt">char</span> a = <span class="ch">&#39;a&#39;</span>;</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true"></a><span class="dt">int</span> ia = (<span class="dt">int</span>)a; </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true"></a><span class="co">/* note that the int cast is not necessary -- int ia = a would suffice */</span></span></code></pre></div>
<p>to convert the character <code>'0' -&amp;gt; 0</code>, <code>'1' -&amp;gt; 1</code>, etc, you can write</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true"></a><span class="dt">char</span> a = <span class="ch">&#39;4&#39;</span>;</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true"></a><span class="dt">int</span> ia = a - <span class="ch">&#39;0&#39;</span>;</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true"></a><span class="co">/* check here if ia is bounded by 0 and 9 */</span></span></code></pre></div>
<p>
<strong>Explanation</strong>:<br> <code>a - '0'</code> is equivalent to <code>((int)a) - ((int)'0')</code>, which means the ascii values of the characters are subtracted from each other. Since <code>0</code> comes directly before <code>1</code> in the ascii table (and so on until <code>9</code>), the difference between the two gives the number that the character <code>a</code> represents.
</p>
</section>
<section id="answer-3-score-78" class="level4">
<h4>Answer 3 (score 78)</h4>
<p>Well, in ASCII code, the numbers (digits) start from <strong>48</strong>. All you need to do is:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true"></a><span class="dt">int</span> x = (<span class="dt">int</span>)character - <span class="dv">48</span>;</span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-to-generate-a-random-int-in-c-score-1515123-in-2018" class="level3">
<h3>4: How to generate a random int in C? (score <a href="https://stackoverflow.com/q/822323.html">1515123</a> in 2018)</h3>
<section id="question-3" class="level4">
<h4>Question</h4>
<p>Is there a function to generate a random int number in C? Or will I have to use a third party library?</p>
</section>
<section id="answer-accepted-score-639" class="level4">
<h4>Answer accepted (score 639)</h4>
<blockquote>
<strong>Note</strong>: Don’t use <code>rand()</code> for security. If you need a cryptographically secure number, <a href="https://stackoverflow.com/a/39475626/2224584">see this answer</a> instead.
</blockquote>
<div class="sourceCode" id="cb23"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true"></a></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;time.h&gt;</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdlib.h&gt;</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true"></a>srand(time(NULL));   <span class="co">// Initialization, should only be called once.</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true"></a><span class="dt">int</span> r = rand();      <span class="co">// Returns a pseudo-random integer between 0 and RAND_MAX.</span></span></code></pre></div>
<p><em>Edit</em>: On Linux, you might prefer to use <a href="https://linux.die.net/man/3/random" rel="noreferrer">random and srandom</a>.</p>
</section>
<section id="answer-2-score-229" class="level4">
<h4>Answer 2 (score 229)</h4>
<p>The <code>rand()</code> function in <code>&amp;lt;stdlib.h&amp;gt;</code> returns a pseudo-random integer between 0 and <code>RAND_MAX</code>. You can use <code>srand(unsigned int seed)</code> to set a seed.</p>
<p>It’s common practice to use the <code>%</code> operator in conjunction with <code>rand()</code> to get a different range (though bear in mind that this throws off the uniformity somewhat). For example:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true"></a><span class="co">/* random int between 0 and 19 */</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true"></a><span class="dt">int</span> r = rand() % <span class="dv">20</span>;</span></code></pre></div>
<p>If you <em>really</em> care about uniformity you can do something like this:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true"></a><span class="co">/* Returns an integer in the range [0, n).</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true"></a><span class="co"> *</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true"></a><span class="co"> * Uses rand(), and so is affected-by/affects the same seed.</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true"></a><span class="co"> */</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true"></a><span class="dt">int</span> randint(<span class="dt">int</span> n) {</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true"></a>  <span class="cf">if</span> ((n - <span class="dv">1</span>) == RAND_MAX) {</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true"></a>    <span class="cf">return</span> rand();</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true"></a>  } <span class="cf">else</span> {</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true"></a>    <span class="co">// Supporting larger values for n would requires an even more</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true"></a>    <span class="co">// elaborate implementation that combines multiple calls to rand()</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true"></a>    assert (n &lt;= RAND_MAX)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true"></a></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true"></a>    <span class="co">// Chop off all of the values that would cause skew...</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true"></a>    <span class="dt">int</span> end = RAND_MAX / n; <span class="co">// truncate skew</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true"></a>    assert (end &gt; <span class="dv">0</span>);</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true"></a>    end *= n;</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true"></a></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true"></a>    <span class="co">// ... and ignore results from rand() that fall above that limit.</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true"></a>    <span class="co">// (Worst case the loop condition should succeed 50% of the time,</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true"></a>    <span class="co">// so we can expect to bail out of this loop pretty quickly.)</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true"></a>    <span class="dt">int</span> r;</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true"></a>    <span class="cf">while</span> ((r = rand()) &gt;= end);</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true"></a></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true"></a>    <span class="cf">return</span> r % n;</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true"></a>  }</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true"></a>}</span></code></pre></div>
</section>
<section id="answer-3-score-51" class="level4">
<h4>Answer 3 (score 51)</h4>
<h5>
If you need secure random characters or integers:
</h3>
<p>As addressed in <a href="https://paragonie.com/blog/2016/05/how-generate-secure-random-numbers-in-various-programming-languages
#c-csprng" rel="noreferrer">how to safely generate random numbers in various programming languages</a>, you’ll want to do one of the following:</p>
<ul>
<li>
Use <a href="https://github.com/jedisct1/libsodium" rel="noreferrer">libsodium</a>’s <code>randombytes</code> API
</li>
<li>
Re-implement what you need from <a href="https://github.com/jedisct1/libsodium/blob/master/src/libsodium/randombytes/sysrandom/randombytes_sysrandom.c" rel="noreferrer">libsodium’s sysrandom implementation</a> yourself, very carefully
</li>
<li>
More broadly, <a href="http://sockpuppet.org/blog/2014/02/25/safely-generate-random-numbers/" rel="noreferrer">use <code>/dev/urandom</code></a>, not <code>/dev/random</code>. Not OpenSSL (or other userspace PRNGs).
</li>
</ul>
<p>For example:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true"></a></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;sodium.h&quot;</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true"></a><span class="dt">int</span> foo()</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true"></a>{</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true"></a>    <span class="dt">char</span> myString[<span class="dv">32</span>];</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true"></a>    <span class="dt">uint32_t</span> myInt;</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true"></a></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true"></a>    <span class="cf">if</span> (sodium_init() &lt; <span class="dv">0</span>) {</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true"></a>        <span class="co">/* panic! the library couldn&#39;t be initialized, it is not safe to use */</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true"></a>        <span class="cf">return</span> <span class="dv">1</span>; </span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true"></a>    }</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true"></a></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true"></a></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true"></a>    <span class="co">/* myString will be an array of 32 random bytes, not null-terminated */</span>        </span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true"></a>    randombytes_buf(myString, <span class="dv">32</span>);</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true"></a></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true"></a>    <span class="co">/* myInt will be a random number between 0 and 9 */</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true"></a>    myInt = randombytes_uniform(<span class="dv">10</span>);</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true"></a>}</span></code></pre></div>
<p><code>randombytes_uniform()</code> is cryptographically secure and unbiased.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="using-boolean-values-in-c-score-1246473-in-2016" class="level3">
<h3>5: Using boolean values in C (score <a href="https://stackoverflow.com/q/1921539.html">1246473</a> in 2016)</h3>
<section id="question-4" class="level4">
<h4>Question</h4>
<p>C doesn’t have any built-in boolean types. What’s the best way to use them in C?</p>
</section>
<section id="answer-accepted-score-981" class="level4">
<h4>Answer accepted (score 981)</h4>
<p>From best to worse:</p>
<p><strong>Option 1 (C99)</strong></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true"></a></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdbool.h&gt;</span></span></code></pre></div>
<p><strong>Option 2</strong></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true"></a><span class="kw">typedef</span> <span class="kw">enum</span> { false, true } <span class="dt">bool</span>;</span></code></pre></div>
<p><strong>Option 3</strong></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true"></a><span class="kw">typedef</span> <span class="dt">int</span> <span class="dt">bool</span>;</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true"></a><span class="kw">enum</span> { false, true };</span></code></pre></div>
<p><strong>Option 4</strong></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true"></a><span class="kw">typedef</span> <span class="dt">int</span> <span class="dt">bool</span>;</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true"></a><span class="pp">#define true 1</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true"></a><span class="pp">#define false 0</span></span></code></pre></div>
<h5>
Explanation
</h1>
<ul>
<li>
Option 1 will work only if you use C99 and it’s the “standard way” to do it. Choose this if possible.
</li>
<li>
Options 2, 3 and 4 will have in practice the same identical behavior. #2 and #3 don’t use #defines though, which in my opinion is better.
</li>
</ul>
<p>If you are undecided, go with #1!</p>
</section>
<section id="answer-2-score-229-1" class="level4">
<h4>Answer 2 (score 229)</h4>
<p>A few thoughts on booleans in C:</p>
<p>I’m old enough that I just use plain <code>int</code>s as my boolean type without any typedefs or special defines or enums for true/false values. If you follow my suggestion below on never comparing against boolean constants, then you only need to use 0/1 to initialize the flags anyway. However, such an approach may be deemed too reactionary in these modern times. In that case, one should definitely use <code>&amp;lt;stdbool.h&amp;gt;</code> since it at least has the benefit of being standardized.</p>
<p>Whatever the boolean constants are called, use them only for initialization. Never ever write something like</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true"></a><span class="cf">if</span> (ready == TRUE) ...</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true"></a><span class="cf">while</span> (empty == FALSE) ...</span></code></pre></div>
<p>These can always be replaced by the clearer</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true"></a><span class="cf">if</span> (ready) ...</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true"></a><span class="cf">while</span> (!empty) ...</span></code></pre></div>
<p>Note that these can actually reasonably and understandably be read out loud.</p>
<p>Give your boolean variables positive names, ie <code>full</code> instead of <code>notfull</code>. The latter leads to code that is difficult to read easily. Compare</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true"></a><span class="cf">if</span> (full) ...</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true"></a><span class="cf">if</span> (!full) ...</span></code></pre></div>
<p>with</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true"></a><span class="cf">if</span> (!notfull) ...</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true"></a><span class="cf">if</span> (notfull) ...</span></code></pre></div>
<p>Both of the former pair read naturally, while <code>!notfull</code> is awkward to read even as it is, and becomes much worse in more complex boolean expressions.</p>
<p>Boolean arguments should generally be avoided. Consider a function defined like this</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true"></a><span class="dt">void</span> foo(<span class="dt">bool</span> option) { ... }</span></code></pre></div>
<p>Within the body of the function, it is very clear what the argument means since it has a convenient, and hopefully meaningful, name. But, the call sites look like</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true"></a>foo(TRUE);</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true"></a>foo(FALSE):</span></code></pre></div>
<p>Here, it’s essentially impossible to tell what the parameter meant without always looking at the function definition or declaration, and it gets much worse as soon if you add even more boolean parameters. I suggest either</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true"></a><span class="kw">typedef</span> <span class="kw">enum</span> { OPT_ON, OPT_OFF } foo_option;</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true"></a><span class="dt">void</span> foo(foo_option option);</span></code></pre></div>
<p>or</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true"></a></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true"></a><span class="pp">#define OPT_ON true</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true"></a><span class="pp">#define OPT_OFF false</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true"></a><span class="dt">void</span> foo(<span class="dt">bool</span> option) { ... }</span></code></pre></div>
<p>In either case, the call site now looks like</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true"></a>foo(OPT_ON);</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true"></a>foo(OPT_OFF);</span></code></pre></div>
<p>which the reader has at least a chance of understanding without dredging up the definition of <code>foo</code>.</p>
</section>
<section id="answer-3-score-83" class="level4">
<h4>Answer 3 (score 83)</h4>
<p>A boolean in C is an integer: zero for false and non-zero for true.</p>
<p>See also <a href="https://en.wikipedia.org/wiki/Boolean_data_type
#C.2C_C.2B.2B.2C_Objective-C.2C_AWK" rel="noreferrer"><em>Boolean data type</em>, section <em>C, C++, Objective-C, AWK</em></a>.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-do-you-set-clear-and-toggle-a-single-bit-score-1095506-in-2019" class="level3">
<h3>6: How do you set, clear, and toggle a single bit? (score <a href="https://stackoverflow.com/q/47981.html">1095506</a> in 2019)</h3>
<section id="question-5" class="level4">
<h4>Question</h4>
<p>How do you set, clear, and toggle a bit?</p>
</section>
<section id="answer-accepted-score-3407" class="level4">
<h4>Answer accepted (score 3407)</h4>
<h5>
Setting a bit
</h1>
<p>Use the bitwise OR operator (<code>|</code>) to set a bit.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true"></a>number |= <span class="dv">1</span><span class="bu">UL</span> &lt;&lt; n;</span></code></pre></div>
<p>That will set the <code>n</code>th bit of <code>number</code>. <code>n</code> should be zero, if you want to set the <code>1</code>st bit and so on upto <code>n-1</code>, if you want to set the <code>n</code>th bit.</p>
<p>Use <code>1ULL</code> if <code>number</code> is wider than <code>unsigned long</code>; promotion of <code>1UL &amp;lt;&amp;lt; n</code> doesn’t happen until after evaluating <code>1UL &amp;lt;&amp;lt; n</code> where it’s undefined behaviour to shift by more than the width of a <code>long</code>. The same applies to all the rest of the examples.</p>
<h5>
Clearing a bit
</h1>
<p>Use the bitwise AND operator (<code>&amp;amp;</code>) to clear a bit.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true"></a>number &amp;= ~(<span class="dv">1</span><span class="bu">UL</span> &lt;&lt; n);</span></code></pre></div>
<p>That will clear the <code>n</code>th bit of <code>number</code>. You must invert the bit string with the bitwise NOT operator (<code>~</code>), then AND it.</p>
<h5>
Toggling a bit
</h1>
<p>The XOR operator (<code>^</code>) can be used to toggle a bit.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true"></a>number ^= <span class="dv">1</span><span class="bu">UL</span> &lt;&lt; n;</span></code></pre></div>
<p>That will toggle the <code>n</code>th bit of <code>number</code>.</p>
<h5>
Checking a bit
</h1>
<p>You didn’t ask for this, but I might as well add it.</p>
<p>To check a bit, shift the number n to the right, then bitwise AND it:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true"></a>bit = (number &gt;&gt; n) &amp; <span class="dv">1</span><span class="bu">U</span>;</span></code></pre></div>
<p>That will put the value of the <code>n</code>th bit of <code>number</code> into the variable <code>bit</code>.</p>
<h5>
Changing the <em>n</em>th bit to <em>x</em>
</h1>
<p>Setting the <code>n</code>th bit to either <code>1</code> or <code>0</code> can be achieved with the following on a 2’s complement C++ implementation:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true"></a>number ^= (-x ^ number) &amp; (<span class="dv">1</span><span class="bu">UL</span> &lt;&lt; n);</span></code></pre></div>
<p>Bit <code>n</code> will be set if <code>x</code> is <code>1</code>, and cleared if <code>x</code> is <code>0</code>. If <code>x</code> has some other value, you get garbage. <code>x = !!x</code> will booleanize it to 0 or 1.</p>
<p>To make this independent of 2’s complement negation behaviour (where <code>-1</code> has all bits set, unlike on a 1’s complement or sign/magnitude C++ implementation), use unsigned negation.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true"></a>number ^= (-(<span class="dt">unsigned</span> <span class="dt">long</span>)x ^ number) &amp; (<span class="dv">1</span><span class="bu">UL</span> &lt;&lt; n);</span></code></pre></div>
<p>or</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true"></a><span class="dt">unsigned</span> <span class="dt">long</span> newbit = !!x;    <span class="co">// Also booleanize to force 0 or 1</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true"></a>number ^= (-newbit ^ number) &amp; (<span class="dv">1</span><span class="bu">UL</span> &lt;&lt; n);</span></code></pre></div>
<p>It’s generally a good idea to use unsigned types for portable bit manipulation.</p>
<p>or</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true"></a>number = (number &amp; ~(<span class="dv">1</span><span class="bu">UL</span> &lt;&lt; n)) | (x &lt;&lt; n);</span></code></pre></div>
<p><code>(number &amp;amp; ~(1UL &amp;lt;&amp;lt; n))</code> will clear the <code>n</code>th bit and <code>(x &amp;lt;&amp;lt; n)</code> will set the <code>n</code>th bit to <code>x</code>.</p>
<p>It’s also generally a good idea to not to copy/paste code in general and so many people use preprocessor macros (like <a href="https://stackoverflow.com/a/263738/52074">the community wiki answer further down</a>) or some sort of encapsulation.</p>
</section>
<section id="answer-2-score-438" class="level4">
<h4>Answer 2 (score 438)</h4>
<p>Using the Standard C++ Library: <a href="http://en.cppreference.com/w/cpp/utility/bitset" rel="noreferrer"><code>std::bitset&amp;lt;N&amp;gt;</code></a>.</p>
<p>Or the <a href="http://en.wikipedia.org/wiki/Boost_%28C%2B%2B_libraries%29" rel="noreferrer">Boost</a> version: <a href="http://www.boost.org/doc/libs/release/libs/dynamic_bitset/dynamic_bitset.html" rel="noreferrer"><code>boost::dynamic_bitset</code></a>.</p>
<p>There is no need to roll your own:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true"></a></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;bitset&gt;</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true"></a><span class="dt">int</span> main()</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true"></a>{</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true"></a>    std::bitset&lt;<span class="dv">5</span>&gt; x;</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true"></a></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true"></a>    x[<span class="dv">1</span>] = <span class="dv">1</span>;</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true"></a>    x[<span class="dv">2</span>] = <span class="dv">0</span>;</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true"></a>    <span class="co">// Note x[0-4]  valid</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true"></a></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true"></a>    std::cout &lt;&lt; x &lt;&lt; std::endl;</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true"></a>}</span></code></pre></div>
<hr>
<div class="sourceCode" id="cb49"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true"></a>[Alpha:] &gt; ./a.out</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true"></a><span class="bn">00010</span></span></code></pre></div>
<p>The Boost version allows a runtime sized bitset compared with a <a href="https://en.wikipedia.org/wiki/C%2B%2B_Standard_Library" rel="noreferrer">standard library</a> compile-time sized bitset.</p>
</section>
<section id="answer-3-score-234" class="level4">
<h4>Answer 3 (score 234)</h4>
<p>The other option is to use bit fields:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true"></a><span class="kw">struct</span> bits {</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true"></a>    <span class="dt">unsigned</span> <span class="dt">int</span> a:<span class="dv">1</span>;</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true"></a>    <span class="dt">unsigned</span> <span class="dt">int</span> b:<span class="dv">1</span>;</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true"></a>    <span class="dt">unsigned</span> <span class="dt">int</span> c:<span class="dv">1</span>;</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true"></a>};</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true"></a></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true"></a><span class="kw">struct</span> bits mybits;</span></code></pre></div>
<p>defines a 3-bit field (actually, it’s three 1-bit felds). Bit operations now become a bit (haha) simpler:</p>
<p>To set or clear a bit:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true"></a>mybits.b = <span class="dv">1</span>;</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true"></a>mybits.c = <span class="dv">0</span>;</span></code></pre></div>
<p>To toggle a bit:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true"></a>mybits.a = !mybits.a;</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true"></a>mybits.b = ~mybits.b;</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true"></a>mybits.c ^= <span class="dv">1</span>;  <span class="co">/* all work */</span></span></code></pre></div>
<p>Checking a bit:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true"></a><span class="cf">if</span> (mybits.c)  <span class="co">//if mybits.c is non zero the next line below will execute</span></span></code></pre></div>
<p>This only works with fixed-size bit fields. Otherwise you have to resort to the bit-twiddling techniques described in previous posts.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-do-i-concatenate-constliteral-strings-in-c-score-964267-in-2017" class="level3">
<h3>7: How do I concatenate const/literal strings in C? (score <a href="https://stackoverflow.com/q/308695.html">964267</a> in 2017)</h3>
<section id="question-6" class="level4">
<h4>Question</h4>
<p>I’m working in C, and I have to concatenate a few things.</p>
<p>Right now I have this:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true"></a>message = strcat(<span class="st">&quot;TEXT &quot;</span>, var);</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true"></a>message2 = strcat(strcat(<span class="st">&quot;TEXT &quot;</span>, foo), strcat(<span class="st">&quot; TEXT &quot;</span>, bar));</span></code></pre></div>
<p>Now if you have experience in C I’m sure you realize that this gives you a segmentation fault when you try to run it. So how do I work around that?</p>
</section>
<section id="answer-accepted-score-351" class="level4">
<h4>Answer accepted (score 351)</h4>
<p>In C, “strings” are just plain <code>char</code> arrays. Therefore, you can’t directly concatenate them with other “strings”.</p>
<p>You can use the <code>strcat</code> function, which appends the string pointed to by <code>src</code> to the end of the string pointed to by <code>dest</code>:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true"></a><span class="dt">char</span> *strcat(<span class="dt">char</span> *dest, <span class="dt">const</span> <span class="dt">char</span> *src);</span></code></pre></div>
<p>Here is an <a href="http://www.cplusplus.com/reference/clibrary/cstring/strcat.html" rel="noreferrer">example from cplusplus.com</a>:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true"></a><span class="dt">char</span> str[<span class="dv">80</span>];</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true"></a>strcpy(str, <span class="st">&quot;these &quot;</span>);</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true"></a>strcat(str, <span class="st">&quot;strings &quot;</span>);</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true"></a>strcat(str, <span class="st">&quot;are &quot;</span>);</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true"></a>strcat(str, <span class="st">&quot;concatenated.&quot;</span>);</span></code></pre></div>
<p>For the first parameter, you need to provide the destination buffer itself. The destination buffer must be a char array buffer. E.g.: <code>char buffer[1024];</code></p>
<p><strong>Make sure</strong> that the first parameter has enough space to store what you’re trying to copy into it. If available to you, it is safer to use functions like: <code>strcpy_s</code> and <code>strcat_s</code> where you explicitly have to specify the size of the destination buffer.</p>
<p><em>Note</em>: A string literal cannot be used as a buffer, since it is a constant. Thus, you always have to allocate a char array for the buffer.</p>
<p>The return value of <code>strcat</code> can simply be ignored, it merely returns the same pointer as was passed in as the first argument. It is there for convenience, and allows you to chain the calls into one line of code:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true"></a>strcat(strcat(str, foo), bar);</span></code></pre></div>
<p>So your problem could be solved as follows:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true"></a><span class="dt">char</span> *foo = <span class="st">&quot;foo&quot;</span>;</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true"></a><span class="dt">char</span> *bar = <span class="st">&quot;bar&quot;</span>;</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true"></a><span class="dt">char</span> str[<span class="dv">80</span>];</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true"></a>strcpy(str, <span class="st">&quot;TEXT &quot;</span>);</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true"></a>strcat(str, foo);</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true"></a>strcat(str, bar);</span></code></pre></div>
</section>
<section id="answer-2-score-236" class="level4">
<h4>Answer 2 (score 236)</h4>
<p>Avoid using <a href="http://en.cppreference.com/w/cpp/string/byte/strcat" rel="noreferrer"><code>strcat</code></a> in C code. The cleanest and, most importantly, the safest way is to use <a href="http://en.cppreference.com/w/cpp/io/c/snprintf" rel="noreferrer"><code>snprintf</code></a>:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true"></a><span class="dt">char</span> buf[<span class="dv">256</span>];</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true"></a>snprintf(buf, <span class="kw">sizeof</span> buf, <span class="st">&quot;%s%s%s%s&quot;</span>, str1, str2, str3, str4);</span></code></pre></div>
<p>Some commenters raised an issue that the number of arguments may not match the format string and the code will still compile, but most compilers already issue a warning if this is the case.</p>
</section>
<section id="answer-3-score-24" class="level4">
<h4>Answer 3 (score 24)</h4>
<p>
Folks, use str<b>n</b>cpy(), str<b>n</b>cat(), or s<b>n</b>printf(). <br>Exceeding your buffer space will trash whatever else follows in memory! <br>(And remember to allow space for the trailing null ‘\0’ character!)
</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-to-convert-integer-to-string-in-c-score-945144-in-2018" class="level3">
<h3>8: How to convert integer to string in C? (score <a href="https://stackoverflow.com/q/9655202.html">945144</a> in 2018)</h3>
<section id="question-7" class="level4">
<h4>Question</h4>
<p>I tried this example:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true"></a><span class="co">/* itoa example */</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true"></a></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdlib.h&gt;</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true"></a></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true"></a><span class="dt">int</span> main ()</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true"></a>{</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true"></a>    <span class="dt">int</span> i;</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true"></a>    <span class="dt">char</span> buffer [<span class="dv">33</span>];</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true"></a>    printf (<span class="st">&quot;Enter a number: &quot;</span>);</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true"></a>    scanf (<span class="st">&quot;%d&quot;</span>,&amp;i);</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true"></a>    itoa (i,buffer,<span class="dv">10</span>);</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true"></a>    printf (<span class="st">&quot;decimal: %s</span><span class="sc">\n</span><span class="st">&quot;</span>,buffer);</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true"></a>    itoa (i,buffer,<span class="dv">16</span>);</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true"></a>    printf (<span class="st">&quot;hexadecimal: %s</span><span class="sc">\n</span><span class="st">&quot;</span>,buffer);</span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true"></a>    itoa (i,buffer,<span class="dv">2</span>);</span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true"></a>    printf (<span class="st">&quot;binary: %s</span><span class="sc">\n</span><span class="st">&quot;</span>,buffer);</span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true"></a>}</span></code></pre></div>
<p>but the example there doesn’t work (it says the function <code>itoa</code> doesn’t exist).</p>
</section>
<section id="answer-accepted-score-274" class="level4">
<h4>Answer accepted (score 274)</h4>
<p>Use <a href="http://en.cppreference.com/w/c/io/fprintf" rel="noreferrer"><code>sprintf()</code></a>:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true"></a><span class="dt">int</span> someInt = <span class="dv">368</span>;</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true"></a><span class="dt">char</span> str[<span class="dv">12</span>];</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true"></a>sprintf(str, <span class="st">&quot;%d&quot;</span>, someInt);</span></code></pre></div>
<p>All numbers that are representable by <code>int</code> will fit in a 12-char-array without overflow, unless your compiler is somehow using more than 32-bits for <code>int</code>. When using numbers with greater bitsize, e.g. <code>long</code> with most 64-bit compilers, you need to increase the array size—at least 21 characters for 64-bit types.</p>
</section>
<section id="answer-2-score-51" class="level4">
<h4>Answer 2 (score 51)</h4>
<p>Making your own <code>itoa</code> is also easy, try this :</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true"></a><span class="dt">char</span>* itoa(<span class="dt">int</span> i, <span class="dt">char</span> b[]){</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true"></a>    <span class="dt">char</span> <span class="dt">const</span> digit[] = <span class="st">&quot;0123456789&quot;</span>;</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true"></a>    <span class="dt">char</span>* p = b;</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true"></a>    <span class="cf">if</span>(i&lt;<span class="dv">0</span>){</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true"></a>        *p++ = <span class="ch">&#39;-&#39;</span>;</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true"></a>        i *= -<span class="dv">1</span>;</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true"></a>    }</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true"></a>    <span class="dt">int</span> shifter = i;</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true"></a>    <span class="cf">do</span>{ <span class="co">//Move to where representation ends</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true"></a>        ++p;</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true"></a>        shifter = shifter/<span class="dv">10</span>;</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true"></a>    }<span class="cf">while</span>(shifter);</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true"></a>    *p = <span class="ch">&#39;\0&#39;</span>;</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true"></a>    <span class="cf">do</span>{ <span class="co">//Move back, inserting digits as u go</span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true"></a>        *--p = digit[i%<span class="dv">10</span>];</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true"></a>        i = i/<span class="dv">10</span>;</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true"></a>    }<span class="cf">while</span>(i);</span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true"></a>    <span class="cf">return</span> b;</span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true"></a>}</span></code></pre></div>
<p>or use the standard <code>sprintf()</code> function.</p>
</section>
<section id="answer-3-score-44" class="level4">
<h4>Answer 3 (score 44)</h4>
<p>That’s because <code>itoa</code> isn’t a standard function. Try <code>snprintf</code> instead.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true"></a><span class="dt">char</span> str[LEN];</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true"></a>snprintf(str, LEN, <span class="st">&quot;%d&quot;</span>, <span class="dv">42</span>);</span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="what-is-the-difference-between-float-and-double-score-936859-in-2018" class="level3">
<h3>9: What is the difference between float and double? (score <a href="https://stackoverflow.com/q/2386772.html">936859</a> in 2018)</h3>
<section id="question-8" class="level4">
<h4>Question</h4>
<p>I’ve read about the difference between double precision and single precision. However, in most cases, <code>float</code> and <code>double</code> seem to be interchangeable, i.e. using one or the other does not seem to affect the results. Is this really the case? When are floats and doubles interchangeable? What are the differences between them?</p>
</section>
<section id="answer-accepted-score-466" class="level4">
<h4>Answer accepted (score 466)</h4>
<p>Huge difference.</p>
<p>As the name implies, a <a href="http://en.wikipedia.org/wiki/Double_precision_floating-point_format" rel="noreferrer"><code>double</code></a> has 2x the precision of <a href="http://en.wikipedia.org/wiki/Single_precision_floating-point_format" rel="noreferrer"><code>float</code></a><sup>[1]</sup>. In general a <code>double</code> has 15 decimal digits of precision, while <code>float</code> has 7.</p>
<p>Here’s how the number of digits are calculated:</p>
<blockquote>
<p><code>double</code> has 52 mantissa bits + 1 hidden bit: log(2<sup>53</sup>)÷log(10) = 15.95 digits</p>
<code>float</code> has 23 mantissa bits + 1 hidden bit: log(2<sup>24</sup>)÷log(10) = 7.22 digits
</blockquote>
<p>This precision loss could lead to greater truncation errors being accumulated when repeated calculations are done, e.g. </p>
<div class="sourceCode" id="cb64"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true"></a><span class="dt">float</span> a = <span class="fl">1.</span><span class="bu">f</span> / <span class="dv">81</span>;</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true"></a><span class="dt">float</span> b = <span class="dv">0</span>;</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true"></a><span class="cf">for</span> (<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; <span class="dv">729</span>; ++ i)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true"></a>    b += a;</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true"></a>printf(<span class="st">&quot;%.7g</span><span class="sc">\n</span><span class="st">&quot;</span>, b); <span class="co">// prints 9.000023</span></span></code></pre></div>
<p>while</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true"></a><span class="dt">double</span> a = <span class="fl">1.0</span> / <span class="dv">81</span>;</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true"></a><span class="dt">double</span> b = <span class="dv">0</span>;</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true"></a><span class="cf">for</span> (<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; <span class="dv">729</span>; ++ i)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true"></a>    b += a;</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true"></a>printf(<span class="st">&quot;%.15g</span><span class="sc">\n</span><span class="st">&quot;</span>, b); <span class="co">// prints 8.99999999999996</span></span></code></pre></div>
<p>Also, the maximum value of float is about <code>3e38</code>, but double is about <code>1.7e308</code>, so using <code>float</code> can hit “infinity” (i.e. a special floating-point number) much more easily than <code>double</code> for something simple, e.g. computing the factorial of 60.</p>
<p>During testing, maybe a few test cases contain these huge numbers, which may cause your programs to fail if you use floats.</p>
<hr>
<p>Of course, sometimes, even <code>double</code> isn’t accurate enough, hence we sometimes have <code>long double</code><sup>[1]</sup> (the above example gives 9.000000000000000066 on Mac), but all floating point types suffer from <em>round-off errors</em>, so if precision is very important (e.g. money processing) you should use <code>int</code> or a fraction class.</p>
<hr>
<p>Furthermore, don’t use <code>+=</code> to sum lots of floating point numbers, as the errors accumulate quickly. If you’re using Python, use <code>fsum</code>. Otherwise, try to implement the <a href="http://en.wikipedia.org/wiki/Kahan_summation_algorithm" rel="noreferrer">Kahan summation algorithm</a>.</p>
<hr>
<p><sup>[1]: The C and C++ standards do not specify the representation of <code>float</code>, <code>double</code> and <code>long double</code>. It is possible that all three are implemented as IEEE double-precision. Nevertheless, for most architectures (gcc, MSVC; x86, x64, ARM) <code>float</code> <em>is</em> indeed a IEEE single-precision floating point number (binary32), and <code>double</code> <em>is</em> a IEEE double-precision floating point number (binary64).</sup></p>
</section>
<section id="answer-2-score-54" class="level4">
<h4>Answer 2 (score 54)</h4>
<p>Here is what the standard C99 (ISO-IEC 9899 6.2.5 §10) or C++2003 (ISO-IEC 14882-2003 3.1.9 §8) standards say:</p>
<blockquote>
There are three floating point types: <code>float</code>, <code>double</code>, and <code>long double</code>. The type <code>double</code> provides at least as much precision as <code>float</code>, and the type <code>long double</code> provides at least as much precision as <code>double</code>. The set of values of the type <code>float</code> is a subset of the set of values of the type <code>double</code>; the set of values of the type <code>double</code> is a subset of the set of values of the type <code>long double</code>.
</blockquote>
<p>The C++ standard adds:</p>
<blockquote>
The value representation of floating-point types is implementation-defined.
</blockquote>
<p>I would suggest having a look at the excellent <a href="http://docs.sun.com/source/806-3568/ncg_goldberg.html" rel="noreferrer">What Every Computer Scientist Should Know About Floating-Point Arithmetic</a> that covers the IEEE floating-point standard in depth. You’ll learn about the representation details and you’ll realize there is a tradeoff between magnitude and precision. The precision of the floating point representation increases as the magnitude decreases, hence floating point numbers between -1 and 1 are those with the most precision.</p>
</section>
<section id="answer-3-score-26" class="level4">
<h4>Answer 3 (score 26)</h4>
<p>Given a quadratic equation: <em>x</em><sup>2</sup> − 4.0000000 <em>x</em> + 3.9999999 = 0, the exact roots to 10 significant digits are, <em>r</em><sub>1</sub> = 2.000316228 and <em>r</em><sub>2</sub> = 1.999683772.</p>
<p>Using <code>float</code> and <code>double</code>, we can write a test program:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true"></a></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;math.h&gt;</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true"></a></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true"></a><span class="dt">void</span> dbl_solve(<span class="dt">double</span> a, <span class="dt">double</span> b, <span class="dt">double</span> c)</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true"></a>{</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true"></a>    <span class="dt">double</span> d = b*b - <span class="fl">4.0</span>*a*c;</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true"></a>    <span class="dt">double</span> sd = sqrt(d);</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true"></a>    <span class="dt">double</span> r1 = (-b + sd) / (<span class="fl">2.0</span>*a);</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true"></a>    <span class="dt">double</span> r2 = (-b - sd) / (<span class="fl">2.0</span>*a);</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true"></a>    printf(<span class="st">&quot;%.5f</span><span class="sc">\t</span><span class="st">%.5f</span><span class="sc">\n</span><span class="st">&quot;</span>, r1, r2);</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true"></a>}</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true"></a></span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true"></a><span class="dt">void</span> flt_solve(<span class="dt">float</span> a, <span class="dt">float</span> b, <span class="dt">float</span> c)</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true"></a>{</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true"></a>    <span class="dt">float</span> d = b*b - <span class="fl">4.0</span><span class="bu">f</span>*a*c;</span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true"></a>    <span class="dt">float</span> sd = sqrtf(d);</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true"></a>    <span class="dt">float</span> r1 = (-b + sd) / (<span class="fl">2.0</span><span class="bu">f</span>*a);</span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true"></a>    <span class="dt">float</span> r2 = (-b - sd) / (<span class="fl">2.0</span><span class="bu">f</span>*a);</span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true"></a>    printf(<span class="st">&quot;%.5f</span><span class="sc">\t</span><span class="st">%.5f</span><span class="sc">\n</span><span class="st">&quot;</span>, r1, r2);</span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true"></a>}   </span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true"></a></span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true"></a><span class="dt">int</span> main(<span class="dt">void</span>)</span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true"></a>{</span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true"></a>    <span class="dt">float</span> fa = <span class="fl">1.0</span><span class="bu">f</span>;</span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true"></a>    <span class="dt">float</span> fb = -<span class="fl">4.0000000</span><span class="bu">f</span>;</span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true"></a>    <span class="dt">float</span> fc = <span class="fl">3.9999999</span><span class="bu">f</span>;</span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true"></a>    <span class="dt">double</span> da = <span class="fl">1.0</span>;</span>
<span id="cb66-30"><a href="#cb66-30" aria-hidden="true"></a>    <span class="dt">double</span> db = -<span class="fl">4.0000000</span>;</span>
<span id="cb66-31"><a href="#cb66-31" aria-hidden="true"></a>    <span class="dt">double</span> dc = <span class="fl">3.9999999</span>;</span>
<span id="cb66-32"><a href="#cb66-32" aria-hidden="true"></a>    flt_solve(fa, fb, fc);</span>
<span id="cb66-33"><a href="#cb66-33" aria-hidden="true"></a>    dbl_solve(da, db, dc);</span>
<span id="cb66-34"><a href="#cb66-34" aria-hidden="true"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb66-35"><a href="#cb66-35" aria-hidden="true"></a>}  </span></code></pre></div>
<p>Running the program gives me:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true"></a><span class="fl">2.00000</span> <span class="fl">2.00000</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true"></a><span class="fl">2.00032</span> <span class="fl">1.99968</span></span></code></pre></div>
<p>Note that the numbers aren’t large, but still you get cancellation effects using <code>float</code>.</p>
<p>(In fact, the above is not the best way of solving quadratic equations using either single- or double-precision floating-point numbers, but the answer remains unchanged even if one uses a <a href="http://en.wikipedia.org/wiki/Quadratic_equation
#Floating_point_implementation" rel="noreferrer">more stable method</a>.)</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="correct-format-specifier-for-double-in-printf-score-936300-in-2019" class="level3">
<h3>10: Correct format specifier for double in printf (score <a href="https://stackoverflow.com/q/4264127.html">936300</a> in 2019)</h3>
<section id="question-9" class="level4">
<h4>Question</h4>
<p>What is the correct format specifier for <code>double</code> in printf? Is it <code>%f</code> or is it <code>%lf</code>? I believe it’s <code>%f</code>, but I am not sure.</p>
<h5>
Code sample
</h3>
<div class="sourceCode" id="cb68"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true"></a></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true"></a></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true"></a><span class="dt">int</span> main()</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true"></a>{</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true"></a>   <span class="dt">double</span> d = <span class="fl">1.4</span>;</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true"></a>   printf(<span class="st">&quot;%lf&quot;</span>, d); <span class="co">// Is this wrong?</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true"></a>}</span></code></pre></div>
</section>
<section id="answer-accepted-score-576" class="level4">
<h4>Answer accepted (score 576)</h4>
<p><code>"%f"</code> is the (or at least one) correct format for a double. There <em>is</em> no format for a <code>float</code>, because if you attempt to pass a <code>float</code> to <code>printf</code>, it’ll be promoted to <code>double</code> before <code>printf</code> receives it<sup>1</sup>. <code>"%lf"</code> is also acceptable under the current standard – the <code>l</code> is specified as having no effect if followed by the <code>f</code> conversion specifier (among others).</p>
<p>Note that this is one place that <code>printf</code> format strings differ substantially from <code>scanf</code> (and <code>fscanf</code>, etc.) format strings. For output, you’re passing a <em>value</em>, which will be promoted from <code>float</code> to <code>double</code> when passed as a variadic parameter. For input you’re passing a <em>pointer</em>, which is not promoted, so you have to tell <code>scanf</code> whether you want to read a <code>float</code> or a <code>double</code>, so for <code>scanf</code>, <code>%f</code> means you want to read a <code>float</code> and <code>%lf</code> means you want to read a <code>double</code> (and, for what it’s worth, for a <code>long double</code>, you use <code>%Lf</code> for either <code>printf</code> or <code>scanf</code>).</p>
<hr>
<p>
<sub> 1. C99, §6.5.2.2/6: “If the expression that denotes the called function has a type that does not include a prototype, the integer promotions are performed on each argument, and arguments that have type float are promoted to double. These are called the default argument promotions.” In C++ the wording is somewhat different (e.g., it doesn’t use the word “prototype”) but the effect is the same: all the variadic parameters undergo default promotions before they’re received by the function. </sub>
</p>
</section>
<section id="answer-2-score-61" class="level4">
<h4>Answer 2 (score 61)</h4>
<p>
Given the <a href="http://en.wikipedia.org/wiki/C99" rel="noreferrer">C99</a> standard (namely, the <em>N1256</em> draft), the rules depend on the function kind: fprintf (printf, sprintf, …) or scanf.
</p>
<p>Here are relevant parts extracted:</p>
<blockquote>
<p><strong>Foreword</strong></p>
<p>
This second edition cancels and replaces the first edition, ISO/IEC 9899:1990, as amended and corrected by ISO/IEC 9899/COR1:1994, ISO/IEC 9899/AMD1:1995, and ISO/IEC 9899/COR2:1996. Major changes from the previous edition include:
</p>
<ul>
<li>
<code>%lf</code> conversion specifier allowed in <code>printf</code>
</li>
</ul>
<p><strong>7.19.6.1 The <code>fprintf</code> function</strong></p>
<p><strong>7</strong> The length modifiers and their meanings are:</p>
<p><em>l</em> (ell) Specifies that (…) has no effect on a following a, A, e, E, f, F, g, or G conversion specifier.</p>
<em>L</em> Specifies that a following a, A, e, E, f, F, g, or G conversion specifier applies to a long double argument.
</blockquote>
<p>The same rules specified for <code>fprintf</code> apply for <code>printf</code>, <code>sprintf</code> and similar functions.</p>
<blockquote>
<p><strong>7.19.6.2 The <code>fscanf</code> function</strong></p>
<p><strong>11</strong> The length modifiers and their meanings are:</p>
<p><em>l</em> (ell) Specifies that (…) that a following a, A, e, E, f, F, g, or G conversion specifier applies to an argument with type pointer to double;</p>
<p>
<em>L</em> Specifies that a following a, A, e, E, f, F, g, or G conversion specifier applies to an argument with type pointer to long double.
</p>
<p>
<strong>12</strong> The conversion specifiers and their meanings are: a,e,f,g Matches an optionally signed floating-point number, (…)
</p>
<strong>14</strong> The conversion specifiers A, E, F, G, and X are also valid and behave the same as, respectively, a, e, f, g, and x.
</blockquote>
<p>The long story short, for <code>fprintf</code> the following specifiers and corresponding types are specified:</p>
<ul>
<li>
<code>%f</code> -&gt; double
</li>
<li>
<code>%Lf</code> -&gt; long double.
</li>
</ul>
<p>and for <code>fscanf</code> it is:</p>
<ul>
<li>
<code>%f</code> -&gt; float
</li>
<li>
<code>%lf</code> -&gt; double
</li>
<li>
<code>%Lf</code> -&gt; long double.
</li>
</ul>
</section>
<section id="answer-3-score-20" class="level4">
<h4>Answer 3 (score 20)</h4>
<p>It can be <code>%f</code>, <code>%g</code> or <code>%e</code> depending on how you want the number to be formatted. See <a href="http://en.wikipedia.org/wiki/Printf">here</a> for more details. The <code>l</code> modifier is required in <code>scanf</code> with <code>double</code>, but not in <code>printf</code>.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="c-what-is-the-difference-between-i-and-i-score-933182-in-2019" class="level3">
<h3>11: C: What is the difference between ++i and i++? (score <a href="https://stackoverflow.com/q/24853.html">933182</a> in 2019)</h3>
<section id="question-10" class="level4">
<h4>Question</h4>
<p>In C, what is the difference between using <code>++i</code> and <code>i++</code>, and which should be used in the incrementation block of a <code>for</code> loop?</p>
</section>
<section id="answer-accepted-score-985" class="level4">
<h4>Answer accepted (score 985)</h4>
<ul>
<li>
<p>
<code>++i</code> will increment the value of <code>i</code>, and then return the incremented value.
</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true"></a> i = <span class="dv">1</span>;</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true"></a> j = ++i;</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true"></a> (i is <span class="dv">2</span>, j is <span class="dv">2</span>)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true"></a>&lt;li&gt;&lt;p&gt;`i++` will increment the value of `i`, but <span class="cf">return</span> the original value that `i` held before being incremented.&lt;/p&gt;</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true"></a></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true"></a>```c</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true"></a> i = <span class="dv">1</span>;</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true"></a> j = i++;</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true"></a> (i is <span class="dv">2</span>, j is <span class="dv">1</span>)</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true"></a>&lt;/ul&gt;</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true"></a></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true"></a>For a `for` loop, either works. `++i` seems more common, perhaps because that is what is used in &lt;a href=<span class="st">&quot;https://en.wikipedia.org/wiki/The_C_Programming_Language&quot;</span> rel=<span class="st">&quot;noreferrer&quot;</span>&gt;K&amp;amp;R&lt;/a&gt;.  </span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true"></a></span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true"></a>In any <span class="cf">case</span>, follow the guideline <span class="st">&quot;prefer `++i` over `i++`&quot;</span> and you won&#39;t go wrong.  </span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true"></a></span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true"></a>There&#39;s a couple of comments regarding the efficiency of `++i` and `i++`. In any non-student-project compiler, there will be no performance difference.  You can verify this by looking at the generated code, which will be identical.  </span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true"></a></span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true"></a>&lt;p&gt;The efficiency question is interesting... here&#39;s my attempt at an answer:</span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true"></a>&lt;a href=<span class="st">&quot;https://stackoverflow.com/questions/24886/is-there-a-performance-difference-between-i-and-i&quot;</span>&gt;Is there a performance difference between i++ and ++i in C?&lt;/a&gt;&lt;/p&gt;</span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true"></a></span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true"></a>As &lt;em&gt;On Freund&lt;/em&gt; notes, it&#39;s different <span class="cf">for</span> a C++ object, since `operator++()` is a function and the compiler can&#39;t know to optimize away the creation of a temporary object to hold the intermediate value.  </span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true"></a></span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true"></a></span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true"></a><span class="er">#### Answer 2 (score 159)</span></span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true"></a>&lt;strong&gt;i++&lt;/strong&gt; is known as &lt;strong&gt;Post Increment&lt;/strong&gt; whereas &lt;strong&gt;++i&lt;/strong&gt; is called &lt;strong&gt;Pre Increment.&lt;/strong&gt;  </span>
<span id="cb69-28"><a href="#cb69-28" aria-hidden="true"></a></span>
<span id="cb69-29"><a href="#cb69-29" aria-hidden="true"></a>&lt;strong&gt;`i++`&lt;/strong&gt;  </span>
<span id="cb69-30"><a href="#cb69-30" aria-hidden="true"></a></span>
<span id="cb69-31"><a href="#cb69-31" aria-hidden="true"></a>`i++` is post increment because it increments `i`&#39;s value by <span class="dv">1</span> after the operation is over.  </span>
<span id="cb69-32"><a href="#cb69-32" aria-hidden="true"></a></span>
<span id="cb69-33"><a href="#cb69-33" aria-hidden="true"></a>Lets see the following example:  </span>
<span id="cb69-34"><a href="#cb69-34" aria-hidden="true"></a></span>
<span id="cb69-35"><a href="#cb69-35" aria-hidden="true"></a>```c</span>
<span id="cb69-36"><a href="#cb69-36" aria-hidden="true"></a><span class="dt">int</span> i = <span class="dv">1</span>, j;</span>
<span id="cb69-37"><a href="#cb69-37" aria-hidden="true"></a>j = i++;</span></code></pre></div>
<p>Here value of <code>j = 1</code> but <code>i = 2</code>. Here value of <code>i</code> will be assigned to <code>j</code> first then <code>i</code> will be incremented.</p>
<p><strong><code>++i</code></strong></p>
<p>
<code>++i</code> is pre increment because it increments <code>i</code>’s value by 1 before the operation. It means <code>j = i;</code> will execute after <code>i++</code>.
</p>
<p>Lets see the following example:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true"></a><span class="dt">int</span> i = <span class="dv">1</span>, j;</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true"></a>j = ++i;</span></code></pre></div>
<p>
Here value of <code>j = 2</code> but <code>i = 2</code>. Here value of <code>i</code> will be assigned to <code>j</code> after the <code>i</code> incremention of <code>i</code>. Similarly <code>++i</code> will be executed before <code>j=i;</code>.
</p>
<p>For your question <strong>which should be used in the incrementation block of a for loop?</strong> the answer is, you can use any one.. doesn’t matter. It will execute your for loop same no. of times.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true"></a><span class="cf">for</span>(i=<span class="dv">0</span>; i&lt;<span class="dv">5</span>; i++)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true"></a>   printf(<span class="st">&quot;%d &quot;</span>,i);</span></code></pre></div>
<p>And</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true"></a><span class="cf">for</span>(i=<span class="dv">0</span>; i&lt;<span class="dv">5</span>; ++i)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true"></a>   printf(<span class="st">&quot;%d &quot;</span>,i);</span></code></pre></div>
<p>Both the loops will produce same output. ie <code>0 1 2 3 4</code>.</p>
<p>It only matters where you are using it.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true"></a><span class="cf">for</span>(i = <span class="dv">0</span>; i&lt;<span class="dv">5</span>;)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true"></a>    printf(<span class="st">&quot;%d &quot;</span>,++i);</span></code></pre></div>
<p>In this case output will be <code>1 2 3 4 5</code>.</p>
</section>
<section id="answer-3-score-38" class="level4">
<h4>Answer 3 (score 38)</h4>
<p>Please don’t worry about the “efficiency” (speed, really) of which one is faster. We have compilers these days that take care of these things. Use whichever one makes sense to use, based on which more clearly shows your intent.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-do-i-create-an-array-of-strings-in-c-score-916965-in-2018" class="level3">
<h3>12: How do I create an array of strings in C? (score <a href="https://stackoverflow.com/q/1088622.html">916965</a> in 2018)</h3>
<section id="question-11" class="level4">
<h4>Question</h4>
<p>I am trying to create an array of strings in C. If I use this code:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true"></a><span class="dt">char</span> (*a[<span class="dv">2</span>])[<span class="dv">14</span>];</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true"></a>a[<span class="dv">0</span>]=<span class="st">&quot;blah&quot;</span>;</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true"></a>a[<span class="dv">1</span>]=<span class="st">&quot;hmm&quot;</span>;</span></code></pre></div>
<p>gcc gives me “warning: assignment from incompatible pointer type”. What is the correct way to do this?</p>
<p>edit: I am curious why this should give a compiler warning since if I do <code>printf(a[1]);</code>, it correctly prints “hmm”.</p>
</section>
<section id="answer-2-score-211" class="level4">
<h4>Answer 2 (score 211)</h4>
<p>If you don’t want to change the strings, then you could simply do</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true"></a><span class="dt">const</span> <span class="dt">char</span> *a[<span class="dv">2</span>];</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true"></a>a[<span class="dv">0</span>] = <span class="st">&quot;blah&quot;</span>;</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true"></a>a[<span class="dv">1</span>] = <span class="st">&quot;hmm&quot;</span>;</span></code></pre></div>
<p>When you do it like this you will allocate an array of two pointers to <code>const char</code>. These pointers will then be set to the addresses of the static strings <code>"blah"</code> and <code>"hmm"</code>.</p>
<p>If you do want to be able to change the actual string content, the you have to do something like</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true"></a><span class="dt">char</span> a[<span class="dv">2</span>][<span class="dv">14</span>];</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true"></a>strcpy(a[<span class="dv">0</span>], <span class="st">&quot;blah&quot;</span>);</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true"></a>strcpy(a[<span class="dv">1</span>], <span class="st">&quot;hmm&quot;</span>);</span></code></pre></div>
<p>This will allocate two consecutive arrays of 14 <code>char</code>s each, after which the content of the static strings will be copied into them.</p>
</section>
<section id="answer-3-score-167" class="level4">
<h4>Answer 3 (score 167)</h4>
<p>There are several ways to create an array of strings in C. If all the strings are going to be the same length (or at least have the same maximum length), you simply declare a 2-d array of char and assign as necessary:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true"></a><span class="dt">char</span> strs[NUMBER_OF_STRINGS][STRING_LENGTH+<span class="dv">1</span>];</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true"></a>...</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true"></a>strcpy(strs[<span class="dv">0</span>], aString); <span class="co">// where aString is either an array or pointer to char</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true"></a>strcpy(strs[<span class="dv">1</span>], <span class="st">&quot;foo&quot;</span>);</span></code></pre></div>
<p>You can add a list of initializers as well:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true"></a><span class="dt">char</span> strs[NUMBER_OF_STRINGS][STRING_LENGTH+<span class="dv">1</span>] = {<span class="st">&quot;foo&quot;</span>, <span class="st">&quot;bar&quot;</span>, <span class="st">&quot;bletch&quot;</span>, ...};</span></code></pre></div>
<p>This assumes the size and number of strings in the initializer match up with your array dimensions. In this case, the contents of each string literal (which is itself a zero-terminated array of char) are copied to the memory allocated to strs. The problem with this approach is the possibility of internal fragmentation; if you have 99 strings that are 5 characters or less, but 1 string that’s 20 characters long, 99 strings are going to have at least 15 unused characters; that’s a waste of space.</p>
<p>Instead of using a 2-d array of char, you can store a 1-d array of pointers to char:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true"></a><span class="dt">char</span> *strs[NUMBER_OF_STRINGS];</span></code></pre></div>
<p>Note that in this case, you’ve only allocated memory to hold the pointers to the strings; the memory for the strings themselves must be allocated elsewhere (either as static arrays or by using <code>malloc()</code> or <code>calloc()</code>). You can use the initializer list like the earlier example:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true"></a><span class="dt">char</span> *strs[NUMBER_OF_STRINGS] = {<span class="st">&quot;foo&quot;</span>, <span class="st">&quot;bar&quot;</span>, <span class="st">&quot;bletch&quot;</span>, ...};</span></code></pre></div>
<p>Instead of copying the contents of the string constants, you’re simply storing the pointers to them. Note that string constants may not be writable; you can reassign the pointer, like so:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true"></a>strs[i] = <span class="st">&quot;bar&quot;</span>;</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true"></a>strs[i] = <span class="st">&quot;foo&quot;</span>; </span></code></pre></div>
<p>But you may not be able to change the string’s contents; i.e.,</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true"></a>strs[i] = <span class="st">&quot;bar&quot;</span>;</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true"></a>strcpy(strs[i], <span class="st">&quot;foo&quot;</span>);</span></code></pre></div>
<p>may not be allowed.</p>
<p>You can use <code>malloc()</code> to dynamically allocate the buffer for each string and copy to that buffer:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true"></a>strs[i] = malloc(strlen(<span class="st">&quot;foo&quot;</span>) + <span class="dv">1</span>);</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true"></a>strcpy(strs[i], <span class="st">&quot;foo&quot;</span>);</span></code></pre></div>
<p>BTW,</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true"></a><span class="dt">char</span> (*a[<span class="dv">2</span>])[<span class="dv">14</span>];</span></code></pre></div>
<p>Declares a as a 2-element array of pointers to 14-element arrays of char.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-to-convert-a-string-to-integer-in-c-score-897704-in-2018" class="level3">
<h3>13: How to convert a string to integer in C? (score <a href="https://stackoverflow.com/q/7021725.html">897704</a> in 2018)</h3>
<section id="question-12" class="level4">
<h4>Question</h4>
<p>I am trying to find out if there is an alternative way of converting string to integer in C.</p>
<p>I regularly pattern the following in my code.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true"></a><span class="dt">char</span> s[] = <span class="st">&quot;45&quot;</span>;</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true"></a></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true"></a><span class="dt">int</span> num = atoi(s);</span></code></pre></div>
<p>So, is there a better way or another way?</p>
</section>
<section id="answer-accepted-score-165" class="level4">
<h4>Answer accepted (score 165)</h4>
<p>There is <a href="http://en.cppreference.com/w/c/string/byte/strtol" rel="noreferrer"><code>strtol</code></a> which is better IMO. Also I have taken a liking in <a href="http://www.freebsd.org/cgi/man.cgi?query=strtonum" rel="noreferrer"><code>strtonum</code></a>, so use it if you have it (but remember it’s not portable):</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true"></a><span class="dt">long</span> <span class="dt">long</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true"></a>     strtonum(<span class="dt">const</span> <span class="dt">char</span> *nptr, <span class="dt">long</span> <span class="dt">long</span> minval, <span class="dt">long</span> <span class="dt">long</span> maxval,</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true"></a>     <span class="dt">const</span> <span class="dt">char</span> **errstr);</span></code></pre></div>
<h5>
EDIT
</h3>
<p>You might also be interested in <a href="http://en.cppreference.com/w/c/string/byte/strtoimax" rel="noreferrer"><code>strtoumax</code> and <code>strtoimax</code></a> which are standard functions in C99. For example you could say:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true"></a><span class="dt">uintmax_t</span> num = strtoumax(s, NULL, <span class="dv">10</span>);</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true"></a><span class="cf">if</span> (num == UINTMAX_MAX &amp;&amp; errno == ERANGE)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true"></a>    <span class="co">/* Could not convert. */</span></span></code></pre></div>
<p>Anyway, stay away from <code>atoi</code>:</p>
<blockquote>
<p>The call atoi(str) shall be equivalent to:</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true"></a>(<span class="dt">int</span>) strtol(str, (<span class="dt">char</span> **)NULL, <span class="dv">10</span>)</span></code></pre></div>
<p>
except that the handling of errors may differ. <strong>If the value cannot be represented, the behavior is undefined</strong>.
</p>
</blockquote>
</section>
<section id="answer-2-score-24" class="level4">
<h4>Answer 2 (score 24)</h4>
<p><strong>Robust C89 <code>strtol</code>-based solution</strong></p>
<p>With:</p>
<ul>
<li>
no undefined behavior (as could be had with the <code>atoi</code> family)
</li>
<li>
a stricter definition of integer than <code>strtol</code> (e.g. no leading whitespace nor trailing trash chars)
</li>
<li>
classification of the error case (e.g. to give useful error messages to users)
</li>
<li>
a “testsuite”
</li>
</ul>
<div class="sourceCode" id="cb89"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true"></a></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;assert.h&gt;</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true"></a></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;ctype.h&gt;</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true"></a></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;errno.h&gt;</span></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true"></a></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;limits.h&gt;</span></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true"></a></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true"></a></span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdlib.h&gt;</span></span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true"></a></span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true"></a><span class="kw">typedef</span> <span class="kw">enum</span> {</span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true"></a>    STR2INT_SUCCESS,</span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true"></a>    STR2INT_OVERFLOW,</span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true"></a>    STR2INT_UNDERFLOW,</span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true"></a>    STR2INT_INCONVERTIBLE</span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true"></a>} str2int_errno;</span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true"></a></span>
<span id="cb89-21"><a href="#cb89-21" aria-hidden="true"></a><span class="co">/* Convert string s to int out.</span></span>
<span id="cb89-22"><a href="#cb89-22" aria-hidden="true"></a><span class="co"> *</span></span>
<span id="cb89-23"><a href="#cb89-23" aria-hidden="true"></a><span class="co"> * @param[out] out The converted int. Cannot be NULL.</span></span>
<span id="cb89-24"><a href="#cb89-24" aria-hidden="true"></a><span class="co"> *</span></span>
<span id="cb89-25"><a href="#cb89-25" aria-hidden="true"></a><span class="co"> * @param[in] s Input string to be converted.</span></span>
<span id="cb89-26"><a href="#cb89-26" aria-hidden="true"></a><span class="co"> *</span></span>
<span id="cb89-27"><a href="#cb89-27" aria-hidden="true"></a><span class="co"> *     The format is the same as strtol,</span></span>
<span id="cb89-28"><a href="#cb89-28" aria-hidden="true"></a><span class="co"> *     except that the following are inconvertible:</span></span>
<span id="cb89-29"><a href="#cb89-29" aria-hidden="true"></a><span class="co"> *</span></span>
<span id="cb89-30"><a href="#cb89-30" aria-hidden="true"></a><span class="co"> *     - empty string</span></span>
<span id="cb89-31"><a href="#cb89-31" aria-hidden="true"></a><span class="co"> *     - leading whitespace</span></span>
<span id="cb89-32"><a href="#cb89-32" aria-hidden="true"></a><span class="co"> *     - any trailing characters that are not part of the number</span></span>
<span id="cb89-33"><a href="#cb89-33" aria-hidden="true"></a><span class="co"> *</span></span>
<span id="cb89-34"><a href="#cb89-34" aria-hidden="true"></a><span class="co"> *     Cannot be NULL.</span></span>
<span id="cb89-35"><a href="#cb89-35" aria-hidden="true"></a><span class="co"> *</span></span>
<span id="cb89-36"><a href="#cb89-36" aria-hidden="true"></a><span class="co"> * @param[in] base Base to interpret string in. Same range as strtol (2 to 36).</span></span>
<span id="cb89-37"><a href="#cb89-37" aria-hidden="true"></a><span class="co"> *</span></span>
<span id="cb89-38"><a href="#cb89-38" aria-hidden="true"></a><span class="co"> * @return Indicates if the operation succeeded, or why it failed.</span></span>
<span id="cb89-39"><a href="#cb89-39" aria-hidden="true"></a><span class="co"> */</span></span>
<span id="cb89-40"><a href="#cb89-40" aria-hidden="true"></a>str2int_errno str2int(<span class="dt">int</span> *out, <span class="dt">char</span> *s, <span class="dt">int</span> base) {</span>
<span id="cb89-41"><a href="#cb89-41" aria-hidden="true"></a>    <span class="dt">char</span> *end;</span>
<span id="cb89-42"><a href="#cb89-42" aria-hidden="true"></a>    <span class="cf">if</span> (s[<span class="dv">0</span>] == <span class="ch">&#39;\0&#39;</span> || isspace(s[<span class="dv">0</span>]))</span>
<span id="cb89-43"><a href="#cb89-43" aria-hidden="true"></a>        <span class="cf">return</span> STR2INT_INCONVERTIBLE;</span>
<span id="cb89-44"><a href="#cb89-44" aria-hidden="true"></a>    errno = <span class="dv">0</span>;</span>
<span id="cb89-45"><a href="#cb89-45" aria-hidden="true"></a>    <span class="dt">long</span> l = strtol(s, &amp;end, base);</span>
<span id="cb89-46"><a href="#cb89-46" aria-hidden="true"></a>    <span class="co">/* Both checks are needed because INT_MAX == LONG_MAX is possible. */</span></span>
<span id="cb89-47"><a href="#cb89-47" aria-hidden="true"></a>    <span class="cf">if</span> (l &gt; INT_MAX || (errno == ERANGE &amp;&amp; l == LONG_MAX))</span>
<span id="cb89-48"><a href="#cb89-48" aria-hidden="true"></a>        <span class="cf">return</span> STR2INT_OVERFLOW;</span>
<span id="cb89-49"><a href="#cb89-49" aria-hidden="true"></a>    <span class="cf">if</span> (l &lt; INT_MIN || (errno == ERANGE &amp;&amp; l == LONG_MIN))</span>
<span id="cb89-50"><a href="#cb89-50" aria-hidden="true"></a>        <span class="cf">return</span> STR2INT_UNDERFLOW;</span>
<span id="cb89-51"><a href="#cb89-51" aria-hidden="true"></a>    <span class="cf">if</span> (*end != <span class="ch">&#39;\0&#39;</span>)</span>
<span id="cb89-52"><a href="#cb89-52" aria-hidden="true"></a>        <span class="cf">return</span> STR2INT_INCONVERTIBLE;</span>
<span id="cb89-53"><a href="#cb89-53" aria-hidden="true"></a>    *out = l;</span>
<span id="cb89-54"><a href="#cb89-54" aria-hidden="true"></a>    <span class="cf">return</span> STR2INT_SUCCESS;</span>
<span id="cb89-55"><a href="#cb89-55" aria-hidden="true"></a>}</span>
<span id="cb89-56"><a href="#cb89-56" aria-hidden="true"></a></span>
<span id="cb89-57"><a href="#cb89-57" aria-hidden="true"></a><span class="dt">int</span> main(<span class="dt">void</span>) {</span>
<span id="cb89-58"><a href="#cb89-58" aria-hidden="true"></a>    <span class="dt">int</span> i;</span>
<span id="cb89-59"><a href="#cb89-59" aria-hidden="true"></a>    <span class="co">/* Lazy to calculate this size properly. */</span></span>
<span id="cb89-60"><a href="#cb89-60" aria-hidden="true"></a>    <span class="dt">char</span> s[<span class="dv">256</span>];</span>
<span id="cb89-61"><a href="#cb89-61" aria-hidden="true"></a></span>
<span id="cb89-62"><a href="#cb89-62" aria-hidden="true"></a>    <span class="co">/* Simple case. */</span></span>
<span id="cb89-63"><a href="#cb89-63" aria-hidden="true"></a>    assert(str2int(&amp;i, <span class="st">&quot;11&quot;</span>, <span class="dv">10</span>) == STR2INT_SUCCESS);</span>
<span id="cb89-64"><a href="#cb89-64" aria-hidden="true"></a>    assert(i == <span class="dv">11</span>);</span>
<span id="cb89-65"><a href="#cb89-65" aria-hidden="true"></a></span>
<span id="cb89-66"><a href="#cb89-66" aria-hidden="true"></a>    <span class="co">/* Negative number . */</span></span>
<span id="cb89-67"><a href="#cb89-67" aria-hidden="true"></a>    assert(str2int(&amp;i, <span class="st">&quot;-11&quot;</span>, <span class="dv">10</span>) == STR2INT_SUCCESS);</span>
<span id="cb89-68"><a href="#cb89-68" aria-hidden="true"></a>    assert(i == -<span class="dv">11</span>);</span>
<span id="cb89-69"><a href="#cb89-69" aria-hidden="true"></a></span>
<span id="cb89-70"><a href="#cb89-70" aria-hidden="true"></a>    <span class="co">/* Different base. */</span></span>
<span id="cb89-71"><a href="#cb89-71" aria-hidden="true"></a>    assert(str2int(&amp;i, <span class="st">&quot;11&quot;</span>, <span class="dv">16</span>) == STR2INT_SUCCESS);</span>
<span id="cb89-72"><a href="#cb89-72" aria-hidden="true"></a>    assert(i == <span class="dv">17</span>);</span>
<span id="cb89-73"><a href="#cb89-73" aria-hidden="true"></a></span>
<span id="cb89-74"><a href="#cb89-74" aria-hidden="true"></a>    <span class="co">/* 0 */</span></span>
<span id="cb89-75"><a href="#cb89-75" aria-hidden="true"></a>    assert(str2int(&amp;i, <span class="st">&quot;0&quot;</span>, <span class="dv">10</span>) == STR2INT_SUCCESS);</span>
<span id="cb89-76"><a href="#cb89-76" aria-hidden="true"></a>    assert(i == <span class="dv">0</span>);</span>
<span id="cb89-77"><a href="#cb89-77" aria-hidden="true"></a></span>
<span id="cb89-78"><a href="#cb89-78" aria-hidden="true"></a>    <span class="co">/* INT_MAX. */</span></span>
<span id="cb89-79"><a href="#cb89-79" aria-hidden="true"></a>    sprintf(s, <span class="st">&quot;%d&quot;</span>, INT_MAX);</span>
<span id="cb89-80"><a href="#cb89-80" aria-hidden="true"></a>    assert(str2int(&amp;i, s, <span class="dv">10</span>) == STR2INT_SUCCESS);</span>
<span id="cb89-81"><a href="#cb89-81" aria-hidden="true"></a>    assert(i == INT_MAX);</span>
<span id="cb89-82"><a href="#cb89-82" aria-hidden="true"></a></span>
<span id="cb89-83"><a href="#cb89-83" aria-hidden="true"></a>    <span class="co">/* INT_MIN. */</span></span>
<span id="cb89-84"><a href="#cb89-84" aria-hidden="true"></a>    sprintf(s, <span class="st">&quot;%d&quot;</span>, INT_MIN);</span>
<span id="cb89-85"><a href="#cb89-85" aria-hidden="true"></a>    assert(str2int(&amp;i, s, <span class="dv">10</span>) == STR2INT_SUCCESS);</span>
<span id="cb89-86"><a href="#cb89-86" aria-hidden="true"></a>    assert(i == INT_MIN);</span>
<span id="cb89-87"><a href="#cb89-87" aria-hidden="true"></a></span>
<span id="cb89-88"><a href="#cb89-88" aria-hidden="true"></a>    <span class="co">/* Leading and trailing space. */</span></span>
<span id="cb89-89"><a href="#cb89-89" aria-hidden="true"></a>    assert(str2int(&amp;i, <span class="st">&quot; 1&quot;</span>, <span class="dv">10</span>) == STR2INT_INCONVERTIBLE);</span>
<span id="cb89-90"><a href="#cb89-90" aria-hidden="true"></a>    assert(str2int(&amp;i, <span class="st">&quot;1 &quot;</span>, <span class="dv">10</span>) == STR2INT_INCONVERTIBLE);</span>
<span id="cb89-91"><a href="#cb89-91" aria-hidden="true"></a></span>
<span id="cb89-92"><a href="#cb89-92" aria-hidden="true"></a>    <span class="co">/* Trash characters. */</span></span>
<span id="cb89-93"><a href="#cb89-93" aria-hidden="true"></a>    assert(str2int(&amp;i, <span class="st">&quot;a10&quot;</span>, <span class="dv">10</span>) == STR2INT_INCONVERTIBLE);</span>
<span id="cb89-94"><a href="#cb89-94" aria-hidden="true"></a>    assert(str2int(&amp;i, <span class="st">&quot;10a&quot;</span>, <span class="dv">10</span>) == STR2INT_INCONVERTIBLE);</span>
<span id="cb89-95"><a href="#cb89-95" aria-hidden="true"></a></span>
<span id="cb89-96"><a href="#cb89-96" aria-hidden="true"></a>    <span class="co">/* int overflow.</span></span>
<span id="cb89-97"><a href="#cb89-97" aria-hidden="true"></a><span class="co">     *</span></span>
<span id="cb89-98"><a href="#cb89-98" aria-hidden="true"></a><span class="co">     * `if` needed to avoid undefined behaviour</span></span>
<span id="cb89-99"><a href="#cb89-99" aria-hidden="true"></a><span class="co">     * on `INT_MAX + 1` if INT_MAX == LONG_MAX.</span></span>
<span id="cb89-100"><a href="#cb89-100" aria-hidden="true"></a><span class="co">     */</span></span>
<span id="cb89-101"><a href="#cb89-101" aria-hidden="true"></a>    <span class="cf">if</span> (INT_MAX &lt; LONG_MAX) {</span>
<span id="cb89-102"><a href="#cb89-102" aria-hidden="true"></a>        sprintf(s, <span class="st">&quot;%ld&quot;</span>, (<span class="dt">long</span> <span class="dt">int</span>)INT_MAX + <span class="dv">1</span><span class="bu">L</span>);</span>
<span id="cb89-103"><a href="#cb89-103" aria-hidden="true"></a>        assert(str2int(&amp;i, s, <span class="dv">10</span>) == STR2INT_OVERFLOW);</span>
<span id="cb89-104"><a href="#cb89-104" aria-hidden="true"></a>    }</span>
<span id="cb89-105"><a href="#cb89-105" aria-hidden="true"></a></span>
<span id="cb89-106"><a href="#cb89-106" aria-hidden="true"></a>    <span class="co">/* int underflow */</span></span>
<span id="cb89-107"><a href="#cb89-107" aria-hidden="true"></a>    <span class="cf">if</span> (LONG_MIN &lt; INT_MIN) {</span>
<span id="cb89-108"><a href="#cb89-108" aria-hidden="true"></a>        sprintf(s, <span class="st">&quot;%ld&quot;</span>, (<span class="dt">long</span> <span class="dt">int</span>)INT_MIN - <span class="dv">1</span><span class="bu">L</span>);</span>
<span id="cb89-109"><a href="#cb89-109" aria-hidden="true"></a>        assert(str2int(&amp;i, s, <span class="dv">10</span>) == STR2INT_UNDERFLOW);</span>
<span id="cb89-110"><a href="#cb89-110" aria-hidden="true"></a>    }</span>
<span id="cb89-111"><a href="#cb89-111" aria-hidden="true"></a></span>
<span id="cb89-112"><a href="#cb89-112" aria-hidden="true"></a>    <span class="co">/* long overflow */</span></span>
<span id="cb89-113"><a href="#cb89-113" aria-hidden="true"></a>    sprintf(s, <span class="st">&quot;%ld0&quot;</span>, LONG_MAX);</span>
<span id="cb89-114"><a href="#cb89-114" aria-hidden="true"></a>    assert(str2int(&amp;i, s, <span class="dv">10</span>) == STR2INT_OVERFLOW);</span>
<span id="cb89-115"><a href="#cb89-115" aria-hidden="true"></a></span>
<span id="cb89-116"><a href="#cb89-116" aria-hidden="true"></a>    <span class="co">/* long underflow */</span></span>
<span id="cb89-117"><a href="#cb89-117" aria-hidden="true"></a>    sprintf(s, <span class="st">&quot;%ld0&quot;</span>, LONG_MIN);</span>
<span id="cb89-118"><a href="#cb89-118" aria-hidden="true"></a>    assert(str2int(&amp;i, s, <span class="dv">10</span>) == STR2INT_UNDERFLOW);</span>
<span id="cb89-119"><a href="#cb89-119" aria-hidden="true"></a></span>
<span id="cb89-120"><a href="#cb89-120" aria-hidden="true"></a>    <span class="cf">return</span> EXIT_SUCCESS;</span>
<span id="cb89-121"><a href="#cb89-121" aria-hidden="true"></a>}</span></code></pre></div>
<p><a href="https://github.com/cirosantilli/cpp-cheat/blob/c6087065b6b499b949360830aa2edeb4ec2ab276/c/string_to_int.c" rel="nofollow noreferrer">GitHub upstream</a>.</p>
<p>Based on: <a href="https://stackoverflow.com/a/6154614/895245">https://stackoverflow.com/a/6154614/895245</a></p>
</section>
<section id="answer-3-score-22" class="level4">
<h4>Answer 3 (score 22)</h4>
<p>Don’t use functions from <code>ato...</code> group. These are broken and virtually useless. A moderately better solution would be to use <code>sscanf</code>, although it is not perfect either.</p>
<p>To convert string to integer, functions from <code>strto...</code> group should be used. In your specific case it would be <code>strtol</code> function.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="max-value-of-integer-score-847436-in-2017" class="level3">
<h3>14: max value of integer (score <a href="https://stackoverflow.com/q/15004944.html">847436</a> in 2017)</h3>
<section id="question-13" class="level4">
<h4>Question</h4>
<p>
In C, the integer (for 32 bit machine) is 32 bits, and it ranges from -32,768 to +32,767. In Java, the integer is also 32 bits, but ranges from -2,147,483,648 to +2,147,483,647.
</p>
<p>I do not understand how the range is different in Java, even though the number of bits is the same. Can someone explain this?</p>
</section>
<section id="answer-2-score-356" class="level4">
<h4>Answer 2 (score 356)</h4>
<p><strong>In <em>C</em>,</strong> the language itself does not determine the representation of certain datatypes. It can vary from machine to machine, on embedded systems the <code>int</code> can be 16 bit wide, though usually it is 32 bit.</p>
<p>The only requirement is that <code>short int</code> &lt;= <code>int</code> &lt;= <code>long int</code> by size. Also, there is a recommendation that <strong><code>int</code> should represent the native capacity of the processor</strong>.</p>
<p>All types are signed. The <code>unsigned</code> modifier allows you to use the highest bit as part of the value (otherwise it is reserved for the sign bit).</p>
<p>Here’s a short table of the possible values for the possible data types:</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true"></a>          width                     minimum                         maximum</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true"></a><span class="dt">signed</span>    <span class="dv">8</span> bit                        -<span class="dv">128</span>                            +<span class="dv">127</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true"></a><span class="dt">signed</span>   <span class="dv">16</span> bit                     -<span class="dv">32</span> <span class="dv">768</span>                         +<span class="dv">32</span> <span class="dv">767</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true"></a><span class="dt">signed</span>   <span class="dv">32</span> bit              -<span class="dv">2</span> <span class="dv">147</span> <span class="dv">483</span> <span class="dv">648</span>                  +<span class="dv">2</span> <span class="dv">147</span> <span class="dv">483</span> <span class="dv">647</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true"></a><span class="dt">signed</span>   <span class="dv">64</span> bit  -<span class="dv">9</span> <span class="dv">223</span> <span class="dv">372</span> <span class="bn">036</span> <span class="dv">854</span> <span class="dv">775</span> <span class="dv">808</span>      +<span class="dv">9</span> <span class="dv">223</span> <span class="dv">372</span> <span class="bn">036</span> <span class="dv">854</span> <span class="dv">775</span> <span class="dv">807</span></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true"></a><span class="dt">unsigned</span>  <span class="dv">8</span> bit                           <span class="dv">0</span>                            +<span class="dv">255</span></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true"></a><span class="dt">unsigned</span> <span class="dv">16</span> bit                           <span class="dv">0</span>                         +<span class="dv">65</span> <span class="dv">535</span></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true"></a><span class="dt">unsigned</span> <span class="dv">32</span> bit                           <span class="dv">0</span>                  +<span class="dv">4</span> <span class="dv">294</span> <span class="dv">967</span> <span class="dv">295</span></span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true"></a><span class="dt">unsigned</span> <span class="dv">64</span> bit                           <span class="dv">0</span>     +<span class="dv">18</span> <span class="dv">446</span> <span class="dv">744</span> <span class="bn">073</span> <span class="dv">709</span> <span class="dv">551</span> <span class="dv">615</span></span></code></pre></div>
<p><strong>In <em>Java</em>,</strong> the <a href="https://docs.oracle.com/javase/specs/jls/se7/html/jls-4.html
#jls-4.2" rel="noreferrer">Java Language Specification</a> determines the representation of the data types.</p>
<p>The order is: <code>byte</code> 8 bits, <code>short</code> 16 bits, <code>int</code> 32 bits, <code>long</code> 64 bits. All of these types are <em>signed</em>, there are no unsigned versions. However, bit manipulations treat the numbers as they were unsigned (that is, handling all bits correctly).</p>
<p>The character data type <code>char</code> is 16 bits wide, <em>unsigned</em>, and holds characters using UTF-16 encoding (however, it is possible to assign a <code>char</code> an arbitrary unsigned 16 bit integer that represents an invalid character codepoint)</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true"></a>          width                     minimum                         maximum</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true"></a></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true"></a>SIGNED</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true"></a>byte:     <span class="dv">8</span> bit                        -<span class="dv">128</span>                            +<span class="dv">127</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true"></a><span class="dt">short</span>:   <span class="dv">16</span> bit                     -<span class="dv">32</span> <span class="dv">768</span>                         +<span class="dv">32</span> <span class="dv">767</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true"></a><span class="dt">int</span>:     <span class="dv">32</span> bit              -<span class="dv">2</span> <span class="dv">147</span> <span class="dv">483</span> <span class="dv">648</span>                  +<span class="dv">2</span> <span class="dv">147</span> <span class="dv">483</span> <span class="dv">647</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true"></a><span class="dt">long</span>:    <span class="dv">64</span> bit  -<span class="dv">9</span> <span class="dv">223</span> <span class="dv">372</span> <span class="bn">036</span> <span class="dv">854</span> <span class="dv">775</span> <span class="dv">808</span>      +<span class="dv">9</span> <span class="dv">223</span> <span class="dv">372</span> <span class="bn">036</span> <span class="dv">854</span> <span class="dv">775</span> <span class="dv">807</span></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true"></a></span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true"></a>UNSIGNED</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true"></a><span class="dt">char</span>     <span class="dv">16</span> bit                           <span class="dv">0</span>                         +<span class="dv">65</span> <span class="dv">535</span></span></code></pre></div>
</section>
<section id="answer-3-score-71" class="level4">
<h4>Answer 3 (score 71)</h4>
<blockquote>
In C, the integer(for 32 bit machine) is 32 bit and it ranges from -32768 to +32767.
</blockquote>
<p>Wrong. 32-bit signed integer in 2’s complement representation has the range -2<sup>31</sup> to 2<sup>31</sup>-1 which is equal to -2,147,483,648 to 2,147,483,647.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="what-does-static-mean-in-c-score-846258-in-2017" class="level3">
<h3>15: What does “static” mean in C? (score <a href="https://stackoverflow.com/q/572547.html">846258</a> in 2017)</h3>
<section id="question-14" class="level4">
<h4>Question</h4>
<p>I’ve seen the word <code>static</code> used in different places in C code; is this like a static function/class in C # (where the implementation is shared across objects)?</p>
</section>
<section id="answer-accepted-score-1425" class="level4">
<h4>Answer accepted (score 1425)</h4>
<ol>
<li>
A static variable inside a function keeps its value between invocations.
</li>
<li>
A static global variable or a function is “seen” only in the file it’s declared in
</li>
</ol>
<ol type="1">
<li>is the more foreign topic if you’re a newbie, so here’s an example:</li>
</ol>
<div class="sourceCode" id="cb92"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true"></a></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true"></a></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true"></a><span class="dt">void</span> foo()</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true"></a>{</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true"></a>    <span class="dt">int</span> a = <span class="dv">10</span>;</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true"></a>    <span class="dt">static</span> <span class="dt">int</span> sa = <span class="dv">10</span>;</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true"></a></span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true"></a>    a += <span class="dv">5</span>;</span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true"></a>    sa += <span class="dv">5</span>;</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true"></a></span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true"></a>    printf(<span class="st">&quot;a = %d, sa = %d</span><span class="sc">\n</span><span class="st">&quot;</span>, a, sa);</span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true"></a>}</span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true"></a></span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true"></a></span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true"></a><span class="dt">int</span> main()</span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true"></a>{</span>
<span id="cb92-18"><a href="#cb92-18" aria-hidden="true"></a>    <span class="dt">int</span> i;</span>
<span id="cb92-19"><a href="#cb92-19" aria-hidden="true"></a></span>
<span id="cb92-20"><a href="#cb92-20" aria-hidden="true"></a>    <span class="cf">for</span> (i = <span class="dv">0</span>; i &lt; <span class="dv">10</span>; ++i)</span>
<span id="cb92-21"><a href="#cb92-21" aria-hidden="true"></a>        foo();</span>
<span id="cb92-22"><a href="#cb92-22" aria-hidden="true"></a>}</span></code></pre></div>
<p>This prints:</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true"></a>a = <span class="dv">15</span>, sa = <span class="dv">15</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true"></a>a = <span class="dv">15</span>, sa = <span class="dv">20</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true"></a>a = <span class="dv">15</span>, sa = <span class="dv">25</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true"></a>a = <span class="dv">15</span>, sa = <span class="dv">30</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true"></a>a = <span class="dv">15</span>, sa = <span class="dv">35</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true"></a>a = <span class="dv">15</span>, sa = <span class="dv">40</span></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true"></a>a = <span class="dv">15</span>, sa = <span class="dv">45</span></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true"></a>a = <span class="dv">15</span>, sa = <span class="dv">50</span></span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true"></a>a = <span class="dv">15</span>, sa = <span class="dv">55</span></span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true"></a>a = <span class="dv">15</span>, sa = <span class="dv">60</span></span></code></pre></div>
<p>This is useful for cases where a function needs to keep some state between invocations, and you don’t want to use global variables. Beware, however, this feature should be used very sparingly - it makes your code not thread-safe and harder to understand.</p>
<ol start="2" type="1">
<li>Is used widely as an “access control” feature. If you have a .c file implementing some functionality, it usually exposes only a few “public” functions to users. The rest of its functions should be made <code>static</code>, so that the user won’t be able to access them. This is encapsulation, a good practice.</li>
</ol>
<p>Quoting <a href="http://en.wikipedia.org/wiki/Static_variable" rel="noreferrer">Wikipedia</a>:</p>
<blockquote>
<p>
In the C programming language, static is used with global variables and functions to set their scope to the containing file. In local variables, static is used to store the variable in the statically allocated memory instead of the automatically allocated memory. While the language does not dictate the implementation of either type of memory, statically allocated memory is typically reserved in data segment of the program at compile time, while the automatically allocated memory is normally implemented as a transient call stack.
</p>
</blockquote>
<p>See <a href="http://os.camden.rutgers.edu/c_resources/c_manual/C/CONCEPT/storage_class.html" rel="noreferrer">here</a> and <a href="http://os.camden.rutgers.edu/c_resources/c_manual/C/SYNTAX/static.htm" rel="noreferrer">here</a> for more details.</p>
<p>And to answer your second question, it’s not like in C #.</p>
<p>In C++, however, <code>static</code> is also used to define class attributes (shared between all objects of the same class) and methods. In C there are no classes, so this feature is irrelevant.</p>
</section>
<section id="answer-2-score-217" class="level4">
<h4>Answer 2 (score 217)</h4>
<p>There is one more use not covered here, and that is as part of an array type declaration as an argument to a function:</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true"></a><span class="dt">int</span> someFunction(<span class="dt">char</span> arg[<span class="dt">static</span> <span class="dv">10</span>])</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true"></a>{</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true"></a>    ...</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true"></a>}</span></code></pre></div>
<p>In this context, this specifies that arguments passed to this function must be an array of type <code>char</code> with at least 10 elements in it. For more info see my question <a href="https://stackoverflow.com/questions/3430315/purpose-of-static-keyword-in-array-parameter-of-function">here</a>.</p>
</section>
<section id="answer-3-score-160" class="level4">
<h4>Answer 3 (score 160)</h4>
<p>Short answer … <strong>it depends.</strong></p>
<ol>
<li>
<p>
Static defined local variables do not lose their value between function calls. In other words they are global variables, but scoped to the local function they are defined in.
</p>
</li>
<li>
<p>
Static global variables are not visible outside of the C file they are defined in.
</p>
</li>
<li>
<p>
Static functions are not visible outside of the C file they are defined in.
</p>
</li>
</ol>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-can-i-get-the-list-of-files-in-a-directory-using-c-or-c-score-806406-in-2018" class="level3">
<h3>16: How can I get the list of files in a directory using C or C++? (score <a href="https://stackoverflow.com/q/612097.html">806406</a> in 2018)</h3>
<section id="question-15" class="level4">
<h4>Question</h4>
<p>How can I determine the list of files in a directory from inside my C or C++ code?</p>
<p>I’m not allowed to execute the <code>ls</code> command and parse the results from within my program.</p>
</section>
<section id="answer-accepted-score-749" class="level4">
<h4>Answer accepted (score 749)</h4>
<p>In small and simple tasks I do not use boost, I use <strong>dirent.h</strong> which is also available for windows:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true"></a>DIR *dir;</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true"></a><span class="kw">struct</span> dirent *ent;</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true"></a><span class="cf">if</span> ((dir = opendir (<span class="st">&quot;c:</span><span class="sc">\\</span><span class="st">src</span><span class="sc">\\</span><span class="st">&quot;</span>)) != NULL) {</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true"></a>  <span class="co">/* print all the files and directories within directory */</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true"></a>  <span class="cf">while</span> ((ent = readdir (dir)) != NULL) {</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true"></a>    printf (<span class="st">&quot;%s</span><span class="sc">\n</span><span class="st">&quot;</span>, ent-&gt;d_name);</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true"></a>  }</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true"></a>  closedir (dir);</span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true"></a>} <span class="cf">else</span> {</span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true"></a>  <span class="co">/* could not open directory */</span></span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true"></a>  perror (<span class="st">&quot;&quot;</span>);</span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true"></a>  <span class="cf">return</span> EXIT_FAILURE;</span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true"></a>}</span></code></pre></div>
<p>It is just a small header file and does most of the simple stuff you need without using a big template-based approach like boost(no offence, I like boost!).</p>
<p>The author of the windows compatibility layer is Toni Ronkko. In Unix, it is a standard header.</p>
<p><strong>UPDATE 2017</strong>:</p>
<p>In C++17 there is now an official way to list files of your file system: <code>std::filesystem</code>. There is an excellent answer from <a href="https://stackoverflow.com/a/37494654/23264"><strong>Shreevardhan</strong></a> below with this source code:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true"></a></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;string&gt;</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true"></a></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true"></a></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;filesystem&gt;</span></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true"></a>namespace fs = std::filesystem;</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true"></a></span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true"></a><span class="dt">int</span> main()</span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true"></a>{</span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true"></a>    std::string path = <span class="st">&quot;/path/to/directory&quot;</span>;</span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true"></a>    <span class="cf">for</span> (<span class="dt">const</span> <span class="dt">auto</span> &amp; entry : fs::directory_iterator(path))</span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true"></a>        std::cout &lt;&lt; entry.path() &lt;&lt; std::endl;</span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true"></a>}</span></code></pre></div>
</section>
<section id="answer-2-score-285" class="level4">
<h4>Answer 2 (score 285)</h4>
<p>C++17 now has a <a href="http://en.cppreference.com/w/cpp/filesystem/directory_iterator" rel="noreferrer"><code>std::filesystem::directory_iterator</code></a>, which can be used as</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true"></a></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;string&gt;</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true"></a></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true"></a></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;filesystem&gt;</span></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true"></a>namespace fs = std::filesystem;</span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true"></a></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true"></a><span class="dt">int</span> main() {</span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true"></a>    std::string path = <span class="st">&quot;/path/to/directory&quot;</span>;</span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true"></a>    <span class="cf">for</span> (<span class="dt">const</span> <span class="dt">auto</span> &amp; entry : fs::directory_iterator(path))</span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true"></a>        std::cout &lt;&lt; entry.path() &lt;&lt; std::endl;</span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true"></a>}</span></code></pre></div>
<p>Also, <a href="http://en.cppreference.com/w/cpp/filesystem/recursive_directory_iterator" rel="noreferrer"><code>std::filesystem::recursive_directory_iterator</code></a> can iterate the subdirectories as well.</p>
</section>
<section id="answer-3-score-227" class="level4">
<h4>Answer 3 (score 227)</h4>
<p>Unfortunately the C++ standard does not define a standard way of working with files and folders in this way.</p>
<p>Since there is no cross platform way, the best cross platform way is to use a library such as the <a href="http://www.boost.org/doc/libs/1_38_0/libs/filesystem/doc/index.htm" rel="noreferrer">boost filesystem module</a>.</p>
<p><strong>Cross platform boost method:</strong></p>
<blockquote>
<p>The following function, given a directory path and a file name, recursively searches the directory and its sub-directories for the file name, returning a bool, and if successful, the path to the file that was found.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true"></a><span class="dt">bool</span> find_file(<span class="dt">const</span> path &amp; dir_path,         <span class="co">// in this directory,</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true"></a>               <span class="dt">const</span> std::string &amp; file_name, <span class="co">// search for this name,</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true"></a>               path &amp; path_found)             <span class="co">// placing path here if found</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true"></a>{</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true"></a>    <span class="cf">if</span> (!exists(dir_path)) </span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true"></a>        <span class="cf">return</span> false;</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true"></a></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true"></a>    directory_iterator end_itr; <span class="co">// default construction yields past-the-end</span></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true"></a></span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true"></a>    <span class="cf">for</span> (directory_iterator itr(dir_path); itr != end_itr; ++itr)</span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true"></a>    {</span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true"></a>        <span class="cf">if</span> (is_directory(itr-&gt;status()))</span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true"></a>        {</span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true"></a>            <span class="cf">if</span> (find_file(itr-&gt;path(), file_name, path_found)) </span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true"></a>                <span class="cf">return</span> true;</span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true"></a>        }</span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true"></a>        <span class="cf">else</span> <span class="cf">if</span> (itr-&gt;leaf() == file_name) <span class="co">// see below</span></span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true"></a>        {</span>
<span id="cb98-19"><a href="#cb98-19" aria-hidden="true"></a>            path_found = itr-&gt;path();</span>
<span id="cb98-20"><a href="#cb98-20" aria-hidden="true"></a>            <span class="cf">return</span> true;</span>
<span id="cb98-21"><a href="#cb98-21" aria-hidden="true"></a>        }</span>
<span id="cb98-22"><a href="#cb98-22" aria-hidden="true"></a>    }</span>
<span id="cb98-23"><a href="#cb98-23" aria-hidden="true"></a>    <span class="cf">return</span> false;</span>
<span id="cb98-24"><a href="#cb98-24" aria-hidden="true"></a>}</span></code></pre></div>
</blockquote>
<p>Source from the boost page mentioned above.</p>
<p><strong>For Unix/Linux based systems:</strong></p>
<p>You can use <a href="http://www.manpagez.com/man/3/opendir/" rel="noreferrer">opendir</a> / <a href="http://www.manpagez.com/man/3/readdir/" rel="noreferrer">readdir</a> / <a href="http://www.manpagez.com/man/3/closedir/" rel="noreferrer">closedir</a>.</p>
<blockquote>
<p>Sample code which searches a directory for entry ``name’’ is:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true"></a>len = strlen(name);</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true"></a>dirp = opendir(<span class="st">&quot;.&quot;</span>);</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true"></a><span class="cf">while</span> ((dp = readdir(dirp)) != NULL)</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true"></a>        <span class="cf">if</span> (dp-&gt;d_namlen == len &amp;&amp; !strcmp(dp-&gt;d_name, name)) {</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true"></a>                (<span class="dt">void</span>)closedir(dirp);</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true"></a>                <span class="cf">return</span> FOUND;</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true"></a>        }</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true"></a>(<span class="dt">void</span>)closedir(dirp);</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true"></a><span class="cf">return</span> NOT_FOUND;</span></code></pre></div>
</blockquote>
<p>Source code from the above man pages.</p>
<p><strong>For a windows based systems:</strong></p>
<p>You can use the Win32 API <a href="http://msdn.microsoft.com/en-us/library/aa364418(VS.85).aspx" rel="noreferrer">FindFirstFile</a> / <a href="http://msdn.microsoft.com/en-us/library/aa364428(VS.85).aspx" rel="noreferrer">FindNextFile</a> / <a href="http://msdn.microsoft.com/en-us/library/aa364413(VS.85).aspx" rel="noreferrer">FindClose</a> functions.</p>
<blockquote>
<p>The following C++ example shows you a minimal use of FindFirstFile.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true"></a></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;windows.h&gt;</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true"></a></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;tchar.h&gt;</span></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true"></a></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true"></a></span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true"></a><span class="dt">void</span> _tmain(<span class="dt">int</span> argc, TCHAR *argv[])</span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true"></a>{</span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true"></a>   WIN32_FIND_DATA FindFileData;</span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true"></a>   HANDLE hFind;</span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true"></a></span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true"></a>   <span class="cf">if</span>( argc != <span class="dv">2</span> )</span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true"></a>   {</span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true"></a>      _tprintf(TEXT(<span class="st">&quot;Usage: %s [target_file]</span><span class="sc">\n</span><span class="st">&quot;</span>), argv[<span class="dv">0</span>]);</span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true"></a>      <span class="cf">return</span>;</span>
<span id="cb100-17"><a href="#cb100-17" aria-hidden="true"></a>   }</span>
<span id="cb100-18"><a href="#cb100-18" aria-hidden="true"></a></span>
<span id="cb100-19"><a href="#cb100-19" aria-hidden="true"></a>   _tprintf (TEXT(<span class="st">&quot;Target file is %s</span><span class="sc">\n</span><span class="st">&quot;</span>), argv[<span class="dv">1</span>]);</span>
<span id="cb100-20"><a href="#cb100-20" aria-hidden="true"></a>   hFind = FindFirstFile(argv[<span class="dv">1</span>], &amp;FindFileData);</span>
<span id="cb100-21"><a href="#cb100-21" aria-hidden="true"></a>   <span class="cf">if</span> (hFind == INVALID_HANDLE_VALUE) </span>
<span id="cb100-22"><a href="#cb100-22" aria-hidden="true"></a>   {</span>
<span id="cb100-23"><a href="#cb100-23" aria-hidden="true"></a>      printf (<span class="st">&quot;FindFirstFile failed (%d)</span><span class="sc">\n</span><span class="st">&quot;</span>, GetLastError());</span>
<span id="cb100-24"><a href="#cb100-24" aria-hidden="true"></a>      <span class="cf">return</span>;</span>
<span id="cb100-25"><a href="#cb100-25" aria-hidden="true"></a>   } </span>
<span id="cb100-26"><a href="#cb100-26" aria-hidden="true"></a>   <span class="cf">else</span> </span>
<span id="cb100-27"><a href="#cb100-27" aria-hidden="true"></a>   {</span>
<span id="cb100-28"><a href="#cb100-28" aria-hidden="true"></a>      _tprintf (TEXT(<span class="st">&quot;The first file found is %s</span><span class="sc">\n</span><span class="st">&quot;</span>), </span>
<span id="cb100-29"><a href="#cb100-29" aria-hidden="true"></a>                FindFileData.cFileName);</span>
<span id="cb100-30"><a href="#cb100-30" aria-hidden="true"></a>      FindClose(hFind);</span>
<span id="cb100-31"><a href="#cb100-31" aria-hidden="true"></a>   }</span>
<span id="cb100-32"><a href="#cb100-32" aria-hidden="true"></a>}</span></code></pre></div>
</blockquote>
<p>Source code from the above msdn pages.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-do-function-pointers-in-c-work-score-766864-in" class="level3">
<h3>17: How do function pointers in C work? (score <a href="https://stackoverflow.com/q/840501.html">766864</a> in )</h3>
<section id="question-16" class="level4">
<h4>Question</h4>
<p>I had some experience lately with function pointers in C.</p>
<p>So going on with the tradition of answering your own questions, I decided to make a small summary of the very basics, for those who need a quick dive-in to the subject.</p>
</section>
<section id="answer-accepted-score-1396" class="level4">
<h4>Answer accepted (score 1396)</h4>
<h5>
Function pointers in C
</h1>
<p>Let’s start with a basic function which we will be <em>pointing to</em>:</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true"></a><span class="dt">int</span> addInt(<span class="dt">int</span> n, <span class="dt">int</span> m) {</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true"></a>    <span class="cf">return</span> n+m;</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true"></a>}</span></code></pre></div>
<p>First thing, let’s define a pointer to a function which receives 2 <code>int</code>s and returns an <code>int</code>:</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true"></a><span class="dt">int</span> (*functionPtr)(<span class="dt">int</span>,<span class="dt">int</span>);</span></code></pre></div>
<p>Now we can safely point to our function:</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true"></a>functionPtr = &amp;addInt;</span></code></pre></div>
<p>Now that we have a pointer to the function, let’s use it:</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true"></a><span class="dt">int</span> sum = (*functionPtr)(<span class="dv">2</span>, <span class="dv">3</span>); <span class="co">// sum == 5</span></span></code></pre></div>
<p>Passing the pointer to another function is basically the same:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true"></a><span class="dt">int</span> add2to3(<span class="dt">int</span> (*functionPtr)(<span class="dt">int</span>, <span class="dt">int</span>)) {</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true"></a>    <span class="cf">return</span> (*functionPtr)(<span class="dv">2</span>, <span class="dv">3</span>);</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true"></a>}</span></code></pre></div>
<p>We can use function pointers in return values as well (try to keep up, it gets messy):</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true"></a><span class="co">// this is a function called functionFactory which receives parameter n</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true"></a><span class="co">// and returns a pointer to another function which receives two ints</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true"></a><span class="co">// and it returns another int</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true"></a><span class="dt">int</span> (*functionFactory(<span class="dt">int</span> n))(<span class="dt">int</span>, <span class="dt">int</span>) {</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true"></a>    printf(<span class="st">&quot;Got parameter %d&quot;</span>, n);</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true"></a>    <span class="dt">int</span> (*functionPtr)(<span class="dt">int</span>,<span class="dt">int</span>) = &amp;addInt;</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true"></a>    <span class="cf">return</span> functionPtr;</span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true"></a>}</span></code></pre></div>
<p>But it’s much nicer to use a <code>typedef</code>:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true"></a><span class="kw">typedef</span> <span class="dt">int</span> (*myFuncDef)(<span class="dt">int</span>, <span class="dt">int</span>);</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true"></a><span class="co">// note that the typedef name is indeed myFuncDef</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true"></a></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true"></a>myFuncDef functionFactory(<span class="dt">int</span> n) {</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true"></a>    printf(<span class="st">&quot;Got parameter %d&quot;</span>, n);</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true"></a>    myFuncDef functionPtr = &amp;addInt;</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true"></a>    <span class="cf">return</span> functionPtr;</span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true"></a>}</span></code></pre></div>
</section>
<section id="answer-2-score-292" class="level4">
<h4>Answer 2 (score 292)</h4>
<p><strong>Function pointers in C can be used to perform object-oriented programming in C.</strong></p>
<p>For example, the following lines is written in C:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true"></a>String s1 = newString();</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true"></a>s1-&gt;set(s1, <span class="st">&quot;hello&quot;</span>);</span></code></pre></div>
<p>Yes, the <code>-&amp;gt;</code> and the lack of a <code>new</code> operator is a dead give away, but it sure seems to imply that we’re setting the text of some <code>String</code> class to be <code>"hello"</code>.</p>
<p>By using function pointers, <strong>it is possible to emulate methods in C</strong>.</p>
<p>How is this accomplished?</p>
<p>The <code>String</code> class is actually a <code>struct</code> with a bunch of function pointers which act as a way to simulate methods. The following is a partial declaration of the <code>String</code> class:</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true"></a><span class="kw">typedef</span> <span class="kw">struct</span> String_Struct* String;</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true"></a></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true"></a><span class="kw">struct</span> String_Struct</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true"></a>{</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true"></a>    <span class="dt">char</span>* (*get)(<span class="dt">const</span> <span class="dt">void</span>* self);</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true"></a>    <span class="dt">void</span> (*set)(<span class="dt">const</span> <span class="dt">void</span>* self, <span class="dt">char</span>* value);</span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true"></a>    <span class="dt">int</span> (*length)(<span class="dt">const</span> <span class="dt">void</span>* self);</span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true"></a>};</span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true"></a></span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true"></a><span class="dt">char</span>* getString(<span class="dt">const</span> <span class="dt">void</span>* self);</span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true"></a><span class="dt">void</span> setString(<span class="dt">const</span> <span class="dt">void</span>* self, <span class="dt">char</span>* value);</span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true"></a><span class="dt">int</span> lengthString(<span class="dt">const</span> <span class="dt">void</span>* self);</span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true"></a></span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true"></a>String newString();</span></code></pre></div>
<p>As can be seen, the methods of the <code>String</code> class are actually function pointers to the declared function. In preparing the instance of the <code>String</code>, the <code>newString</code> function is called in order to set up the function pointers to their respective functions:</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true"></a>String newString()</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true"></a>{</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true"></a>    String self = (String)malloc(<span class="kw">sizeof</span>(<span class="kw">struct</span> String_Struct));</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true"></a></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true"></a>    self-&gt;get = &amp;getString;</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true"></a>    self-&gt;set = &amp;setString;</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true"></a>    self-&gt;length = &amp;lengthString;</span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true"></a></span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true"></a>    self-&gt;set(self, <span class="st">&quot;&quot;</span>);</span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true"></a></span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true"></a>    <span class="cf">return</span> self;</span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true"></a>}</span></code></pre></div>
<p>For example, the <code>getString</code> function that is called by invoking the <code>get</code> method is defined as the following:</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true"></a><span class="dt">char</span>* getString(<span class="dt">const</span> <span class="dt">void</span>* self_obj)</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true"></a>{</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true"></a>    <span class="cf">return</span> ((String)self_obj)-&gt;internal-&gt;value;</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true"></a>}</span></code></pre></div>
<p>One thing that can be noticed is that there is no concept of an instance of an object and having methods that are actually a part of an object, so a “self object” must be passed in on each invocation. (And the <code>internal</code> is just a hidden <code>struct</code> which was omitted from the code listing earlier – it is a way of performing information hiding, but that is not relevant to function pointers.)</p>
<p>So, rather than being able to do <code>s1-&amp;gt;set("hello");</code>, one must pass in the object to perform the action on <code>s1-&amp;gt;set(s1, "hello")</code>.</p>
<p>With that minor explanation having to pass in a reference to yourself out of the way, we’ll move to the next part, which is <strong>inheritance in C</strong>.</p>
<p>Let’s say we want to make a subclass of <code>String</code>, say an <code>ImmutableString</code>. In order to make the string immutable, the <code>set</code> method will not be accessible, while maintaining access to <code>get</code> and <code>length</code>, and force the “constructor” to accept a <code>char*</code>:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true"></a><span class="kw">typedef</span> <span class="kw">struct</span> ImmutableString_Struct* ImmutableString;</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true"></a></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true"></a><span class="kw">struct</span> ImmutableString_Struct</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true"></a>{</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true"></a>    String base;</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true"></a></span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true"></a>    <span class="dt">char</span>* (*get)(<span class="dt">const</span> <span class="dt">void</span>* self);</span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true"></a>    <span class="dt">int</span> (*length)(<span class="dt">const</span> <span class="dt">void</span>* self);</span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true"></a>};</span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true"></a></span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true"></a>ImmutableString newImmutableString(<span class="dt">const</span> <span class="dt">char</span>* value);</span></code></pre></div>
<p>Basically, for all subclasses, the available methods are once again function pointers. This time, the declaration for the <code>set</code> method is not present, therefore, it cannot be called in a <code>ImmutableString</code>.</p>
<p>As for the implementation of the <code>ImmutableString</code>, the only relevant code is the “constructor” function, the <code>newImmutableString</code>:</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true"></a>ImmutableString newImmutableString(<span class="dt">const</span> <span class="dt">char</span>* value)</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true"></a>{</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true"></a>    ImmutableString self = (ImmutableString)malloc(<span class="kw">sizeof</span>(<span class="kw">struct</span> ImmutableString_Struct));</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true"></a></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true"></a>    self-&gt;base = newString();</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true"></a></span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true"></a>    self-&gt;get = self-&gt;base-&gt;get;</span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true"></a>    self-&gt;length = self-&gt;base-&gt;length;</span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true"></a></span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true"></a>    self-&gt;base-&gt;set(self-&gt;base, (<span class="dt">char</span>*)value);</span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true"></a></span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true"></a>    <span class="cf">return</span> self;</span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true"></a>}</span></code></pre></div>
<p>In instantiating the <code>ImmutableString</code>, the function pointers to the <code>get</code> and <code>length</code> methods actually refer to the <code>String.get</code> and <code>String.length</code> method, by going through the <code>base</code> variable which is an internally stored <code>String</code> object.</p>
<p>The use of a function pointer can achieve inheritance of a method from a superclass.</p>
<p>We can further continue to <strong>polymorphism in C</strong>.</p>
<p>If for example we wanted to change the behavior of the <code>length</code> method to return <code>0</code> all the time in the <code>ImmutableString</code> class for some reason, all that would have to be done is to:</p>
<ol>
<li>
Add a function that is going to serve as the overriding <code>length</code> method.
</li>
<li>
Go to the “constructor” and set the function pointer to the overriding <code>length</code> method.
</li>
</ol>
<p>Adding an overriding <code>length</code> method in <code>ImmutableString</code> may be performed by adding an <code>lengthOverrideMethod</code>:</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true"></a><span class="dt">int</span> lengthOverrideMethod(<span class="dt">const</span> <span class="dt">void</span>* self)</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true"></a>{</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true"></a>}</span></code></pre></div>
<p>Then, the function pointer for the <code>length</code> method in the constructor is hooked up to the <code>lengthOverrideMethod</code>:</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true"></a>ImmutableString newImmutableString(<span class="dt">const</span> <span class="dt">char</span>* value)</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true"></a>{</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true"></a>    ImmutableString self = (ImmutableString)malloc(<span class="kw">sizeof</span>(<span class="kw">struct</span> ImmutableString_Struct));</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true"></a></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true"></a>    self-&gt;base = newString();</span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true"></a></span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true"></a>    self-&gt;get = self-&gt;base-&gt;get;</span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true"></a>    self-&gt;length = &amp;lengthOverrideMethod;</span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true"></a></span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true"></a>    self-&gt;base-&gt;set(self-&gt;base, (<span class="dt">char</span>*)value);</span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true"></a></span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true"></a>    <span class="cf">return</span> self;</span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true"></a>}</span></code></pre></div>
<p>Now, rather than having an identical behavior for the <code>length</code> method in <code>ImmutableString</code> class as the <code>String</code> class, now the <code>length</code> method will refer to the behavior defined in the <code>lengthOverrideMethod</code> function.</p>
<p>I must add a disclaimer that I am still learning how to write with an object-oriented programming style in C, so there probably are points that I didn’t explain well, or may just be off mark in terms of how best to implement OOP in C. But my purpose was to try to illustrate one of many uses of function pointers.</p>
<p>For more information on how to perform object-oriented programming in C, please refer to the following questions:</p>
<ul>
<li>
<a href="https://stackoverflow.com/questions/415452/object-orientation-in-c">Object-Orientation in C?</a>
</li>
<li>
<a href="https://stackoverflow.com/questions/351733/can-you-write-object-oriented-code-in-c">Can you write object oriented code in C?</a>
</li>
</ul>
</section>
<section id="answer-3-score-218" class="level4">
<h4>Answer 3 (score 218)</h4>
<p>The guide to getting fired: How to abuse function pointers in GCC on x86 machines by compiling your code by hand:</p>
<p>These string literals are bytes of 32-bit x86 machine code. <code>0xC3</code> is <a href="http://felixcloutier.com/x86/RET.html" rel="noreferrer">an x86 <code>ret</code> instruction</a>.</p>
<p>You wouldn’t normally write these by hand, you’d write in assembly language and then use an assembler like <code>nasm</code> to assemble it into a flat binary which you hexdump into a C string literal.</p>
<ol>
<li>
<p>
Returns the current value on the EAX register
</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true"></a><span class="dt">int</span> eax = ((<span class="dt">int</span>(*)())(<span class="st">&quot;</span><span class="sc">\xc3</span><span class="st"> &lt;- This returns the value of the EAX register&quot;</span>))();</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true"></a>&lt;li&gt;&lt;p&gt;Write a swap function&lt;/p&gt;</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true"></a></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true"></a>```c</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true"></a><span class="dt">int</span> a = <span class="dv">10</span>, b = <span class="dv">20</span>;</span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true"></a>((<span class="dt">void</span>(*)(<span class="dt">int</span>*,<span class="dt">int</span>*))<span class="st">&quot;</span><span class="sc">\x8b\x44\x24\x04\x8b\x5c\x24\x08\x8b\x00\x8b\x1b\x31\xc3\x31\xd8\x31\xc3\x8b\x4c\x24\x04\x89\x01\x8b\x4c\x24\x08\x89\x19\xc3</span><span class="st"> &lt;- This swaps the values of a and b&quot;</span>)(&amp;a,&amp;b);</span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true"></a>&lt;li&gt;&lt;p&gt;Write a <span class="cf">for</span>-loop counter to <span class="dv">1000</span>, calling some function each time&lt;/p&gt;</span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true"></a></span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true"></a>```c</span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true"></a>((<span class="dt">int</span>(*)())<span class="st">&quot;</span><span class="sc">\x66\x31\xc0\x8b\x5c\x24\x04\x66\x40\x50\xff\xd3\x58\x66\x3d\xe8\x03\x75\xf4\xc3</span><span class="st">&quot;</span>)(&amp;function); <span class="co">// calls function with 1-&gt;1000</span></span>
<span id="cb116-13"><a href="#cb116-13" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb116-14"><a href="#cb116-14" aria-hidden="true"></a>&lt;li&gt;&lt;p&gt;You can even write a recursive function that counts to <span class="dv">100</span>&lt;/p&gt;</span>
<span id="cb116-15"><a href="#cb116-15" aria-hidden="true"></a></span>
<span id="cb116-16"><a href="#cb116-16" aria-hidden="true"></a>```c</span>
<span id="cb116-17"><a href="#cb116-17" aria-hidden="true"></a><span class="dt">const</span> <span class="dt">char</span>* lol = <span class="st">&quot;</span><span class="sc">\x8b\x5c\x24\x4\x3d\xe8\x3\x0\x0\x7e\x2\x31\xc0\x83\xf8\x64\x7d\x6\x40\x53\xff\xd3\x5b\xc3\xc3</span><span class="st"> &lt;- Recursively calls the function at address lol.&quot;</span>;</span>
<span id="cb116-18"><a href="#cb116-18" aria-hidden="true"></a>i = ((<span class="dt">int</span>(*)())(lol))(lol);</span>
<span id="cb116-19"><a href="#cb116-19" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb116-20"><a href="#cb116-20" aria-hidden="true"></a>&lt;/ol&gt;</span>
<span id="cb116-21"><a href="#cb116-21" aria-hidden="true"></a></span>
<span id="cb116-22"><a href="#cb116-22" aria-hidden="true"></a>Note that compilers place string literals in the `.rodata` section (or `.rdata` on Windows), which is linked as part of the text segment (along with code <span class="cf">for</span> functions).  </span>
<span id="cb116-23"><a href="#cb116-23" aria-hidden="true"></a></span>
<span id="cb116-24"><a href="#cb116-24" aria-hidden="true"></a>The text segment has Read+Exec permission, so casting string literals to function pointers works without needing `mprotect()` or `VirtualProtect()` system calls like you&#39;d need <span class="cf">for</span> dynamically allocated memory.  (Or `gcc -z execstack` links the program with stack + data segment + heap executable, as a quick hack.)  </span>
<span id="cb116-25"><a href="#cb116-25" aria-hidden="true"></a></span>
<span id="cb116-26"><a href="#cb116-26" aria-hidden="true"></a>&lt;hr&gt;</span>
<span id="cb116-27"><a href="#cb116-27" aria-hidden="true"></a></span>
<span id="cb116-28"><a href="#cb116-28" aria-hidden="true"></a>To disassemble these, you can compile this to put a label on the bytes, and use a disassembler.  </span>
<span id="cb116-29"><a href="#cb116-29" aria-hidden="true"></a></span>
<span id="cb116-30"><a href="#cb116-30" aria-hidden="true"></a>```c</span>
<span id="cb116-31"><a href="#cb116-31" aria-hidden="true"></a><span class="co">// at global scope</span></span>
<span id="cb116-32"><a href="#cb116-32" aria-hidden="true"></a><span class="dt">const</span> <span class="dt">char</span> swap[] = <span class="st">&quot;</span><span class="sc">\x8b\x44\x24\x04\x8b\x5c\x24\x08\x8b\x00\x8b\x1b\x31\xc3\x31\xd8\x31\xc3\x8b\x4c\x24\x04\x89\x01\x8b\x4c\x24\x08\x89\x19\xc3</span><span class="st"> &lt;- This swaps the values of a and b&quot;</span>;</span></code></pre></div>
<p>Compiling with <code>gcc -c -m32 foo.c</code> and disassembling with <code>objdump -D -rwC -Mintel</code>, we can get the assembly, and find out that this code violates the ABI by clobbering EBX (a call-preserved register) and is generally inefficient.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true"></a><span class="bn">00000000</span> &lt;swap&gt;:</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true"></a>   <span class="dv">0</span>:   <span class="dv">8</span><span class="er">b</span> <span class="dv">44</span> <span class="dv">24</span> <span class="bn">04</span>             mov    eax,DWORD PTR [esp+<span class="bn">0x4</span>]</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true"></a><span class="er"># load int *a arg from the stack</span></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true"></a>   <span class="dv">4</span>:   <span class="dv">8</span><span class="er">b</span> <span class="dv">5</span><span class="er">c</span> <span class="dv">24</span> <span class="er">08</span>             mov    ebx,DWORD PTR [esp+<span class="bn">0x8</span>]</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true"></a><span class="er"># ebx = b</span></span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true"></a>   <span class="dv">8</span>:   <span class="dv">8</span><span class="er">b</span> <span class="bn">00</span>                   mov    eax,DWORD PTR [eax]</span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true"></a><span class="er"># dereference: eax = *a</span></span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true"></a>   a:   <span class="dv">8</span><span class="er">b</span> <span class="dv">1</span><span class="er">b</span>                   mov    ebx,DWORD PTR [ebx]</span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true"></a>   c:   <span class="dv">31</span> c3                   xor    ebx,eax</span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true"></a><span class="er"># pointless xor-swap</span></span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true"></a>   e:   <span class="dv">31</span> d8                   xor    eax,ebx</span>
<span id="cb117-12"><a href="#cb117-12" aria-hidden="true"></a><span class="er"># instead of just storing with opposite registers</span></span>
<span id="cb117-13"><a href="#cb117-13" aria-hidden="true"></a>  <span class="dv">10</span>:   <span class="dv">31</span> c3                   xor    ebx,eax</span>
<span id="cb117-14"><a href="#cb117-14" aria-hidden="true"></a>  <span class="dv">12</span>:   <span class="dv">8</span><span class="er">b</span> <span class="dv">4</span><span class="er">c</span> <span class="dv">24</span> <span class="bn">04</span>             mov    ecx,DWORD PTR [esp+<span class="bn">0x4</span>]</span>
<span id="cb117-15"><a href="#cb117-15" aria-hidden="true"></a><span class="er"># reload a from the stack</span></span>
<span id="cb117-16"><a href="#cb117-16" aria-hidden="true"></a>  <span class="dv">16</span>:   <span class="dv">89</span> <span class="bn">01</span>                   mov    DWORD PTR [ecx],eax</span>
<span id="cb117-17"><a href="#cb117-17" aria-hidden="true"></a><span class="er"># store to *a</span></span>
<span id="cb117-18"><a href="#cb117-18" aria-hidden="true"></a>  <span class="dv">18</span>:   <span class="dv">8</span><span class="er">b</span> <span class="dv">4</span><span class="er">c</span> <span class="dv">24</span> <span class="er">08</span>             mov    ecx,DWORD PTR [esp+<span class="bn">0x8</span>]</span>
<span id="cb117-19"><a href="#cb117-19" aria-hidden="true"></a>  <span class="dv">1</span><span class="er">c</span>:   <span class="dv">89</span> <span class="dv">19</span>                   mov    DWORD PTR [ecx],ebx</span>
<span id="cb117-20"><a href="#cb117-20" aria-hidden="true"></a>  <span class="dv">1</span><span class="er">e</span>:   c3                      ret    </span>
<span id="cb117-21"><a href="#cb117-21" aria-hidden="true"></a></span>
<span id="cb117-22"><a href="#cb117-22" aria-hidden="true"></a>  not shown: the later bytes are ASCII text documentation</span>
<span id="cb117-23"><a href="#cb117-23" aria-hidden="true"></a>  they&#39;re not executed by the CPU because the ret instruction sends execution back to the caller</span></code></pre></div>
<p>This machine code will (probably) work in 32-bit code on Windows, Linux, OS X, and so on: the default calling conventions on all those OSes pass args on the stack instead of more efficiently in registers. But EBX is call-preserved in all the normal calling conventions, so using it as a scratch register without saving/restoring it can easily make the caller crash.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-can-i-get-a-files-size-in-c-score-735156-in-2019" class="level3">
<h3>18: How can I get a file’s size in C? (score <a href="https://stackoverflow.com/q/238603.html">735156</a> in 2019)</h3>
<section id="question-17" class="level4">
<h4>Question</h4>
<blockquote>
<p>
<strong>Possible Duplicate:</strong><br> <a href="https://stackoverflow.com/questions/8236/how-do-you-determine-the-size-of-a-file-in-c">How do you determine the size of a file in C?</a>
</p>
</blockquote>
<p>
How can I find out the size of a file I opened with an application written in C ? I would like to know the size, because I want to put the content of the loaded file into a string, which I allocate using <code>malloc()</code>. Just writing <code>malloc(10000*sizeof(char));</code> is IMHO a bad idea.
</p>
</section>
<section id="answer-accepted-score-479" class="level4">
<h4>Answer accepted (score 479)</h4>
<p>You need to seek to the end of the file and then ask for the position:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true"></a>fseek(fp, <span class="dv">0</span><span class="bu">L</span>, SEEK_END);</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true"></a>sz = ftell(fp);</span></code></pre></div>
<p>You can then seek back, e.g.:</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true"></a>fseek(fp, <span class="dv">0</span><span class="bu">L</span>, SEEK_SET);</span></code></pre></div>
<p>or (if seeking to go to the beginning)</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true"></a>rewind(fp);</span></code></pre></div>
</section>
<section id="answer-2-score-359" class="level4">
<h4>Answer 2 (score 359)</h4>
<h5>
Using standard library:
</h2>
<p>Assuming that your implementation meaningfully supports SEEK_END:</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true"></a>fseek(f, <span class="dv">0</span>, SEEK_END); <span class="co">// seek to end of file</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true"></a>size = ftell(f); <span class="co">// get current file pointer</span></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true"></a>fseek(f, <span class="dv">0</span>, SEEK_SET); <span class="co">// seek back to beginning of file</span></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true"></a><span class="co">// proceed with allocating memory and reading the file</span></span></code></pre></div>
<h5>
Linux/POSIX:
</h2>
<p>You can use <code>stat</code> (if you know the filename), or <code>fstat</code> (if you have the file descriptor).</p>
<p>Here is an example for stat:</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true"></a></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;sys/stat.h&gt;</span></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true"></a><span class="kw">struct</span> stat st;</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true"></a>stat(filename, &amp;st);</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true"></a>size = st.st_size;</span></code></pre></div>
<h5>
Win32:
</h2>
<p>You can use <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa364955(v=vs.85).aspx" rel="noreferrer">GetFileSize</a> or <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa364957(v=vs.85).aspx" rel="noreferrer">GetFileSizeEx</a>.</p>
</section>
<section id="answer-3-score-104" class="level4">
<h4>Answer 3 (score 104)</h4>
<p>If you have the file descriptor <code>fstat()</code> returns a stat structure which contain the file size.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true"></a></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;sys/types.h&gt;</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true"></a></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;sys/stat.h&gt;</span></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true"></a></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;unistd.h&gt;</span></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true"></a></span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true"></a><span class="co">// fd = fileno(f); //if you have a stream (e.g. from fopen), not a file descriptor.</span></span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true"></a><span class="kw">struct</span> stat buf;</span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true"></a>fstat(fd, &amp;buf);</span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true"></a>off_t size = buf.st_size;</span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="is-there-a-printf-converter-to-print-in-binary-format-score-717928-in" class="level3">
<h3>19: Is there a printf converter to print in binary format? (score <a href="https://stackoverflow.com/q/111928.html">717928</a> in )</h3>
<section id="question-18" class="level4">
<h4>Question</h4>
<p>I can print with printf as a hex or octal number. Is there a format tag to print as binary, or arbitrary base?</p>
<p>I am running gcc.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true"></a>printf(<span class="st">&quot;%d %x %o</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">10</span>); <span class="co">//prints &quot;10 A 12\n&quot;</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true"></a>print(<span class="st">&quot;%b</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="dv">10</span>); <span class="co">// prints &quot;%b\n&quot;</span></span></code></pre></div>
</section>
<section id="answer-2-score-240" class="level4">
<h4>Answer 2 (score 240)</h4>
<p>Hacky but works for me:</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true"></a></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true"></a><span class="pp">#define BYTE_TO_BINARY_PATTERN &quot;%c%c%c%c%c%c%c%c&quot;</span></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true"></a></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true"></a><span class="pp">#define BYTE_TO_BINARY(byte)  \</span></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true"></a><span class="pp">  (byte &amp; 0x80 ? &#39;1&#39; : &#39;0&#39;), \</span></span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true"></a><span class="pp">  (byte &amp; 0x40 ? &#39;1&#39; : &#39;0&#39;), \</span></span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true"></a><span class="pp">  (byte &amp; 0x20 ? &#39;1&#39; : &#39;0&#39;), \</span></span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true"></a><span class="pp">  (byte &amp; 0x10 ? &#39;1&#39; : &#39;0&#39;), \</span></span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true"></a><span class="pp">  (byte &amp; 0x08 ? &#39;1&#39; : &#39;0&#39;), \</span></span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true"></a><span class="pp">  (byte &amp; 0x04 ? &#39;1&#39; : &#39;0&#39;), \</span></span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true"></a><span class="pp">  (byte &amp; 0x02 ? &#39;1&#39; : &#39;0&#39;), \</span></span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true"></a><span class="pp">  (byte &amp; 0x01 ? &#39;1&#39; : &#39;0&#39;) </span></span></code></pre></div>
<div class="sourceCode" id="cb126"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true"></a>printf(<span class="st">&quot;Leading text &quot;</span>BYTE_TO_BINARY_PATTERN, BYTE_TO_BINARY(byte));</span></code></pre></div>
<p>For multi-byte types</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true"></a>printf(<span class="st">&quot;m: &quot;</span>BYTE_TO_BINARY_PATTERN<span class="st">&quot; &quot;</span>BYTE_TO_BINARY_PATTERN<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true"></a>  BYTE_TO_BINARY(m&gt;&gt;<span class="dv">8</span>), BYTE_TO_BINARY(m));</span></code></pre></div>
<p>You need all the extra quotes unfortunately. This approach has the efficiency risks of macros (don’t pass a function as the argument to <code>BYTE_TO_BINARY</code>) but avoids the memory issues and multiple invocations of strcat in some of the other proposals here.</p>
</section>
<section id="answer-3-score-195" class="level4">
<h4>Answer 3 (score 195)</h4>
<p><strong>Print Binary for Any Datatype</strong></p>
<div class="sourceCode" id="cb128"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true"></a><span class="co">//assumes little endian</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true"></a><span class="dt">void</span> printBits(<span class="dt">size_t</span> <span class="dt">const</span> size, <span class="dt">void</span> <span class="dt">const</span> * <span class="dt">const</span> ptr)</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true"></a>{</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true"></a>    <span class="dt">unsigned</span> <span class="dt">char</span> *b = (<span class="dt">unsigned</span> <span class="dt">char</span>*) ptr;</span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true"></a>    <span class="dt">unsigned</span> <span class="dt">char</span> byte;</span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true"></a>    <span class="dt">int</span> i, j;</span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true"></a></span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true"></a>    <span class="cf">for</span> (i=size-<span class="dv">1</span>;i&gt;=<span class="dv">0</span>;i--)</span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true"></a>    {</span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true"></a>        <span class="cf">for</span> (j=<span class="dv">7</span>;j&gt;=<span class="dv">0</span>;j--)</span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true"></a>        {</span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true"></a>            byte = (b[i] &gt;&gt; j) &amp; <span class="dv">1</span>;</span>
<span id="cb128-13"><a href="#cb128-13" aria-hidden="true"></a>            printf(<span class="st">&quot;%u&quot;</span>, byte);</span>
<span id="cb128-14"><a href="#cb128-14" aria-hidden="true"></a>        }</span>
<span id="cb128-15"><a href="#cb128-15" aria-hidden="true"></a>    }</span>
<span id="cb128-16"><a href="#cb128-16" aria-hidden="true"></a>    puts(<span class="st">&quot;&quot;</span>);</span>
<span id="cb128-17"><a href="#cb128-17" aria-hidden="true"></a>}</span></code></pre></div>
<p>test</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true"></a><span class="dt">int</span> main(<span class="dt">int</span> argv, <span class="dt">char</span>* argc[])</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true"></a>{</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true"></a>        <span class="dt">int</span> i = <span class="dv">23</span>;</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true"></a>        uint ui = UINT_MAX;</span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true"></a>        <span class="dt">float</span> f = <span class="fl">23.45</span><span class="bu">f</span>;</span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true"></a>        printBits(<span class="kw">sizeof</span>(i), &amp;i);</span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true"></a>        printBits(<span class="kw">sizeof</span>(ui), &amp;ui);</span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true"></a>        printBits(<span class="kw">sizeof</span>(f), &amp;f);</span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true"></a>        <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true"></a>}</span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-do-you-format-an-unsigned-long-long-int-using-printf-score-717617-in-2018" class="level3">
<h3>20: How do you format an unsigned long long int using printf? (score <a href="https://stackoverflow.com/q/2844.html">717617</a> in 2018)</h3>
<section id="question-19" class="level4">
<h4>Question</h4>
<div class="sourceCode" id="cb130"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true"></a></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true"></a><span class="dt">int</span> main() {</span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true"></a>    <span class="dt">unsigned</span> <span class="dt">long</span> <span class="dt">long</span> <span class="dt">int</span> num = <span class="dv">285212672</span>; <span class="co">//FYI: fits in 29 bits</span></span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true"></a>    <span class="dt">int</span> normalInt = <span class="dv">5</span>;</span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true"></a>    printf(<span class="st">&quot;My number is %d bytes wide and its value is %ul. A normal number is %d.</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="kw">sizeof</span>(num), num, normalInt);</span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true"></a>}</span></code></pre></div>
<p>Output:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true"></a>My number is <span class="dv">8</span> bytes wide and its value is <span class="dv">285212672</span><span class="bu">l</span><span class="er">.</span> A normal number is <span class="fl">0.</span></span></code></pre></div>
<p>I assume this unexpected result is from printing the <code>unsigned long long int</code>. How do you <code>printf()</code> an <code>unsigned long long int</code>?</p>
</section>
<section id="answer-accepted-score-455" class="level4">
<h4>Answer accepted (score 455)</h4>
<p>Use the ll (el-el) long-long modifier with the u (unsigned) conversion. (Works in windows, GNU).</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true"></a>printf(<span class="st">&quot;%llu&quot;</span>, <span class="dv">285212672</span>);</span></code></pre></div>
</section>
<section id="answer-2-score-84" class="level4">
<h4>Answer 2 (score 84)</h4>
<p>
You may want to try using the inttypes.h library that gives you types such as <code>int32_t</code>, <code>int64_t</code>, <code>uint64_t</code> etc. You can then use its macros such as:
</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true"></a><span class="dt">uint64_t</span> x;</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true"></a><span class="dt">uint32_t</span> y;</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true"></a></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true"></a>printf(<span class="st">&quot;x: %&quot;</span>PRId64<span class="st">&quot;, y: %&quot;</span>PRId32<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>, x, y);</span></code></pre></div>
<p>This is “guaranteed” to not give you the same trouble as <code>long</code>, <code>unsigned long long</code> etc, since you don’t have to guess how many bits are in each data type.</p>
</section>
<section id="answer-3-score-61" class="level4">
<h4>Answer 3 (score 61)</h4>
<p><code>%d</code>–&gt; for <code>int</code></p>
<p><code>%u</code>–&gt; for <code>unsigned int</code></p>
<p><code>%ld</code>–&gt; for <code>long int</code></p>
<p><code>%lu</code>–&gt; for <code>unsigned long int</code></p>
<p><code>%lld</code>–&gt; for <code>long long int</code></p>
<p><code>%llu</code>–&gt; for <code>unsigned long long int</code></p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-to-initialize-a-struct-in-accordance-with-c-programming-language-standards-score-712842-in-2018" class="level3">
<h3>21: How to initialize a struct in accordance with C programming language standards (score <a href="https://stackoverflow.com/q/330793.html">712842</a> in 2018)</h3>
<section id="question-20" class="level4">
<h4>Question</h4>
<p>I want to initialize a struct element, split in declaration and initialization. This is what I have:</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true"></a><span class="kw">typedef</span> <span class="kw">struct</span> MY_TYPE {</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true"></a>  <span class="dt">bool</span> flag;</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true"></a>  <span class="dt">short</span> <span class="dt">int</span> value;</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true"></a>  <span class="dt">double</span> stuff;</span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true"></a>} MY_TYPE;</span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true"></a></span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true"></a><span class="dt">void</span> function(<span class="dt">void</span>) {</span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true"></a>  MY_TYPE a;</span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true"></a>  ...</span>
<span id="cb134-10"><a href="#cb134-10" aria-hidden="true"></a>  a = { true, <span class="dv">15</span>, <span class="fl">0.123</span> }</span>
<span id="cb134-11"><a href="#cb134-11" aria-hidden="true"></a>}</span></code></pre></div>
<p>Is this the way to declare and initialize a local variable of <code>MY_TYPE</code> in accordance with C programming language standards (C89, C90, C99, C11, etc.)? Or is there anything better or at least working?</p>
<p><strong>Update</strong> I ended up having a static initialization element where I set every subelement according to my needs.</p>
</section>
<section id="answer-accepted-score-687" class="level4">
<h4>Answer accepted (score 687)</h4>
<p>In (ANSI) C99, you can use a <strong>designated initializer</strong> to initialize a structure:</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true"></a>MY_TYPE a = { .flag = true, .value = <span class="dv">123</span>, .stuff = <span class="fl">0.456</span> };</span></code></pre></div>
<p>Edit: Other members are initialized as zero: “Omitted field members are implicitly initialized the same as objects that have static storage duration.” (<a href="https://gcc.gnu.org/onlinedocs/gcc/Designated-Inits.html" rel="noreferrer">https://gcc.gnu.org/onlinedocs/gcc/Designated-Inits.html</a>)</p>
</section>
<section id="answer-2-score-188" class="level4">
<h4>Answer 2 (score 188)</h4>
<p>You can do it with a <a href="http://gcc.gnu.org/onlinedocs/gcc-4.3.2/gcc/Compound-Literals.html" rel="noreferrer">compound literal</a>. According to that page, it works in C99 (which also counts as <a href="http://en.wikipedia.org/wiki/ANSI_C" rel="noreferrer">ANSI C</a>).</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true"></a>MY_TYPE a;</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true"></a></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true"></a>a = (MY_TYPE) { .flag = true, .value = <span class="dv">123</span>, .stuff = <span class="fl">0.456</span> };</span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true"></a>...</span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true"></a>a = (MY_TYPE) { .value = <span class="dv">234</span>, .stuff = <span class="fl">1.234</span>, .flag = false };</span></code></pre></div>
<p>The designations in the initializers are optional; you could also write:</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true"></a>a = (MY_TYPE) { true,  <span class="dv">123</span>, <span class="fl">0.456</span> };</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true"></a>...</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true"></a>a = (MY_TYPE) { false, <span class="dv">234</span>, <span class="fl">1.234</span> };</span></code></pre></div>
</section>
<section id="answer-3-score-88" class="level4">
<h4>Answer 3 (score 88)</h4>
<p>
I see you’ve already received an answer about ANSI C 99, so I’ll throw a bone about ANSI C 89. ANSI C 89 allows you to initialize a struct this way:
</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true"></a><span class="kw">typedef</span> <span class="kw">struct</span> Item {</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true"></a>    <span class="dt">int</span> a;</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true"></a>    <span class="dt">float</span> b;</span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true"></a>    <span class="dt">char</span>* name;</span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true"></a>} Item;</span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true"></a></span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true"></a><span class="dt">int</span> main(<span class="dt">void</span>) {</span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true"></a>    Item item = { <span class="dv">5</span>, <span class="fl">2.2</span>, <span class="st">&quot;George&quot;</span> };</span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb138-10"><a href="#cb138-10" aria-hidden="true"></a>}</span></code></pre></div>
<p>An important thing to remember, at the moment you initialize even one object/ variable in the struct, all of its other variables will be initialized to default value.</p>
<p>If you don’t initialize the values in your struct, all variables will contain “garbage values”.</p>
<p>Good luck!</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="what-is-the-effect-of-extern-c-in-c-score-709916-in-2018" class="level3">
<h3>22: What is the effect of extern “C” in C++? (score <a href="https://stackoverflow.com/q/1041866.html">709916</a> in 2018)</h3>
<section id="question-21" class="level4">
<h4>Question</h4>
<p>What exactly does putting <code>extern "C"</code> into C++ code do?</p>
<p>For example:</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true"></a><span class="kw">extern</span> <span class="st">&quot;C&quot;</span> {</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true"></a>   <span class="dt">void</span> foo();</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true"></a>}</span></code></pre></div>
</section>
<section id="answer-accepted-score-1442" class="level4">
<h4>Answer accepted (score 1442)</h4>
<p>extern “C” makes a function-name in C++ have ‘C’ linkage (compiler does not mangle the name) so that client C code can link to (i.e use) your function using a ‘C’ compatible header file that contains just the declaration of your function. Your function definition is contained in a binary format (that was compiled by your C++ compiler) that the client ‘C’ linker will then link to using the ‘C’ name.</p>
<p>Since C++ has overloading of function names and C does not, the C++ compiler cannot just use the function name as a unique id to link to, so it mangles the name by adding information about the arguments. A C compiler does not need to mangle the name since you can not overload function names in C. When you state that a function has extern “C” linkage in C++, the C++ compiler does not add argument/parameter type information to the name used for linkage.</p>
<p>Just so you know, you can specify “C” linkage to each individual declaration/definition explicitly or use a block to group a sequence of declarations/definitions to have a certain linkage:</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true"></a><span class="kw">extern</span> <span class="st">&quot;C&quot;</span> <span class="dt">void</span> foo(<span class="dt">int</span>);</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true"></a><span class="kw">extern</span> <span class="st">&quot;C&quot;</span></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true"></a>{</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true"></a>   <span class="dt">void</span> g(<span class="dt">char</span>);</span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true"></a>   <span class="dt">int</span> i;</span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true"></a>}</span></code></pre></div>
<p>If you care about the technicalities, they are listed in section 7.5 of the C++03 standard, here is a brief summary (with emphasis on extern “C”):</p>
<ul>
<li>
extern “C” is a linkage-specification
</li>
<li>
Every compiler is <em>required</em> to provide “C” linkage
</li>
<li>
a linkage specification shall occur only in namespace scope
</li>
<li>
<strike> all function types, function names and variable names have a language linkage </strike> <b><a href="https://stackoverflow.com/questions/1041866/in-c-source-what-is-the-effect-of-extern-c
#comment20842899_1041880">See Richard’s Comment:</a></b> Only function names and variable names with external linkage have a language linkage
</li>
<li>
two function types with distinct language linkages are distinct types even if otherwise identical
</li>
<li>
linkage specs nest, inner one determines the final linkage
</li>
<li>
extern “C” is ignored for class members
</li>
<li>
at most one function with a particular name can have “C” linkage (regardless of namespace)
</li>
<li>
<strike> extern “C” forces a function to have external linkage (cannot make it static) </strike> <b> <a href="https://stackoverflow.com/questions/1041866/what-is-the-effect-of-extern-c-in-c?rq=1
#comment20842893_1041880">See Richard’s comment:</a> </b> ‘static’ inside ‘extern “C”’ is valid; an entity so declared has internal linkage, and so does not have a language linkage
</li>
<li>
Linkage from C++ to objects defined in other languages and to objects defined in C++ from other languages is implementation-defined and language-dependent. Only where the object layout strategies of two language implementations are similar enough can such linkage be achieved
</li>
</ul>
</section>
<section id="answer-2-score-295" class="level4">
<h4>Answer 2 (score 295)</h4>
<p>Just wanted to add a bit of info, since I haven’t seen it posted yet.</p>
<p>You’ll very often see code in C headers like so:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true"></a></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true"></a><span class="pp">#ifdef __cplusplus</span></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true"></a><span class="kw">extern</span> <span class="st">&quot;C&quot;</span> {</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true"></a></span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true"></a><span class="pp">#endif</span></span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true"></a></span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true"></a><span class="co">// all of your legacy C code here</span></span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true"></a></span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true"></a></span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true"></a><span class="pp">#ifdef __cplusplus</span></span>
<span id="cb141-11"><a href="#cb141-11" aria-hidden="true"></a>}</span>
<span id="cb141-12"><a href="#cb141-12" aria-hidden="true"></a></span>
<span id="cb141-13"><a href="#cb141-13" aria-hidden="true"></a><span class="pp">#endif</span></span></code></pre></div>
<p>What this accomplishes is that it allows you to use that C header file with your C++ code, because the macro "__cplusplus" will be defined. But you can <em>also</em> still use it with your legacy C code, where the macro is <em>NOT</em> defined, so it won’t see the uniquely C++ construct.</p>
<p>Although, I have also seen C++ code such as:</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true"></a><span class="kw">extern</span> <span class="st">&quot;C&quot;</span> {</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true"></a></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;legacy_C_header.h&quot;</span></span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true"></a>}</span></code></pre></div>
<p>which I imagine accomplishes much the same thing.</p>
<p>Not sure which way is better, but I have seen both.</p>
</section>
<section id="answer-3-score-210" class="level4">
<h4>Answer 3 (score 210)</h4>
<p><strong>Decompile a <code>g++</code> generated binary to see what is going on</strong></p>
<p>main.cpp</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true"></a><span class="dt">void</span> f() {}</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true"></a><span class="dt">void</span> g();</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true"></a></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true"></a><span class="kw">extern</span> <span class="st">&quot;C&quot;</span> {</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true"></a>    <span class="dt">void</span> ef() {}</span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true"></a>    <span class="dt">void</span> eg();</span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true"></a>}</span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true"></a></span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true"></a><span class="co">/* Prevent g and eg from being optimized away. */</span></span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true"></a><span class="dt">void</span> h() { g(); eg(); }</span></code></pre></div>
<p>Compile and disassemble the generated <a href="https://stackoverflow.com/questions/26294034/how-to-make-an-executable-elf-file-in-linux-using-a-hex-editor/30648229
#30648229">ELF</a> output:</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true"></a>g++ -c -std=c++<span class="dv">11</span> -Wall -Wextra -pedantic -o main.o main.cpp</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true"></a>readelf -s main.o</span></code></pre></div>
<p>The output contains:</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true"></a>     <span class="dv">8</span>: <span class="bn">0000000000000000</span>     <span class="dv">7</span> FUNC    GLOBAL DEFAULT    <span class="dv">1</span> _Z1fv</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true"></a>     <span class="dv">9</span>: <span class="bn">0000000000000007</span>     <span class="dv">7</span> FUNC    GLOBAL DEFAULT    <span class="dv">1</span> ef</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true"></a>    <span class="dv">10</span>: <span class="bn">000000000000000</span><span class="er">e</span>    <span class="dv">17</span> FUNC    GLOBAL DEFAULT    <span class="dv">1</span> _Z1hv</span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true"></a>    <span class="dv">11</span>: <span class="bn">0000000000000000</span>     <span class="dv">0</span> NOTYPE  GLOBAL DEFAULT  UND _GLOBAL_OFFSET_TABLE_</span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true"></a>    <span class="dv">12</span>: <span class="bn">0000000000000000</span>     <span class="dv">0</span> NOTYPE  GLOBAL DEFAULT  UND _Z1gv</span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true"></a>    <span class="dv">13</span>: <span class="bn">0000000000000000</span>     <span class="dv">0</span> NOTYPE  GLOBAL DEFAULT  UND eg</span></code></pre></div>
<p><strong>Interpretation</strong></p>
<p>We see that:</p>
<ul>
<li>
<p>
<code>ef</code> and <code>eg</code> were stored in symbols with the same name as in the code
</p>
</li>
<li>
<p>
the other symbols were mangled. Let’s unmangle them:
</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true"></a>$ c++filt _Z1fv</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true"></a>f()</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true"></a>$ c++filt _Z1hv</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true"></a>h()</span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true"></a>$ c++filt _Z1gv</span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true"></a>g()</span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true"></a>&lt;/ul&gt;</span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true"></a></span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true"></a>Conclusion: both of the following symbol types were &lt;em&gt;not&lt;/em&gt; mangled:  </span>
<span id="cb146-11"><a href="#cb146-11" aria-hidden="true"></a></span>
<span id="cb146-12"><a href="#cb146-12" aria-hidden="true"></a>&lt;ul&gt;</span>
<span id="cb146-13"><a href="#cb146-13" aria-hidden="true"></a>&lt;li&gt;defined&lt;/li&gt;</span>
<span id="cb146-14"><a href="#cb146-14" aria-hidden="true"></a>&lt;li&gt;declared but undefined (`Ndx = UND`), to be provided at link or run time from another object file&lt;/li&gt;</span>
<span id="cb146-15"><a href="#cb146-15" aria-hidden="true"></a>&lt;/ul&gt;</span>
<span id="cb146-16"><a href="#cb146-16" aria-hidden="true"></a></span>
<span id="cb146-17"><a href="#cb146-17" aria-hidden="true"></a>So you will need `extern <span class="st">&quot;C&quot;</span>` both when calling:  </span>
<span id="cb146-18"><a href="#cb146-18" aria-hidden="true"></a></span>
<span id="cb146-19"><a href="#cb146-19" aria-hidden="true"></a>&lt;ul&gt;</span>
<span id="cb146-20"><a href="#cb146-20" aria-hidden="true"></a>&lt;li&gt;C from C++: tell `g++` to expect unmangled symbols produced by `gcc`&lt;/li&gt;</span>
<span id="cb146-21"><a href="#cb146-21" aria-hidden="true"></a>&lt;li&gt;C++ from C: tell `g++` to generate unmangled symbols <span class="cf">for</span> `gcc` to use&lt;/li&gt;</span>
<span id="cb146-22"><a href="#cb146-22" aria-hidden="true"></a>&lt;/ul&gt;</span>
<span id="cb146-23"><a href="#cb146-23" aria-hidden="true"></a></span>
<span id="cb146-24"><a href="#cb146-24" aria-hidden="true"></a>&lt;strong&gt;Things that <span class="cf">do</span> not work in <span class="kw">extern</span> C&lt;/strong&gt;  </span>
<span id="cb146-25"><a href="#cb146-25" aria-hidden="true"></a></span>
<span id="cb146-26"><a href="#cb146-26" aria-hidden="true"></a>It becomes obvious that any C++ feature that requires name mangling will not work inside `extern C`:  </span>
<span id="cb146-27"><a href="#cb146-27" aria-hidden="true"></a></span>
<span id="cb146-28"><a href="#cb146-28" aria-hidden="true"></a>```c</span>
<span id="cb146-29"><a href="#cb146-29" aria-hidden="true"></a><span class="kw">extern</span> <span class="st">&quot;C&quot;</span> {</span>
<span id="cb146-30"><a href="#cb146-30" aria-hidden="true"></a>    <span class="co">// Overloading.</span></span>
<span id="cb146-31"><a href="#cb146-31" aria-hidden="true"></a>    <span class="co">// error: declaration of C function ‘void f(int)’ conflicts with</span></span>
<span id="cb146-32"><a href="#cb146-32" aria-hidden="true"></a>    <span class="dt">void</span> f();</span>
<span id="cb146-33"><a href="#cb146-33" aria-hidden="true"></a>    <span class="dt">void</span> f(<span class="dt">int</span> i);</span>
<span id="cb146-34"><a href="#cb146-34" aria-hidden="true"></a></span>
<span id="cb146-35"><a href="#cb146-35" aria-hidden="true"></a>    <span class="co">// Templates.</span></span>
<span id="cb146-36"><a href="#cb146-36" aria-hidden="true"></a>    <span class="co">// error: template with C linkage</span></span>
<span id="cb146-37"><a href="#cb146-37" aria-hidden="true"></a>    template &lt;class C&gt; <span class="dt">void</span> f(C i) { }</span>
<span id="cb146-38"><a href="#cb146-38" aria-hidden="true"></a>}</span></code></pre></div>
<p><strong>Minimal runnable C from C++ example</strong></p>
<p>For the sake of completeness and for the newbs out there, see also: <a href="https://stackoverflow.com/questions/13694605/how-to-use-c-source-files-in-a-c-project/51912672
#51912672">How to use C source files in a C++ project?</a></p>
<p>Calling C from C++ is pretty easy: each C function only has one possible non-mangled symbol, so no extra work is required.</p>
<p>main.cpp</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true"></a></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;cassert&gt;</span></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true"></a></span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true"></a></span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;c.h&quot;</span></span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true"></a></span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true"></a><span class="dt">int</span> main() {</span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true"></a>    assert(f() == <span class="dv">1</span>);</span>
<span id="cb147-9"><a href="#cb147-9" aria-hidden="true"></a>}</span></code></pre></div>
<p>c.h</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true"></a></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true"></a><span class="pp">#ifndef C_H</span></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true"></a></span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true"></a><span class="pp">#define C_H</span></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true"></a></span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true"></a><span class="co">/* This ifdef allows the header to be used from both C and C++. */</span></span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true"></a></span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true"></a><span class="pp">#ifdef __cplusplus</span></span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true"></a><span class="kw">extern</span> <span class="st">&quot;C&quot;</span> {</span>
<span id="cb148-10"><a href="#cb148-10" aria-hidden="true"></a></span>
<span id="cb148-11"><a href="#cb148-11" aria-hidden="true"></a><span class="pp">#endif</span></span>
<span id="cb148-12"><a href="#cb148-12" aria-hidden="true"></a><span class="dt">int</span> f();</span>
<span id="cb148-13"><a href="#cb148-13" aria-hidden="true"></a></span>
<span id="cb148-14"><a href="#cb148-14" aria-hidden="true"></a><span class="pp">#ifdef __cplusplus</span></span>
<span id="cb148-15"><a href="#cb148-15" aria-hidden="true"></a>}</span>
<span id="cb148-16"><a href="#cb148-16" aria-hidden="true"></a></span>
<span id="cb148-17"><a href="#cb148-17" aria-hidden="true"></a><span class="pp">#endif</span></span>
<span id="cb148-18"><a href="#cb148-18" aria-hidden="true"></a></span>
<span id="cb148-19"><a href="#cb148-19" aria-hidden="true"></a></span>
<span id="cb148-20"><a href="#cb148-20" aria-hidden="true"></a><span class="pp">#endif</span></span></code></pre></div>
<p>c.c</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true"></a></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;c.h&quot;</span></span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true"></a></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true"></a><span class="dt">int</span> f(<span class="dt">void</span>) { <span class="cf">return</span> <span class="dv">1</span>; }</span></code></pre></div>
<p>Run:</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true"></a>g++ -c -o main.o -std=c++<span class="dv">98</span> main.cpp</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true"></a>gcc -c -o c.o -std=c89 c.c</span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true"></a>g++ -o main.out main.o c.o</span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true"></a>./main.out</span></code></pre></div>
<p>Without <code>extern "C"</code> the link fails with:</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true"></a>main.cpp:<span class="dv">6</span>: undefined reference to `f()&#39;</span></code></pre></div>
<p>because <code>g++</code> expects to find a mangled <code>f</code>, which <code>gcc</code> did not produce.</p>
<p><a href="https://github.com/cirosantilli/cpp-cheat/tree/bf5f48628d0b01ba6a3fcea6f1162b28539654c9/c-from-cpp" rel="noreferrer">Example on GitHub</a>.</p>
<p><strong>Minimal runnable C++ from C example</strong></p>
<p>Calling C++ from C is a bit harder: we have to manually create non-mangled versions of each function we want to expose.</p>
<p>Here we illustrate how to expose C++ function overloads to C.</p>
<p>main.c</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true"></a></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;assert.h&gt;</span></span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true"></a></span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true"></a></span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;cpp.h&quot;</span></span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true"></a></span>
<span id="cb152-7"><a href="#cb152-7" aria-hidden="true"></a><span class="dt">int</span> main(<span class="dt">void</span>) {</span>
<span id="cb152-8"><a href="#cb152-8" aria-hidden="true"></a>    assert(f_int(<span class="dv">1</span>) == <span class="dv">2</span>);</span>
<span id="cb152-9"><a href="#cb152-9" aria-hidden="true"></a>    assert(f_float(<span class="fl">1.0</span>) == <span class="dv">3</span>);</span>
<span id="cb152-10"><a href="#cb152-10" aria-hidden="true"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb152-11"><a href="#cb152-11" aria-hidden="true"></a>}</span></code></pre></div>
<p>cpp.h</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true"></a></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true"></a><span class="pp">#ifndef CPP_H</span></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true"></a></span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true"></a><span class="pp">#define CPP_H</span></span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true"></a></span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true"></a></span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true"></a><span class="pp">#ifdef __cplusplus</span></span>
<span id="cb153-8"><a href="#cb153-8" aria-hidden="true"></a><span class="co">// C cannot see these overloaded prototypes, or else it would get confused.</span></span>
<span id="cb153-9"><a href="#cb153-9" aria-hidden="true"></a><span class="dt">int</span> f(<span class="dt">int</span> i);</span>
<span id="cb153-10"><a href="#cb153-10" aria-hidden="true"></a><span class="dt">int</span> f(<span class="dt">float</span> i);</span>
<span id="cb153-11"><a href="#cb153-11" aria-hidden="true"></a><span class="kw">extern</span> <span class="st">&quot;C&quot;</span> {</span>
<span id="cb153-12"><a href="#cb153-12" aria-hidden="true"></a></span>
<span id="cb153-13"><a href="#cb153-13" aria-hidden="true"></a><span class="pp">#endif</span></span>
<span id="cb153-14"><a href="#cb153-14" aria-hidden="true"></a><span class="dt">int</span> f_int(<span class="dt">int</span> i);</span>
<span id="cb153-15"><a href="#cb153-15" aria-hidden="true"></a><span class="dt">int</span> f_float(<span class="dt">float</span> i);</span>
<span id="cb153-16"><a href="#cb153-16" aria-hidden="true"></a></span>
<span id="cb153-17"><a href="#cb153-17" aria-hidden="true"></a><span class="pp">#ifdef __cplusplus</span></span>
<span id="cb153-18"><a href="#cb153-18" aria-hidden="true"></a>}</span>
<span id="cb153-19"><a href="#cb153-19" aria-hidden="true"></a></span>
<span id="cb153-20"><a href="#cb153-20" aria-hidden="true"></a><span class="pp">#endif</span></span>
<span id="cb153-21"><a href="#cb153-21" aria-hidden="true"></a></span>
<span id="cb153-22"><a href="#cb153-22" aria-hidden="true"></a></span>
<span id="cb153-23"><a href="#cb153-23" aria-hidden="true"></a><span class="pp">#endif</span></span></code></pre></div>
<p>cpp.cpp</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true"></a></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;cpp.h&quot;</span></span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true"></a></span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true"></a><span class="dt">int</span> f(<span class="dt">int</span> i) {</span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true"></a>    <span class="cf">return</span> i + <span class="dv">1</span>;</span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true"></a>}</span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true"></a></span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true"></a><span class="dt">int</span> f(<span class="dt">float</span> i) {</span>
<span id="cb154-9"><a href="#cb154-9" aria-hidden="true"></a>    <span class="cf">return</span> i + <span class="dv">2</span>;</span>
<span id="cb154-10"><a href="#cb154-10" aria-hidden="true"></a>}</span>
<span id="cb154-11"><a href="#cb154-11" aria-hidden="true"></a></span>
<span id="cb154-12"><a href="#cb154-12" aria-hidden="true"></a><span class="dt">int</span> f_int(<span class="dt">int</span> i) {</span>
<span id="cb154-13"><a href="#cb154-13" aria-hidden="true"></a>    <span class="cf">return</span> f(i);</span>
<span id="cb154-14"><a href="#cb154-14" aria-hidden="true"></a>}</span>
<span id="cb154-15"><a href="#cb154-15" aria-hidden="true"></a></span>
<span id="cb154-16"><a href="#cb154-16" aria-hidden="true"></a><span class="dt">int</span> f_float(<span class="dt">float</span> i) {</span>
<span id="cb154-17"><a href="#cb154-17" aria-hidden="true"></a>    <span class="cf">return</span> f(i);</span>
<span id="cb154-18"><a href="#cb154-18" aria-hidden="true"></a>}</span></code></pre></div>
<p>Run:</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true"></a>gcc -c -o main.o -std=c89 -Wextra main.c</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true"></a>g++ -c -o cpp.o -std=c++<span class="dv">98</span> cpp.cpp</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true"></a>g++ -o main.out main.o cpp.o</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true"></a>./main.out</span></code></pre></div>
<p>Without <code>extern "C"</code> it fails with:</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true"></a>main.c:<span class="dv">6</span>: undefined reference to `f_int&#39;</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true"></a>main.c:<span class="dv">7</span>: undefined reference to `f_float&#39;</span></code></pre></div>
<p>because <code>g++</code> generated mangled symbols which <code>gcc</code> cannot find.</p>
<p><a href="https://github.com/cirosantilli/cpp-cheat/tree/bf5f48628d0b01ba6a3fcea6f1162b28539654c9/cpp-from-c" rel="noreferrer">Example on GitHub</a>.</p>
<p>Tested in Ubuntu 18.04.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="c-read-file-line-by-line-score-708636-in" class="level3">
<h3>23: C read file line by line (score <a href="https://stackoverflow.com/q/3501338.html">708636</a> in )</h3>
<section id="question-22" class="level4">
<h4>Question</h4>
<p>I wrote this function to read a line from a file:</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true"></a><span class="dt">const</span> <span class="dt">char</span> *readLine(<span class="dt">FILE</span> *file) {</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true"></a></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true"></a>    <span class="cf">if</span> (file == NULL) {</span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true"></a>        printf(<span class="st">&quot;Error: file pointer is null.&quot;</span>);</span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true"></a>        exit(<span class="dv">1</span>);</span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true"></a>    }</span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true"></a></span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true"></a>    <span class="dt">int</span> maximumLineLength = <span class="dv">128</span>;</span>
<span id="cb157-9"><a href="#cb157-9" aria-hidden="true"></a>    <span class="dt">char</span> *lineBuffer = (<span class="dt">char</span> *)malloc(<span class="kw">sizeof</span>(<span class="dt">char</span>) * maximumLineLength);</span>
<span id="cb157-10"><a href="#cb157-10" aria-hidden="true"></a></span>
<span id="cb157-11"><a href="#cb157-11" aria-hidden="true"></a>    <span class="cf">if</span> (lineBuffer == NULL) {</span>
<span id="cb157-12"><a href="#cb157-12" aria-hidden="true"></a>        printf(<span class="st">&quot;Error allocating memory for line buffer.&quot;</span>);</span>
<span id="cb157-13"><a href="#cb157-13" aria-hidden="true"></a>        exit(<span class="dv">1</span>);</span>
<span id="cb157-14"><a href="#cb157-14" aria-hidden="true"></a>    }</span>
<span id="cb157-15"><a href="#cb157-15" aria-hidden="true"></a></span>
<span id="cb157-16"><a href="#cb157-16" aria-hidden="true"></a>    <span class="dt">char</span> ch = getc(file);</span>
<span id="cb157-17"><a href="#cb157-17" aria-hidden="true"></a>    <span class="dt">int</span> count = <span class="dv">0</span>;</span>
<span id="cb157-18"><a href="#cb157-18" aria-hidden="true"></a></span>
<span id="cb157-19"><a href="#cb157-19" aria-hidden="true"></a>    <span class="cf">while</span> ((ch != <span class="ch">&#39;\n&#39;</span>) &amp;&amp; (ch != EOF)) {</span>
<span id="cb157-20"><a href="#cb157-20" aria-hidden="true"></a>        <span class="cf">if</span> (count == maximumLineLength) {</span>
<span id="cb157-21"><a href="#cb157-21" aria-hidden="true"></a>            maximumLineLength += <span class="dv">128</span>;</span>
<span id="cb157-22"><a href="#cb157-22" aria-hidden="true"></a>            lineBuffer = realloc(lineBuffer, maximumLineLength);</span>
<span id="cb157-23"><a href="#cb157-23" aria-hidden="true"></a>            <span class="cf">if</span> (lineBuffer == NULL) {</span>
<span id="cb157-24"><a href="#cb157-24" aria-hidden="true"></a>                printf(<span class="st">&quot;Error reallocating space for line buffer.&quot;</span>);</span>
<span id="cb157-25"><a href="#cb157-25" aria-hidden="true"></a>                exit(<span class="dv">1</span>);</span>
<span id="cb157-26"><a href="#cb157-26" aria-hidden="true"></a>            }</span>
<span id="cb157-27"><a href="#cb157-27" aria-hidden="true"></a>        }</span>
<span id="cb157-28"><a href="#cb157-28" aria-hidden="true"></a>        lineBuffer[count] = ch;</span>
<span id="cb157-29"><a href="#cb157-29" aria-hidden="true"></a>        count++;</span>
<span id="cb157-30"><a href="#cb157-30" aria-hidden="true"></a></span>
<span id="cb157-31"><a href="#cb157-31" aria-hidden="true"></a>        ch = getc(file);</span>
<span id="cb157-32"><a href="#cb157-32" aria-hidden="true"></a>    }</span>
<span id="cb157-33"><a href="#cb157-33" aria-hidden="true"></a></span>
<span id="cb157-34"><a href="#cb157-34" aria-hidden="true"></a>    lineBuffer[count] = <span class="ch">&#39;\0&#39;</span>;</span>
<span id="cb157-35"><a href="#cb157-35" aria-hidden="true"></a>    <span class="dt">char</span> line[count + <span class="dv">1</span>];</span>
<span id="cb157-36"><a href="#cb157-36" aria-hidden="true"></a>    strncpy(line, lineBuffer, (count + <span class="dv">1</span>));</span>
<span id="cb157-37"><a href="#cb157-37" aria-hidden="true"></a>    free(lineBuffer);</span>
<span id="cb157-38"><a href="#cb157-38" aria-hidden="true"></a>    <span class="dt">const</span> <span class="dt">char</span> *constLine = line;</span>
<span id="cb157-39"><a href="#cb157-39" aria-hidden="true"></a>    <span class="cf">return</span> constLine;</span>
<span id="cb157-40"><a href="#cb157-40" aria-hidden="true"></a>}</span></code></pre></div>
<p>The function reads the file correctly, and using printf I see that the constLine string did get read correctly as well.</p>
<p>However, if I use the function e.g. like this:</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true"></a><span class="cf">while</span> (!feof(myFile)) {</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true"></a>    <span class="dt">const</span> <span class="dt">char</span> *line = readLine(myFile);</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true"></a>    printf(<span class="st">&quot;%s</span><span class="sc">\n</span><span class="st">&quot;</span>, line);</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true"></a>}</span></code></pre></div>
<p>printf outputs gibberish. Why?</p>
</section>
<section id="answer-2-score-276" class="level4">
<h4>Answer 2 (score 276)</h4>
<p>If your task is not to invent the line-by-line reading function, but just to read the file line-by-line, you may use a typical code snippet involving the <code>getline()</code> function (see the manual page <a href="http://linux.die.net/man/3/getline" rel="noreferrer">here</a>):</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true"></a></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true"></a><span class="pp">#define _GNU_SOURCE</span></span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true"></a></span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true"></a></span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdlib.h&gt;</span></span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true"></a></span>
<span id="cb159-8"><a href="#cb159-8" aria-hidden="true"></a><span class="dt">int</span> main(<span class="dt">void</span>)</span>
<span id="cb159-9"><a href="#cb159-9" aria-hidden="true"></a>{</span>
<span id="cb159-10"><a href="#cb159-10" aria-hidden="true"></a>    <span class="dt">FILE</span> * fp;</span>
<span id="cb159-11"><a href="#cb159-11" aria-hidden="true"></a>    <span class="dt">char</span> * line = NULL;</span>
<span id="cb159-12"><a href="#cb159-12" aria-hidden="true"></a>    <span class="dt">size_t</span> len = <span class="dv">0</span>;</span>
<span id="cb159-13"><a href="#cb159-13" aria-hidden="true"></a>    <span class="dt">ssize_t</span> read;</span>
<span id="cb159-14"><a href="#cb159-14" aria-hidden="true"></a></span>
<span id="cb159-15"><a href="#cb159-15" aria-hidden="true"></a>    fp = fopen(<span class="st">&quot;/etc/motd&quot;</span>, <span class="st">&quot;r&quot;</span>);</span>
<span id="cb159-16"><a href="#cb159-16" aria-hidden="true"></a>    <span class="cf">if</span> (fp == NULL)</span>
<span id="cb159-17"><a href="#cb159-17" aria-hidden="true"></a>        exit(EXIT_FAILURE);</span>
<span id="cb159-18"><a href="#cb159-18" aria-hidden="true"></a></span>
<span id="cb159-19"><a href="#cb159-19" aria-hidden="true"></a>    <span class="cf">while</span> ((read = getline(&amp;line, &amp;len, fp)) != -<span class="dv">1</span>) {</span>
<span id="cb159-20"><a href="#cb159-20" aria-hidden="true"></a>        printf(<span class="st">&quot;Retrieved line of length %zu:</span><span class="sc">\n</span><span class="st">&quot;</span>, read);</span>
<span id="cb159-21"><a href="#cb159-21" aria-hidden="true"></a>        printf(<span class="st">&quot;%s&quot;</span>, line);</span>
<span id="cb159-22"><a href="#cb159-22" aria-hidden="true"></a>    }</span>
<span id="cb159-23"><a href="#cb159-23" aria-hidden="true"></a></span>
<span id="cb159-24"><a href="#cb159-24" aria-hidden="true"></a>    fclose(fp);</span>
<span id="cb159-25"><a href="#cb159-25" aria-hidden="true"></a>    <span class="cf">if</span> (line)</span>
<span id="cb159-26"><a href="#cb159-26" aria-hidden="true"></a>        free(line);</span>
<span id="cb159-27"><a href="#cb159-27" aria-hidden="true"></a>    exit(EXIT_SUCCESS);</span>
<span id="cb159-28"><a href="#cb159-28" aria-hidden="true"></a>}</span></code></pre></div>
</section>
<section id="answer-3-score-20-1" class="level4">
<h4>Answer 3 (score 20)</h4>
<p>In your <code>readLine</code> function, you return a pointer to the <code>line</code> array (Strictly speaking, a pointer to its first character, but the difference is irrelevant here). Since it’s an automatic variable (i.e., it’s “on the stack”), the memory is reclaimed when the function returns. You see gibberish because <code>printf</code> has put its own stuff on the stack.</p>
<p>You need to return a dynamically allocated buffer from the function. You already have one, it’s <code>lineBuffer</code>; all you have to do is truncate it to the desired length.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true"></a>    lineBuffer[count] = <span class="ch">&#39;\0&#39;</span>;</span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true"></a>    realloc(lineBuffer, count + <span class="dv">1</span>);</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true"></a>    <span class="cf">return</span> lineBuffer;</span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true"></a>}</span></code></pre></div>
<p><strong>ADDED</strong> (response to follow-up question in comment): <code>readLine</code> returns a pointer to the characters that make up the line. This pointer is what you need to work with the contents of the line. It’s also what you must pass to <code>free</code> when you’ve finished using the memory taken by these characters. Here’s how you might use the <code>readLine</code> function:</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true"></a><span class="dt">char</span> *line = readLine(file);</span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true"></a>printf(<span class="st">&quot;LOG: read a line: %s</span><span class="sc">\n</span><span class="st">&quot;</span>, line);</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true"></a><span class="cf">if</span> (strchr(line, <span class="ch">&#39;a&#39;</span>)) { puts(<span class="st">&quot;The line contains an a&quot;</span>); }</span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true"></a><span class="co">/* etc. */</span></span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true"></a>free(line);</span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true"></a><span class="co">/* After this point, the memory allocated for the line has been reclaimed.</span></span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true"></a><span class="co">   You can&#39;t use the value of `line` again (though you can assign a new value</span></span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true"></a><span class="co">   to the `line` variable if you want). */</span></span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="what-is-the-argument-for-printf-that-formats-a-long-score-707746-in-2018" class="level3">
<h3>24: What is the argument for printf that formats a long? (score <a href="https://stackoverflow.com/q/38561.html">707746</a> in 2018)</h3>
<section id="question-23" class="level4">
<h4>Question</h4>
<p>The <code>printf</code> function takes an argument type, such as <code>%d</code> or <code>%i</code> for a <code>signed int</code>. However, I don’t see anything for a <code>long</code> value.</p>
</section>
<section id="answer-accepted-score-581" class="level4">
<h4>Answer accepted (score 581)</h4>
<p>Put an <code>l</code> (lowercased letter L) directly before the specifier.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true"></a><span class="dt">unsigned</span> <span class="dt">long</span> n;</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true"></a><span class="dt">long</span> m;</span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true"></a></span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true"></a>printf(<span class="st">&quot;%lu %ld&quot;</span>, n, m);</span></code></pre></div>
</section>
<section id="answer-2-score-187" class="level4">
<h4>Answer 2 (score 187)</h4>
<p>I think you mean:</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true"></a><span class="dt">unsigned</span> <span class="dt">long</span> n;</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true"></a>printf(<span class="st">&quot;%lu&quot;</span>, n);   <span class="co">// unsigned long</span></span></code></pre></div>
<p>or</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true"></a><span class="dt">long</span> n;</span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true"></a>printf(<span class="st">&quot;%ld&quot;</span>, n);   <span class="co">// signed long</span></span></code></pre></div>
</section>
<section id="answer-3-score-66" class="level4">
<h4>Answer 3 (score 66)</h4>
<p>On most platforms, <code>long</code> and <code>int</code> are the same size (32 bits). Still, it does have its own format specifier:</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true"></a><span class="dt">long</span> n;</span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true"></a><span class="dt">unsigned</span> <span class="dt">long</span> un;</span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true"></a>printf(<span class="st">&quot;%ld&quot;</span>, n); <span class="co">// signed</span></span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true"></a>printf(<span class="st">&quot;%lu&quot;</span>, un); <span class="co">// unsigned</span></span></code></pre></div>
<p>For 64 bits, you’d want a <code>long long</code>:</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true"></a><span class="dt">long</span> <span class="dt">long</span> n;</span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true"></a><span class="dt">unsigned</span> <span class="dt">long</span> <span class="dt">long</span> un;</span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true"></a>printf(<span class="st">&quot;%lld&quot;</span>, n); <span class="co">// signed</span></span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true"></a>printf(<span class="st">&quot;%llu&quot;</span>, un); <span class="co">// unsigned</span></span></code></pre></div>
<p>Oh, and of course, it’s different in Windows:</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true"></a>printf(<span class="st">&quot;%l64d&quot;</span>, n); <span class="co">// signed</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true"></a>printf(<span class="st">&quot;%l64u&quot;</span>, un); <span class="co">// unsigned</span></span></code></pre></div>
<p>Frequently, when I’m printing 64-bit values, I find it helpful to print them in hex (usually with numbers that big, they are pointers or bit fields).</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true"></a><span class="dt">unsigned</span> <span class="dt">long</span> <span class="dt">long</span> n;</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true"></a>printf(<span class="st">&quot;0x%016llX&quot;</span>, n); <span class="co">// &quot;0x&quot; followed by &quot;0-padded&quot;, &quot;16 char wide&quot;, &quot;long long&quot;, &quot;HEX with 0-9A-F&quot;</span></span></code></pre></div>
<p>will print:</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true"></a><span class="bn">0x00000000DEADBEEF</span></span></code></pre></div>
<p>Btw, “long” doesn’t mean that much anymore (on mainstream x64). “int” is the platform default int size, typically 32 bits. “long” is usually the same size. However, they have different portability semantics on older platforms (and modern embedded platforms!). “long long” is a 64-bit number and usually what people meant to use unless they really really knew what they were doing editing a piece of x-platform portable code. Even then, they probably would have used a macro instead to capture the semantic meaning of the type (eg uint64_t).</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true"></a><span class="dt">char</span> c;       <span class="co">// 8 bits</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true"></a><span class="dt">short</span> s;      <span class="co">// 16 bits</span></span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true"></a><span class="dt">int</span> i;        <span class="co">// 32 bits (on modern platforms)</span></span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true"></a><span class="dt">long</span> l;       <span class="co">// 32 bits</span></span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true"></a><span class="dt">long</span> <span class="dt">long</span> ll; <span class="co">// 64 bits </span></span></code></pre></div>
<p>Back in the day, “int” was 16 bits. You’d think it would now be 64 bits, but no, that would have caused insane portability issues. Of course, even this is a simplification of the arcane and history-rich truth. See <a href="http://en.wikipedia.org/wiki/Integer_(computer_science)" rel="noreferrer">wiki:Integer</a></p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="rounding-number-to-2-decimal-places-in-c-score-690219-in-2012" class="level3">
<h3>25: Rounding Number to 2 Decimal Places in C (score <a href="https://stackoverflow.com/q/1343890.html">690219</a> in 2012)</h3>
<section id="question-24" class="level4">
<h4>Question</h4>
<p>How can I round a float (such as 37.777779) to two decimal places (37.78) in C?</p>
</section>
<section id="answer-2-score-385" class="level4">
<h4>Answer 2 (score 385)</h4>
<p>If you just want to round the number for output purposes, then the <code>"%.2f"</code> format string is indeed the correct answer. However, if you actually want to round the floating point value for further computation, something like the following works:</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true"></a></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;math.h&gt;</span></span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true"></a></span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true"></a><span class="dt">float</span> val = <span class="fl">37.777779</span>;</span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true"></a></span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true"></a><span class="dt">float</span> rounded_down = floorf(val * <span class="dv">100</span>) / <span class="dv">100</span>;   <span class="co">/* Result: 37.77 */</span></span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true"></a><span class="dt">float</span> nearest = roundf(val * <span class="dv">100</span>) / <span class="dv">100</span>;  <span class="co">/* Result: 37.78 */</span></span>
<span id="cb171-8"><a href="#cb171-8" aria-hidden="true"></a><span class="dt">float</span> rounded_up = ceilf(val * <span class="dv">100</span>) / <span class="dv">100</span>;      <span class="co">/* Result: 37.78 */</span></span></code></pre></div>
<p>Notice that there are three different rounding rules you might want to choose: round down (ie, truncate after two decimal places), rounded to nearest, and round up. Usually, you want round to nearest.</p>
<p>As several others have pointed out, due to the quirks of floating point representation, these rounded values may not be exactly the “obvious” decimal values, but they will be very very close.</p>
<p>For much (much!) more information on rounding, and especially on tie-breaking rules for rounding to nearest, see <a href="http://en.wikipedia.org/wiki/Rounding" rel="noreferrer">the Wikipedia article on Rounding</a>.</p>
</section>
<section id="answer-3-score-72" class="level4">
<h4>Answer 3 (score 72)</h4>
<p>Using <strong>%.2f</strong> in printf. It only print 2 decimal points.</p>
<p>Example:</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true"></a>printf(<span class="st">&quot;%.2f&quot;</span>, <span class="fl">37.777779</span>);</span></code></pre></div>
<p>Output:</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true"></a><span class="fl">37.77</span></span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="what-is-size_t-in-c-score-666997-in-2013" class="level3">
<h3>26: What is size_t in C? (score <a href="https://stackoverflow.com/q/2550774.html">666997</a> in 2013)</h3>
<section id="question-25" class="level4">
<h4>Question</h4>
<p>I am getting confused with <code>size_t</code> in C. I know that it is returned by the <code>sizeof</code> operator. But what exactly is it? Is it a data type?</p>
<p>Let’s say I have a <code>for</code> loop:</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true"></a><span class="cf">for</span>(i = <span class="dv">0</span>; i &lt; some_size; i++)</span></code></pre></div>
<p>Should I use <code>int i;</code> or <code>size_t i;</code>?</p>
</section>
<section id="answer-accepted-score-437" class="level4">
<h4>Answer accepted (score 437)</h4>
<p><a href="http://en.wikipedia.org/wiki/Size_t" rel="noreferrer">From Wikipedia</a>:</p>
<blockquote>
<p>
According to the 1999 ISO C standard (C99), <code>size_t</code> is an unsigned integer type of at least 16 bit (see sections 7.17 and 7.18.3).
</p>
<p>
<code>size_t</code>is an unsigned data type defined by several C/C++ standards, e.g. the C99 ISO/IEC 9899 standard, that is defined in <code>stddef.h</code>.<a href="http://en.wikipedia.org/wiki/Size_t" rel="noreferrer">1</a> It can be further imported by inclusion of <code>stdlib.h</code> as this file internally sub includes <code>stddef.h</code>.
</p>
<p>
This type is used to represent the size of an object. Library functions that take or return sizes expect them to be of type or have the return type of <code>size_t</code>. Further, the most frequently used compiler-based operator sizeof should evaluate to a constant value that is compatible with <code>size_t</code>.
</p>
</blockquote>
<p>As an implication, <code>size_t</code> is a type guaranteed to hold any array index.</p>
</section>
<section id="answer-2-score-211-1" class="level4">
<h4>Answer 2 (score 211)</h4>
<p><code>size_t</code> is an unsigned type. So, it cannot represent any negative values(&lt;0). You use it when you are counting something, and are sure that it cannot be negative. For example, <a href="http://devdocs.io/c/string/byte/strlen" rel="noreferrer"><code>strlen()</code></a> returns a <code>size_t</code> because the length of a string has to be at least 0.</p>
<p>In your example, if your loop index is going to be always greater than 0, it might make sense to use <code>size_t</code>, or any other unsigned data type.</p>
<p>When you use a <code>size_t</code> object, you have to make sure that in all the contexts it is used, including arithmetic, you want non-negative values. For example, let’s say you have:</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true"></a><span class="dt">size_t</span> s1 = strlen(str1);</span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true"></a><span class="dt">size_t</span> s2 = strlen(str2);</span></code></pre></div>
<p>and you want to find the difference of the lengths of <code>str2</code> and <code>str1</code>. You cannot do:</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true"></a><span class="dt">int</span> diff = s2 - s1; <span class="co">/* bad */</span></span></code></pre></div>
<p>This is because the value assigned to <code>diff</code> is always going to be a positive number, even when <code>s2 &amp;lt; s1</code>, because the calculation is done with unsigned types. In this case, depending upon what your use case is, you might be better off using <code>int</code> (or <code>long long</code>) for <code>s1</code> and <code>s2</code>.</p>
<p>There are some functions in C/POSIX that could/should use <code>size_t</code>, but don’t because of historical reasons. For example, the second parameter to <code>fgets</code> should ideally be <code>size_t</code>, but is <code>int</code>.</p>
</section>
<section id="answer-3-score-69" class="level4">
<h4>Answer 3 (score 69)</h4>
<p><code>size_t</code> is a type that can hold any array index.</p>
<p>Depending on the implementation, it can be any of:</p>
<p><code>unsigned char</code></p>
<p><code>unsigned short</code></p>
<p><code>unsigned int</code></p>
<p><code>unsigned long</code></p>
<p><code>unsigned long long</code></p>
<p>Here’s how <code>size_t</code> is defined in <code>stddef.h</code> of my machine:</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true"></a><span class="kw">typedef</span> <span class="dt">unsigned</span> <span class="dt">long</span> <span class="dt">size_t</span>;</span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-do-i-use-extern-to-share-variables-between-source-files-score-665535-in-2017" class="level3">
<h3>27: How do I use extern to share variables between source files? (score <a href="https://stackoverflow.com/q/1433204.html">665535</a> in 2017)</h3>
<section id="question-26" class="level4">
<h4>Question</h4>
<p>I know that global variables in C sometimes have the <code>extern</code> keyword. What is an <code>extern</code> variable? What is the declaration like? What is its scope?</p>
<p>This is related to sharing variables across source files, but how does that work precisely? Where do I use <code>extern</code>?</p>
</section>
<section id="answer-2-score-1667" class="level4">
<h4>Answer 2 (score 1667)</h4>
<p>
Using <code>extern</code> is only of relevance when the program you’re building consists of multiple source files linked together, where some of the variables defined, for example, in source file <code>file1.c</code> need to be referenced in other source files, such as <code>file2.c</code>.
</p>
<p>
It is important to <a href="https://stackoverflow.com/questions/1410563">understand the difference between <em>defining</em> a variable and <em>declaring</em> a variable</a>:
</p>
<ul>
<li>
A variable is <strong>declared</strong> when the compiler is informed that a variable exists (and this is its type); it does not allocate the storage for the variable at that point.
</li>
<li>
A variable is <strong>defined</strong> when the compiler allocates the storage for the variable.
</li>
</ul>
<p>
You may declare a variable multiple times (though once is sufficient); you may only define it once within a given scope. A variable definition is also a declaration, but not all variable declarations are definitions.
</p>
<h5>
Best way to declare and define global variables
</h2>
<p>
The clean, reliable way to declare and define global variables is to use a header file to contain an <code>extern</code> <em>declaration</em> of the variable.
</p>
<p>
The header is included by the one source file that defines the variable and by all the source files that reference the variable. For each program, one source file (and only one source file) defines the variable. Similarly, one header file (and only one header file) should declare the variable. The header file is crucial; it enables cross-checking between independent TUs (translation units — think source files) and ensures consistency.
</p>
<p>
Although there are other ways of doing it, this method is simple and reliable. It is demonstrated by <code>file3.h</code>, <code>file1.c</code> and <code>file2.c</code>:
</p>
<h5>
file3.h
</h3>
<div class="sourceCode" id="cb178"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true"></a><span class="kw">extern</span> <span class="dt">int</span> global_variable;  <span class="co">/* Declaration of the variable */</span></span></code></pre></div>
<h5>
file1.c
</h3>
<div class="sourceCode" id="cb179"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true"></a></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;file3.h&quot;</span><span class="pp">  </span><span class="co">/* Declaration made available here */</span></span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true"></a></span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;prog1.h&quot;</span><span class="pp">  </span><span class="co">/* Function declarations */</span></span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true"></a></span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true"></a><span class="co">/* Variable defined here */</span></span>
<span id="cb179-7"><a href="#cb179-7" aria-hidden="true"></a><span class="dt">int</span> global_variable = <span class="dv">37</span>;    <span class="co">/* Definition checked against declaration */</span></span>
<span id="cb179-8"><a href="#cb179-8" aria-hidden="true"></a></span>
<span id="cb179-9"><a href="#cb179-9" aria-hidden="true"></a><span class="dt">int</span> increment(<span class="dt">void</span>) { <span class="cf">return</span> global_variable++; }</span></code></pre></div>
<h5>
file2.c
</h3>
<div class="sourceCode" id="cb180"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true"></a></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;file3.h&quot;</span></span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true"></a></span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;prog1.h&quot;</span></span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true"></a></span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb180-7"><a href="#cb180-7" aria-hidden="true"></a></span>
<span id="cb180-8"><a href="#cb180-8" aria-hidden="true"></a><span class="dt">void</span> use_it(<span class="dt">void</span>)</span>
<span id="cb180-9"><a href="#cb180-9" aria-hidden="true"></a>{</span>
<span id="cb180-10"><a href="#cb180-10" aria-hidden="true"></a>    printf(<span class="st">&quot;Global variable: %d</span><span class="sc">\n</span><span class="st">&quot;</span>, global_variable++);</span>
<span id="cb180-11"><a href="#cb180-11" aria-hidden="true"></a>}</span></code></pre></div>
<p>That’s the best way to declare and define global variables.</p>
<hr>
<p><em>The next two files complete the source for <code>prog1</code>:</em></p>
<p>
The complete programs shown use functions, so function declarations have crept in. Both C99 and C11 require functions to be declared or defined before they are used (whereas C90 did not, for good reasons). I use the keyword <code>extern</code> in front of function declarations in headers for consistency — to match the <code>extern</code> in front of variable declarations in headers. Many people prefer not to use <code>extern</code> in front of function declarations; the compiler doesn’t care — and ultimately, neither do I as long as you’re consistent, at least within a source file.
</p>
<h5>
prog1.h
</h3>
<div class="sourceCode" id="cb181"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true"></a><span class="kw">extern</span> <span class="dt">void</span> use_it(<span class="dt">void</span>);</span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true"></a><span class="kw">extern</span> <span class="dt">int</span> increment(<span class="dt">void</span>);</span></code></pre></div>
<h5>
prog1.c
</h3>
<div class="sourceCode" id="cb182"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true"></a></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;file3.h&quot;</span></span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true"></a></span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;prog1.h&quot;</span></span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true"></a></span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb182-7"><a href="#cb182-7" aria-hidden="true"></a></span>
<span id="cb182-8"><a href="#cb182-8" aria-hidden="true"></a><span class="dt">int</span> main(<span class="dt">void</span>)</span>
<span id="cb182-9"><a href="#cb182-9" aria-hidden="true"></a>{</span>
<span id="cb182-10"><a href="#cb182-10" aria-hidden="true"></a>    use_it();</span>
<span id="cb182-11"><a href="#cb182-11" aria-hidden="true"></a>    global_variable += <span class="dv">19</span>;</span>
<span id="cb182-12"><a href="#cb182-12" aria-hidden="true"></a>    use_it();</span>
<span id="cb182-13"><a href="#cb182-13" aria-hidden="true"></a>    printf(<span class="st">&quot;Increment: %d</span><span class="sc">\n</span><span class="st">&quot;</span>, increment());</span>
<span id="cb182-14"><a href="#cb182-14" aria-hidden="true"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb182-15"><a href="#cb182-15" aria-hidden="true"></a>}</span></code></pre></div>
<ul>
<li>
<code>prog1</code> uses <code>prog1.c</code>, <code>file1.c</code>, <code>file2.c</code>, <code>file3.h</code> and <code>prog1.h</code>.
</li>
</ul>
<p>
The file <code>prog1.mk</code> is a makefile for <code>prog1</code> only. It will work with most versions of <code>make</code> produced since about the turn of the millennium. It is not tied specifically to GNU Make.
</p>
<h5>
prog1.mk
</h3>
<div class="sourceCode" id="cb183"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true"></a></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true"></a><span class="er"># Minimal makefile for prog1</span></span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true"></a></span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true"></a>PROGRAM = prog1</span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true"></a>FILES.c = prog1.c file1.c file2.c</span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true"></a>FILES.h = prog1.h file3.h</span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true"></a>FILES.o = ${FILES.c:.c=.o}</span>
<span id="cb183-8"><a href="#cb183-8" aria-hidden="true"></a></span>
<span id="cb183-9"><a href="#cb183-9" aria-hidden="true"></a>CC      = gcc</span>
<span id="cb183-10"><a href="#cb183-10" aria-hidden="true"></a>SFLAGS  = -std=c11</span>
<span id="cb183-11"><a href="#cb183-11" aria-hidden="true"></a>GFLAGS  = -g</span>
<span id="cb183-12"><a href="#cb183-12" aria-hidden="true"></a>OFLAGS  = -O3</span>
<span id="cb183-13"><a href="#cb183-13" aria-hidden="true"></a>WFLAG1  = -Wall</span>
<span id="cb183-14"><a href="#cb183-14" aria-hidden="true"></a>WFLAG2  = -Wextra</span>
<span id="cb183-15"><a href="#cb183-15" aria-hidden="true"></a>WFLAG3  = -Werror</span>
<span id="cb183-16"><a href="#cb183-16" aria-hidden="true"></a>WFLAG4  = -Wstrict-prototypes</span>
<span id="cb183-17"><a href="#cb183-17" aria-hidden="true"></a>WFLAG5  = -Wmissing-prototypes</span>
<span id="cb183-18"><a href="#cb183-18" aria-hidden="true"></a>WFLAGS  = ${WFLAG1} ${WFLAG2} ${WFLAG3} ${WFLAG4} ${WFLAG5}</span>
<span id="cb183-19"><a href="#cb183-19" aria-hidden="true"></a>UFLAGS  =</span>
<span id="cb183-20"><a href="#cb183-20" aria-hidden="true"></a><span class="er"># Set on command line only</span></span>
<span id="cb183-21"><a href="#cb183-21" aria-hidden="true"></a></span>
<span id="cb183-22"><a href="#cb183-22" aria-hidden="true"></a>CFLAGS  = ${SFLAGS} ${GFLAGS} ${OFLAGS} ${WFLAGS} ${UFLAGS}</span>
<span id="cb183-23"><a href="#cb183-23" aria-hidden="true"></a>LDFLAGS =</span>
<span id="cb183-24"><a href="#cb183-24" aria-hidden="true"></a>LDLIBS  =</span>
<span id="cb183-25"><a href="#cb183-25" aria-hidden="true"></a></span>
<span id="cb183-26"><a href="#cb183-26" aria-hidden="true"></a>all:    ${PROGRAM}</span>
<span id="cb183-27"><a href="#cb183-27" aria-hidden="true"></a></span>
<span id="cb183-28"><a href="#cb183-28" aria-hidden="true"></a>${PROGRAM}: ${FILES.o}</span>
<span id="cb183-29"><a href="#cb183-29" aria-hidden="true"></a>    ${CC} -o $@ ${CFLAGS} ${FILES.o} ${LDFLAGS} ${LDLIBS}</span>
<span id="cb183-30"><a href="#cb183-30" aria-hidden="true"></a></span>
<span id="cb183-31"><a href="#cb183-31" aria-hidden="true"></a>prog1.o: ${FILES.h}</span>
<span id="cb183-32"><a href="#cb183-32" aria-hidden="true"></a>file1.o: ${FILES.h}</span>
<span id="cb183-33"><a href="#cb183-33" aria-hidden="true"></a>file2.o: ${FILES.h}</span>
<span id="cb183-34"><a href="#cb183-34" aria-hidden="true"></a></span>
<span id="cb183-35"><a href="#cb183-35" aria-hidden="true"></a></span>
<span id="cb183-36"><a href="#cb183-36" aria-hidden="true"></a><span class="pp"># If it exists, prog1.dSYM is a directory on macOS</span></span>
<span id="cb183-37"><a href="#cb183-37" aria-hidden="true"></a>DEBRIS = a.out core *~ *.dSYM</span>
<span id="cb183-38"><a href="#cb183-38" aria-hidden="true"></a>RM_FR  = rm -fr</span>
<span id="cb183-39"><a href="#cb183-39" aria-hidden="true"></a></span>
<span id="cb183-40"><a href="#cb183-40" aria-hidden="true"></a>clean:</span>
<span id="cb183-41"><a href="#cb183-41" aria-hidden="true"></a>    ${RM_FR} ${FILES.o} ${PROGRAM} ${DEBRIS}</span></code></pre></div>
<hr>
<h5>
Guidelines
</h2>
<p>Rules to be broken by experts only, and only with good reason:</p>
<ul>
<li>
A header file only contains <code>extern</code> declarations of variables — never <code>static</code> or unqualified variable definitions.
</li>
<li>
For any given variable, only one header file declares it (SPOT — Single Point of Truth).
</li>
<li>
A source file never contains <code>extern</code> declarations of variables — source files always include the (sole) header that declares them.
</li>
<li>
For any given variable, exactly one source file defines the variable, preferably initializing it too. (Although there is no need to initialize explicitly to zero, it does no harm and can do some good, because there can be only one initialized definition of a particular global variable in a program).
</li>
<li>
The source file that defines the variable also includes the header to ensure that the definition and the declaration are consistent.
</li>
<li>
A function should never need to declare a variable using <code>extern</code>.
</li>
<li>
Avoid global variables whenever possible — use functions instead.
</li>
</ul>
<p>
<sup><em>The source code and text of this answer are available in my <a href="https://github.com/jleffler/soq" rel="noreferrer">SOQ</a> (Stack Overflow Questions) repository on GitHub in the <a href="https://github.com/jleffler/soq/tree/master/src/so-0143-3204" rel="noreferrer">src/so-0143-3204</a> sub-directory.</em> </sup>
</p>
<p>
<sup><em>If you’re not an experienced C programmer, you could (and perhaps should) stop reading here.</em> </sup>
</p>
<h5>
Not so good way to define global variables
</h2>
<p>
With some (indeed, many) C compilers, you can get away with what’s called a ‘common’ definition of a variable too. ‘Common’, here, refers to a technique used in Fortran for sharing variables between source files, using a (possibly named) COMMON block. What happens here is that each of a number of files provides a tentative definition of the variable. As long as no more than one file provides an initialized definition, then the various files end up sharing a common single definition of the variable:
</p>
<h5>
file10.c
</h3>
<div class="sourceCode" id="cb184"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true"></a></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;prog2.h&quot;</span></span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true"></a></span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true"></a><span class="dt">int</span> i;   <span class="co">/* Do not do this in portable code */</span></span>
<span id="cb184-5"><a href="#cb184-5" aria-hidden="true"></a></span>
<span id="cb184-6"><a href="#cb184-6" aria-hidden="true"></a><span class="dt">void</span> inc(<span class="dt">void</span>) { i++; }</span></code></pre></div>
<h5>
file11.c
</h3>
<div class="sourceCode" id="cb185"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true"></a></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;prog2.h&quot;</span></span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true"></a></span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true"></a><span class="dt">int</span> i;   <span class="co">/* Do not do this in portable code */</span></span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true"></a></span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true"></a><span class="dt">void</span> dec(<span class="dt">void</span>) { i--; }</span></code></pre></div>
<h5>
file12.c
</h3>
<div class="sourceCode" id="cb186"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true"></a></span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;prog2.h&quot;</span></span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true"></a></span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb186-5"><a href="#cb186-5" aria-hidden="true"></a></span>
<span id="cb186-6"><a href="#cb186-6" aria-hidden="true"></a><span class="dt">int</span> i = <span class="dv">9</span>;   <span class="co">/* Do not do this in portable code */</span></span>
<span id="cb186-7"><a href="#cb186-7" aria-hidden="true"></a></span>
<span id="cb186-8"><a href="#cb186-8" aria-hidden="true"></a><span class="dt">void</span> put(<span class="dt">void</span>) { printf(<span class="st">&quot;i = %d</span><span class="sc">\n</span><span class="st">&quot;</span>, i); }</span></code></pre></div>
<p>
This technique does not conform to the letter of the C standard and the ‘one definition rule’ — it is officially undefined behaviour:
</p>
<blockquote>
<p><strong><a href="http://port70.net/~nsz/c/c11/n1570.html
#J.2" rel="noreferrer">J.2 Undefined behavior</a></strong></p>
<p>
An identifier with external linkage is used, but in the program there does not exist exactly one external definition for the identifier, or the identifier is not used and there exist multiple external definitions for the identifier (6.9).
</p>
<p><strong><a href="http://port70.net/~nsz/c/c11/n1570.html
#6.9p5" rel="noreferrer">§6.9 External definitions ¶5</a></strong></p>
<p>
An <em>external definition</em> is an external declaration that is also a definition of a function (other than an inline definition) or an object. If an identifier declared with external linkage is used in an expression (other than as part of the operand of a <code>sizeof</code> or <code>_Alignof</code> operator whose result is an integer constant), somewhere in the entire program there shall be exactly one external definition for the identifier; otherwise, there shall be no more than one.<sup>161)</sup>
</p>
<p>
<sup>161)</sup> Thus, if an identifier declared with external linkage is not used in an expression, there need be no external definition for it.
</p>
</blockquote>
<p>
However, the C standard also lists it in informative Annex J as one of the <a href="http://port70.net/~nsz/c/c11/n1570.html
#J.5" rel="noreferrer">Common extensions</a>.
</p>
<blockquote>
<p><a href="http://port70.net/~nsz/c/c11/n1570.html
#J.5.11" rel="noreferrer">J.5.11 Multiple external definitions</a></p>
<p>
There may be more than one external definition for the identifier of an object, with or without the explicit use of the keyword extern; if the definitions disagree, or more than one is initialized, the behavior is undefined (6.9.2).
</p>
</blockquote>
<p>
Because this technique is not always supported, it is best to avoid using it, <em>especially if your code needs to be portable</em>. Using this technique, you can also end up with unintentional type punning. If one of the files declared <code>i</code> as a <code>double</code> instead of as an <code>int</code>, C’s type-unsafe linkers probably would not spot the mismatch. If you’re on a machine with 64-bit <code>int</code> and <code>double</code>, you’d not even get a warning; on a machine with 32-bit <code>int</code> and 64-bit <code>double</code>, you’d probably get a warning about the different sizes — the linker would use the largest size, exactly as a Fortran program would take the largest size of any common blocks.
</p>
<hr>
<p><em>The next two files complete the source for <code>prog2</code>:</em></p>
<h5>
prog2.h
</h3>
<div class="sourceCode" id="cb187"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true"></a><span class="kw">extern</span> <span class="dt">void</span> dec(<span class="dt">void</span>);</span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true"></a><span class="kw">extern</span> <span class="dt">void</span> put(<span class="dt">void</span>);</span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true"></a><span class="kw">extern</span> <span class="dt">void</span> inc(<span class="dt">void</span>);</span></code></pre></div>
<h5>
prog2.c
</h3>
<div class="sourceCode" id="cb188"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true"></a></span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;prog2.h&quot;</span></span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true"></a></span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true"></a></span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true"></a><span class="dt">int</span> main(<span class="dt">void</span>)</span>
<span id="cb188-7"><a href="#cb188-7" aria-hidden="true"></a>{</span>
<span id="cb188-8"><a href="#cb188-8" aria-hidden="true"></a>    inc();</span>
<span id="cb188-9"><a href="#cb188-9" aria-hidden="true"></a>    put();</span>
<span id="cb188-10"><a href="#cb188-10" aria-hidden="true"></a>    dec();</span>
<span id="cb188-11"><a href="#cb188-11" aria-hidden="true"></a>    put();</span>
<span id="cb188-12"><a href="#cb188-12" aria-hidden="true"></a>    dec();</span>
<span id="cb188-13"><a href="#cb188-13" aria-hidden="true"></a>    put();</span>
<span id="cb188-14"><a href="#cb188-14" aria-hidden="true"></a>}</span></code></pre></div>
<ul>
<li>
<code>prog2</code> uses <code>prog2.c</code>, <code>file10.c</code>, <code>file11.c</code>, <code>file12.c</code>, <code>prog2.h</code>.
</li>
</ul>
<hr>
<h5>
Warning
</h3>
<p>
As noted in comments here, and as stated in my answer to a similar <a href="https://stackoverflow.com/questions/1490693">question</a>, using multiple definitions for a global variable leads to undefined behaviour (J.2; §6.9), which is the standard’s way of saying “anything could happen”. One of the things that can happen is that the program behaves as you expect; and J.5.11 says, approximately, “you might be lucky more often than you deserve”. But a program that relies on multiple definitions of an extern variable — with or without the explicit ‘extern’ keyword — is not a strictly conforming program and not guaranteed to work everywhere. Equivalently: it contains a bug which may or may not show itself.
</p>
<h5>
Violating the guidelines
</h2>
<p>
There are, of course, many ways in which these guidelines can be broken. Occasionally, there may be a good reason to break the guidelines, but such occasions are extremely unusual.
</p>
<h5>
faulty_header.h
</h3>
<div class="sourceCode" id="cb189"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true"></a><span class="dt">int</span> some_var;    <span class="co">/* Do not do this in a header!!! */</span></span></code></pre></div>
<p>
Note 1: if the header defines the variable without the <code>extern</code> keyword, then each file that includes the header creates a tentative definition of the variable. As noted previously, this will often work, but the C standard does not guarantee that it will work.
</p>
<h5>
broken_header.h
</h3>
<div class="sourceCode" id="cb190"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true"></a><span class="dt">int</span> some_var = <span class="dv">13</span>;    <span class="co">/* Only one source file in a program can use this */</span></span></code></pre></div>
<p>
Note 2: if the header defines and initializes the variable, then only one source file in a given program can use the header. Since headers are primarily for sharing information, it is a bit silly to create one that can only be used once.
</p>
<h5>
seldom_correct.h
</h3>
<div class="sourceCode" id="cb191"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true"></a><span class="dt">static</span> <span class="dt">int</span> hidden_global = <span class="dv">3</span>;   <span class="co">/* Each source file gets its own copy  */</span></span></code></pre></div>
<p>
Note 3: if the header defines a static variable (with or without initialization), then each source file ends up with its own private version of the ‘global’ variable.
</p>
<p>
If the variable is actually a complex array, for example, this can lead to extreme duplication of code. It can, very occasionally, be a sensible way to achieve some effect, but that is very unusual.
</p>
<hr>
<h5>
Summary
</h2>
<p>
Use the header technique I showed first. It works reliably and everywhere. Note, in particular, that the header declaring the <code>global_variable</code> is included in every file that uses it — including the one that defines it. This ensures that everything is self-consistent.
</p>
<p>
Similar concerns arise with declaring and defining functions — analogous rules apply. But the question was about variables specifically, so I’ve kept the answer to variables only.
</p>
<h5>
End of Original Answer
</h3>
<p><sup><em>If you’re not an experienced C programmer, you probably should stop reading here.</em></sup></p>
<hr>
<p><em>Late Major Addition</em></p>
<h5>
Avoiding Code Duplication
</h1>
<p>
One concern that is sometimes (and legitimately) raised about the ‘declarations in headers, definitions in source’ mechanism described here is that there are two files to be kept synchronized — the header and the source. This is usually followed up with an observation that a macro can be used so that the header serves double duty — normally declaring the variables, but when a specific macro is set before the header is included, it defines the variables instead.
</p>
<p>
Another concern can be that the variables need to be defined in each of a number of ‘main programs’. This is normally a spurious concern; you can simply introduce a C source file to define the variables and link the object file produced with each of the programs.
</p>
<p>
A typical scheme works like this, using the original global variable illustrated in <code>file3.h</code>:
</p>
<h5>
file3a.h
</h3>
<div class="sourceCode" id="cb192"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true"></a></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true"></a><span class="pp">#ifdef DEFINE_VARIABLES</span></span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true"></a></span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true"></a><span class="pp">#define EXTERN </span><span class="co">/* nothing */</span></span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true"></a></span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true"></a><span class="pp">#else</span></span>
<span id="cb192-7"><a href="#cb192-7" aria-hidden="true"></a></span>
<span id="cb192-8"><a href="#cb192-8" aria-hidden="true"></a><span class="pp">#define EXTERN extern</span></span>
<span id="cb192-9"><a href="#cb192-9" aria-hidden="true"></a></span>
<span id="cb192-10"><a href="#cb192-10" aria-hidden="true"></a><span class="pp">#endif </span><span class="co">/* DEFINE_VARIABLES */</span></span>
<span id="cb192-11"><a href="#cb192-11" aria-hidden="true"></a></span>
<span id="cb192-12"><a href="#cb192-12" aria-hidden="true"></a>EXTERN <span class="dt">int</span> global_variable;</span></code></pre></div>
<h5>
file1a.c
</h3>
<div class="sourceCode" id="cb193"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true"></a></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true"></a><span class="pp">#define DEFINE_VARIABLES</span></span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true"></a></span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;file3a.h&quot;</span><span class="pp">  </span><span class="co">/* Variable defined - but not initialized */</span></span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true"></a></span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;prog3.h&quot;</span></span>
<span id="cb193-7"><a href="#cb193-7" aria-hidden="true"></a></span>
<span id="cb193-8"><a href="#cb193-8" aria-hidden="true"></a><span class="dt">int</span> increment(<span class="dt">void</span>) { <span class="cf">return</span> global_variable++; }</span></code></pre></div>
<h5>
file2a.c
</h3>
<div class="sourceCode" id="cb194"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true"></a></span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;file3a.h&quot;</span></span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true"></a></span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;prog3.h&quot;</span></span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true"></a></span>
<span id="cb194-6"><a href="#cb194-6" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb194-7"><a href="#cb194-7" aria-hidden="true"></a></span>
<span id="cb194-8"><a href="#cb194-8" aria-hidden="true"></a><span class="dt">void</span> use_it(<span class="dt">void</span>)</span>
<span id="cb194-9"><a href="#cb194-9" aria-hidden="true"></a>{</span>
<span id="cb194-10"><a href="#cb194-10" aria-hidden="true"></a>    printf(<span class="st">&quot;Global variable: %d</span><span class="sc">\n</span><span class="st">&quot;</span>, global_variable++);</span>
<span id="cb194-11"><a href="#cb194-11" aria-hidden="true"></a>}</span></code></pre></div>
<hr>
<p><em>The next two files complete the source for <code>prog3</code>:</em></p>
<h5>
prog3.h
</h3>
<div class="sourceCode" id="cb195"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true"></a><span class="kw">extern</span> <span class="dt">void</span> use_it(<span class="dt">void</span>);</span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true"></a><span class="kw">extern</span> <span class="dt">int</span> increment(<span class="dt">void</span>);</span></code></pre></div>
<h5>
prog3.c
</h3>
<div class="sourceCode" id="cb196"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true"></a></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;file3a.h&quot;</span></span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true"></a></span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;prog3.h&quot;</span></span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true"></a></span>
<span id="cb196-6"><a href="#cb196-6" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb196-7"><a href="#cb196-7" aria-hidden="true"></a></span>
<span id="cb196-8"><a href="#cb196-8" aria-hidden="true"></a><span class="dt">int</span> main(<span class="dt">void</span>)</span>
<span id="cb196-9"><a href="#cb196-9" aria-hidden="true"></a>{</span>
<span id="cb196-10"><a href="#cb196-10" aria-hidden="true"></a>    use_it();</span>
<span id="cb196-11"><a href="#cb196-11" aria-hidden="true"></a>    global_variable += <span class="dv">19</span>;</span>
<span id="cb196-12"><a href="#cb196-12" aria-hidden="true"></a>    use_it();</span>
<span id="cb196-13"><a href="#cb196-13" aria-hidden="true"></a>    printf(<span class="st">&quot;Increment: %d</span><span class="sc">\n</span><span class="st">&quot;</span>, increment());</span>
<span id="cb196-14"><a href="#cb196-14" aria-hidden="true"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb196-15"><a href="#cb196-15" aria-hidden="true"></a>}</span></code></pre></div>
<ul>
<li>
<code>prog3</code> uses <code>prog3.c</code>, <code>file1a.c</code>, <code>file2a.c</code>, <code>file3a.h</code>, <code>prog3.h</code>.
</li>
</ul>
<hr>
<h5>
Variable initialization
</h2>
<p>
The problem with this scheme as shown is that it does not provide for initialization of the global variable. With C99 or C11 and variable argument lists for macros, you could define a macro to support initialization too. (With C89 and no support for variable argument lists in macros, there is no easy way to handle arbitrarily long initializers.)
</p>
<h5>
file3b.h
</h3>
<div class="sourceCode" id="cb197"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true"></a></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true"></a><span class="pp">#ifdef DEFINE_VARIABLES</span></span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true"></a></span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true"></a><span class="pp">#define EXTERN                  </span><span class="co">/* nothing */</span></span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true"></a></span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true"></a><span class="pp">#define INITIALIZER(...)        = __VA_ARGS__</span></span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true"></a></span>
<span id="cb197-8"><a href="#cb197-8" aria-hidden="true"></a><span class="pp">#else</span></span>
<span id="cb197-9"><a href="#cb197-9" aria-hidden="true"></a></span>
<span id="cb197-10"><a href="#cb197-10" aria-hidden="true"></a><span class="pp">#define EXTERN                  extern</span></span>
<span id="cb197-11"><a href="#cb197-11" aria-hidden="true"></a></span>
<span id="cb197-12"><a href="#cb197-12" aria-hidden="true"></a><span class="pp">#define INITIALIZER(...)        </span><span class="co">/* nothing */</span></span>
<span id="cb197-13"><a href="#cb197-13" aria-hidden="true"></a></span>
<span id="cb197-14"><a href="#cb197-14" aria-hidden="true"></a><span class="pp">#endif </span><span class="co">/* DEFINE_VARIABLES */</span></span>
<span id="cb197-15"><a href="#cb197-15" aria-hidden="true"></a></span>
<span id="cb197-16"><a href="#cb197-16" aria-hidden="true"></a>EXTERN <span class="dt">int</span> global_variable INITIALIZER(<span class="dv">37</span>);</span>
<span id="cb197-17"><a href="#cb197-17" aria-hidden="true"></a>EXTERN <span class="kw">struct</span> { <span class="dt">int</span> a; <span class="dt">int</span> b; } oddball_struct INITIALIZER({ <span class="dv">41</span>, <span class="dv">43</span> });</span></code></pre></div>
<p>
<sup>Reverse contents of <code>#if</code> and <code>#else</code> blocks, fixing bug identified by <a href="https://stackoverflow.com/users/369317/denis-kniazhev">Denis Kniazhev</a></sup>
</p>
<h5>
file1b.c
</h3>
<div class="sourceCode" id="cb198"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true"></a></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true"></a><span class="pp">#define DEFINE_VARIABLES</span></span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true"></a></span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;file3b.h&quot;</span><span class="pp">  </span><span class="co">/* Variables now defined and initialized */</span></span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true"></a></span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;prog4.h&quot;</span></span>
<span id="cb198-7"><a href="#cb198-7" aria-hidden="true"></a></span>
<span id="cb198-8"><a href="#cb198-8" aria-hidden="true"></a><span class="dt">int</span> increment(<span class="dt">void</span>) { <span class="cf">return</span> global_variable++; }</span>
<span id="cb198-9"><a href="#cb198-9" aria-hidden="true"></a><span class="dt">int</span> oddball_value(<span class="dt">void</span>) { <span class="cf">return</span> oddball_struct.a + oddball_struct.b; }</span></code></pre></div>
<h5>
file2b.c
</h3>
<div class="sourceCode" id="cb199"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true"></a></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;file3b.h&quot;</span></span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true"></a></span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;prog4.h&quot;</span></span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true"></a></span>
<span id="cb199-6"><a href="#cb199-6" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb199-7"><a href="#cb199-7" aria-hidden="true"></a></span>
<span id="cb199-8"><a href="#cb199-8" aria-hidden="true"></a><span class="dt">void</span> use_them(<span class="dt">void</span>)</span>
<span id="cb199-9"><a href="#cb199-9" aria-hidden="true"></a>{</span>
<span id="cb199-10"><a href="#cb199-10" aria-hidden="true"></a>    printf(<span class="st">&quot;Global variable: %d</span><span class="sc">\n</span><span class="st">&quot;</span>, global_variable++);</span>
<span id="cb199-11"><a href="#cb199-11" aria-hidden="true"></a>    oddball_struct.a += global_variable;</span>
<span id="cb199-12"><a href="#cb199-12" aria-hidden="true"></a>    oddball_struct.b -= global_variable / <span class="dv">2</span>;</span>
<span id="cb199-13"><a href="#cb199-13" aria-hidden="true"></a>}</span></code></pre></div>
<p>
Clearly, the code for the oddball structure is not what you’d normally write, but it illustrates the point. The first argument to the second invocation of <code>INITIALIZER</code> is <code>{ 41</code> and the remaining argument (singular in this example) is <code>43 }</code>. Without C99 or similar support for variable argument lists for macros, initializers that need to contain commas are very problematic.
</p>
<p>
<sup>Correct header <code>file3b.h</code> included (instead of <code>fileba.h</code>) per <a href="https://stackoverflow.com/users/369317/denis-kniazhev">Denis Kniazhev</a></sup>
</p>
<hr>
<p><em>The next two files complete the source for <code>prog4</code>:</em></p>
<h5>
prog4.h
</h3>
<div class="sourceCode" id="cb200"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true"></a><span class="kw">extern</span> <span class="dt">int</span> increment(<span class="dt">void</span>);</span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true"></a><span class="kw">extern</span> <span class="dt">int</span> oddball_value(<span class="dt">void</span>);</span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true"></a><span class="kw">extern</span> <span class="dt">void</span> use_them(<span class="dt">void</span>);</span></code></pre></div>
<h5>
prog4.c
</h3>
<div class="sourceCode" id="cb201"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true"></a></span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;file3b.h&quot;</span></span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true"></a></span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;prog4.h&quot;</span></span>
<span id="cb201-5"><a href="#cb201-5" aria-hidden="true"></a></span>
<span id="cb201-6"><a href="#cb201-6" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb201-7"><a href="#cb201-7" aria-hidden="true"></a></span>
<span id="cb201-8"><a href="#cb201-8" aria-hidden="true"></a><span class="dt">int</span> main(<span class="dt">void</span>)</span>
<span id="cb201-9"><a href="#cb201-9" aria-hidden="true"></a>{</span>
<span id="cb201-10"><a href="#cb201-10" aria-hidden="true"></a>    use_them();</span>
<span id="cb201-11"><a href="#cb201-11" aria-hidden="true"></a>    global_variable += <span class="dv">19</span>;</span>
<span id="cb201-12"><a href="#cb201-12" aria-hidden="true"></a>    use_them();</span>
<span id="cb201-13"><a href="#cb201-13" aria-hidden="true"></a>    printf(<span class="st">&quot;Increment: %d</span><span class="sc">\n</span><span class="st">&quot;</span>, increment());</span>
<span id="cb201-14"><a href="#cb201-14" aria-hidden="true"></a>    printf(<span class="st">&quot;Oddball:   %d</span><span class="sc">\n</span><span class="st">&quot;</span>, oddball_value());</span>
<span id="cb201-15"><a href="#cb201-15" aria-hidden="true"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb201-16"><a href="#cb201-16" aria-hidden="true"></a>}</span></code></pre></div>
<ul>
<li>
<code>prog4</code> uses <code>prog4.c</code>, <code>file1b.c</code>, <code>file2b.c</code>, <code>prog4.h</code>, <code>file3b.h</code>.
</li>
</ul>
<hr>
<h5>
Header Guards
</h2>
<p>
Any header should be protected against reinclusion, so that type definitions (enum, struct or union types, or typedefs generally) do not cause problems. The standard technique is to wrap the body of the header in a header guard such as:
</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true"></a></span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true"></a><span class="pp">#ifndef FILE3B_H_INCLUDED</span></span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true"></a></span>
<span id="cb202-4"><a href="#cb202-4" aria-hidden="true"></a><span class="pp">#define FILE3B_H_INCLUDED</span></span>
<span id="cb202-5"><a href="#cb202-5" aria-hidden="true"></a></span>
<span id="cb202-6"><a href="#cb202-6" aria-hidden="true"></a>...contents of header...</span>
<span id="cb202-7"><a href="#cb202-7" aria-hidden="true"></a></span>
<span id="cb202-8"><a href="#cb202-8" aria-hidden="true"></a></span>
<span id="cb202-9"><a href="#cb202-9" aria-hidden="true"></a><span class="pp">#endif </span><span class="co">/* FILE3B_H_INCLUDED */</span></span></code></pre></div>
<p>
The header might be included twice indirectly. For example, if <code>file4b.h</code> includes <code>file3b.h</code> for a type definition that isn’t shown, and <code>file1b.c</code> needs to use both header <code>file4b.h</code> and <code>file3b.h</code>, then you have some more tricky issues to resolve. Clearly, you might revise the header list to include just <code>file4b.h</code>. However, you might not be aware of the internal dependencies — and the code should, ideally, continue to work.
</p>
<p>
Further, it starts to get tricky because you might include <code>file4b.h</code> before including <code>file3b.h</code> to generate the definitions, but the normal header guards on <code>file3b.h</code> would prevent the header being reincluded.
</p>
<p>
So, you need to include the body of <code>file3b.h</code> at most once for declarations, and at most once for definitions, but you might need both in a single translation unit (TU — a combination of a source file and the headers it uses).
</p>
<h5>
Multiple inclusion with variable definitions
</h2>
<p>
However, it can be done subject to a not too unreasonable constraint. Let’s introduce a new set of file names:
</p>
<ul>
<li>
<code>external.h</code> for the EXTERN macro definitions, etc.
</li>
<li>
<code>file1c.h</code> to define types (notably, <code>struct oddball</code>, the type of <code>oddball_struct</code>).
</li>
<li>
<code>file2c.h</code> to define or declare the global variables.
</li>
<li>
<code>file3c.c</code> which defines the global variables.
</li>
<li>
<code>file4c.c</code> which simply uses the global variables.
</li>
<li>
<code>file5c.c</code> which shows that you can declare and then define the global variables.
</li>
<li>
<code>file6c.c</code> which shows that you can define and then (attempt to) declare the global variables.
</li>
</ul>
<p>
In these examples, <code>file5c.c</code> and <code>file6c.c</code> directly include the header <code>file2c.h</code> several times, but that is the simplest way to show that the mechanism works. It means that if the header was indirectly included twice, it would also be safe.
</p>
<p>The restrictions for this to work are:</p>
<ol>
<li>
The header defining or declaring the global variables may not itself define any types.
</li>
<li>
Immediately before you include a header that should define variables, you define the macro DEFINE_VARIABLES.
</li>
<li>
The header defining or declaring the variables has stylized contents.
</li>
</ol>
<h5>
external.h
</h3>
<div class="sourceCode" id="cb203"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true"></a><span class="co">/*</span></span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true"></a><span class="co">** This header must not contain header guards (like &lt;assert.h&gt; must not).</span></span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true"></a><span class="co">** Each time it is invoked, it redefines the macros EXTERN, INITIALIZE</span></span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true"></a><span class="co">** based on whether macro DEFINE_VARIABLES is currently defined.</span></span>
<span id="cb203-5"><a href="#cb203-5" aria-hidden="true"></a><span class="co">*/</span></span>
<span id="cb203-6"><a href="#cb203-6" aria-hidden="true"></a></span>
<span id="cb203-7"><a href="#cb203-7" aria-hidden="true"></a><span class="pp">#undef EXTERN</span></span>
<span id="cb203-8"><a href="#cb203-8" aria-hidden="true"></a></span>
<span id="cb203-9"><a href="#cb203-9" aria-hidden="true"></a><span class="pp">#undef INITIALIZE</span></span>
<span id="cb203-10"><a href="#cb203-10" aria-hidden="true"></a></span>
<span id="cb203-11"><a href="#cb203-11" aria-hidden="true"></a></span>
<span id="cb203-12"><a href="#cb203-12" aria-hidden="true"></a><span class="pp">#ifdef DEFINE_VARIABLES</span></span>
<span id="cb203-13"><a href="#cb203-13" aria-hidden="true"></a></span>
<span id="cb203-14"><a href="#cb203-14" aria-hidden="true"></a><span class="pp">#define EXTERN              </span><span class="co">/* nothing */</span></span>
<span id="cb203-15"><a href="#cb203-15" aria-hidden="true"></a></span>
<span id="cb203-16"><a href="#cb203-16" aria-hidden="true"></a><span class="pp">#define INITIALIZE(...)     = __VA_ARGS__</span></span>
<span id="cb203-17"><a href="#cb203-17" aria-hidden="true"></a></span>
<span id="cb203-18"><a href="#cb203-18" aria-hidden="true"></a><span class="pp">#else</span></span>
<span id="cb203-19"><a href="#cb203-19" aria-hidden="true"></a></span>
<span id="cb203-20"><a href="#cb203-20" aria-hidden="true"></a><span class="pp">#define EXTERN              extern</span></span>
<span id="cb203-21"><a href="#cb203-21" aria-hidden="true"></a></span>
<span id="cb203-22"><a href="#cb203-22" aria-hidden="true"></a><span class="pp">#define INITIALIZE(...)     </span><span class="co">/* nothing */</span></span>
<span id="cb203-23"><a href="#cb203-23" aria-hidden="true"></a></span>
<span id="cb203-24"><a href="#cb203-24" aria-hidden="true"></a><span class="pp">#endif </span><span class="co">/* DEFINE_VARIABLES */</span></span></code></pre></div>
<h5>
file1c.h
</h3>
<div class="sourceCode" id="cb204"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true"></a></span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true"></a><span class="pp">#ifndef FILE1C_H_INCLUDED</span></span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true"></a></span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true"></a><span class="pp">#define FILE1C_H_INCLUDED</span></span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true"></a></span>
<span id="cb204-6"><a href="#cb204-6" aria-hidden="true"></a><span class="kw">struct</span> oddball</span>
<span id="cb204-7"><a href="#cb204-7" aria-hidden="true"></a>{</span>
<span id="cb204-8"><a href="#cb204-8" aria-hidden="true"></a>    <span class="dt">int</span> a;</span>
<span id="cb204-9"><a href="#cb204-9" aria-hidden="true"></a>    <span class="dt">int</span> b;</span>
<span id="cb204-10"><a href="#cb204-10" aria-hidden="true"></a>};</span>
<span id="cb204-11"><a href="#cb204-11" aria-hidden="true"></a></span>
<span id="cb204-12"><a href="#cb204-12" aria-hidden="true"></a><span class="kw">extern</span> <span class="dt">void</span> use_them(<span class="dt">void</span>);</span>
<span id="cb204-13"><a href="#cb204-13" aria-hidden="true"></a><span class="kw">extern</span> <span class="dt">int</span> increment(<span class="dt">void</span>);</span>
<span id="cb204-14"><a href="#cb204-14" aria-hidden="true"></a><span class="kw">extern</span> <span class="dt">int</span> oddball_value(<span class="dt">void</span>);</span>
<span id="cb204-15"><a href="#cb204-15" aria-hidden="true"></a></span>
<span id="cb204-16"><a href="#cb204-16" aria-hidden="true"></a></span>
<span id="cb204-17"><a href="#cb204-17" aria-hidden="true"></a><span class="pp">#endif </span><span class="co">/* FILE1C_H_INCLUDED */</span></span></code></pre></div>
<h5>
file2c.h
</h3>
<div class="sourceCode" id="cb205"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true"></a><span class="co">/* Standard prologue */</span></span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true"></a></span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true"></a><span class="pp">#if defined(DEFINE_VARIABLES) &amp;&amp; !defined(FILE2C_H_DEFINITIONS)</span></span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true"></a></span>
<span id="cb205-5"><a href="#cb205-5" aria-hidden="true"></a><span class="pp">#undef FILE2C_H_INCLUDED</span></span>
<span id="cb205-6"><a href="#cb205-6" aria-hidden="true"></a></span>
<span id="cb205-7"><a href="#cb205-7" aria-hidden="true"></a><span class="pp">#endif</span></span>
<span id="cb205-8"><a href="#cb205-8" aria-hidden="true"></a></span>
<span id="cb205-9"><a href="#cb205-9" aria-hidden="true"></a></span>
<span id="cb205-10"><a href="#cb205-10" aria-hidden="true"></a><span class="pp">#ifndef FILE2C_H_INCLUDED</span></span>
<span id="cb205-11"><a href="#cb205-11" aria-hidden="true"></a></span>
<span id="cb205-12"><a href="#cb205-12" aria-hidden="true"></a><span class="pp">#define FILE2C_H_INCLUDED</span></span>
<span id="cb205-13"><a href="#cb205-13" aria-hidden="true"></a></span>
<span id="cb205-14"><a href="#cb205-14" aria-hidden="true"></a></span>
<span id="cb205-15"><a href="#cb205-15" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;external.h&quot;</span><span class="pp">   </span><span class="co">/* Support macros EXTERN, INITIALIZE */</span></span>
<span id="cb205-16"><a href="#cb205-16" aria-hidden="true"></a></span>
<span id="cb205-17"><a href="#cb205-17" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;file1c.h&quot;</span><span class="pp">     </span><span class="co">/* Type definition for struct oddball */</span></span>
<span id="cb205-18"><a href="#cb205-18" aria-hidden="true"></a></span>
<span id="cb205-19"><a href="#cb205-19" aria-hidden="true"></a></span>
<span id="cb205-20"><a href="#cb205-20" aria-hidden="true"></a><span class="pp">#if !defined(DEFINE_VARIABLES) || !defined(FILE2C_H_DEFINITIONS)</span></span>
<span id="cb205-21"><a href="#cb205-21" aria-hidden="true"></a></span>
<span id="cb205-22"><a href="#cb205-22" aria-hidden="true"></a><span class="co">/* Global variable declarations / definitions */</span></span>
<span id="cb205-23"><a href="#cb205-23" aria-hidden="true"></a>EXTERN <span class="dt">int</span> global_variable INITIALIZE(<span class="dv">37</span>);</span>
<span id="cb205-24"><a href="#cb205-24" aria-hidden="true"></a>EXTERN <span class="kw">struct</span> oddball oddball_struct INITIALIZE({ <span class="dv">41</span>, <span class="dv">43</span> });</span>
<span id="cb205-25"><a href="#cb205-25" aria-hidden="true"></a></span>
<span id="cb205-26"><a href="#cb205-26" aria-hidden="true"></a></span>
<span id="cb205-27"><a href="#cb205-27" aria-hidden="true"></a><span class="pp">#endif </span><span class="co">/* !DEFINE_VARIABLES || !FILE2C_H_DEFINITIONS */</span></span>
<span id="cb205-28"><a href="#cb205-28" aria-hidden="true"></a></span>
<span id="cb205-29"><a href="#cb205-29" aria-hidden="true"></a><span class="co">/* Standard epilogue */</span></span>
<span id="cb205-30"><a href="#cb205-30" aria-hidden="true"></a></span>
<span id="cb205-31"><a href="#cb205-31" aria-hidden="true"></a><span class="pp">#ifdef DEFINE_VARIABLES</span></span>
<span id="cb205-32"><a href="#cb205-32" aria-hidden="true"></a></span>
<span id="cb205-33"><a href="#cb205-33" aria-hidden="true"></a><span class="pp">#define FILE2C_H_DEFINITIONS</span></span>
<span id="cb205-34"><a href="#cb205-34" aria-hidden="true"></a></span>
<span id="cb205-35"><a href="#cb205-35" aria-hidden="true"></a><span class="pp">#endif </span><span class="co">/* DEFINE_VARIABLES */</span></span>
<span id="cb205-36"><a href="#cb205-36" aria-hidden="true"></a></span>
<span id="cb205-37"><a href="#cb205-37" aria-hidden="true"></a></span>
<span id="cb205-38"><a href="#cb205-38" aria-hidden="true"></a><span class="pp">#endif </span><span class="co">/* FILE2C_H_INCLUDED */</span></span></code></pre></div>
<h5>
file3c.c
</h3>
<div class="sourceCode" id="cb206"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true"></a></span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true"></a><span class="pp">#define DEFINE_VARIABLES</span></span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true"></a></span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;file2c.h&quot;</span><span class="pp">  </span><span class="co">/* Variables now defined and initialized */</span></span>
<span id="cb206-5"><a href="#cb206-5" aria-hidden="true"></a></span>
<span id="cb206-6"><a href="#cb206-6" aria-hidden="true"></a><span class="dt">int</span> increment(<span class="dt">void</span>) { <span class="cf">return</span> global_variable++; }</span>
<span id="cb206-7"><a href="#cb206-7" aria-hidden="true"></a><span class="dt">int</span> oddball_value(<span class="dt">void</span>) { <span class="cf">return</span> oddball_struct.a + oddball_struct.b; }</span></code></pre></div>
<h5>
file4c.c
</h3>
<div class="sourceCode" id="cb207"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true"></a></span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;file2c.h&quot;</span></span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true"></a></span>
<span id="cb207-4"><a href="#cb207-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb207-5"><a href="#cb207-5" aria-hidden="true"></a></span>
<span id="cb207-6"><a href="#cb207-6" aria-hidden="true"></a><span class="dt">void</span> use_them(<span class="dt">void</span>)</span>
<span id="cb207-7"><a href="#cb207-7" aria-hidden="true"></a>{</span>
<span id="cb207-8"><a href="#cb207-8" aria-hidden="true"></a>    printf(<span class="st">&quot;Global variable: %d</span><span class="sc">\n</span><span class="st">&quot;</span>, global_variable++);</span>
<span id="cb207-9"><a href="#cb207-9" aria-hidden="true"></a>    oddball_struct.a += global_variable;</span>
<span id="cb207-10"><a href="#cb207-10" aria-hidden="true"></a>    oddball_struct.b -= global_variable / <span class="dv">2</span>;</span>
<span id="cb207-11"><a href="#cb207-11" aria-hidden="true"></a>}</span></code></pre></div>
<h5>
file5c.c
</h3>
<div class="sourceCode" id="cb208"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true"></a></span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;file2c.h&quot;</span><span class="pp">     </span><span class="co">/* Declare variables */</span></span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true"></a></span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true"></a></span>
<span id="cb208-5"><a href="#cb208-5" aria-hidden="true"></a><span class="pp">#define DEFINE_VARIABLES</span></span>
<span id="cb208-6"><a href="#cb208-6" aria-hidden="true"></a></span>
<span id="cb208-7"><a href="#cb208-7" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;file2c.h&quot;</span><span class="pp">  </span><span class="co">/* Variables now defined and initialized */</span></span>
<span id="cb208-8"><a href="#cb208-8" aria-hidden="true"></a></span>
<span id="cb208-9"><a href="#cb208-9" aria-hidden="true"></a><span class="dt">int</span> increment(<span class="dt">void</span>) { <span class="cf">return</span> global_variable++; }</span>
<span id="cb208-10"><a href="#cb208-10" aria-hidden="true"></a><span class="dt">int</span> oddball_value(<span class="dt">void</span>) { <span class="cf">return</span> oddball_struct.a + oddball_struct.b; }</span></code></pre></div>
<h5>
file6c.c
</h3>
<div class="sourceCode" id="cb209"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true"></a></span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true"></a><span class="pp">#define DEFINE_VARIABLES</span></span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true"></a></span>
<span id="cb209-4"><a href="#cb209-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;file2c.h&quot;</span><span class="pp">     </span><span class="co">/* Variables now defined and initialized */</span></span>
<span id="cb209-5"><a href="#cb209-5" aria-hidden="true"></a></span>
<span id="cb209-6"><a href="#cb209-6" aria-hidden="true"></a></span>
<span id="cb209-7"><a href="#cb209-7" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;file2c.h&quot;</span><span class="pp">     </span><span class="co">/* Declare variables */</span></span>
<span id="cb209-8"><a href="#cb209-8" aria-hidden="true"></a></span>
<span id="cb209-9"><a href="#cb209-9" aria-hidden="true"></a><span class="dt">int</span> increment(<span class="dt">void</span>) { <span class="cf">return</span> global_variable++; }</span>
<span id="cb209-10"><a href="#cb209-10" aria-hidden="true"></a><span class="dt">int</span> oddball_value(<span class="dt">void</span>) { <span class="cf">return</span> oddball_struct.a + oddball_struct.b; }</span></code></pre></div>
<hr>
<p><em>The next source file completes the source (provides a main program) for <code>prog5</code>, <code>prog6</code> and <code>prog7</code>:</em></p>
<h5>
prog5.c
</h3>
<div class="sourceCode" id="cb210"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true"></a></span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;file2c.h&quot;</span></span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true"></a></span>
<span id="cb210-4"><a href="#cb210-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb210-5"><a href="#cb210-5" aria-hidden="true"></a></span>
<span id="cb210-6"><a href="#cb210-6" aria-hidden="true"></a><span class="dt">int</span> main(<span class="dt">void</span>)</span>
<span id="cb210-7"><a href="#cb210-7" aria-hidden="true"></a>{</span>
<span id="cb210-8"><a href="#cb210-8" aria-hidden="true"></a>    use_them();</span>
<span id="cb210-9"><a href="#cb210-9" aria-hidden="true"></a>    global_variable += <span class="dv">19</span>;</span>
<span id="cb210-10"><a href="#cb210-10" aria-hidden="true"></a>    use_them();</span>
<span id="cb210-11"><a href="#cb210-11" aria-hidden="true"></a>    printf(<span class="st">&quot;Increment: %d</span><span class="sc">\n</span><span class="st">&quot;</span>, increment());</span>
<span id="cb210-12"><a href="#cb210-12" aria-hidden="true"></a>    printf(<span class="st">&quot;Oddball:   %d</span><span class="sc">\n</span><span class="st">&quot;</span>, oddball_value());</span>
<span id="cb210-13"><a href="#cb210-13" aria-hidden="true"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb210-14"><a href="#cb210-14" aria-hidden="true"></a>}</span></code></pre></div>
<ul>
<li>
<code>prog5</code> uses <code>prog5.c</code>, <code>file3c.c</code>, <code>file4c.c</code>, <code>file1c.h</code>, <code>file2c.h</code>, <code>external.h</code>.
</li>
<li>
<code>prog6</code> uses <code>prog5.c</code>, <code>file5c.c</code>, <code>file4c.c</code>, <code>file1c.h</code>, <code>file2c.h</code>, <code>external.h</code>.
</li>
<li>
<code>prog7</code> uses <code>prog5.c</code>, <code>file6c.c</code>, <code>file4c.c</code>, <code>file1c.h</code>, <code>file2c.h</code>, <code>external.h</code>.
</li>
</ul>
<hr>
<p>
This scheme avoids most problems. You only run into a problem if a header that defines variables (such as <code>file2c.h</code>) is included by another header (say <code>file7c.h</code>) that defines variables. There isn’t an easy way around that other than “don’t do it”.
</p>
<p>
You can partially work around the problem by revising <code>file2c.h</code> into <code>file2d.h</code>:
</p>
<h5>
file2d.h
</h3>
<div class="sourceCode" id="cb211"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true"></a><span class="co">/* Standard prologue */</span></span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true"></a></span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true"></a><span class="pp">#if defined(DEFINE_VARIABLES) &amp;&amp; !defined(FILE2D_H_DEFINITIONS)</span></span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true"></a></span>
<span id="cb211-5"><a href="#cb211-5" aria-hidden="true"></a><span class="pp">#undef FILE2D_H_INCLUDED</span></span>
<span id="cb211-6"><a href="#cb211-6" aria-hidden="true"></a></span>
<span id="cb211-7"><a href="#cb211-7" aria-hidden="true"></a><span class="pp">#endif</span></span>
<span id="cb211-8"><a href="#cb211-8" aria-hidden="true"></a></span>
<span id="cb211-9"><a href="#cb211-9" aria-hidden="true"></a></span>
<span id="cb211-10"><a href="#cb211-10" aria-hidden="true"></a><span class="pp">#ifndef FILE2D_H_INCLUDED</span></span>
<span id="cb211-11"><a href="#cb211-11" aria-hidden="true"></a></span>
<span id="cb211-12"><a href="#cb211-12" aria-hidden="true"></a><span class="pp">#define FILE2D_H_INCLUDED</span></span>
<span id="cb211-13"><a href="#cb211-13" aria-hidden="true"></a></span>
<span id="cb211-14"><a href="#cb211-14" aria-hidden="true"></a></span>
<span id="cb211-15"><a href="#cb211-15" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;external.h&quot;</span><span class="pp">   </span><span class="co">/* Support macros EXTERN, INITIALIZE */</span></span>
<span id="cb211-16"><a href="#cb211-16" aria-hidden="true"></a></span>
<span id="cb211-17"><a href="#cb211-17" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;file1c.h&quot;</span><span class="pp">     </span><span class="co">/* Type definition for struct oddball */</span></span>
<span id="cb211-18"><a href="#cb211-18" aria-hidden="true"></a></span>
<span id="cb211-19"><a href="#cb211-19" aria-hidden="true"></a></span>
<span id="cb211-20"><a href="#cb211-20" aria-hidden="true"></a><span class="pp">#if !defined(DEFINE_VARIABLES) || !defined(FILE2D_H_DEFINITIONS)</span></span>
<span id="cb211-21"><a href="#cb211-21" aria-hidden="true"></a></span>
<span id="cb211-22"><a href="#cb211-22" aria-hidden="true"></a><span class="co">/* Global variable declarations / definitions */</span></span>
<span id="cb211-23"><a href="#cb211-23" aria-hidden="true"></a>EXTERN <span class="dt">int</span> global_variable INITIALIZE(<span class="dv">37</span>);</span>
<span id="cb211-24"><a href="#cb211-24" aria-hidden="true"></a>EXTERN <span class="kw">struct</span> oddball oddball_struct INITIALIZE({ <span class="dv">41</span>, <span class="dv">43</span> });</span>
<span id="cb211-25"><a href="#cb211-25" aria-hidden="true"></a></span>
<span id="cb211-26"><a href="#cb211-26" aria-hidden="true"></a></span>
<span id="cb211-27"><a href="#cb211-27" aria-hidden="true"></a><span class="pp">#endif </span><span class="co">/* !DEFINE_VARIABLES || !FILE2D_H_DEFINITIONS */</span></span>
<span id="cb211-28"><a href="#cb211-28" aria-hidden="true"></a></span>
<span id="cb211-29"><a href="#cb211-29" aria-hidden="true"></a><span class="co">/* Standard epilogue */</span></span>
<span id="cb211-30"><a href="#cb211-30" aria-hidden="true"></a></span>
<span id="cb211-31"><a href="#cb211-31" aria-hidden="true"></a><span class="pp">#ifdef DEFINE_VARIABLES</span></span>
<span id="cb211-32"><a href="#cb211-32" aria-hidden="true"></a></span>
<span id="cb211-33"><a href="#cb211-33" aria-hidden="true"></a><span class="pp">#define FILE2D_H_DEFINITIONS</span></span>
<span id="cb211-34"><a href="#cb211-34" aria-hidden="true"></a></span>
<span id="cb211-35"><a href="#cb211-35" aria-hidden="true"></a><span class="pp">#undef DEFINE_VARIABLES</span></span>
<span id="cb211-36"><a href="#cb211-36" aria-hidden="true"></a></span>
<span id="cb211-37"><a href="#cb211-37" aria-hidden="true"></a><span class="pp">#endif </span><span class="co">/* DEFINE_VARIABLES */</span></span>
<span id="cb211-38"><a href="#cb211-38" aria-hidden="true"></a></span>
<span id="cb211-39"><a href="#cb211-39" aria-hidden="true"></a></span>
<span id="cb211-40"><a href="#cb211-40" aria-hidden="true"></a><span class="pp">#endif </span><span class="co">/* FILE2D_H_INCLUDED */</span></span></code></pre></div>
<p>
The issue becomes ‘should the header include <code>#undef DEFINE_VARIABLES</code>?’ If you omit that from the header and wrap any defining invocation with <code>#define</code> and <code>#undef</code>:
</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true"></a></span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true"></a><span class="pp">#define DEFINE_VARIABLES</span></span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true"></a></span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;file2c.h&quot;</span></span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true"></a></span>
<span id="cb212-6"><a href="#cb212-6" aria-hidden="true"></a><span class="pp">#undef DEFINE_VARIABLES</span></span></code></pre></div>
<p>
in the source code (so the headers never alter the value of <code>DEFINE_VARIABLES</code>), then you should be clean. It is just a nuisance to have to remember to write the the extra line. An alternative might be:
</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true"></a></span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true"></a><span class="pp">#define HEADER_DEFINING_VARIABLES &quot;file2c.h&quot;</span></span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true"></a></span>
<span id="cb213-4"><a href="#cb213-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;externdef.h&quot;</span></span></code></pre></div>
<h5>
externdef.h
</h3>
<div class="sourceCode" id="cb214"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true"></a><span class="co">/*</span></span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true"></a><span class="co">** This header must not contain header guards (like &lt;assert.h&gt; must not).</span></span>
<span id="cb214-3"><a href="#cb214-3" aria-hidden="true"></a><span class="co">** Each time it is included, the macro HEADER_DEFINING_VARIABLES should</span></span>
<span id="cb214-4"><a href="#cb214-4" aria-hidden="true"></a><span class="co">** be defined with the name (in quotes - or possibly angle brackets) of</span></span>
<span id="cb214-5"><a href="#cb214-5" aria-hidden="true"></a><span class="co">** the header to be included that defines variables when the macro</span></span>
<span id="cb214-6"><a href="#cb214-6" aria-hidden="true"></a><span class="co">** DEFINE_VARIABLES is defined.  See also: external.h (which uses</span></span>
<span id="cb214-7"><a href="#cb214-7" aria-hidden="true"></a><span class="co">** DEFINE_VARIABLES and defines macros EXTERN and INITIALIZE</span></span>
<span id="cb214-8"><a href="#cb214-8" aria-hidden="true"></a><span class="co">** appropriately).</span></span>
<span id="cb214-9"><a href="#cb214-9" aria-hidden="true"></a><span class="co">**</span></span>
<span id="cb214-10"><a href="#cb214-10" aria-hidden="true"></a><span class="co">**</span></span>
<span id="cb214-11"><a href="#cb214-11" aria-hidden="true"></a><span class="co">#define HEADER_DEFINING_VARIABLES &quot;file2c.h&quot;</span></span>
<span id="cb214-12"><a href="#cb214-12" aria-hidden="true"></a><span class="co">**</span></span>
<span id="cb214-13"><a href="#cb214-13" aria-hidden="true"></a><span class="co">#include &quot;externdef.h&quot;</span></span>
<span id="cb214-14"><a href="#cb214-14" aria-hidden="true"></a><span class="co">*/</span></span>
<span id="cb214-15"><a href="#cb214-15" aria-hidden="true"></a></span>
<span id="cb214-16"><a href="#cb214-16" aria-hidden="true"></a></span>
<span id="cb214-17"><a href="#cb214-17" aria-hidden="true"></a><span class="pp">#if defined(HEADER_DEFINING_VARIABLES)</span></span>
<span id="cb214-18"><a href="#cb214-18" aria-hidden="true"></a></span>
<span id="cb214-19"><a href="#cb214-19" aria-hidden="true"></a><span class="pp">#define DEFINE_VARIABLES</span></span>
<span id="cb214-20"><a href="#cb214-20" aria-hidden="true"></a></span>
<span id="cb214-21"><a href="#cb214-21" aria-hidden="true"></a><span class="pp">#include HEADER_DEFINING_VARIABLES</span></span>
<span id="cb214-22"><a href="#cb214-22" aria-hidden="true"></a></span>
<span id="cb214-23"><a href="#cb214-23" aria-hidden="true"></a><span class="pp">#undef DEFINE_VARIABLES</span></span>
<span id="cb214-24"><a href="#cb214-24" aria-hidden="true"></a></span>
<span id="cb214-25"><a href="#cb214-25" aria-hidden="true"></a><span class="pp">#undef HEADER_DEFINING_VARIABLES</span></span>
<span id="cb214-26"><a href="#cb214-26" aria-hidden="true"></a></span>
<span id="cb214-27"><a href="#cb214-27" aria-hidden="true"></a><span class="pp">#endif </span><span class="co">/* HEADER_DEFINING_VARIABLES */</span></span></code></pre></div>
<p>
This is getting a tad convoluted, but seems to be secure (using the <code>file2d.h</code>, with no <code>#undef DEFINE_VARIABLES</code> in the <code>file2d.h</code>).
</p>
<h5>
file7c.c
</h3>
<div class="sourceCode" id="cb215"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true"></a><span class="co">/* Declare variables */</span></span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true"></a></span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;file2d.h&quot;</span></span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true"></a></span>
<span id="cb215-5"><a href="#cb215-5" aria-hidden="true"></a><span class="co">/* Define variables */</span></span>
<span id="cb215-6"><a href="#cb215-6" aria-hidden="true"></a></span>
<span id="cb215-7"><a href="#cb215-7" aria-hidden="true"></a><span class="pp">#define HEADER_DEFINING_VARIABLES &quot;file2d.h&quot;</span></span>
<span id="cb215-8"><a href="#cb215-8" aria-hidden="true"></a></span>
<span id="cb215-9"><a href="#cb215-9" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;externdef.h&quot;</span></span>
<span id="cb215-10"><a href="#cb215-10" aria-hidden="true"></a></span>
<span id="cb215-11"><a href="#cb215-11" aria-hidden="true"></a><span class="co">/* Declare variables - again */</span></span>
<span id="cb215-12"><a href="#cb215-12" aria-hidden="true"></a></span>
<span id="cb215-13"><a href="#cb215-13" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;file2d.h&quot;</span></span>
<span id="cb215-14"><a href="#cb215-14" aria-hidden="true"></a></span>
<span id="cb215-15"><a href="#cb215-15" aria-hidden="true"></a><span class="co">/* Define variables - again */</span></span>
<span id="cb215-16"><a href="#cb215-16" aria-hidden="true"></a></span>
<span id="cb215-17"><a href="#cb215-17" aria-hidden="true"></a><span class="pp">#define HEADER_DEFINING_VARIABLES &quot;file2d.h&quot;</span></span>
<span id="cb215-18"><a href="#cb215-18" aria-hidden="true"></a></span>
<span id="cb215-19"><a href="#cb215-19" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;externdef.h&quot;</span></span>
<span id="cb215-20"><a href="#cb215-20" aria-hidden="true"></a></span>
<span id="cb215-21"><a href="#cb215-21" aria-hidden="true"></a><span class="dt">int</span> increment(<span class="dt">void</span>) { <span class="cf">return</span> global_variable++; }</span>
<span id="cb215-22"><a href="#cb215-22" aria-hidden="true"></a><span class="dt">int</span> oddball_value(<span class="dt">void</span>) { <span class="cf">return</span> oddball_struct.a + oddball_struct.b; }</span></code></pre></div>
<h5>
file8c.h
</h3>
<div class="sourceCode" id="cb216"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true"></a><span class="co">/* Standard prologue */</span></span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true"></a></span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true"></a><span class="pp">#if defined(DEFINE_VARIABLES) &amp;&amp; !defined(FILE8C_H_DEFINITIONS)</span></span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true"></a></span>
<span id="cb216-5"><a href="#cb216-5" aria-hidden="true"></a><span class="pp">#undef FILE8C_H_INCLUDED</span></span>
<span id="cb216-6"><a href="#cb216-6" aria-hidden="true"></a></span>
<span id="cb216-7"><a href="#cb216-7" aria-hidden="true"></a><span class="pp">#endif</span></span>
<span id="cb216-8"><a href="#cb216-8" aria-hidden="true"></a></span>
<span id="cb216-9"><a href="#cb216-9" aria-hidden="true"></a></span>
<span id="cb216-10"><a href="#cb216-10" aria-hidden="true"></a><span class="pp">#ifndef FILE8C_H_INCLUDED</span></span>
<span id="cb216-11"><a href="#cb216-11" aria-hidden="true"></a></span>
<span id="cb216-12"><a href="#cb216-12" aria-hidden="true"></a><span class="pp">#define FILE8C_H_INCLUDED</span></span>
<span id="cb216-13"><a href="#cb216-13" aria-hidden="true"></a></span>
<span id="cb216-14"><a href="#cb216-14" aria-hidden="true"></a></span>
<span id="cb216-15"><a href="#cb216-15" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;external.h&quot;</span><span class="pp">   </span><span class="co">/* Support macros EXTERN, INITIALIZE */</span></span>
<span id="cb216-16"><a href="#cb216-16" aria-hidden="true"></a></span>
<span id="cb216-17"><a href="#cb216-17" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;file2d.h&quot;</span><span class="pp">     </span><span class="co">/* struct oddball */</span></span>
<span id="cb216-18"><a href="#cb216-18" aria-hidden="true"></a></span>
<span id="cb216-19"><a href="#cb216-19" aria-hidden="true"></a></span>
<span id="cb216-20"><a href="#cb216-20" aria-hidden="true"></a><span class="pp">#if !defined(DEFINE_VARIABLES) || !defined(FILE8C_H_DEFINITIONS)</span></span>
<span id="cb216-21"><a href="#cb216-21" aria-hidden="true"></a></span>
<span id="cb216-22"><a href="#cb216-22" aria-hidden="true"></a><span class="co">/* Global variable declarations / definitions */</span></span>
<span id="cb216-23"><a href="#cb216-23" aria-hidden="true"></a>EXTERN <span class="kw">struct</span> oddball another INITIALIZE({ <span class="dv">14</span>, <span class="dv">34</span> });</span>
<span id="cb216-24"><a href="#cb216-24" aria-hidden="true"></a></span>
<span id="cb216-25"><a href="#cb216-25" aria-hidden="true"></a></span>
<span id="cb216-26"><a href="#cb216-26" aria-hidden="true"></a><span class="pp">#endif </span><span class="co">/* !DEFINE_VARIABLES || !FILE8C_H_DEFINITIONS */</span></span>
<span id="cb216-27"><a href="#cb216-27" aria-hidden="true"></a></span>
<span id="cb216-28"><a href="#cb216-28" aria-hidden="true"></a><span class="co">/* Standard epilogue */</span></span>
<span id="cb216-29"><a href="#cb216-29" aria-hidden="true"></a></span>
<span id="cb216-30"><a href="#cb216-30" aria-hidden="true"></a><span class="pp">#ifdef DEFINE_VARIABLES</span></span>
<span id="cb216-31"><a href="#cb216-31" aria-hidden="true"></a></span>
<span id="cb216-32"><a href="#cb216-32" aria-hidden="true"></a><span class="pp">#define FILE8C_H_DEFINITIONS</span></span>
<span id="cb216-33"><a href="#cb216-33" aria-hidden="true"></a></span>
<span id="cb216-34"><a href="#cb216-34" aria-hidden="true"></a><span class="pp">#endif </span><span class="co">/* DEFINE_VARIABLES */</span></span>
<span id="cb216-35"><a href="#cb216-35" aria-hidden="true"></a></span>
<span id="cb216-36"><a href="#cb216-36" aria-hidden="true"></a></span>
<span id="cb216-37"><a href="#cb216-37" aria-hidden="true"></a><span class="pp">#endif </span><span class="co">/* FILE8C_H_INCLUDED */</span></span></code></pre></div>
<h5>
file8c.c
</h3>
<div class="sourceCode" id="cb217"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true"></a><span class="co">/* Define variables */</span></span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true"></a></span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true"></a><span class="pp">#define HEADER_DEFINING_VARIABLES &quot;file2d.h&quot;</span></span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true"></a></span>
<span id="cb217-5"><a href="#cb217-5" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;externdef.h&quot;</span></span>
<span id="cb217-6"><a href="#cb217-6" aria-hidden="true"></a></span>
<span id="cb217-7"><a href="#cb217-7" aria-hidden="true"></a><span class="co">/* Define variables */</span></span>
<span id="cb217-8"><a href="#cb217-8" aria-hidden="true"></a></span>
<span id="cb217-9"><a href="#cb217-9" aria-hidden="true"></a><span class="pp">#define HEADER_DEFINING_VARIABLES &quot;file8c.h&quot;</span></span>
<span id="cb217-10"><a href="#cb217-10" aria-hidden="true"></a></span>
<span id="cb217-11"><a href="#cb217-11" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;externdef.h&quot;</span></span>
<span id="cb217-12"><a href="#cb217-12" aria-hidden="true"></a></span>
<span id="cb217-13"><a href="#cb217-13" aria-hidden="true"></a><span class="dt">int</span> increment(<span class="dt">void</span>) { <span class="cf">return</span> global_variable++; }</span>
<span id="cb217-14"><a href="#cb217-14" aria-hidden="true"></a><span class="dt">int</span> oddball_value(<span class="dt">void</span>) { <span class="cf">return</span> oddball_struct.a + oddball_struct.b; }</span></code></pre></div>
<hr>
<p><em>The next two files complete the source for <code>prog8</code> and <code>prog9</code>:</em></p>
<h5>
prog8.c
</h3>
<div class="sourceCode" id="cb218"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true"></a></span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;file2d.h&quot;</span></span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true"></a></span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb218-5"><a href="#cb218-5" aria-hidden="true"></a></span>
<span id="cb218-6"><a href="#cb218-6" aria-hidden="true"></a><span class="dt">int</span> main(<span class="dt">void</span>)</span>
<span id="cb218-7"><a href="#cb218-7" aria-hidden="true"></a>{</span>
<span id="cb218-8"><a href="#cb218-8" aria-hidden="true"></a>    use_them();</span>
<span id="cb218-9"><a href="#cb218-9" aria-hidden="true"></a>    global_variable += <span class="dv">19</span>;</span>
<span id="cb218-10"><a href="#cb218-10" aria-hidden="true"></a>    use_them();</span>
<span id="cb218-11"><a href="#cb218-11" aria-hidden="true"></a>    printf(<span class="st">&quot;Increment: %d</span><span class="sc">\n</span><span class="st">&quot;</span>, increment());</span>
<span id="cb218-12"><a href="#cb218-12" aria-hidden="true"></a>    printf(<span class="st">&quot;Oddball:   %d</span><span class="sc">\n</span><span class="st">&quot;</span>, oddball_value());</span>
<span id="cb218-13"><a href="#cb218-13" aria-hidden="true"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb218-14"><a href="#cb218-14" aria-hidden="true"></a>}</span></code></pre></div>
<h5>
file9c.c
</h3>
<div class="sourceCode" id="cb219"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true"></a></span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;file2d.h&quot;</span></span>
<span id="cb219-3"><a href="#cb219-3" aria-hidden="true"></a></span>
<span id="cb219-4"><a href="#cb219-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb219-5"><a href="#cb219-5" aria-hidden="true"></a></span>
<span id="cb219-6"><a href="#cb219-6" aria-hidden="true"></a><span class="dt">void</span> use_them(<span class="dt">void</span>)</span>
<span id="cb219-7"><a href="#cb219-7" aria-hidden="true"></a>{</span>
<span id="cb219-8"><a href="#cb219-8" aria-hidden="true"></a>    printf(<span class="st">&quot;Global variable: %d</span><span class="sc">\n</span><span class="st">&quot;</span>, global_variable++);</span>
<span id="cb219-9"><a href="#cb219-9" aria-hidden="true"></a>    oddball_struct.a += global_variable;</span>
<span id="cb219-10"><a href="#cb219-10" aria-hidden="true"></a>    oddball_struct.b -= global_variable / <span class="dv">2</span>;</span>
<span id="cb219-11"><a href="#cb219-11" aria-hidden="true"></a>}</span></code></pre></div>
<ul>
<li>
<code>prog8</code> uses <code>prog8.c</code>, <code>file7c.c</code>, <code>file9c.c</code>.
</li>
<li>
<code>prog9</code> uses <code>prog8.c</code>, <code>file8c.c</code>, <code>file9c.c</code>.
</li>
</ul>
<hr>
<p>
However, the problems are relatively unlikely to occur in practice, especially if you take the standard advice to
</p>
<h5>
Avoid global variables
</h1>
<hr>
<p>Does this exposition miss anything?</p>
<p>
<em>Confession</em>: The ‘avoiding duplicated code’ scheme outlined here was developed because the issue affects some code I work on (but don’t own), and is a niggling concern with the scheme outlined in the first part of the answer. However, the original scheme leaves you with just two places to modify to keep variable definitions and declarations synchronized, which is a big step forward over having exernal variable declarations scattered throughout the code base (which really matters when there are thousands of files in total). However, the code in the files with the names <code>fileNc.[ch]</code> (plus <code>external.h</code> and <code>externdef.h</code>) shows that it can be made to work. Clearly, it would not be hard to create a header generator script to give you the standardized template for a variable defining and declaring header file.
</p>
<p>
<em>NB</em> These are toy programs with just barely enough code to make them marginally interesting. There is repetition within the examples that could be removed, but isn’t to simplify the pedagogical explanation. (For example: the difference between <code>prog5.c</code> and <code>prog8.c</code> is the name of one of the headers that are included. It would be possible to reorganize the code so that the <code>main()</code> function was not repeated, but it would conceal more than it revealed.)
</p>
</section>
<section id="answer-3-score-122" class="level4">
<h4>Answer 3 (score 122)</h4>
<p>An <code>extern</code> variable is a declaration (thanks to sbi for the correction) of a variable which is defined in another translation unit. That means the storage for the variable is allocated in another file.</p>
<p>Say you have two <code>.c</code>-files <code>test1.c</code> and <code>test2.c</code>. If you define a global variable <code>int test1_var;</code> in <code>test1.c</code> and you’d like to access this variable in <code>test2.c</code> you have to use <code>extern int test1_var;</code> in <code>test2.c</code>.</p>
<p>Complete sample:</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true"></a>$ cat test1.c </span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true"></a><span class="dt">int</span> test1_var = <span class="dv">5</span>;</span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true"></a>$ cat test2.c</span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true"></a></span>
<span id="cb220-5"><a href="#cb220-5" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb220-6"><a href="#cb220-6" aria-hidden="true"></a></span>
<span id="cb220-7"><a href="#cb220-7" aria-hidden="true"></a><span class="kw">extern</span> <span class="dt">int</span> test1_var;</span>
<span id="cb220-8"><a href="#cb220-8" aria-hidden="true"></a></span>
<span id="cb220-9"><a href="#cb220-9" aria-hidden="true"></a><span class="dt">int</span> main(<span class="dt">void</span>) {</span>
<span id="cb220-10"><a href="#cb220-10" aria-hidden="true"></a>    printf(<span class="st">&quot;test1_var = %d</span><span class="sc">\n</span><span class="st">&quot;</span>, test1_var);</span>
<span id="cb220-11"><a href="#cb220-11" aria-hidden="true"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb220-12"><a href="#cb220-12" aria-hidden="true"></a>}</span>
<span id="cb220-13"><a href="#cb220-13" aria-hidden="true"></a>$ gcc test1.c test2.c -o test</span>
<span id="cb220-14"><a href="#cb220-14" aria-hidden="true"></a>$ ./test</span>
<span id="cb220-15"><a href="#cb220-15" aria-hidden="true"></a>test1_var = <span class="dv">5</span></span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="min-and-max-in-c-score-655315-in-2015" class="level3">
<h3>28: MIN and MAX in C (score <a href="https://stackoverflow.com/q/3437404.html">655315</a> in 2015)</h3>
<section id="question-27" class="level4">
<h4>Question</h4>
<p>Where are <code>MIN</code> and <code>MAX</code> defined in C, if at all?</p>
<p>What is the best way to implement these, as generically and type safely as possible? (Compiler extensions/builtins for mainstream compilers preferred.)</p>
</section>
<section id="answer-accepted-score-348" class="level4">
<h4>Answer accepted (score 348)</h4>
<blockquote>
Where are <code>MIN</code> and <code>MAX</code> defined in C, if at all?
</blockquote>
<p>They aren’t.</p>
<blockquote>
What is the best way to implement these, as generically and type safe as possible (compiler extensions/builtins for mainstream compilers preferred).
</blockquote>
<p>As functions. I wouldn’t use macros like <code>#define MIN(X, Y) (((X) &amp;lt; (Y)) ? (X) : (Y))</code>, especially if you plan to deploy your code. Either write your own, use something like standard <a href="http://en.cppreference.com/w/c/numeric/math/fmax" rel="noreferrer"><code>fmax</code></a> or <a href="http://en.cppreference.com/w/c/numeric/math/fmin" rel="noreferrer"><code>fmin</code></a>, or fix the macro using <a href="http://gcc.gnu.org/onlinedocs/gcc-4.9.2/gcc/Typeof.html#Typeof" rel="noreferrer">GCC’s typeof</a> (you get typesafety bonus too):</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true"></a></span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true"></a><span class="pp">#define max(a,b) \</span></span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true"></a><span class="pp">   ({ __typeof__ (a) _a = (a); \</span></span>
<span id="cb221-4"><a href="#cb221-4" aria-hidden="true"></a><span class="pp">       __typeof__ (b) _b = (b); \</span></span>
<span id="cb221-5"><a href="#cb221-5" aria-hidden="true"></a><span class="pp">     _a &gt; _b ? _a : _b; })</span></span></code></pre></div>
<p>Everyone says “oh I know about double evaluation, it’s no problem” and a few months down the road, you’ll be debugging the silliest problems for hours on end.</p>
<p>Note the use of <code>__typeof__</code> instead of <code>typeof</code>:</p>
<blockquote>
<p>
If you are writing a header file that must work when included in ISO C programs, write <code>__typeof__</code> instead of <code>typeof</code>.
</p>
</blockquote>
</section>
<section id="answer-2-score-84-1" class="level4">
<h4>Answer 2 (score 84)</h4>
<p>It’s also provided in the GNU libc (Linux) and FreeBSD versions of sys/param.h, and has the definition provided by dreamlax.</p>
<hr>
<p>On Debian:</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true"></a>$ uname -sr</span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true"></a>Linux <span class="fl">2.6</span><span class="er">.11</span></span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true"></a></span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true"></a>$ cat /etc/debian_version</span>
<span id="cb222-5"><a href="#cb222-5" aria-hidden="true"></a><span class="fl">5.0</span><span class="er">.2</span></span>
<span id="cb222-6"><a href="#cb222-6" aria-hidden="true"></a></span>
<span id="cb222-7"><a href="#cb222-7" aria-hidden="true"></a>$ egrep &#39;MIN\(|MAX\(&#39; /usr/include/sys/param.h</span>
<span id="cb222-8"><a href="#cb222-8" aria-hidden="true"></a></span>
<span id="cb222-9"><a href="#cb222-9" aria-hidden="true"></a><span class="pp">#define MIN(a,b) (((a)&lt;(b))?(a):(b))</span></span>
<span id="cb222-10"><a href="#cb222-10" aria-hidden="true"></a></span>
<span id="cb222-11"><a href="#cb222-11" aria-hidden="true"></a><span class="pp">#define MAX(a,b) (((a)&gt;(b))?(a):(b))</span></span>
<span id="cb222-12"><a href="#cb222-12" aria-hidden="true"></a></span>
<span id="cb222-13"><a href="#cb222-13" aria-hidden="true"></a>$ head -n <span class="dv">2</span> /usr/include/sys/param.h | grep GNU</span>
<span id="cb222-14"><a href="#cb222-14" aria-hidden="true"></a>This file is part of the GNU C Library.</span></code></pre></div>
<p>On FreeBSD:</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true"></a>$ uname -sr</span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true"></a>FreeBSD <span class="fl">5.5</span>-STABLE</span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true"></a></span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true"></a>$ egrep &#39;MIN\(|MAX\(&#39; /usr/include/sys/param.h</span>
<span id="cb223-5"><a href="#cb223-5" aria-hidden="true"></a></span>
<span id="cb223-6"><a href="#cb223-6" aria-hidden="true"></a><span class="pp">#define MIN(a,b) (((a)&lt;(b))?(a):(b))</span></span>
<span id="cb223-7"><a href="#cb223-7" aria-hidden="true"></a></span>
<span id="cb223-8"><a href="#cb223-8" aria-hidden="true"></a><span class="pp">#define MAX(a,b) (((a)&gt;(b))?(a):(b))</span></span></code></pre></div>
<hr>
<p>The source repositories are here:</p>
<ul>
<li>
<a href="http://sources.redhat.com/git/gitweb.cgi?p=glibc.git;a=blob;f=sysdeps/unix/sysv/linux/sys/param.h" rel="noreferrer">GNU C Library</a>
</li>
<li>
<a href="http://www.freebsd.org/cgi/cvsweb.cgi/src/sys/sys/param.h?rev=1.455;content-type=text/plain" rel="noreferrer">FreeBSD</a>
</li>
</ul>
</section>
<section id="answer-3-score-69-1" class="level4">
<h4>Answer 3 (score 69)</h4>
<p>There’s a <code>std::min</code> and <code>std::max</code> in C++, but AFAIK, there’s no equivalent in the C standard library. You can define them yourself with macros like</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true"></a></span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true"></a><span class="pp">#define MAX(x, y) (((x) &gt; (y)) ? (x) : (y))</span></span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true"></a></span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true"></a><span class="pp">#define MIN(x, y) (((x) &lt; (y)) ? (x) : (y))</span></span></code></pre></div>
<p>But this causes problems if you write something like <code>MAX(++a, ++b)</code>.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="typedef-struct-vs-struct-definitions-score-645139-in-2018" class="level3">
<h3>29: typedef struct vs struct definitions (score <a href="https://stackoverflow.com/q/1675351.html">645139</a> in 2018)</h3>
<section id="question-28" class="level4">
<h4>Question</h4>
<p>I’m a beginner in C programming, but I was wondering what’s the difference between using <code>typedef</code> when defining a structure versus not using <code>typedef</code>. It seems to me like there’s really no difference, they accomplish the same goal.</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true"></a><span class="kw">struct</span> myStruct{</span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true"></a>    <span class="dt">int</span> one;</span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true"></a>    <span class="dt">int</span> two;</span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true"></a>};</span></code></pre></div>
<p>vs. </p>
<div class="sourceCode" id="cb226"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true"></a><span class="kw">typedef</span> <span class="kw">struct</span>{</span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true"></a>    <span class="dt">int</span> one;</span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true"></a>    <span class="dt">int</span> two;</span>
<span id="cb226-4"><a href="#cb226-4" aria-hidden="true"></a>}myStruct;</span></code></pre></div>
</section>
<section id="answer-accepted-score-942" class="level4">
<h4>Answer accepted (score 942)</h4>
<p>The common idiom is using both:</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true"></a><span class="kw">typedef</span> <span class="kw">struct</span> X { </span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true"></a>    <span class="dt">int</span> x; </span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true"></a>} X;</span></code></pre></div>
<p>They are different definitions. To make the discussion clearer I will split the sentence:</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true"></a><span class="kw">struct</span> S { </span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true"></a>    <span class="dt">int</span> x; </span>
<span id="cb228-3"><a href="#cb228-3" aria-hidden="true"></a>};</span>
<span id="cb228-4"><a href="#cb228-4" aria-hidden="true"></a></span>
<span id="cb228-5"><a href="#cb228-5" aria-hidden="true"></a><span class="kw">typedef</span> <span class="kw">struct</span> S S;</span></code></pre></div>
<p>In the first line you are defining the identifier <code>S</code> within the struct name space (not in the C++ sense). You can use it and define variables or function arguments of the newly defined type by defining the type of the argument as <code>struct S</code>:</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true"></a><span class="dt">void</span> f( <span class="kw">struct</span> S argument ); <span class="co">// struct is required here</span></span></code></pre></div>
<p>The second line adds a type alias <code>S</code> in the global name space and thus allows you to just write:</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true"></a><span class="dt">void</span> f( S argument ); <span class="co">// struct keyword no longer needed</span></span></code></pre></div>
<p>Note that since both identifier name spaces are different, defining <code>S</code> both in the structs and global spaces is not an error, as it is not redefining the same identifier, but rather creating a different identifier in a different place.</p>
<p>To make the difference clearer:</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true"></a><span class="kw">typedef</span> <span class="kw">struct</span> S { </span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true"></a>    <span class="dt">int</span> x; </span>
<span id="cb231-3"><a href="#cb231-3" aria-hidden="true"></a>} T;</span>
<span id="cb231-4"><a href="#cb231-4" aria-hidden="true"></a></span>
<span id="cb231-5"><a href="#cb231-5" aria-hidden="true"></a><span class="dt">void</span> S() { } <span class="co">// correct</span></span>
<span id="cb231-6"><a href="#cb231-6" aria-hidden="true"></a></span>
<span id="cb231-7"><a href="#cb231-7" aria-hidden="true"></a><span class="co">//void T() {} // error: symbol T already defined as an alias to &#39;struct S&#39;</span></span></code></pre></div>
<p>You can define a function with the same name of the struct as the identifiers are kept in different spaces, but you cannot define a function with the same name as a <code>typedef</code> as those identifiers collide.</p>
<p>In C++, it is slightly different as the rules to locate a symbol have changed subtly. C++ still keeps the two different identifier spaces, but unlike in C, when you only define the symbol within the class identifier space, you are not required to provide the struct/class keyword:</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true"></a> <span class="co">// C++</span></span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true"></a><span class="kw">struct</span> S { </span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true"></a>    <span class="dt">int</span> x; </span>
<span id="cb232-4"><a href="#cb232-4" aria-hidden="true"></a>}; <span class="co">// S defined as a class</span></span>
<span id="cb232-5"><a href="#cb232-5" aria-hidden="true"></a></span>
<span id="cb232-6"><a href="#cb232-6" aria-hidden="true"></a><span class="dt">void</span> f( S a ); <span class="co">// correct: struct is optional</span></span></code></pre></div>
<p>What changes are the search rules, not where the identifiers are defined. The compiler will search the global identifier table and after <code>S</code> has not been found it will search for <code>S</code> within the class identifiers.</p>
<p>The code presented before behaves in the same way:</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true"></a><span class="kw">typedef</span> <span class="kw">struct</span> S { </span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true"></a>    <span class="dt">int</span> x; </span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true"></a>} T;</span>
<span id="cb233-4"><a href="#cb233-4" aria-hidden="true"></a></span>
<span id="cb233-5"><a href="#cb233-5" aria-hidden="true"></a><span class="dt">void</span> S() {} <span class="co">// correct [*]</span></span>
<span id="cb233-6"><a href="#cb233-6" aria-hidden="true"></a></span>
<span id="cb233-7"><a href="#cb233-7" aria-hidden="true"></a><span class="co">//void T() {} // error: symbol T already defined as an alias to &#39;struct S&#39;</span></span></code></pre></div>
<p>After the definition of the <code>S</code> function in the second line, the struct S cannot be resolved automatically by the compiler, and to create an object or define an argument of that type you must fall back to including the <code>struct</code> keyword:</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true"></a><span class="co">// previous code here...</span></span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true"></a><span class="dt">int</span> main() {</span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true"></a>    S(); </span>
<span id="cb234-4"><a href="#cb234-4" aria-hidden="true"></a>    <span class="kw">struct</span> S s;</span>
<span id="cb234-5"><a href="#cb234-5" aria-hidden="true"></a>}</span></code></pre></div>
</section>
<section id="answer-2-score-117" class="level4">
<h4>Answer 2 (score 117)</h4>
<p><code>struct</code> and <code>typedef</code> are two very different things.</p>
<p>The <code>struct</code> keyword is used to define, or to refer to, a structure type. For example, this:</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true"></a><span class="kw">struct</span> foo {</span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true"></a>    <span class="dt">int</span> n;</span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true"></a>};</span></code></pre></div>
<p>creates a new type called <code>struct foo</code>. The name <code>foo</code> is a <em>tag</em>; it’s meaningful only when it’s immediately preceded by the <code>struct</code> keyword, because tags and other identifiers are in distinct <em>name spaces</em>. (This is similar to, but much more restricted than, the C++ concept of <code>namespace</code>s.)</p>
<p>A <code>typedef</code>, in spite of the name, does not define a new type; it merely creates a new name for an existing type. For example, given:</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true"></a><span class="kw">typedef</span> <span class="dt">int</span> my_int;</span></code></pre></div>
<p><code>my_int</code> is a new name for <code>int</code>; <code>my_int</code> and <code>int</code> are <em>exactly</em> the same type. Similarly, given the <code>struct</code> definition above, you can write:</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true"></a><span class="kw">typedef</span> <span class="kw">struct</span> foo foo;</span></code></pre></div>
<p>The type already has a name, <code>struct foo</code>. The <code>typedef</code> declaration gives the same type a new name, <code>foo</code>.</p>
<p>The syntax allows you to combine a <code>struct</code> and <code>typedef</code> into a single declaration:</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true"></a><span class="kw">typedef</span> <span class="kw">struct</span> bar {</span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true"></a>    <span class="dt">int</span> n;</span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true"></a>} bar;</span></code></pre></div>
<p>This is a common idiom. Now you can refer to this structure type either as <code>struct bar</code> or just as <code>bar</code>.</p>
<p>Note that the typedef name doesn’t become visible until the end of the declaration. If the structure contains a pointer to itself, you have use the <code>struct</code> version to refer to it:</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true"></a><span class="kw">typedef</span> <span class="kw">struct</span> node {</span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true"></a>    <span class="dt">int</span> data;</span>
<span id="cb239-3"><a href="#cb239-3" aria-hidden="true"></a>    <span class="kw">struct</span> node *next; <span class="co">/* can&#39;t use just &quot;node *next&quot; here */</span></span>
<span id="cb239-4"><a href="#cb239-4" aria-hidden="true"></a>} node;</span></code></pre></div>
<p>Some programmers will use distinct identifiers for the struct tag and for the typedef name. In my opinion, there’s no good reason for that; using the same name is perfectly legal and makes it clearer that they’re the same type. If you must use different identifiers, at least use a consistent convention:</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true"></a><span class="kw">typedef</span> <span class="kw">struct</span> node_s {</span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true"></a>    <span class="co">/* ... */</span></span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true"></a>} node;</span></code></pre></div>
<p>(Personally, I prefer to omit the <code>typedef</code> and refer to the type as <code>struct bar</code>. The <code>typedef</code> save a little typing, but it hides the fact that it’s a structure type. If you want the type to be opaque, this can be a good thing. If client code is going to be referring to the member <code>n</code> by name, then it’s not opaque; it’s visibly a structure, and in my opinion it makes sense to refer to it as a structure. But plenty of smart programmers disagree with me on this point. Be prepared to read and understand code written either way.)</p>
<p>(C++ has different rules. Given a declaration of <code>struct blah</code>, you can refer to the type as just <code>blah</code>, even without a typedef. Using a typedef might make your C code a little more C++-like – if you think that’s a good thing.)</p>
</section>
<section id="answer-3-score-89" class="level4">
<h4>Answer 3 (score 89)</h4>
<p>Another difference not pointed out is that giving the struct a name (i.e. struct myStruct) also enables you to provide forward declarations of the struct. So in some other file, you could write:</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true"></a><span class="kw">struct</span> myStruct;</span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true"></a><span class="dt">void</span> doit(<span class="kw">struct</span> myStruct *ptr);</span></code></pre></div>
<p>without having to have access to the definition. What I recommend is you combine your two examples:</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true"></a><span class="kw">typedef</span> <span class="kw">struct</span> myStruct{</span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true"></a>    <span class="dt">int</span> one;</span>
<span id="cb242-3"><a href="#cb242-3" aria-hidden="true"></a>    <span class="dt">int</span> two;</span>
<span id="cb242-4"><a href="#cb242-4" aria-hidden="true"></a>} myStruct;</span></code></pre></div>
<p>This gives you the convenience of the more concise typedef name but still allows you to use the full struct name if you need.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-to-printf-unsigned-long-in-c-score-640953-in-2017" class="level3">
<h3>30: How to printf “unsigned long” in C? (score <a href="https://stackoverflow.com/q/3209909.html">640953</a> in 2017)</h3>
<section id="question-29" class="level4">
<h4>Question</h4>
<p>I can never understand how to print <code>unsigned long</code> datatype in C.</p>
<p>Suppose <code>unsigned_foo</code> is an <code>unsigned long</code>, then I try:</p>
<ul>
<li>
<code>printf("%lu\n", unsigned_foo)</code>
</li>
<li>
<code>printf("%du\n", unsigned_foo)</code>
</li>
<li>
<code>printf("%ud\n", unsigned_foo)</code>
</li>
<li>
<code>printf("%ll\n", unsigned_foo)</code>
</li>
<li>
<code>printf("%ld\n", unsigned_foo)</code>
</li>
<li>
<code>printf("%dl\n", unsigned_foo)</code>
</li>
</ul>
<p>And all of them print some kind of <code>-123123123</code> number instead of <code>unsigned long</code> that I have.</p>
</section>
<section id="answer-accepted-score-473" class="level4">
<h4>Answer accepted (score 473)</h4>
<p><code>%lu</code> is the correct format for <code>unsigned long</code>. Sounds like there are other issues at play here, such as memory corruption or an uninitialized variable. Perhaps show us a larger picture?</p>
</section>
<section id="answer-2-score-28" class="level4">
<h4>Answer 2 (score 28)</h4>
<ul>
<li>
<code>%lu</code> for <strong>unsigned long</strong>
</li>
<li>
<code>%llu</code> for <strong>unsigned long long</strong>
</li>
</ul>
</section>
<section id="answer-3-score-23" class="level4">
<h4>Answer 3 (score 23)</h4>
<p>Out of all the combinations you tried, <code>%ld</code> and <code>%lu</code> are the only ones which are valid printf format specifiers at all. <code>%lu</code> (long unsigned decimal), <code>%lx</code> or <code>%lX</code> (long hex with lowercase or uppercase letters), and <code>%lo</code> (long octal) are the only valid format specifiers for a variable of type unsigned long (of course you can add field width, precision, etc modifiers between the <code>%</code> and the <code>l</code>).</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="what-is-segmentation-fault-core-dumped-score-587699-in-2013" class="level3">
<h3>31: what is Segmentation fault (core dumped)? (score <a href="https://stackoverflow.com/q/19641597.html">587699</a> in 2013)</h3>
<section id="question-30" class="level4">
<h4>Question</h4>
<p>I am trying to write a C program in linux that having sqrt of the argument, Here’s the code:</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true"></a></span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true"></a><span class="pp">#include</span><span class="im">&lt;stdlib.h&gt;</span></span>
<span id="cb243-3"><a href="#cb243-3" aria-hidden="true"></a></span>
<span id="cb243-4"><a href="#cb243-4" aria-hidden="true"></a><span class="pp">#include</span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb243-5"><a href="#cb243-5" aria-hidden="true"></a></span>
<span id="cb243-6"><a href="#cb243-6" aria-hidden="true"></a><span class="pp">#include</span><span class="im">&lt;math.h&gt;</span></span>
<span id="cb243-7"><a href="#cb243-7" aria-hidden="true"></a></span>
<span id="cb243-8"><a href="#cb243-8" aria-hidden="true"></a><span class="dt">int</span> main(<span class="dt">char</span> *argv[]){</span>
<span id="cb243-9"><a href="#cb243-9" aria-hidden="true"></a>    <span class="dt">float</span> k;</span>
<span id="cb243-10"><a href="#cb243-10" aria-hidden="true"></a>    printf(<span class="st">&quot;this is consumer</span><span class="sc">\n</span><span class="st">&quot;</span>);</span>
<span id="cb243-11"><a href="#cb243-11" aria-hidden="true"></a>    k=(<span class="dt">float</span>)sqrt(atoi(argv[<span class="dv">1</span>]));</span>
<span id="cb243-12"><a href="#cb243-12" aria-hidden="true"></a>    printf(<span class="st">&quot;%s</span><span class="sc">\n</span><span class="st">&quot;</span>,k);</span>
<span id="cb243-13"><a href="#cb243-13" aria-hidden="true"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb243-14"><a href="#cb243-14" aria-hidden="true"></a>}</span></code></pre></div>
<p>After I type in my input at the “shell&gt;” prompt, gcc gives me the following error:</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true"></a>Segmentation fault (core dumped)</span></code></pre></div>
</section>
<section id="answer-accepted-score-117" class="level4">
<h4>Answer accepted (score 117)</h4>
<p>“Segmentation fault” means that you tried to access memory that you do not have access to.</p>
<p>The first problem is with your arguments of <code>main</code>. The <code>main</code> function should be <code>int main(int argc, char *argv[])</code>, and you should check that <code>argc</code> is at least 2 before accessing <code>argv[1]</code>.</p>
<p>Also, since you’re passing in a <code>float</code> to <code>printf</code> (which, by the way, gets converted to a <code>double</code> when passing to <code>printf</code>), you should use the <code>%f</code> format specifier. The <code>%s</code> format specifier is for strings (<code>'\0'</code>-terminated character arrays).</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="in-c-how-should-i-read-a-text-file-and-print-all-strings-score-582393-in-2010" class="level3">
<h3>32: In C, how should I read a text file and print all strings (score <a href="https://stackoverflow.com/q/3463426.html">582393</a> in 2010)</h3>
<section id="question-31" class="level4">
<h4>Question</h4>
<p>I have a text file named <code>test.txt</code></p>
<p>I want to write a C program that can read this file and print the content to the console (assume the file contains only ASCII text).</p>
<p>I don’t know how to get the size of my string variable. Like this:</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true"></a><span class="dt">char</span> str[<span class="dv">999</span>];</span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true"></a><span class="dt">FILE</span> * file;</span>
<span id="cb245-3"><a href="#cb245-3" aria-hidden="true"></a>file = fopen( <span class="st">&quot;test.txt&quot;</span> , <span class="st">&quot;r&quot;</span>);</span>
<span id="cb245-4"><a href="#cb245-4" aria-hidden="true"></a><span class="cf">if</span> (file) {</span>
<span id="cb245-5"><a href="#cb245-5" aria-hidden="true"></a>    <span class="cf">while</span> (fscanf(file, <span class="st">&quot;%s&quot;</span>, str)!=EOF)</span>
<span id="cb245-6"><a href="#cb245-6" aria-hidden="true"></a>        printf(<span class="st">&quot;%s&quot;</span>,str);</span>
<span id="cb245-7"><a href="#cb245-7" aria-hidden="true"></a>    fclose(file);</span>
<span id="cb245-8"><a href="#cb245-8" aria-hidden="true"></a>}</span></code></pre></div>
<p>The size <code>999</code> doesn’t work because the string returned by <code>fscanf</code> can be larger than that. How can I solve this?</p>
</section>
<section id="answer-accepted-score-120" class="level4">
<h4>Answer accepted (score 120)</h4>
<p>The simplest way is to read a character, and print it right after reading:</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true"></a><span class="dt">int</span> c;</span>
<span id="cb246-2"><a href="#cb246-2" aria-hidden="true"></a><span class="dt">FILE</span> *file;</span>
<span id="cb246-3"><a href="#cb246-3" aria-hidden="true"></a>file = fopen(<span class="st">&quot;test.txt&quot;</span>, <span class="st">&quot;r&quot;</span>);</span>
<span id="cb246-4"><a href="#cb246-4" aria-hidden="true"></a><span class="cf">if</span> (file) {</span>
<span id="cb246-5"><a href="#cb246-5" aria-hidden="true"></a>    <span class="cf">while</span> ((c = getc(file)) != EOF)</span>
<span id="cb246-6"><a href="#cb246-6" aria-hidden="true"></a>        putchar(c);</span>
<span id="cb246-7"><a href="#cb246-7" aria-hidden="true"></a>    fclose(file);</span>
<span id="cb246-8"><a href="#cb246-8" aria-hidden="true"></a>}</span></code></pre></div>
<p><code>c</code> is <code>int</code> above, since <code>EOF</code> is a negative number, and a plain <code>char</code> may be <code>unsigned</code>.</p>
<p>If you want to read the file in chunks, but without dynamic memory allocation, you can do:</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true"></a></span>
<span id="cb247-2"><a href="#cb247-2" aria-hidden="true"></a><span class="pp">#define CHUNK 1024 </span><span class="co">/* read 1024 bytes at a time */</span></span>
<span id="cb247-3"><a href="#cb247-3" aria-hidden="true"></a><span class="dt">char</span> buf[CHUNK];</span>
<span id="cb247-4"><a href="#cb247-4" aria-hidden="true"></a><span class="dt">FILE</span> *file;</span>
<span id="cb247-5"><a href="#cb247-5" aria-hidden="true"></a><span class="dt">size_t</span> nread;</span>
<span id="cb247-6"><a href="#cb247-6" aria-hidden="true"></a></span>
<span id="cb247-7"><a href="#cb247-7" aria-hidden="true"></a>file = fopen(<span class="st">&quot;test.txt&quot;</span>, <span class="st">&quot;r&quot;</span>);</span>
<span id="cb247-8"><a href="#cb247-8" aria-hidden="true"></a><span class="cf">if</span> (file) {</span>
<span id="cb247-9"><a href="#cb247-9" aria-hidden="true"></a>    <span class="cf">while</span> ((nread = fread(buf, <span class="dv">1</span>, <span class="kw">sizeof</span> buf, file)) &gt; <span class="dv">0</span>)</span>
<span id="cb247-10"><a href="#cb247-10" aria-hidden="true"></a>        fwrite(buf, <span class="dv">1</span>, nread, stdout);</span>
<span id="cb247-11"><a href="#cb247-11" aria-hidden="true"></a>    <span class="cf">if</span> (ferror(file)) {</span>
<span id="cb247-12"><a href="#cb247-12" aria-hidden="true"></a>        <span class="co">/* deal with error */</span></span>
<span id="cb247-13"><a href="#cb247-13" aria-hidden="true"></a>    }</span>
<span id="cb247-14"><a href="#cb247-14" aria-hidden="true"></a>    fclose(file);</span>
<span id="cb247-15"><a href="#cb247-15" aria-hidden="true"></a>}</span></code></pre></div>
<p>The second method above is essentially how you will read a file with a dynamically allocated array:</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true"></a><span class="dt">char</span> *buf = malloc(chunk);</span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true"></a></span>
<span id="cb248-3"><a href="#cb248-3" aria-hidden="true"></a><span class="cf">if</span> (buf == NULL) {</span>
<span id="cb248-4"><a href="#cb248-4" aria-hidden="true"></a>    <span class="co">/* deal with malloc() failure */</span></span>
<span id="cb248-5"><a href="#cb248-5" aria-hidden="true"></a>}</span>
<span id="cb248-6"><a href="#cb248-6" aria-hidden="true"></a></span>
<span id="cb248-7"><a href="#cb248-7" aria-hidden="true"></a><span class="co">/* otherwise do this.  Note &#39;chunk&#39; instead of &#39;sizeof buf&#39; */</span></span>
<span id="cb248-8"><a href="#cb248-8" aria-hidden="true"></a><span class="cf">while</span> ((nread = fread(buf, <span class="dv">1</span>, chunk, file)) &gt; <span class="dv">0</span>) {</span>
<span id="cb248-9"><a href="#cb248-9" aria-hidden="true"></a>    <span class="co">/* as above */</span></span>
<span id="cb248-10"><a href="#cb248-10" aria-hidden="true"></a>}</span></code></pre></div>
<p>Your method of <code>fscanf()</code> with <code>%s</code> as format loses information about whitespace in the file, so it is not exactly copying a file to <code>stdout</code>.</p>
</section>
<section id="answer-2-score-54-1" class="level4">
<h4>Answer 2 (score 54)</h4>
<p>There are plenty of good answers here about reading it in chunks, I’m just gonna show you a little trick that reads all the content at once to a buffer and prints it.</p>
<p>I’m not saying it’s better. It’s not, and as Ricardo sometimes it can be bad, but I find it’s a nice solution for the simple cases.</p>
<p>I sprinkled it with comments because there’s a lot going on.</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true"></a></span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb249-3"><a href="#cb249-3" aria-hidden="true"></a></span>
<span id="cb249-4"><a href="#cb249-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdlib.h&gt;</span></span>
<span id="cb249-5"><a href="#cb249-5" aria-hidden="true"></a></span>
<span id="cb249-6"><a href="#cb249-6" aria-hidden="true"></a><span class="dt">char</span>* ReadFile(<span class="dt">char</span> *filename)</span>
<span id="cb249-7"><a href="#cb249-7" aria-hidden="true"></a>{</span>
<span id="cb249-8"><a href="#cb249-8" aria-hidden="true"></a>   <span class="dt">char</span> *buffer = NULL;</span>
<span id="cb249-9"><a href="#cb249-9" aria-hidden="true"></a>   <span class="dt">int</span> string_size, read_size;</span>
<span id="cb249-10"><a href="#cb249-10" aria-hidden="true"></a>   <span class="dt">FILE</span> *handler = fopen(filename, <span class="st">&quot;r&quot;</span>);</span>
<span id="cb249-11"><a href="#cb249-11" aria-hidden="true"></a></span>
<span id="cb249-12"><a href="#cb249-12" aria-hidden="true"></a>   <span class="cf">if</span> (handler)</span>
<span id="cb249-13"><a href="#cb249-13" aria-hidden="true"></a>   {</span>
<span id="cb249-14"><a href="#cb249-14" aria-hidden="true"></a>       <span class="co">// Seek the last byte of the file</span></span>
<span id="cb249-15"><a href="#cb249-15" aria-hidden="true"></a>       fseek(handler, <span class="dv">0</span>, SEEK_END);</span>
<span id="cb249-16"><a href="#cb249-16" aria-hidden="true"></a>       <span class="co">// Offset from the first to the last byte, or in other words, filesize</span></span>
<span id="cb249-17"><a href="#cb249-17" aria-hidden="true"></a>       string_size = ftell(handler);</span>
<span id="cb249-18"><a href="#cb249-18" aria-hidden="true"></a>       <span class="co">// go back to the start of the file</span></span>
<span id="cb249-19"><a href="#cb249-19" aria-hidden="true"></a>       rewind(handler);</span>
<span id="cb249-20"><a href="#cb249-20" aria-hidden="true"></a></span>
<span id="cb249-21"><a href="#cb249-21" aria-hidden="true"></a>       <span class="co">// Allocate a string that can hold it all</span></span>
<span id="cb249-22"><a href="#cb249-22" aria-hidden="true"></a>       buffer = (<span class="dt">char</span>*) malloc(<span class="kw">sizeof</span>(<span class="dt">char</span>) * (string_size + <span class="dv">1</span>) );</span>
<span id="cb249-23"><a href="#cb249-23" aria-hidden="true"></a></span>
<span id="cb249-24"><a href="#cb249-24" aria-hidden="true"></a>       <span class="co">// Read it all in one operation</span></span>
<span id="cb249-25"><a href="#cb249-25" aria-hidden="true"></a>       read_size = fread(buffer, <span class="kw">sizeof</span>(<span class="dt">char</span>), string_size, handler);</span>
<span id="cb249-26"><a href="#cb249-26" aria-hidden="true"></a></span>
<span id="cb249-27"><a href="#cb249-27" aria-hidden="true"></a>       <span class="co">// fread doesn&#39;t set it so put a \0 in the last position</span></span>
<span id="cb249-28"><a href="#cb249-28" aria-hidden="true"></a>       <span class="co">// and buffer is now officially a string</span></span>
<span id="cb249-29"><a href="#cb249-29" aria-hidden="true"></a>       buffer[string_size] = <span class="ch">&#39;\0&#39;</span>;</span>
<span id="cb249-30"><a href="#cb249-30" aria-hidden="true"></a></span>
<span id="cb249-31"><a href="#cb249-31" aria-hidden="true"></a>       <span class="cf">if</span> (string_size != read_size)</span>
<span id="cb249-32"><a href="#cb249-32" aria-hidden="true"></a>       {</span>
<span id="cb249-33"><a href="#cb249-33" aria-hidden="true"></a>           <span class="co">// Something went wrong, throw away the memory and set</span></span>
<span id="cb249-34"><a href="#cb249-34" aria-hidden="true"></a>           <span class="co">// the buffer to NULL</span></span>
<span id="cb249-35"><a href="#cb249-35" aria-hidden="true"></a>           free(buffer);</span>
<span id="cb249-36"><a href="#cb249-36" aria-hidden="true"></a>           buffer = NULL;</span>
<span id="cb249-37"><a href="#cb249-37" aria-hidden="true"></a>       }</span>
<span id="cb249-38"><a href="#cb249-38" aria-hidden="true"></a></span>
<span id="cb249-39"><a href="#cb249-39" aria-hidden="true"></a>       <span class="co">// Always remember to close the file.</span></span>
<span id="cb249-40"><a href="#cb249-40" aria-hidden="true"></a>       fclose(handler);</span>
<span id="cb249-41"><a href="#cb249-41" aria-hidden="true"></a>    }</span>
<span id="cb249-42"><a href="#cb249-42" aria-hidden="true"></a></span>
<span id="cb249-43"><a href="#cb249-43" aria-hidden="true"></a>    <span class="cf">return</span> buffer;</span>
<span id="cb249-44"><a href="#cb249-44" aria-hidden="true"></a>}</span>
<span id="cb249-45"><a href="#cb249-45" aria-hidden="true"></a></span>
<span id="cb249-46"><a href="#cb249-46" aria-hidden="true"></a><span class="dt">int</span> main()</span>
<span id="cb249-47"><a href="#cb249-47" aria-hidden="true"></a>{</span>
<span id="cb249-48"><a href="#cb249-48" aria-hidden="true"></a>    <span class="dt">char</span> *string = ReadFile(<span class="st">&quot;yourfile.txt&quot;</span>);</span>
<span id="cb249-49"><a href="#cb249-49" aria-hidden="true"></a>    <span class="cf">if</span> (string)</span>
<span id="cb249-50"><a href="#cb249-50" aria-hidden="true"></a>    {</span>
<span id="cb249-51"><a href="#cb249-51" aria-hidden="true"></a>        puts(string);</span>
<span id="cb249-52"><a href="#cb249-52" aria-hidden="true"></a>        free(string);</span>
<span id="cb249-53"><a href="#cb249-53" aria-hidden="true"></a>    }</span>
<span id="cb249-54"><a href="#cb249-54" aria-hidden="true"></a></span>
<span id="cb249-55"><a href="#cb249-55" aria-hidden="true"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb249-56"><a href="#cb249-56" aria-hidden="true"></a>}</span></code></pre></div>
<p>Let me know if it’s useful or you could learn something from it :)</p>
</section>
<section id="answer-3-score-12" class="level4">
<h4>Answer 3 (score 12)</h4>
<p>Instead just directly print the characters onto the console because the text file maybe very large and you may require a lot of memory.</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true"></a></span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb250-3"><a href="#cb250-3" aria-hidden="true"></a></span>
<span id="cb250-4"><a href="#cb250-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdlib.h&gt;</span></span>
<span id="cb250-5"><a href="#cb250-5" aria-hidden="true"></a></span>
<span id="cb250-6"><a href="#cb250-6" aria-hidden="true"></a><span class="dt">int</span> main() {</span>
<span id="cb250-7"><a href="#cb250-7" aria-hidden="true"></a></span>
<span id="cb250-8"><a href="#cb250-8" aria-hidden="true"></a>    <span class="dt">FILE</span> *f;</span>
<span id="cb250-9"><a href="#cb250-9" aria-hidden="true"></a>    <span class="dt">char</span> c;</span>
<span id="cb250-10"><a href="#cb250-10" aria-hidden="true"></a>    f=fopen(<span class="st">&quot;test.txt&quot;</span>,<span class="st">&quot;rt&quot;</span>);</span>
<span id="cb250-11"><a href="#cb250-11" aria-hidden="true"></a></span>
<span id="cb250-12"><a href="#cb250-12" aria-hidden="true"></a>    <span class="cf">while</span>((c=fgetc(f))!=EOF){</span>
<span id="cb250-13"><a href="#cb250-13" aria-hidden="true"></a>        printf(<span class="st">&quot;%c&quot;</span>,c);</span>
<span id="cb250-14"><a href="#cb250-14" aria-hidden="true"></a>    }</span>
<span id="cb250-15"><a href="#cb250-15" aria-hidden="true"></a></span>
<span id="cb250-16"><a href="#cb250-16" aria-hidden="true"></a>    fclose(f);</span>
<span id="cb250-17"><a href="#cb250-17" aria-hidden="true"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb250-18"><a href="#cb250-18" aria-hidden="true"></a>}</span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="warning-implicit-declaration-of-function-score-575586-in-2011" class="level3">
<h3>33: warning: implicit declaration of function (score <a href="https://stackoverflow.com/q/8440816.html">575586</a> in 2011)</h3>
<section id="question-32" class="level4">
<h4>Question</h4>
<p>My compiler (GCC) is giving me the warning:</p>
<blockquote>
warning: implicit declaration of function
</blockquote>
<p>Please help me understand why is it coming.</p>
</section>
<section id="answer-accepted-score-202" class="level4">
<h4>Answer accepted (score 202)</h4>
<p>You are using a function for which the compiler has not seen a declaration (“<em>prototype</em>”) yet.</p>
<p>For example:</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true"></a><span class="dt">int</span> main()</span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true"></a>{</span>
<span id="cb251-3"><a href="#cb251-3" aria-hidden="true"></a>    fun(<span class="dv">2</span>, <span class="st">&quot;21&quot;</span>); <span class="co">/* The compiler has not seen the declaration. */</span>       </span>
<span id="cb251-4"><a href="#cb251-4" aria-hidden="true"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb251-5"><a href="#cb251-5" aria-hidden="true"></a>}</span>
<span id="cb251-6"><a href="#cb251-6" aria-hidden="true"></a></span>
<span id="cb251-7"><a href="#cb251-7" aria-hidden="true"></a><span class="dt">int</span> fun(<span class="dt">int</span> x, <span class="dt">char</span> *p)</span>
<span id="cb251-8"><a href="#cb251-8" aria-hidden="true"></a>{</span>
<span id="cb251-9"><a href="#cb251-9" aria-hidden="true"></a>    <span class="co">/* ... */</span></span>
<span id="cb251-10"><a href="#cb251-10" aria-hidden="true"></a>}</span></code></pre></div>
<p>You need to declare your function before main, like this, either directly or in a header:</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true"></a><span class="dt">int</span> fun(<span class="dt">int</span> x, <span class="dt">char</span> *p);</span></code></pre></div>
</section>
<section id="answer-2-score-17" class="level4">
<h4>Answer 2 (score 17)</h4>
<p>The right way is to declare function prototype in header.</p>
<h5>
Example
</h1>
<p><strong>main.h</strong></p>
<div class="sourceCode" id="cb253"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true"></a></span>
<span id="cb253-2"><a href="#cb253-2" aria-hidden="true"></a><span class="pp">#ifndef MAIN_H</span></span>
<span id="cb253-3"><a href="#cb253-3" aria-hidden="true"></a></span>
<span id="cb253-4"><a href="#cb253-4" aria-hidden="true"></a><span class="pp">#define MAIN_H</span></span>
<span id="cb253-5"><a href="#cb253-5" aria-hidden="true"></a></span>
<span id="cb253-6"><a href="#cb253-6" aria-hidden="true"></a><span class="dt">int</span> some_main(<span class="dt">const</span> <span class="dt">char</span> *name);</span>
<span id="cb253-7"><a href="#cb253-7" aria-hidden="true"></a></span>
<span id="cb253-8"><a href="#cb253-8" aria-hidden="true"></a></span>
<span id="cb253-9"><a href="#cb253-9" aria-hidden="true"></a><span class="pp">#endif</span></span></code></pre></div>
<p><strong>main.c</strong></p>
<div class="sourceCode" id="cb254"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true"></a></span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;main.h&quot;</span></span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true"></a></span>
<span id="cb254-4"><a href="#cb254-4" aria-hidden="true"></a><span class="dt">int</span> main()</span>
<span id="cb254-5"><a href="#cb254-5" aria-hidden="true"></a>{</span>
<span id="cb254-6"><a href="#cb254-6" aria-hidden="true"></a>    some_main(<span class="st">&quot;Hello, World</span><span class="sc">\n</span><span class="st">&quot;</span>);</span>
<span id="cb254-7"><a href="#cb254-7" aria-hidden="true"></a>}</span>
<span id="cb254-8"><a href="#cb254-8" aria-hidden="true"></a></span>
<span id="cb254-9"><a href="#cb254-9" aria-hidden="true"></a><span class="dt">int</span> some_main(<span class="dt">const</span> <span class="dt">char</span> *name)</span>
<span id="cb254-10"><a href="#cb254-10" aria-hidden="true"></a>{</span>
<span id="cb254-11"><a href="#cb254-11" aria-hidden="true"></a>    printf(<span class="st">&quot;%s&quot;</span>, name);</span>
<span id="cb254-12"><a href="#cb254-12" aria-hidden="true"></a>}</span></code></pre></div>
<p><strong>Alternative with one file (main.c)</strong></p>
<div class="sourceCode" id="cb255"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true"></a><span class="dt">static</span> <span class="dt">int</span> some_main(<span class="dt">const</span> <span class="dt">char</span> *name);</span>
<span id="cb255-2"><a href="#cb255-2" aria-hidden="true"></a></span>
<span id="cb255-3"><a href="#cb255-3" aria-hidden="true"></a><span class="dt">int</span> some_main(<span class="dt">const</span> <span class="dt">char</span> *name)</span>
<span id="cb255-4"><a href="#cb255-4" aria-hidden="true"></a>{</span>
<span id="cb255-5"><a href="#cb255-5" aria-hidden="true"></a>    <span class="co">// do something</span></span>
<span id="cb255-6"><a href="#cb255-6" aria-hidden="true"></a>}</span></code></pre></div>
</section>
<section id="answer-3-score-7" class="level4">
<h4>Answer 3 (score 7)</h4>
<p>
When you do your #includes in main.c, put the #include reference to the file that contains the referenced function at the top of the include list. e.g. Say this is main.c and your referenced function is in “SSD1306_LCD.h”
</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true"></a></span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;SSD1306_LCD.h&quot;</span><span class="pp">    </span></span>
<span id="cb256-3"><a href="#cb256-3" aria-hidden="true"></a></span>
<span id="cb256-4"><a href="#cb256-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;system.h&quot;</span><span class="pp">        #include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb256-5"><a href="#cb256-5" aria-hidden="true"></a></span>
<span id="cb256-6"><a href="#cb256-6" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdlib.h&gt;</span></span>
<span id="cb256-7"><a href="#cb256-7" aria-hidden="true"></a></span>
<span id="cb256-8"><a href="#cb256-8" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;xc.h&gt;</span></span>
<span id="cb256-9"><a href="#cb256-9" aria-hidden="true"></a></span>
<span id="cb256-10"><a href="#cb256-10" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;string.h&gt;</span></span>
<span id="cb256-11"><a href="#cb256-11" aria-hidden="true"></a></span>
<span id="cb256-12"><a href="#cb256-12" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;math.h&gt;</span></span>
<span id="cb256-13"><a href="#cb256-13" aria-hidden="true"></a></span>
<span id="cb256-14"><a href="#cb256-14" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;libpic30.h&gt;</span><span class="pp">       </span><span class="co">// http://microchip.wikidot.com/faq:74</span></span>
<span id="cb256-15"><a href="#cb256-15" aria-hidden="true"></a></span>
<span id="cb256-16"><a href="#cb256-16" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdint.h&gt;</span></span>
<span id="cb256-17"><a href="#cb256-17" aria-hidden="true"></a></span>
<span id="cb256-18"><a href="#cb256-18" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdbool.h&gt;</span></span>
<span id="cb256-19"><a href="#cb256-19" aria-hidden="true"></a></span>
<span id="cb256-20"><a href="#cb256-20" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;GenericTypeDefs.h&quot;</span><span class="pp">  </span><span class="co">// This has the &#39;BYTE&#39; type definition</span></span></code></pre></div>
<p>The above will not generate the “implicit declaration of function” error, but below will-</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true"></a></span>
<span id="cb257-2"><a href="#cb257-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;system.h&quot;</span><span class="pp">        </span></span>
<span id="cb257-3"><a href="#cb257-3" aria-hidden="true"></a></span>
<span id="cb257-4"><a href="#cb257-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb257-5"><a href="#cb257-5" aria-hidden="true"></a></span>
<span id="cb257-6"><a href="#cb257-6" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdlib.h&gt;</span></span>
<span id="cb257-7"><a href="#cb257-7" aria-hidden="true"></a></span>
<span id="cb257-8"><a href="#cb257-8" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;xc.h&gt;</span></span>
<span id="cb257-9"><a href="#cb257-9" aria-hidden="true"></a></span>
<span id="cb257-10"><a href="#cb257-10" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;string.h&gt;</span></span>
<span id="cb257-11"><a href="#cb257-11" aria-hidden="true"></a></span>
<span id="cb257-12"><a href="#cb257-12" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;math.h&gt;</span></span>
<span id="cb257-13"><a href="#cb257-13" aria-hidden="true"></a></span>
<span id="cb257-14"><a href="#cb257-14" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;libpic30.h&gt;</span><span class="pp">       </span><span class="co">// http://microchip.wikidot.com/faq:74</span></span>
<span id="cb257-15"><a href="#cb257-15" aria-hidden="true"></a></span>
<span id="cb257-16"><a href="#cb257-16" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdint.h&gt;</span></span>
<span id="cb257-17"><a href="#cb257-17" aria-hidden="true"></a></span>
<span id="cb257-18"><a href="#cb257-18" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdbool.h&gt;</span></span>
<span id="cb257-19"><a href="#cb257-19" aria-hidden="true"></a></span>
<span id="cb257-20"><a href="#cb257-20" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;GenericTypeDefs.h&quot;</span><span class="pp">     </span><span class="co">// This has the &#39;BYTE&#39; type definition</span></span>
<span id="cb257-21"><a href="#cb257-21" aria-hidden="true"></a></span>
<span id="cb257-22"><a href="#cb257-22" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;SSD1306_LCD.h&quot;</span><span class="pp">    </span></span></code></pre></div>
<p>Exactly the same #include list, just different order.</p>
<p>Well, it did for me.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="what-is-the-printf-format-specifier-for-bool-score-575382-in" class="level3">
<h3>34: What is the printf format specifier for bool? (score <a href="https://stackoverflow.com/q/17307275.html">575382</a> in )</h3>
<section id="question-33" class="level4">
<h4>Question</h4>
<p>Since ANSI C99 there is <code>_Bool</code> or <code>bool</code> via <code>stdbool.h</code>. But is there also a <code>printf</code> format specifier for bool?</p>
<p>I mean something like in that pseudo code:</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true"></a><span class="dt">bool</span> x = true;</span>
<span id="cb258-2"><a href="#cb258-2" aria-hidden="true"></a>printf(<span class="st">&quot;%B</span><span class="sc">\n</span><span class="st">&quot;</span>, x);</span></code></pre></div>
<p>which would print:</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true"></a>true</span></code></pre></div>
</section>
<section id="answer-accepted-score-615" class="level4">
<h4>Answer accepted (score 615)</h4>
<p>There isn’t. But since any integral type shorter than <code>int</code> is promoted to <code>int</code> when passed down to <code>printf()</code>s variadic arguments, you can use <code>%d</code>:</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true"></a><span class="dt">bool</span> x = true;</span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true"></a>printf(<span class="st">&quot;%d</span><span class="sc">\n</span><span class="st">&quot;</span>, x); <span class="co">// prints 1</span></span></code></pre></div>
<p>But why not</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true"></a>printf(x ? <span class="st">&quot;true&quot;</span> : <span class="st">&quot;false&quot;</span>);</span></code></pre></div>
<p>or better</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true"></a>printf(<span class="st">&quot;%s&quot;</span>, x ? <span class="st">&quot;true&quot;</span> : <span class="st">&quot;false&quot;</span>);</span></code></pre></div>
<p>or even better</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true"></a>fputs(x ? <span class="st">&quot;true&quot;</span> : <span class="st">&quot;false&quot;</span>, stdout);</span></code></pre></div>
<p>instead?</p>
</section>
<section id="answer-2-score-39" class="level4">
<h4>Answer 2 (score 39)</h4>
<p>There is no format specifier for bool. You can print it using some of the existing specifiers for printing integral types or do something more fancy:</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true"></a> printf(<span class="st">&quot;%s&quot;</span>, x?<span class="st">&quot;true&quot;</span>:<span class="st">&quot;false&quot;</span>);</span></code></pre></div>
</section>
<section id="answer-3-score-30" class="level4">
<h4>Answer 3 (score 30)</h4>
<p>ANSI C99/C11 don’t include an extra printf conversion specifier for <code>bool</code>.</p>
<p>But the <a href="http://www.gnu.org/software/libc/manual/html_node/Customizing-Printf.html">GNU C library provides an API for adding custom specifiers</a>.</p>
<p>An example:</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true"></a></span>
<span id="cb265-2"><a href="#cb265-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb265-3"><a href="#cb265-3" aria-hidden="true"></a></span>
<span id="cb265-4"><a href="#cb265-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;printf.h&gt;</span></span>
<span id="cb265-5"><a href="#cb265-5" aria-hidden="true"></a></span>
<span id="cb265-6"><a href="#cb265-6" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdbool.h&gt;</span></span>
<span id="cb265-7"><a href="#cb265-7" aria-hidden="true"></a></span>
<span id="cb265-8"><a href="#cb265-8" aria-hidden="true"></a><span class="dt">static</span> <span class="dt">int</span> bool_arginfo(<span class="dt">const</span> <span class="kw">struct</span> printf_info *info, <span class="dt">size_t</span> n,</span>
<span id="cb265-9"><a href="#cb265-9" aria-hidden="true"></a>    <span class="dt">int</span> *argtypes, <span class="dt">int</span> *size)</span>
<span id="cb265-10"><a href="#cb265-10" aria-hidden="true"></a>{</span>
<span id="cb265-11"><a href="#cb265-11" aria-hidden="true"></a>  <span class="cf">if</span> (n) {</span>
<span id="cb265-12"><a href="#cb265-12" aria-hidden="true"></a>    argtypes[<span class="dv">0</span>] = PA_INT;</span>
<span id="cb265-13"><a href="#cb265-13" aria-hidden="true"></a>    *size = <span class="kw">sizeof</span>(<span class="dt">bool</span>);</span>
<span id="cb265-14"><a href="#cb265-14" aria-hidden="true"></a>  }</span>
<span id="cb265-15"><a href="#cb265-15" aria-hidden="true"></a>  <span class="cf">return</span> <span class="dv">1</span>;</span>
<span id="cb265-16"><a href="#cb265-16" aria-hidden="true"></a>}</span>
<span id="cb265-17"><a href="#cb265-17" aria-hidden="true"></a><span class="dt">static</span> <span class="dt">int</span> bool_printf(<span class="dt">FILE</span> *stream, <span class="dt">const</span> <span class="kw">struct</span> printf_info *info,</span>
<span id="cb265-18"><a href="#cb265-18" aria-hidden="true"></a>    <span class="dt">const</span> <span class="dt">void</span> *<span class="dt">const</span> *args)</span>
<span id="cb265-19"><a href="#cb265-19" aria-hidden="true"></a>{</span>
<span id="cb265-20"><a href="#cb265-20" aria-hidden="true"></a>  <span class="dt">bool</span> b =  *(<span class="dt">const</span> <span class="dt">bool</span>*)(args[<span class="dv">0</span>]);</span>
<span id="cb265-21"><a href="#cb265-21" aria-hidden="true"></a>  <span class="dt">int</span> r = fputs(b ? <span class="st">&quot;true&quot;</span> : <span class="st">&quot;false&quot;</span>, stream);</span>
<span id="cb265-22"><a href="#cb265-22" aria-hidden="true"></a>  <span class="cf">return</span> r == EOF ? -<span class="dv">1</span> : (b ? <span class="dv">4</span> : <span class="dv">5</span>);</span>
<span id="cb265-23"><a href="#cb265-23" aria-hidden="true"></a>}</span>
<span id="cb265-24"><a href="#cb265-24" aria-hidden="true"></a><span class="dt">static</span> <span class="dt">int</span> setup_bool_specifier()</span>
<span id="cb265-25"><a href="#cb265-25" aria-hidden="true"></a>{</span>
<span id="cb265-26"><a href="#cb265-26" aria-hidden="true"></a>  <span class="dt">int</span> r = register_printf_specifier(<span class="ch">&#39;B&#39;</span>, bool_printf, bool_arginfo);</span>
<span id="cb265-27"><a href="#cb265-27" aria-hidden="true"></a>  <span class="cf">return</span> r;</span>
<span id="cb265-28"><a href="#cb265-28" aria-hidden="true"></a>}</span>
<span id="cb265-29"><a href="#cb265-29" aria-hidden="true"></a><span class="dt">int</span> main(<span class="dt">int</span> argc, <span class="dt">char</span> **argv)</span>
<span id="cb265-30"><a href="#cb265-30" aria-hidden="true"></a>{</span>
<span id="cb265-31"><a href="#cb265-31" aria-hidden="true"></a>  <span class="dt">int</span> r = setup_bool_specifier();</span>
<span id="cb265-32"><a href="#cb265-32" aria-hidden="true"></a>  <span class="cf">if</span> (r) <span class="cf">return</span> <span class="dv">1</span>;</span>
<span id="cb265-33"><a href="#cb265-33" aria-hidden="true"></a>  <span class="dt">bool</span> b = argc &gt; <span class="dv">1</span>;</span>
<span id="cb265-34"><a href="#cb265-34" aria-hidden="true"></a>  r = printf(<span class="st">&quot;The result is: %B</span><span class="sc">\n</span><span class="st">&quot;</span>, b);</span>
<span id="cb265-35"><a href="#cb265-35" aria-hidden="true"></a>  printf(<span class="st">&quot;(written %d characters)</span><span class="sc">\n</span><span class="st">&quot;</span>, r);</span>
<span id="cb265-36"><a href="#cb265-36" aria-hidden="true"></a>  <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb265-37"><a href="#cb265-37" aria-hidden="true"></a>}</span></code></pre></div>
<p>Since it is a glibc extensions the GCC warns about that custom specifier:</p>
<pre>
$ gcc -Wall -g    main.c   -o main
main.c: In function ‘main’:
main.c:34:3: warning: unknown conversion type character ‘B’ in format [-Wformat=]
   r = printf("The result is: %B\n", b);
   ^
main.c:34:3: warning: too many arguments for format [-Wformat-extra-args]
</pre>
<p>Output:</p>
<pre>
$ ./main
The result is: false
(written 21 characters)
$ ./main 1
The result is: true
(written 20 characters)
</pre>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-to-convert-integer-to-char-in-c-score-574458-in-2015" class="level3">
<h3>35: How to convert integer to char in C? (score <a href="https://stackoverflow.com/q/2279379.html">574458</a> in 2015)</h3>
<section id="question-34" class="level4">
<h4>Question</h4>
<p>How to convert integer to char in C?</p>
</section>
<section id="answer-2-score-82" class="level4">
<h4>Answer 2 (score 82)</h4>
<p>A char in C is already a number (the character’s ASCII code), no conversion required.</p>
<p>If you want to convert a digit to the corresponding character, you can simply add ‘0’:</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true"></a>c = i +<span class="ch">&#39;0&#39;</span>;</span></code></pre></div>
<p>The ‘0’ is a character in the ASCll table.</p>
</section>
<section id="answer-3-score-22-1" class="level4">
<h4>Answer 3 (score 22)</h4>
<p>
You can try atoi() library function. Also sscanf() and sprintf() would help.
</p>
<p>Here is a small example to show converting integer to character string:</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true"></a>main()</span>
<span id="cb267-2"><a href="#cb267-2" aria-hidden="true"></a>{</span>
<span id="cb267-3"><a href="#cb267-3" aria-hidden="true"></a>  <span class="dt">int</span> i = <span class="dv">247593</span>;</span>
<span id="cb267-4"><a href="#cb267-4" aria-hidden="true"></a>  <span class="dt">char</span> str[<span class="dv">10</span>];</span>
<span id="cb267-5"><a href="#cb267-5" aria-hidden="true"></a></span>
<span id="cb267-6"><a href="#cb267-6" aria-hidden="true"></a>  sprintf(str, <span class="st">&quot;%d&quot;</span>, i);</span>
<span id="cb267-7"><a href="#cb267-7" aria-hidden="true"></a>  <span class="co">// Now str contains the integer as characters</span></span>
<span id="cb267-8"><a href="#cb267-8" aria-hidden="true"></a>} </span></code></pre></div>
<p>Here for another Example</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true"></a></span>
<span id="cb268-2"><a href="#cb268-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb268-3"><a href="#cb268-3" aria-hidden="true"></a></span>
<span id="cb268-4"><a href="#cb268-4" aria-hidden="true"></a><span class="dt">int</span> main(<span class="dt">void</span>)</span>
<span id="cb268-5"><a href="#cb268-5" aria-hidden="true"></a>{</span>
<span id="cb268-6"><a href="#cb268-6" aria-hidden="true"></a>   <span class="dt">char</span> text[] = <span class="st">&quot;StringX&quot;</span>;</span>
<span id="cb268-7"><a href="#cb268-7" aria-hidden="true"></a>   <span class="dt">int</span> digit;</span>
<span id="cb268-8"><a href="#cb268-8" aria-hidden="true"></a>   <span class="cf">for</span> (digit = <span class="dv">0</span>; digit &lt; <span class="dv">10</span>; ++digit)</span>
<span id="cb268-9"><a href="#cb268-9" aria-hidden="true"></a>   {</span>
<span id="cb268-10"><a href="#cb268-10" aria-hidden="true"></a>      text[<span class="dv">6</span>] = digit + <span class="ch">&#39;0&#39;</span>;</span>
<span id="cb268-11"><a href="#cb268-11" aria-hidden="true"></a>      puts(text);</span>
<span id="cb268-12"><a href="#cb268-12" aria-hidden="true"></a>   }</span>
<span id="cb268-13"><a href="#cb268-13" aria-hidden="true"></a>   <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb268-14"><a href="#cb268-14" aria-hidden="true"></a>}</span>
<span id="cb268-15"><a href="#cb268-15" aria-hidden="true"></a></span>
<span id="cb268-16"><a href="#cb268-16" aria-hidden="true"></a><span class="co">/* my output</span></span>
<span id="cb268-17"><a href="#cb268-17" aria-hidden="true"></a><span class="co">String0</span></span>
<span id="cb268-18"><a href="#cb268-18" aria-hidden="true"></a><span class="co">String1</span></span>
<span id="cb268-19"><a href="#cb268-19" aria-hidden="true"></a><span class="co">String2</span></span>
<span id="cb268-20"><a href="#cb268-20" aria-hidden="true"></a><span class="co">String3</span></span>
<span id="cb268-21"><a href="#cb268-21" aria-hidden="true"></a><span class="co">String4</span></span>
<span id="cb268-22"><a href="#cb268-22" aria-hidden="true"></a><span class="co">String5</span></span>
<span id="cb268-23"><a href="#cb268-23" aria-hidden="true"></a><span class="co">String6</span></span>
<span id="cb268-24"><a href="#cb268-24" aria-hidden="true"></a><span class="co">String7</span></span>
<span id="cb268-25"><a href="#cb268-25" aria-hidden="true"></a><span class="co">String8</span></span>
<span id="cb268-26"><a href="#cb268-26" aria-hidden="true"></a><span class="co">String9</span></span>
<span id="cb268-27"><a href="#cb268-27" aria-hidden="true"></a><span class="co">*/</span></span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="split-string-with-delimiters-in-c-score-572995-in-2013" class="level3">
<h3>36: Split string with delimiters in C (score <a href="https://stackoverflow.com/q/9210528.html">572995</a> in 2013)</h3>
<section id="question-35" class="level4">
<h4>Question</h4>
<p>How do I write a function to split and return an array for a string with delimiters in the C programming language?</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true"></a><span class="dt">char</span>* str = <span class="st">&quot;JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC&quot;</span>;</span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true"></a>str_split(str,<span class="ch">&#39;,&#39;</span>);</span></code></pre></div>
</section>
<section id="answer-accepted-score-154" class="level4">
<h4>Answer accepted (score 154)</h4>
<p>You can use the <a href="http://en.cppreference.com/w/c/string/byte/strtok"><code>strtok()</code></a> function to split a string (and specify the delimiter to use). Note that <code>strtok()</code> will modify the string passed into it. If the original string is required elsewhere make a copy of it and pass the copy to <code>strtok()</code>.</p>
<p>EDIT:</p>
<p>Example (note it does not handle consecutive delimiters, “JAN,,,FEB,MAR” for example):</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true"></a></span>
<span id="cb270-2"><a href="#cb270-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb270-3"><a href="#cb270-3" aria-hidden="true"></a></span>
<span id="cb270-4"><a href="#cb270-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdlib.h&gt;</span></span>
<span id="cb270-5"><a href="#cb270-5" aria-hidden="true"></a></span>
<span id="cb270-6"><a href="#cb270-6" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;string.h&gt;</span></span>
<span id="cb270-7"><a href="#cb270-7" aria-hidden="true"></a></span>
<span id="cb270-8"><a href="#cb270-8" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;assert.h&gt;</span></span>
<span id="cb270-9"><a href="#cb270-9" aria-hidden="true"></a></span>
<span id="cb270-10"><a href="#cb270-10" aria-hidden="true"></a><span class="dt">char</span>** str_split(<span class="dt">char</span>* a_str, <span class="dt">const</span> <span class="dt">char</span> a_delim)</span>
<span id="cb270-11"><a href="#cb270-11" aria-hidden="true"></a>{</span>
<span id="cb270-12"><a href="#cb270-12" aria-hidden="true"></a>    <span class="dt">char</span>** result    = <span class="dv">0</span>;</span>
<span id="cb270-13"><a href="#cb270-13" aria-hidden="true"></a>    <span class="dt">size_t</span> count     = <span class="dv">0</span>;</span>
<span id="cb270-14"><a href="#cb270-14" aria-hidden="true"></a>    <span class="dt">char</span>* tmp        = a_str;</span>
<span id="cb270-15"><a href="#cb270-15" aria-hidden="true"></a>    <span class="dt">char</span>* last_comma = <span class="dv">0</span>;</span>
<span id="cb270-16"><a href="#cb270-16" aria-hidden="true"></a>    <span class="dt">char</span> delim[<span class="dv">2</span>];</span>
<span id="cb270-17"><a href="#cb270-17" aria-hidden="true"></a>    delim[<span class="dv">0</span>] = a_delim;</span>
<span id="cb270-18"><a href="#cb270-18" aria-hidden="true"></a>    delim[<span class="dv">1</span>] = <span class="dv">0</span>;</span>
<span id="cb270-19"><a href="#cb270-19" aria-hidden="true"></a></span>
<span id="cb270-20"><a href="#cb270-20" aria-hidden="true"></a>    <span class="co">/* Count how many elements will be extracted. */</span></span>
<span id="cb270-21"><a href="#cb270-21" aria-hidden="true"></a>    <span class="cf">while</span> (*tmp)</span>
<span id="cb270-22"><a href="#cb270-22" aria-hidden="true"></a>    {</span>
<span id="cb270-23"><a href="#cb270-23" aria-hidden="true"></a>        <span class="cf">if</span> (a_delim == *tmp)</span>
<span id="cb270-24"><a href="#cb270-24" aria-hidden="true"></a>        {</span>
<span id="cb270-25"><a href="#cb270-25" aria-hidden="true"></a>            count++;</span>
<span id="cb270-26"><a href="#cb270-26" aria-hidden="true"></a>            last_comma = tmp;</span>
<span id="cb270-27"><a href="#cb270-27" aria-hidden="true"></a>        }</span>
<span id="cb270-28"><a href="#cb270-28" aria-hidden="true"></a>        tmp++;</span>
<span id="cb270-29"><a href="#cb270-29" aria-hidden="true"></a>    }</span>
<span id="cb270-30"><a href="#cb270-30" aria-hidden="true"></a></span>
<span id="cb270-31"><a href="#cb270-31" aria-hidden="true"></a>    <span class="co">/* Add space for trailing token. */</span></span>
<span id="cb270-32"><a href="#cb270-32" aria-hidden="true"></a>    count += last_comma &lt; (a_str + strlen(a_str) - <span class="dv">1</span>);</span>
<span id="cb270-33"><a href="#cb270-33" aria-hidden="true"></a></span>
<span id="cb270-34"><a href="#cb270-34" aria-hidden="true"></a>    <span class="co">/* Add space for terminating null string so caller</span></span>
<span id="cb270-35"><a href="#cb270-35" aria-hidden="true"></a><span class="co">       knows where the list of returned strings ends. */</span></span>
<span id="cb270-36"><a href="#cb270-36" aria-hidden="true"></a>    count++;</span>
<span id="cb270-37"><a href="#cb270-37" aria-hidden="true"></a></span>
<span id="cb270-38"><a href="#cb270-38" aria-hidden="true"></a>    result = malloc(<span class="kw">sizeof</span>(<span class="dt">char</span>*) * count);</span>
<span id="cb270-39"><a href="#cb270-39" aria-hidden="true"></a></span>
<span id="cb270-40"><a href="#cb270-40" aria-hidden="true"></a>    <span class="cf">if</span> (result)</span>
<span id="cb270-41"><a href="#cb270-41" aria-hidden="true"></a>    {</span>
<span id="cb270-42"><a href="#cb270-42" aria-hidden="true"></a>        <span class="dt">size_t</span> idx  = <span class="dv">0</span>;</span>
<span id="cb270-43"><a href="#cb270-43" aria-hidden="true"></a>        <span class="dt">char</span>* token = strtok(a_str, delim);</span>
<span id="cb270-44"><a href="#cb270-44" aria-hidden="true"></a></span>
<span id="cb270-45"><a href="#cb270-45" aria-hidden="true"></a>        <span class="cf">while</span> (token)</span>
<span id="cb270-46"><a href="#cb270-46" aria-hidden="true"></a>        {</span>
<span id="cb270-47"><a href="#cb270-47" aria-hidden="true"></a>            assert(idx &lt; count);</span>
<span id="cb270-48"><a href="#cb270-48" aria-hidden="true"></a>            *(result + idx++) = strdup(token);</span>
<span id="cb270-49"><a href="#cb270-49" aria-hidden="true"></a>            token = strtok(<span class="dv">0</span>, delim);</span>
<span id="cb270-50"><a href="#cb270-50" aria-hidden="true"></a>        }</span>
<span id="cb270-51"><a href="#cb270-51" aria-hidden="true"></a>        assert(idx == count - <span class="dv">1</span>);</span>
<span id="cb270-52"><a href="#cb270-52" aria-hidden="true"></a>        *(result + idx) = <span class="dv">0</span>;</span>
<span id="cb270-53"><a href="#cb270-53" aria-hidden="true"></a>    }</span>
<span id="cb270-54"><a href="#cb270-54" aria-hidden="true"></a></span>
<span id="cb270-55"><a href="#cb270-55" aria-hidden="true"></a>    <span class="cf">return</span> result;</span>
<span id="cb270-56"><a href="#cb270-56" aria-hidden="true"></a>}</span>
<span id="cb270-57"><a href="#cb270-57" aria-hidden="true"></a></span>
<span id="cb270-58"><a href="#cb270-58" aria-hidden="true"></a><span class="dt">int</span> main()</span>
<span id="cb270-59"><a href="#cb270-59" aria-hidden="true"></a>{</span>
<span id="cb270-60"><a href="#cb270-60" aria-hidden="true"></a>    <span class="dt">char</span> months[] = <span class="st">&quot;JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC&quot;</span>;</span>
<span id="cb270-61"><a href="#cb270-61" aria-hidden="true"></a>    <span class="dt">char</span>** tokens;</span>
<span id="cb270-62"><a href="#cb270-62" aria-hidden="true"></a></span>
<span id="cb270-63"><a href="#cb270-63" aria-hidden="true"></a>    printf(<span class="st">&quot;months=[%s]</span><span class="sc">\n\n</span><span class="st">&quot;</span>, months);</span>
<span id="cb270-64"><a href="#cb270-64" aria-hidden="true"></a></span>
<span id="cb270-65"><a href="#cb270-65" aria-hidden="true"></a>    tokens = str_split(months, <span class="ch">&#39;,&#39;</span>);</span>
<span id="cb270-66"><a href="#cb270-66" aria-hidden="true"></a></span>
<span id="cb270-67"><a href="#cb270-67" aria-hidden="true"></a>    <span class="cf">if</span> (tokens)</span>
<span id="cb270-68"><a href="#cb270-68" aria-hidden="true"></a>    {</span>
<span id="cb270-69"><a href="#cb270-69" aria-hidden="true"></a>        <span class="dt">int</span> i;</span>
<span id="cb270-70"><a href="#cb270-70" aria-hidden="true"></a>        <span class="cf">for</span> (i = <span class="dv">0</span>; *(tokens + i); i++)</span>
<span id="cb270-71"><a href="#cb270-71" aria-hidden="true"></a>        {</span>
<span id="cb270-72"><a href="#cb270-72" aria-hidden="true"></a>            printf(<span class="st">&quot;month=[%s]</span><span class="sc">\n</span><span class="st">&quot;</span>, *(tokens + i));</span>
<span id="cb270-73"><a href="#cb270-73" aria-hidden="true"></a>            free(*(tokens + i));</span>
<span id="cb270-74"><a href="#cb270-74" aria-hidden="true"></a>        }</span>
<span id="cb270-75"><a href="#cb270-75" aria-hidden="true"></a>        printf(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>);</span>
<span id="cb270-76"><a href="#cb270-76" aria-hidden="true"></a>        free(tokens);</span>
<span id="cb270-77"><a href="#cb270-77" aria-hidden="true"></a>    }</span>
<span id="cb270-78"><a href="#cb270-78" aria-hidden="true"></a></span>
<span id="cb270-79"><a href="#cb270-79" aria-hidden="true"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb270-80"><a href="#cb270-80" aria-hidden="true"></a>}</span></code></pre></div>
<p>Output:</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true"></a>$ ./main.exe</span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true"></a>months=[JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC]</span>
<span id="cb271-3"><a href="#cb271-3" aria-hidden="true"></a></span>
<span id="cb271-4"><a href="#cb271-4" aria-hidden="true"></a>month=[JAN]</span>
<span id="cb271-5"><a href="#cb271-5" aria-hidden="true"></a>month=[FEB]</span>
<span id="cb271-6"><a href="#cb271-6" aria-hidden="true"></a>month=[MAR]</span>
<span id="cb271-7"><a href="#cb271-7" aria-hidden="true"></a>month=[APR]</span>
<span id="cb271-8"><a href="#cb271-8" aria-hidden="true"></a>month=[MAY]</span>
<span id="cb271-9"><a href="#cb271-9" aria-hidden="true"></a>month=[JUN]</span>
<span id="cb271-10"><a href="#cb271-10" aria-hidden="true"></a>month=[JUL]</span>
<span id="cb271-11"><a href="#cb271-11" aria-hidden="true"></a>month=[AUG]</span>
<span id="cb271-12"><a href="#cb271-12" aria-hidden="true"></a>month=[SEP]</span>
<span id="cb271-13"><a href="#cb271-13" aria-hidden="true"></a>month=[OCT]</span>
<span id="cb271-14"><a href="#cb271-14" aria-hidden="true"></a>month=[NOV]</span>
<span id="cb271-15"><a href="#cb271-15" aria-hidden="true"></a>month=[DEC]</span></code></pre></div>
</section>
<section id="answer-2-score-66" class="level4">
<h4>Answer 2 (score 66)</h4>
<p>I think <code>strsep</code> is still the best tool for this:</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true"></a><span class="cf">while</span> ((token = strsep(&amp;str, <span class="st">&quot;,&quot;</span>))) my_fn(token);</span></code></pre></div>
<p>That is literally one line that splits a string.</p>
<p>The extra parentheses are a stylistic element to indicate that we’re intentionally testing the result of an assignment, not an equality operator <code>==</code>.</p>
<p>For that pattern to work, <code>token</code> and <code>str</code> both have type <code>char *</code>. If you started with a string literal, then you’d want to make a copy of it first:</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true"></a><span class="co">// More general pattern:</span></span>
<span id="cb273-2"><a href="#cb273-2" aria-hidden="true"></a><span class="dt">const</span> <span class="dt">char</span> *my_str_literal = <span class="st">&quot;JAN,FEB,MAR&quot;</span>;</span>
<span id="cb273-3"><a href="#cb273-3" aria-hidden="true"></a><span class="dt">char</span> *token, *str, *tofree;</span>
<span id="cb273-4"><a href="#cb273-4" aria-hidden="true"></a></span>
<span id="cb273-5"><a href="#cb273-5" aria-hidden="true"></a>tofree = str = strdup(my_str_literal);  <span class="co">// We own str&#39;s memory now.</span></span>
<span id="cb273-6"><a href="#cb273-6" aria-hidden="true"></a><span class="cf">while</span> ((token = strsep(&amp;str, <span class="st">&quot;,&quot;</span>))) my_fn(token);</span>
<span id="cb273-7"><a href="#cb273-7" aria-hidden="true"></a>free(tofree);</span></code></pre></div>
<p>If two delimiters appear together in <code>str</code>, you’ll get a <code>token</code> value that’s the empty string. The value of <code>str</code> is modified in that each delimiter encountered is overwritten with a zero byte - another good reason to copy the string being parsed first.</p>
<p>In a comment, someone suggested that <code>strtok</code> is better than <code>strsep</code> because <code>strtok</code> is more portable. Ubuntu and Mac OS X have <code>strsep</code>; it’s safe to guess that other unixy systems do as well. Windows lacks <code>strsep</code>, but it has <code>strbrk</code> which enables this short and sweet <code>strsep</code> replacement:</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true"></a><span class="dt">char</span> *strsep(<span class="dt">char</span> **stringp, <span class="dt">const</span> <span class="dt">char</span> *delim) {</span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true"></a>  <span class="cf">if</span> (*stringp == NULL) { <span class="cf">return</span> NULL; }</span>
<span id="cb274-3"><a href="#cb274-3" aria-hidden="true"></a>  <span class="dt">char</span> *token_start = *stringp;</span>
<span id="cb274-4"><a href="#cb274-4" aria-hidden="true"></a>  *stringp = strpbrk(token_start, delim);</span>
<span id="cb274-5"><a href="#cb274-5" aria-hidden="true"></a>  <span class="cf">if</span> (*stringp) {</span>
<span id="cb274-6"><a href="#cb274-6" aria-hidden="true"></a>    **stringp = <span class="ch">&#39;\0&#39;</span>;</span>
<span id="cb274-7"><a href="#cb274-7" aria-hidden="true"></a>    (*stringp)++;</span>
<span id="cb274-8"><a href="#cb274-8" aria-hidden="true"></a>  }</span>
<span id="cb274-9"><a href="#cb274-9" aria-hidden="true"></a>  <span class="cf">return</span> token_start;</span>
<span id="cb274-10"><a href="#cb274-10" aria-hidden="true"></a>}</span></code></pre></div>
<p><a href="https://stackoverflow.com/a/7219504/3561">Here</a> is a good explanation of <code>strsep</code> vs <code>strtok</code>. The pros and cons may be judged subjectively; however, I think it’s a telling sign that <code>strsep</code> was designed as a replacement for <code>strtok</code>.</p>
</section>
<section id="answer-3-score-25" class="level4">
<h4>Answer 3 (score 25)</h4>
<p>String tokenizer this code should put you in the right direction.</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true"></a><span class="dt">int</span> main(<span class="dt">void</span>) {</span>
<span id="cb275-2"><a href="#cb275-2" aria-hidden="true"></a>  <span class="dt">char</span> st[] =<span class="st">&quot;Where there is will, there is a way.&quot;</span>;</span>
<span id="cb275-3"><a href="#cb275-3" aria-hidden="true"></a>  <span class="dt">char</span> *ch;</span>
<span id="cb275-4"><a href="#cb275-4" aria-hidden="true"></a>  ch = strtok(st, <span class="st">&quot; &quot;</span>);</span>
<span id="cb275-5"><a href="#cb275-5" aria-hidden="true"></a>  <span class="cf">while</span> (ch != NULL) {</span>
<span id="cb275-6"><a href="#cb275-6" aria-hidden="true"></a>  printf(<span class="st">&quot;%s</span><span class="sc">\n</span><span class="st">&quot;</span>, ch);</span>
<span id="cb275-7"><a href="#cb275-7" aria-hidden="true"></a>  ch = strtok(NULL, <span class="st">&quot; ,&quot;</span>);</span>
<span id="cb275-8"><a href="#cb275-8" aria-hidden="true"></a>  }</span>
<span id="cb275-9"><a href="#cb275-9" aria-hidden="true"></a>  getch();</span>
<span id="cb275-10"><a href="#cb275-10" aria-hidden="true"></a>  <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb275-11"><a href="#cb275-11" aria-hidden="true"></a>}</span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-to-convert-an-int-to-string-in-c-score-565158-in-2018" class="level3">
<h3>37: How to convert an int to string in C? (score <a href="https://stackoverflow.com/q/8257714.html">565158</a> in 2018)</h3>
<section id="question-36" class="level4">
<h4>Question</h4>
<p>How do you convert an <code>int</code> (integer) to a string? I’m trying to make a function that converts the data of a <code>struct</code> into a string to save it in a file.</p>
</section>
<section id="answer-accepted-score-75" class="level4">
<h4>Answer accepted (score 75)</h4>
<p><strong>EDIT:</strong> As pointed out in the comment, <code>itoa()</code> is not a standard, so better use sprintf() approach suggested in the rivaling answer!</p>
<hr>
<p>You can use <code>itoa()</code> function to <strong>convert</strong> your integer value to a string.</p>
<p>Here is an example:</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true"></a><span class="dt">int</span> num = <span class="dv">321</span>;</span>
<span id="cb276-2"><a href="#cb276-2" aria-hidden="true"></a><span class="dt">char</span> snum[<span class="dv">5</span>];</span>
<span id="cb276-3"><a href="#cb276-3" aria-hidden="true"></a></span>
<span id="cb276-4"><a href="#cb276-4" aria-hidden="true"></a><span class="co">// convert 123 to string [buf]</span></span>
<span id="cb276-5"><a href="#cb276-5" aria-hidden="true"></a>itoa(num, snum, <span class="dv">10</span>);</span>
<span id="cb276-6"><a href="#cb276-6" aria-hidden="true"></a></span>
<span id="cb276-7"><a href="#cb276-7" aria-hidden="true"></a><span class="co">// print our string</span></span>
<span id="cb276-8"><a href="#cb276-8" aria-hidden="true"></a>printf(<span class="st">&quot;%s</span><span class="sc">\n</span><span class="st">&quot;</span>, snum);</span></code></pre></div>
<hr>
<p>If you want to output your structure into a file there is no need to convert any value beforehand. You can just use the <a href="http://www.cplusplus.com/reference/clibrary/cstdio/printf/" rel="noreferrer">printf format specification</a> to indicate how to output your values and use any of the operators from <a href="http://www.tenouk.com/clabworksheet/labworksheet4.html" rel="noreferrer">printf family</a> to output your data.</p>
</section>
<section id="answer-2-score-176" class="level4">
<h4>Answer 2 (score 176)</h4>
<p>You can use <code>sprintf</code> to do it, or maybe <code>snprintf</code> if you have it:</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true"></a><span class="dt">char</span> str[ENOUGH];</span>
<span id="cb277-2"><a href="#cb277-2" aria-hidden="true"></a>sprintf(str, <span class="st">&quot;%d&quot;</span>, <span class="dv">42</span>);</span></code></pre></div>
<p>Where the number of characters (plus terminating char) in the <code>str</code> can be calculated using:</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true"></a>(<span class="dt">int</span>)((ceil(log10(num))+<span class="dv">1</span>)*<span class="kw">sizeof</span>(<span class="dt">char</span>))</span></code></pre></div>
</section>
<section id="answer-3-score-49" class="level4">
<h4>Answer 3 (score 49)</h4>
<p>The short answer is:</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true"></a>snprintf( str, size, <span class="st">&quot;%d&quot;</span>, x );</span></code></pre></div>
<p>The longer is: first you need to find out sufficient size. <code>snprintf</code> tells you length if you call it with <code>NULL, 0</code> as first parameters:</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true"></a>snprintf( NULL, <span class="dv">0</span>, <span class="st">&quot;%d&quot;</span>, x );</span></code></pre></div>
<p>Allocate one character more for null-terminator.</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true"></a><span class="dt">int</span> x = -<span class="dv">42</span>;</span>
<span id="cb281-2"><a href="#cb281-2" aria-hidden="true"></a><span class="dt">int</span> length = snprintf( NULL, <span class="dv">0</span>, <span class="st">&quot;%d&quot;</span>, x );</span>
<span id="cb281-3"><a href="#cb281-3" aria-hidden="true"></a><span class="dt">char</span>* str = malloc( length + <span class="dv">1</span> );</span>
<span id="cb281-4"><a href="#cb281-4" aria-hidden="true"></a>snprintf( str, length + <span class="dv">1</span>, <span class="st">&quot;%d&quot;</span>, x );</span>
<span id="cb281-5"><a href="#cb281-5" aria-hidden="true"></a>...</span>
<span id="cb281-6"><a href="#cb281-6" aria-hidden="true"></a>free(str);</span></code></pre></div>
<p>If works for every format string, so you can convert float or double to string by using <code>"%g"</code>, you can convert int to hex using <code>"%x"</code>, and so on.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="write-to-.txt-file-score-558915-in-2014" class="level3">
<h3>38: Write to .txt file? (score <a href="https://stackoverflow.com/q/11573974.html">558915</a> in 2014)</h3>
<section id="question-37" class="level4">
<h4>Question</h4>
<p>
How can I write a little piece of text into a <code>.txt</code> file? I’ve been Googling for over 3-4 hours, but can’t find out how to do it.
</p>
<p><code>fwrite();</code> has so many arguments, and I don’t know how to use it.</p>
<p>What’s the easiest function to use when you only want to write a name and a few numbers to a <code>.txt</code> file?</p>
<p>Edit: Added a piece of my code.</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true"></a>    <span class="dt">char</span> name;</span>
<span id="cb282-2"><a href="#cb282-2" aria-hidden="true"></a>    <span class="dt">int</span>  number;</span>
<span id="cb282-3"><a href="#cb282-3" aria-hidden="true"></a>    <span class="dt">FILE</span> *f;</span>
<span id="cb282-4"><a href="#cb282-4" aria-hidden="true"></a>    f = fopen(<span class="st">&quot;contacts.pcl&quot;</span>, <span class="st">&quot;a&quot;</span>);</span>
<span id="cb282-5"><a href="#cb282-5" aria-hidden="true"></a></span>
<span id="cb282-6"><a href="#cb282-6" aria-hidden="true"></a>    printf(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">New contact name: &quot;</span>);</span>
<span id="cb282-7"><a href="#cb282-7" aria-hidden="true"></a>    scanf(<span class="st">&quot;%s&quot;</span>, &amp;name);</span>
<span id="cb282-8"><a href="#cb282-8" aria-hidden="true"></a>    printf(<span class="st">&quot;New contact number: &quot;</span>);</span>
<span id="cb282-9"><a href="#cb282-9" aria-hidden="true"></a>    scanf(<span class="st">&quot;%i&quot;</span>, &amp;number);</span>
<span id="cb282-10"><a href="#cb282-10" aria-hidden="true"></a></span>
<span id="cb282-11"><a href="#cb282-11" aria-hidden="true"></a></span>
<span id="cb282-12"><a href="#cb282-12" aria-hidden="true"></a>    fprintf(f, <span class="st">&quot;%c</span><span class="sc">\n</span><span class="st">[ %d ]</span><span class="sc">\n\n</span><span class="st">&quot;</span>, name, number);</span>
<span id="cb282-13"><a href="#cb282-13" aria-hidden="true"></a>    fclose(f);</span></code></pre></div>
</section>
<section id="answer-accepted-score-251" class="level4">
<h4>Answer accepted (score 251)</h4>
<div class="sourceCode" id="cb283"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true"></a><span class="dt">FILE</span> *f = fopen(<span class="st">&quot;file.txt&quot;</span>, <span class="st">&quot;w&quot;</span>);</span>
<span id="cb283-2"><a href="#cb283-2" aria-hidden="true"></a><span class="cf">if</span> (f == NULL)</span>
<span id="cb283-3"><a href="#cb283-3" aria-hidden="true"></a>{</span>
<span id="cb283-4"><a href="#cb283-4" aria-hidden="true"></a>    printf(<span class="st">&quot;Error opening file!</span><span class="sc">\n</span><span class="st">&quot;</span>);</span>
<span id="cb283-5"><a href="#cb283-5" aria-hidden="true"></a>    exit(<span class="dv">1</span>);</span>
<span id="cb283-6"><a href="#cb283-6" aria-hidden="true"></a>}</span>
<span id="cb283-7"><a href="#cb283-7" aria-hidden="true"></a></span>
<span id="cb283-8"><a href="#cb283-8" aria-hidden="true"></a><span class="co">/* print some text */</span></span>
<span id="cb283-9"><a href="#cb283-9" aria-hidden="true"></a><span class="dt">const</span> <span class="dt">char</span> *text = <span class="st">&quot;Write this to the file&quot;</span>;</span>
<span id="cb283-10"><a href="#cb283-10" aria-hidden="true"></a>fprintf(f, <span class="st">&quot;Some text: %s</span><span class="sc">\n</span><span class="st">&quot;</span>, text);</span>
<span id="cb283-11"><a href="#cb283-11" aria-hidden="true"></a></span>
<span id="cb283-12"><a href="#cb283-12" aria-hidden="true"></a><span class="co">/* print integers and floats */</span></span>
<span id="cb283-13"><a href="#cb283-13" aria-hidden="true"></a><span class="dt">int</span> i = <span class="dv">1</span>;</span>
<span id="cb283-14"><a href="#cb283-14" aria-hidden="true"></a><span class="dt">float</span> py = <span class="fl">3.1415927</span>;</span>
<span id="cb283-15"><a href="#cb283-15" aria-hidden="true"></a>fprintf(f, <span class="st">&quot;Integer: %d, float: %f</span><span class="sc">\n</span><span class="st">&quot;</span>, i, py);</span>
<span id="cb283-16"><a href="#cb283-16" aria-hidden="true"></a></span>
<span id="cb283-17"><a href="#cb283-17" aria-hidden="true"></a><span class="co">/* printing single chatacters */</span></span>
<span id="cb283-18"><a href="#cb283-18" aria-hidden="true"></a><span class="dt">char</span> c = <span class="ch">&#39;A&#39;</span>;</span>
<span id="cb283-19"><a href="#cb283-19" aria-hidden="true"></a>fprintf(f, <span class="st">&quot;A character: %c</span><span class="sc">\n</span><span class="st">&quot;</span>, c);</span>
<span id="cb283-20"><a href="#cb283-20" aria-hidden="true"></a></span>
<span id="cb283-21"><a href="#cb283-21" aria-hidden="true"></a>fclose(f);</span></code></pre></div>
</section>
<section id="answer-2-score-20" class="level4">
<h4>Answer 2 (score 20)</h4>
<div class="sourceCode" id="cb284"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true"></a><span class="dt">FILE</span> *fp;</span>
<span id="cb284-2"><a href="#cb284-2" aria-hidden="true"></a><span class="dt">char</span>* str = <span class="st">&quot;string&quot;</span>;</span>
<span id="cb284-3"><a href="#cb284-3" aria-hidden="true"></a><span class="dt">int</span> x = <span class="dv">10</span>;</span>
<span id="cb284-4"><a href="#cb284-4" aria-hidden="true"></a></span>
<span id="cb284-5"><a href="#cb284-5" aria-hidden="true"></a>fp=fopen(<span class="st">&quot;test.txt&quot;</span>, <span class="st">&quot;w&quot;</span>);</span>
<span id="cb284-6"><a href="#cb284-6" aria-hidden="true"></a><span class="cf">if</span>(fp == NULL)</span>
<span id="cb284-7"><a href="#cb284-7" aria-hidden="true"></a>    exit(-<span class="dv">1</span>);</span>
<span id="cb284-8"><a href="#cb284-8" aria-hidden="true"></a>fprintf(fp, <span class="st">&quot;This is a string which is written to a file</span><span class="sc">\n</span><span class="st">&quot;</span>);</span>
<span id="cb284-9"><a href="#cb284-9" aria-hidden="true"></a>fprintf(fp, <span class="st">&quot;The string has %d words and keyword %s</span><span class="sc">\n</span><span class="st">&quot;</span>, x, str);</span>
<span id="cb284-10"><a href="#cb284-10" aria-hidden="true"></a>fclose(fp);</span></code></pre></div>
</section>
<section id="answer-3-score--1" class="level4">
<h4>Answer 3 (score -1)</h4>
<p>Well, you need to first get a good book on C and understand the language.</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true"></a><span class="dt">FILE</span> *fp;</span>
<span id="cb285-2"><a href="#cb285-2" aria-hidden="true"></a>fp = fopen(<span class="st">&quot;c:</span><span class="sc">\\</span><span class="st">test.txt&quot;</span>, <span class="st">&quot;wb&quot;</span>);</span>
<span id="cb285-3"><a href="#cb285-3" aria-hidden="true"></a><span class="cf">if</span>(fp == null)</span>
<span id="cb285-4"><a href="#cb285-4" aria-hidden="true"></a>   <span class="cf">return</span>;</span>
<span id="cb285-5"><a href="#cb285-5" aria-hidden="true"></a><span class="dt">char</span> x[<span class="dv">10</span>]=<span class="st">&quot;ABCDEFGHIJ&quot;</span>;</span>
<span id="cb285-6"><a href="#cb285-6" aria-hidden="true"></a>fwrite(x, <span class="kw">sizeof</span>(x[<span class="dv">0</span>]), <span class="kw">sizeof</span>(x)/<span class="kw">sizeof</span>(x[<span class="dv">0</span>]), fp);</span>
<span id="cb285-7"><a href="#cb285-7" aria-hidden="true"></a>fclose(fp);</span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="undefined-reference-to-pthread_create-in-linux-score-550266-in-2017" class="level3">
<h3>39: Undefined reference to pthread_create in Linux (score <a href="https://stackoverflow.com/q/1662909.html">550266</a> in 2017)</h3>
<section id="question-38" class="level4">
<h4>Question</h4>
<p>I picked up the following demo off the web from <a href="https://computing.llnl.gov/tutorials/pthreads/" rel="noreferrer">https://computing.llnl.gov/tutorials/pthreads/</a></p>
<div class="sourceCode" id="cb286"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true"></a></span>
<span id="cb286-2"><a href="#cb286-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;pthread.h&gt;</span></span>
<span id="cb286-3"><a href="#cb286-3" aria-hidden="true"></a></span>
<span id="cb286-4"><a href="#cb286-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb286-5"><a href="#cb286-5" aria-hidden="true"></a></span>
<span id="cb286-6"><a href="#cb286-6" aria-hidden="true"></a><span class="pp">#define NUM_THREADS     5</span></span>
<span id="cb286-7"><a href="#cb286-7" aria-hidden="true"></a></span>
<span id="cb286-8"><a href="#cb286-8" aria-hidden="true"></a><span class="dt">void</span> *PrintHello(<span class="dt">void</span> *threadid)</span>
<span id="cb286-9"><a href="#cb286-9" aria-hidden="true"></a>{</span>
<span id="cb286-10"><a href="#cb286-10" aria-hidden="true"></a>   <span class="dt">long</span> tid;</span>
<span id="cb286-11"><a href="#cb286-11" aria-hidden="true"></a>   tid = (<span class="dt">long</span>)threadid;</span>
<span id="cb286-12"><a href="#cb286-12" aria-hidden="true"></a>   printf(<span class="st">&quot;Hello World! It&#39;s me, thread</span></span>
<span id="cb286-13"><a href="#cb286-13" aria-hidden="true"></a><span class="er">#%ld!\n&quot;, tid);</span></span>
<span id="cb286-14"><a href="#cb286-14" aria-hidden="true"></a>   pthread_exit(NULL);</span>
<span id="cb286-15"><a href="#cb286-15" aria-hidden="true"></a>}</span>
<span id="cb286-16"><a href="#cb286-16" aria-hidden="true"></a></span>
<span id="cb286-17"><a href="#cb286-17" aria-hidden="true"></a><span class="dt">int</span> main (<span class="dt">int</span> argc, <span class="dt">char</span> *argv[])</span>
<span id="cb286-18"><a href="#cb286-18" aria-hidden="true"></a>{</span>
<span id="cb286-19"><a href="#cb286-19" aria-hidden="true"></a>   pthread_t threads[NUM_THREADS];</span>
<span id="cb286-20"><a href="#cb286-20" aria-hidden="true"></a>   <span class="dt">int</span> rc;</span>
<span id="cb286-21"><a href="#cb286-21" aria-hidden="true"></a>   <span class="dt">long</span> t;</span>
<span id="cb286-22"><a href="#cb286-22" aria-hidden="true"></a>   <span class="cf">for</span>(t=<span class="dv">0</span>; t&lt;NUM_THREADS; t++){</span>
<span id="cb286-23"><a href="#cb286-23" aria-hidden="true"></a>      printf(<span class="st">&quot;In main: creating thread %ld</span><span class="sc">\n</span><span class="st">&quot;</span>, t);</span>
<span id="cb286-24"><a href="#cb286-24" aria-hidden="true"></a>      rc = pthread_create(&amp;threads[t], NULL, PrintHello, (<span class="dt">void</span> *)t);</span>
<span id="cb286-25"><a href="#cb286-25" aria-hidden="true"></a>      <span class="cf">if</span> (rc){</span>
<span id="cb286-26"><a href="#cb286-26" aria-hidden="true"></a>         printf(<span class="st">&quot;ERROR; return code from pthread_create() is %d</span><span class="sc">\n</span><span class="st">&quot;</span>, rc);</span>
<span id="cb286-27"><a href="#cb286-27" aria-hidden="true"></a>         exit(-<span class="dv">1</span>);</span>
<span id="cb286-28"><a href="#cb286-28" aria-hidden="true"></a>      }</span>
<span id="cb286-29"><a href="#cb286-29" aria-hidden="true"></a>   }</span>
<span id="cb286-30"><a href="#cb286-30" aria-hidden="true"></a>   pthread_exit(NULL);</span>
<span id="cb286-31"><a href="#cb286-31" aria-hidden="true"></a>}</span></code></pre></div>
<p>But when I compile it on my machine (running Ubuntu Linux 9.04) I get the following error:</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true"></a>corey@ubuntu:~/demo$ gcc -o term term.c</span>
<span id="cb287-2"><a href="#cb287-2" aria-hidden="true"></a>term.c: In function ‘main’:</span>
<span id="cb287-3"><a href="#cb287-3" aria-hidden="true"></a>term.c:<span class="dv">23</span>: warning: incompatible implicit declaration of built-in function ‘exit’</span>
<span id="cb287-4"><a href="#cb287-4" aria-hidden="true"></a>/tmp/cc8BMzwx.o: In function `main&#39;:</span>
<span id="cb287-5"><a href="#cb287-5" aria-hidden="true"></a>term.c:(.text+<span class="bn">0x82</span>): undefined reference to `pthread_create&#39;</span>
<span id="cb287-6"><a href="#cb287-6" aria-hidden="true"></a>collect2: ld returned <span class="dv">1</span> exit status</span></code></pre></div>
<p>This doesn’t make any sense to me, because the header includes <code>pthread.h</code>, which should have the <code>pthread_create</code> function. Any ideas what’s going wrong?</p>
</section>
<section id="answer-2-score-630" class="level4">
<h4>Answer 2 (score 630)</h4>
<p>
Both answers to this question so far are <em>incorrect</em>.<br> For Linux the correct command is:
</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true"></a>gcc -pthread -o term term.c</span></code></pre></div>
<p>In general, libraries should follow sources and objects on command line, and <code>-lpthread</code> is not an “option”, it’s a library specification. On a system with only <code>libpthread.a</code> installed,</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true"></a>gcc -lpthread ...</span></code></pre></div>
<p>will fail to link.</p>
</section>
<section id="answer-3-score-35" class="level4">
<h4>Answer 3 (score 35)</h4>
<p>in eclipse</p>
<p>properties-&gt;c/c++Build-&gt;setting-&gt;GCC C++ linker-&gt;libraries in top part add “pthread”</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="fastest-way-to-check-if-a-file-exist-using-standard-cc11c-score-550079-in-2017" class="level3">
<h3>40: Fastest way to check if a file exist using standard C++/C++11/C? (score <a href="https://stackoverflow.com/q/12774207.html">550079</a> in 2017)</h3>
<section id="question-39" class="level4">
<h4>Question</h4>
<p>I would like to find the fastest way to check if a file exist in standard C++11, C++, or C. I have thousands of files and before doing something on them I need to check if all of them exist. What can I write instead of <code>/* SOMETHING */</code> in the following function?</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true"></a><span class="kw">inline</span> <span class="dt">bool</span> exist(<span class="dt">const</span> std::string&amp; name)</span>
<span id="cb290-2"><a href="#cb290-2" aria-hidden="true"></a>{</span>
<span id="cb290-3"><a href="#cb290-3" aria-hidden="true"></a>    <span class="co">/* SOMETHING */</span></span>
<span id="cb290-4"><a href="#cb290-4" aria-hidden="true"></a>}</span></code></pre></div>
</section>
<section id="answer-accepted-score-694" class="level4">
<h4>Answer accepted (score 694)</h4>
<p>Well I threw together a test program that ran each of these methods 100,000 times, half on files that existed and half on files that didn’t.</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true"></a></span>
<span id="cb291-2"><a href="#cb291-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;sys/stat.h&gt;</span></span>
<span id="cb291-3"><a href="#cb291-3" aria-hidden="true"></a></span>
<span id="cb291-4"><a href="#cb291-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;unistd.h&gt;</span></span>
<span id="cb291-5"><a href="#cb291-5" aria-hidden="true"></a></span>
<span id="cb291-6"><a href="#cb291-6" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;string&gt;</span></span>
<span id="cb291-7"><a href="#cb291-7" aria-hidden="true"></a></span>
<span id="cb291-8"><a href="#cb291-8" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;fstream&gt;</span></span>
<span id="cb291-9"><a href="#cb291-9" aria-hidden="true"></a></span>
<span id="cb291-10"><a href="#cb291-10" aria-hidden="true"></a><span class="kw">inline</span> <span class="dt">bool</span> exists_test0 (<span class="dt">const</span> std::string&amp; name) {</span>
<span id="cb291-11"><a href="#cb291-11" aria-hidden="true"></a>    ifstream f(name.c_str());</span>
<span id="cb291-12"><a href="#cb291-12" aria-hidden="true"></a>    <span class="cf">return</span> f.good();</span>
<span id="cb291-13"><a href="#cb291-13" aria-hidden="true"></a>}</span>
<span id="cb291-14"><a href="#cb291-14" aria-hidden="true"></a></span>
<span id="cb291-15"><a href="#cb291-15" aria-hidden="true"></a><span class="kw">inline</span> <span class="dt">bool</span> exists_test1 (<span class="dt">const</span> std::string&amp; name) {</span>
<span id="cb291-16"><a href="#cb291-16" aria-hidden="true"></a>    <span class="cf">if</span> (<span class="dt">FILE</span> *file = fopen(name.c_str(), <span class="st">&quot;r&quot;</span>)) {</span>
<span id="cb291-17"><a href="#cb291-17" aria-hidden="true"></a>        fclose(file);</span>
<span id="cb291-18"><a href="#cb291-18" aria-hidden="true"></a>        <span class="cf">return</span> true;</span>
<span id="cb291-19"><a href="#cb291-19" aria-hidden="true"></a>    } <span class="cf">else</span> {</span>
<span id="cb291-20"><a href="#cb291-20" aria-hidden="true"></a>        <span class="cf">return</span> false;</span>
<span id="cb291-21"><a href="#cb291-21" aria-hidden="true"></a>    }   </span>
<span id="cb291-22"><a href="#cb291-22" aria-hidden="true"></a>}</span>
<span id="cb291-23"><a href="#cb291-23" aria-hidden="true"></a></span>
<span id="cb291-24"><a href="#cb291-24" aria-hidden="true"></a><span class="kw">inline</span> <span class="dt">bool</span> exists_test2 (<span class="dt">const</span> std::string&amp; name) {</span>
<span id="cb291-25"><a href="#cb291-25" aria-hidden="true"></a>    <span class="cf">return</span> ( access( name.c_str(), F_OK ) != -<span class="dv">1</span> );</span>
<span id="cb291-26"><a href="#cb291-26" aria-hidden="true"></a>}</span>
<span id="cb291-27"><a href="#cb291-27" aria-hidden="true"></a></span>
<span id="cb291-28"><a href="#cb291-28" aria-hidden="true"></a><span class="kw">inline</span> <span class="dt">bool</span> exists_test3 (<span class="dt">const</span> std::string&amp; name) {</span>
<span id="cb291-29"><a href="#cb291-29" aria-hidden="true"></a>  <span class="kw">struct</span> stat buffer;   </span>
<span id="cb291-30"><a href="#cb291-30" aria-hidden="true"></a>  <span class="cf">return</span> (stat (name.c_str(), &amp;buffer) == <span class="dv">0</span>); </span>
<span id="cb291-31"><a href="#cb291-31" aria-hidden="true"></a>}</span></code></pre></div>
<p>Results for total time to run the 100,000 calls averaged over 5 runs,</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true"></a>Method exists_test0 (ifstream): **<span class="fl">0.485</span><span class="er">s</span>**</span>
<span id="cb292-2"><a href="#cb292-2" aria-hidden="true"></a>Method exists_test1 (<span class="dt">FILE</span> fopen): **<span class="fl">0.302</span><span class="er">s</span>**</span>
<span id="cb292-3"><a href="#cb292-3" aria-hidden="true"></a>Method exists_test2 (posix access()): **<span class="fl">0.202</span><span class="er">s</span>**</span>
<span id="cb292-4"><a href="#cb292-4" aria-hidden="true"></a>Method exists_test3 (posix stat()): **<span class="fl">0.134</span><span class="er">s</span>**</span></code></pre></div>
<p>The <code>stat()</code> function provided the best performance on my system (Linux, compiled with <code>g++</code>), with a standard <code>fopen</code> call being your best bet if you for some reason refuse to use POSIX functions.</p>
</section>
<section id="answer-2-score-118" class="level4">
<h4>Answer 2 (score 118)</h4>
<p>Remark : in C++14 and as soon as the <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4099.html" rel="noreferrer">filesystem TS</a> will be finished and adopted, the solution will be to use:</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true"></a>std::experimental::filesystem::exists(<span class="st">&quot;helloworld.txt&quot;</span>);</span></code></pre></div>
<p>and since C++17, only:</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true"></a>std::filesystem::exists(<span class="st">&quot;helloworld.txt&quot;</span>);</span></code></pre></div>
</section>
<section id="answer-3-score-104-1" class="level4">
<h4>Answer 3 (score 104)</h4>
<p>I use this piece of code, it works OK with me so far. This does not use many fancy features of C++:</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true"></a><span class="dt">bool</span> is_file_exist(<span class="dt">const</span> <span class="dt">char</span> *fileName)</span>
<span id="cb295-2"><a href="#cb295-2" aria-hidden="true"></a>{</span>
<span id="cb295-3"><a href="#cb295-3" aria-hidden="true"></a>    std::ifstream infile(fileName);</span>
<span id="cb295-4"><a href="#cb295-4" aria-hidden="true"></a>    <span class="cf">return</span> infile.good();</span>
<span id="cb295-5"><a href="#cb295-5" aria-hidden="true"></a>}</span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="what-is-a-static-function-score-546371-in-2017" class="level3">
<h3>41: What is a “static” function? (score <a href="https://stackoverflow.com/q/558122.html">546371</a> in 2017)</h3>
<section id="question-40" class="level4">
<h4>Question</h4>
<p>The question was about plain <a href="/questions/tagged/c" class="post-tag" title="show questions tagged &
#39;c&#39;" rel="tag">c</a> functions, not <a href="/questions/tagged/c%2b%2b" class="post-tag" title="show questions tagged &#39;c++&#39;" rel="tag">c++</a> <code>static</code> methods, as clarified in comments.</p>
<p>Ok, I understand what a <code>static</code> variable is, but what is a <code>static</code> function?</p>
<p>And why is it that if I declare a function, let’s say <code>void print_matrix</code>, in let’s say <code>a.c</code> (WITHOUT <code>a.h</code>) and include <code>"a.c"</code> - I get <code>"print_matrix@@....) already defined in a.obj"</code>, BUT if I declare it as <code>static void print_matrix</code> then it compiles?</p>
<p><strong>UPDATE</strong> Just to clear things up - I know that including <code>.c</code> is bad, as many of you pointed out. I just do it to temporarily clear space in <code>main.c</code> until I have a better idea of how to group all those functions into proper <code>.h</code> and <code>.c</code> files. Just a temporary, quick solution.</p>
</section>
<section id="answer-accepted-score-629" class="level4">
<h4>Answer accepted (score 629)</h4>
<p><code>static</code> functions are functions that are only visible to other functions in the same file (more precisely <em>the same <a href="http://en.wikipedia.org/wiki/Translation_unit_%28programming%29" rel="noreferrer">translation unit</a></em>).</p>
<p><strong>EDIT</strong>: For those who thought, that the author of the questions meant a ‘class method’: As the question is tagged <code>C</code> he means a plain old C function. For (C++/Java/…) class methods, <code>static</code> means that this method can be called on the class itself, no instance of that class necessary.</p>
</section>
<section id="answer-2-score-189" class="level4">
<h4>Answer 2 (score 189)</h4>
<p>There is a big difference between static functions in C and static member functions in C++. In C, a static function is not visible outside of its translation unit, which is the object file it is compiled into. In other words, making a function static limits its scope. You can think of a static function as being “private” to its *.c file (although that is not strictly correct).</p>
<p>In C++, “static” can also apply to member functions and data members of classes. A static data member is also called a “class variable”, while a non-static data member is an “instance variable”. This is Smalltalk terminology. This means that there is only one copy of a static data member shared by all objects of a class, while each object has its own copy of a non-static data member. So a static data member is essentially a global variable, that is a member of a class.</p>
<p>Non-static member functions can access all data members of the class: static and non-static. Static member functions can only operate on the static data members.</p>
<p>One way to think about this is that in C++ static data members and static member functions do not belong to any object, but to the entire class.</p>
</section>
<section id="answer-3-score-75" class="level4">
<h4>Answer 3 (score 75)</h4>
<p>There are two uses for the keyword static when it comes to functions in C++.</p>
<p>The first is to mark the function as having internal linkage so it cannot be referenced in other translation units. This usage is deprecated in C++. Unnamed namespaces are preferred for this usage.</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true"></a><span class="co">// inside some .cpp file:</span></span>
<span id="cb296-2"><a href="#cb296-2" aria-hidden="true"></a></span>
<span id="cb296-3"><a href="#cb296-3" aria-hidden="true"></a><span class="dt">static</span> <span class="dt">void</span> foo();    <span class="co">// old &quot;C&quot; way of having internal linkage</span></span>
<span id="cb296-4"><a href="#cb296-4" aria-hidden="true"></a></span>
<span id="cb296-5"><a href="#cb296-5" aria-hidden="true"></a><span class="co">// C++ way:</span></span>
<span id="cb296-6"><a href="#cb296-6" aria-hidden="true"></a>namespace</span>
<span id="cb296-7"><a href="#cb296-7" aria-hidden="true"></a>{</span>
<span id="cb296-8"><a href="#cb296-8" aria-hidden="true"></a>   <span class="dt">void</span> this_function_has_internal_linkage()</span>
<span id="cb296-9"><a href="#cb296-9" aria-hidden="true"></a>   {</span>
<span id="cb296-10"><a href="#cb296-10" aria-hidden="true"></a>      <span class="co">// ...</span></span>
<span id="cb296-11"><a href="#cb296-11" aria-hidden="true"></a>   }</span>
<span id="cb296-12"><a href="#cb296-12" aria-hidden="true"></a>}</span></code></pre></div>
<p>The second usage is in the context of a class. If a class has a static member function, that means the function is a member of the class (and has the usual access to other members), but it doesn’t need to be invoked through a particular object. In other words, inside that function, there is no “this” pointer.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="what-is-a-segmentation-fault-score-539500-in-2016" class="level3">
<h3>42: What is a segmentation fault? (score <a href="https://stackoverflow.com/q/2346806.html">539500</a> in 2016)</h3>
<section id="question-41" class="level4">
<h4>Question</h4>
<p>What is a segmentation fault? Is it different in C and C++? How are segmentation faults and dangling pointers related?</p>
</section>
<section id="answer-accepted-score-610" class="level4">
<h4>Answer accepted (score 610)</h4>
<p>Segmentation fault is a specific kind of error caused by accessing memory that “does not belong to you.” It’s a helper mechanism that keeps you from corrupting the memory and introducing hard-to-debug memory bugs. Whenever you get a segfault you know you are doing something wrong with memory – accessing variable that has already been freed, writing to a read-only portion of the memory, etc. Segmentation fault is essentially the same in most languages that let you mess with the memory management, there is no principial difference between segfaults in C and C++.</p>
<p>There are many ways to get a segfault, at least in the lower-level languages such as C(++). A common way to get a segfault is to dereference a null pointer:</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true"></a><span class="dt">int</span> *p = NULL;</span>
<span id="cb297-2"><a href="#cb297-2" aria-hidden="true"></a>*p = <span class="dv">1</span>;</span></code></pre></div>
<p>Another segfault happens when you try to write to a portion of memory that was marked as read-only:</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true"></a><span class="dt">char</span> *str = <span class="st">&quot;Foo&quot;</span>; <span class="co">// Compiler marks the constant string as read-only</span></span>
<span id="cb298-2"><a href="#cb298-2" aria-hidden="true"></a>*str = <span class="ch">&#39;b&#39;</span>; <span class="co">// Which means this is illegal and results in a segfault</span></span></code></pre></div>
<p>Dangling pointer points to a thing that does not exist any more, like here:</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true"></a><span class="dt">char</span> *p = NULL;</span>
<span id="cb299-2"><a href="#cb299-2" aria-hidden="true"></a>{</span>
<span id="cb299-3"><a href="#cb299-3" aria-hidden="true"></a>    <span class="dt">char</span> c;</span>
<span id="cb299-4"><a href="#cb299-4" aria-hidden="true"></a>    p = &amp;c;</span>
<span id="cb299-5"><a href="#cb299-5" aria-hidden="true"></a>}</span>
<span id="cb299-6"><a href="#cb299-6" aria-hidden="true"></a><span class="co">// Now p is dangling</span></span></code></pre></div>
<p>The pointer <code>p</code> dangles because it points to character variable <code>c</code> that ceased to exist after the block ended. And when you try to dereference dangling pointer (like <code>*p='A'</code>), you would probably get a segfault.</p>
</section>
<section id="answer-2-score-106" class="level4">
<h4>Answer 2 (score 106)</h4>
<p>It would be worth noting that segmentation fault isn’t caused by directly accessing another process memory (this is what I’m hearing sometimes), as it is simply not possible. With virtual memory every process has its own virtual address space and there is no way to access another one using any value of pointer. Exception to this can be shared libraries which are same physical address space mapped to (possibly) different virtual addresses and kernel memory which is even mapped in the same way in every process (to avoid TLB flushing on syscall, I think). And things like shmat ;) - these are what I count as ‘indirect’ access. One can, however, check that they are usually located long way from process code and we are usually able to access them (this is why they are there, nevertheless accessing them in a improper way will produce segmentation fault).</p>
<p>Still, segmentation fault can occur in case of accessing our own (process) memory in improper way (for instance trying to write to non-writable space). But the most common reason for it is the access to the part of the virtual address space that is <em>not mapped</em> to physical one at all.</p>
<p>And all of this with respect to virtual memory systems.</p>
</section>
<section id="answer-3-score-33" class="level4">
<h4>Answer 3 (score 33)</h4>
<p>A segmentation fault is caused by a request for a page that the process does not have listed in its descriptor table, or an invalid request for a page that it does have listed (e.g. a write request on a read-only page).</p>
<p>A dangling pointer is a pointer that may or may not point to a valid page, but does point to an “unexpected” segment of memory.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="what-is-an-unsigned-char-score-539232-in-2016" class="level3">
<h3>43: What is an unsigned char? (score <a href="https://stackoverflow.com/q/75191.html">539232</a> in 2016)</h3>
<section id="question-42" class="level4">
<h4>Question</h4>
<p>In C/C++, what an <code>unsigned char</code> is used for? How is it different from a regular <code>char</code>?</p>
</section>
<section id="answer-accepted-score-523" class="level4">
<h4>Answer accepted (score 523)</h4>
<p>In C++, there are three <em>distinct</em> character types:</p>
<ul>
<li>
<code>char</code>
</li>
<li>
<code>signed char</code>
</li>
<li>
<code>unsigned char</code>
</li>
</ul>
<p>If you are using character types for <em>text</em>, use the unqualified <code>char</code>:</p>
<ul>
<li>
it is the type of character literals like <code>'a'</code> or <code>'0'</code>.
</li>
<li>
it is the type that makes up C strings like <code>"abcde"</code>
</li>
</ul>
<p>It also works out as a number value, but it is unspecified whether that value is treated as signed or unsigned. Beware character comparisons through inequalities - although if you limit yourself to ASCII (0-127) you’re just about safe.</p>
<p>If you are using character types as <em>numbers</em>, use:</p>
<ul>
<li>
<code>signed char</code>, which gives you <em>at least</em> the -127 to 127 range. (-128 to 127 is common)
</li>
<li>
<code>unsigned char</code>, which gives you <em>at least</em> the 0 to 255 range.
</li>
</ul>
<p>“At least”, because the C++ standard only gives the minimum range of values that each numeric type is required to cover. <code>sizeof (char)</code> is required to be 1 (i.e. one byte), but a byte could in theory be for example 32 bits. <strong><code>sizeof</code> would still be report its size as <code>1</code></strong> - meaning that you <em>could</em> have <code>sizeof (char) == sizeof (long) == 1</code>.</p>
</section>
<section id="answer-2-score-84-2" class="level4">
<h4>Answer 2 (score 84)</h4>
<p>This is implementation dependent, as the C standard does NOT define the signed-ness of <code>char</code>. Depending on the platform, char may be <code>signed</code> or <code>unsigned</code>, so you need to explicitly ask for <code>signed char</code> or <code>unsigned char</code> if your implementation depends on it. Just use <code>char</code> if you intend to represent characters from strings, as this will match what your platform puts in the string.</p>
<p>The difference between <code>signed char</code> and <code>unsigned char</code> is as you’d expect. On most platforms, <code>signed char</code> will be an 8-bit two’s complement number ranging from <code>-128</code> to <code>127</code>, and <code>unsigned char</code> will be an 8-bit unsigned integer (<code>0</code> to <code>255</code>). Note the standard does NOT require that <code>char</code> types have 8 bits, only that <code>sizeof(char)</code> return <code>1</code>. You can get at the number of bits in a char with <code>CHAR_BIT</code> in <code>limits.h</code>. There are few if any platforms today where this will be something other than <code>8</code>, though.</p>
<p>There is a nice summary of this issue <a href="http://www.arm.linux.org.uk/docs/faqs/signedchar.php" rel="noreferrer">here</a>.</p>
<p>As others have mentioned since I posted this, you’re better off using <code>int8_t</code> and <code>uint8_t</code> if you really want to represent small integers.</p>
</section>
<section id="answer-3-score-34" class="level4">
<h4>Answer 3 (score 34)</h4>
<p>Because i feel it’s really called for, i just want to state some rules of C and C++ (they are the same in this regard). First, <em>all bits</em> of <code>unsigned char</code> participate in determining the value if any unsigned char object. Second, <code>unsigned char</code> is explicitly stated unsigned.</p>
<p>Now, i had a discussion with someone about what happens when you convert the value <code>-1</code> of type int to <code>unsigned char</code>. He refused the idea that the resulting <code>unsigned char</code> has all its bits set to 1, because he was worried about sign representation. But he don’t have to. It’s immediately following out of this rule that the conversion does what is intended:</p>
<blockquote>
<p>
If the new type is unsigned, the value is converted by repeatedly adding or subtracting one more than the maximum value that can be represented in the new type until the value is in the range of the new type. (<code>6.3.1.3p2</code> in a C99 draft)
</p>
</blockquote>
<p>That’s a mathematical description. C++ describes it in terms of modulo calculus, which yields to the same rule. Anyway, what is <em>not</em> guaranteed is that all bits in the integer <code>-1</code> are one before the conversion. So, what do we have so we can claim that the resulting <code>unsigned char</code> has all its <code>CHAR_BIT</code> bits turned to 1?</p>
<ol>
<li>
All bits participate in determining its value - that is, no padding bits occur in the object.
</li>
<li>
Adding only one time <code>UCHAR_MAX+1</code> to <code>-1</code> will yield a value in range, namely <code>UCHAR_MAX</code>
</li>
</ol>
<p>That’s enough, actually! So whenever you want to have an <code>unsigned char</code> having all its bits one, you do</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb300-1"><a href="#cb300-1" aria-hidden="true"></a><span class="dt">unsigned</span> <span class="dt">char</span> c = (<span class="dt">unsigned</span> <span class="dt">char</span>)-<span class="dv">1</span>;</span></code></pre></div>
<p>It also follows that a conversion is <em>not</em> just truncating higher order bits. The fortunate event for <em>two’s complement</em> is that it is just a truncation there, but the same isn’t necessarily true for other sign representations.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="what-is-the-difference-between-include-and-include-filename-score-537618-in-2016" class="level3">
<h3>44: What is the difference between #include <filename> and #include “filename”? (score <a href="https://stackoverflow.com/q/21593.html">537618</a> in 2016)</h3>
<section id="question-43" class="level4">
<h4>Question</h4>
<p>In the C and C++ programming languages, what is the difference between using angle brackets and using quotes in an <code>include</code> statement, as follows?</p>
<ol>
<li>
<code>#include &amp;lt;filename&amp;gt;</code>
</li>
<li>
<code>#include "filename"</code>
</li>
</ol>
</section>
<section id="answer-2-score-1283" class="level4">
<h4>Answer 2 (score 1283)</h4>
<p>In practice, the difference is in the location where the preprocessor searches for the included file.</p>
<p>For <code>#include &amp;lt;filename&amp;gt;</code> the preprocessor searches in an implementation dependent manner, normally in search directories pre-designated by the compiler/IDE. This method is normally used to include standard library header files.</p>
<p>For <code>#include "filename"</code> the preprocessor searches first in the same directory as the file containing the directive, and then follows the search path used for the <code>#include &amp;lt;filename&amp;gt;</code> form. This method is normally used to include programmer-defined header files.</p>
<p>A more complete description is available in the GCC <a href="https://gcc.gnu.org/onlinedocs/cpp/Search-Path.html" rel="noreferrer">documentation on search paths</a>.</p>
</section>
<section id="answer-3-score-674" class="level4">
<h4>Answer 3 (score 674)</h4>
<p>The only way to know is to read your implementation’s documentation.</p>
<p>In <a href="http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf
#page=182" rel="noreferrer">the C standard</a>, section 6.10.2, paragraphs 2 to 4 state:</p>
<blockquote>
<ul>
<li>
<p>
A preprocessing directive of the form
</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true"></a></span>
<span id="cb301-2"><a href="#cb301-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;h-char-sequence&gt;</span><span class="pp"> new-line</span></span></code></pre></div>
searches a sequence of implementation-defined places for a <strong>header</strong> identified uniquely by the specified sequence between the <code>&amp;lt;</code> and <code>&amp;gt;</code> delimiters, and causes the replacement of that directive by the entire contents of the <strong>header</strong>. How the places are specified or the header identified is implementation-defined.
</li>
<li>
<p>
A preprocessing directive of the form
</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true"></a></span>
<span id="cb302-2"><a href="#cb302-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;q-char-sequence&quot;</span><span class="pp"> new-line</span></span></code></pre></div>
<p>causes the replacement of that directive by the entire contents of the <strong>source file</strong> identified by the specified sequence between the <code>"</code> delimiters. The named <strong>source file</strong> is searched for in an implementation-defined manner. If this search is not supported, or if the search fails, the directive is reprocessed as if it read</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true"></a></span>
<span id="cb303-2"><a href="#cb303-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;h-char-sequence&gt;</span><span class="pp"> new-line</span></span></code></pre></div>
<p>
with the identical contained sequence (including <code>&amp;gt;</code> characters, if any) from the original directive.
</p>
</li>
<li>
<p>
A preprocessing directive of the form
</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb304-1"><a href="#cb304-1" aria-hidden="true"></a></span>
<span id="cb304-2"><a href="#cb304-2" aria-hidden="true"></a><span class="pp">#include pp-tokens new-line</span></span></code></pre></div>
(that does not match one of the two previous forms) is permitted. The preprocessing tokens after <code>include</code> in the directive are processed just as in normal text. (Each identifier currently defined as a macro name is replaced by its replacement list of preprocessing tokens.) The directive resulting after all replacements shall match one of the two previous forms. The method by which a sequence of preprocessing tokens between a <code>&amp;lt;</code> and a <code>&amp;gt;</code> preprocessing token pair or a pair of <code>"</code> characters is combined into a single header name preprocessing token is implementation-defined.
</li>
</ul>
<h5>
Definitions:
</h3>
<ul>
<li>
<p>
h-char: any member of the source character set except the new-line character and <code>&amp;gt;</code>
</p>
</li>
<li>
<p>
q-char: any member of the source character set except the new-line character and <code>"</code>
</p>
</li>
</ul>
</blockquote>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="use-of-exit-function-score-533873-in-2013" class="level3">
<h3>45: Use of exit() function (score <a href="https://stackoverflow.com/q/2425167.html">533873</a> in 2013)</h3>
<section id="question-44" class="level4">
<h4>Question</h4>
<p>I want to know how and when can I use the <code>exit()</code> function like the program in my book:</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true"></a></span>
<span id="cb305-2"><a href="#cb305-2" aria-hidden="true"></a><span class="pp">#include</span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb305-3"><a href="#cb305-3" aria-hidden="true"></a></span>
<span id="cb305-4"><a href="#cb305-4" aria-hidden="true"></a><span class="dt">void</span> main()</span>
<span id="cb305-5"><a href="#cb305-5" aria-hidden="true"></a>{</span>
<span id="cb305-6"><a href="#cb305-6" aria-hidden="true"></a>    <span class="dt">int</span> goals;</span>
<span id="cb305-7"><a href="#cb305-7" aria-hidden="true"></a>    printf(<span class="st">&quot;enter number of goals scored&quot;</span>);</span>
<span id="cb305-8"><a href="#cb305-8" aria-hidden="true"></a>    scanf(<span class="st">&quot;%d&quot;</span>,&amp;goals);</span>
<span id="cb305-9"><a href="#cb305-9" aria-hidden="true"></a></span>
<span id="cb305-10"><a href="#cb305-10" aria-hidden="true"></a>    <span class="cf">if</span>(goals&lt;=<span class="dv">5</span>)</span>
<span id="cb305-11"><a href="#cb305-11" aria-hidden="true"></a>        <span class="cf">goto</span> sos;</span>
<span id="cb305-12"><a href="#cb305-12" aria-hidden="true"></a>    <span class="cf">else</span></span>
<span id="cb305-13"><a href="#cb305-13" aria-hidden="true"></a>    {</span>
<span id="cb305-14"><a href="#cb305-14" aria-hidden="true"></a>        printf(<span class="st">&quot;hehe&quot;</span>);</span>
<span id="cb305-15"><a href="#cb305-15" aria-hidden="true"></a>        exit( );</span>
<span id="cb305-16"><a href="#cb305-16" aria-hidden="true"></a>    }</span>
<span id="cb305-17"><a href="#cb305-17" aria-hidden="true"></a>    sos:</span>
<span id="cb305-18"><a href="#cb305-18" aria-hidden="true"></a>    printf(<span class="st">&quot;to err is human&quot;</span>);</span>
<span id="cb305-19"><a href="#cb305-19" aria-hidden="true"></a>}</span></code></pre></div>
<p>When I run it, it shows ERROR: <em>call to undefined function exit()</em>.</p>
<p>Also, I want to know how I can create an option to close the window in which the program runs? For example, I made a menu-driven program which had several options and one of them was <em>“exit the menu”</em>. How can I make this exit the program (i.e. close the window)?</p>
</section>
<section id="answer-accepted-score-159" class="level4">
<h4>Answer accepted (score 159)</h4>
<p>Try using <code>exit(0);</code> instead. The <a href="http://man7.org/linux/man-pages/man3/exit.3.html" rel="noreferrer"><code>exit</code></a> function expects an integer parameter. And don’t forget to <code>#include &amp;lt;stdlib.h&amp;gt;</code>.</p>
</section>
<section id="answer-2-score-80" class="level4">
<h4>Answer 2 (score 80)</h4>
<p>The <code>exit</code> function is declared in the stdlib header, so you need to have</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb306-1"><a href="#cb306-1" aria-hidden="true"></a></span>
<span id="cb306-2"><a href="#cb306-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdlib.h&gt;</span></span></code></pre></div>
<p>at the top of your program to be able to use <code>exit</code>.</p>
<p>Note also that <code>exit</code> takes an integer argument, so you can’t call it like <code>exit()</code>, you have to call as <code>exit(0)</code> or <code>exit(42)</code>. 0 usually means your program completed successfully, and nonzero values are used as error codes.</p>
<p>There are also predefined macros <code>EXIT_SUCCESS</code> and <code>EXIT_FAILURE</code>, e.g. <code>exit(EXIT_SUCCESS);</code></p>
</section>
<section id="answer-3-score-11" class="level4">
<h4>Answer 3 (score 11)</h4>
<p><code>exit(int code);</code> is declared in <code>stdlib.h</code> so you need an</p>
<div class="sourceCode" id="cb307"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true"></a></span>
<span id="cb307-2"><a href="#cb307-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdlib.h&gt;</span></span></code></pre></div>
<p>
Also:<br> - You have no parameter for the <code>exit()</code>, it requires an <code>int</code> so provide one.<br> - Burn this book, it uses <code>goto</code> which is (for everyone but linux kernel hackers) bad, very, <em>very</em>, VERY bad.
</p>
<p>
Edit:<br> Oh, and
</p>
<div class="sourceCode" id="cb308"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb308-1"><a href="#cb308-1" aria-hidden="true"></a><span class="dt">void</span> main()</span></code></pre></div>
<p>is bad, too, it’s:</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true"></a><span class="dt">int</span> main(<span class="dt">int</span> argc, <span class="dt">char</span> *argv[])</span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="is-the-size-of-c-int-2-bytes-or-4-bytes-score-523652-in-2014" class="level3">
<h3>46: Is the size of C “int” 2 bytes or 4 bytes? (score <a href="https://stackoverflow.com/q/11438794.html">523652</a> in 2014)</h3>
<section id="question-45" class="level4">
<h4>Question</h4>
<p>Does an Integer variable in C occupy 2 bytes or 4 bytes? What are the factors that it depends on?</p>
<p>
Most of the textbooks say integer variables occupy 2 bytes. But when I run a program printing the successive addresses of an array of integers it shows the difference of 4.
</p>
</section>
<section id="answer-2-score-160" class="level4">
<h4>Answer 2 (score 160)</h4>
<p>I know it’s equal to <code>sizeof(int)</code>. The size of an <code>int</code> is really compiler dependent. Back in the day, when processors were 16 bit, an <code>int</code> was 2 bytes. Nowadays, it’s most often 4 bytes on a 32-bit as well as 64-bit systems.</p>
<p>Still, using <code>sizeof(int)</code> is the best way to get the size of an integer for the specific system the program is executed on.</p>
<p><strong>EDIT:</strong> Fixed wrong statement that <code>int</code> is 8 bytes on most 64-bit systems. For example, it is 4 bytes on 64-bit GCC.</p>
</section>
<section id="answer-3-score-97" class="level4">
<h4>Answer 3 (score 97)</h4>
<p>This is one of the points in C that can be confusing at first, but the C standard only specifies a <em>minimum range</em> for integer types that is guaranteed to be supported. <code>int</code> is guaranteed to be able to hold -32767 to 32767, which requires 16 bits. In that case, <code>int</code>, is 2 bytes. However, implementations are free to go beyond that minimum, as you will see that many modern compilers make <code>int</code> 32-bit (which also means 4 bytes pretty ubiquitously).</p>
<p>The reason your book says 2 bytes is most probably because it’s old. At one time, this was the norm. In general, you should always use the <code>sizeof</code> operator if you need to find out how many bytes it is on the platform you’re using.</p>
<p>To address this, C99 added new types where you can explicitly ask for a certain sized integer, for example <code>int16_t</code> or <code>int32_t</code>. Prior to that, there was no universal way to get an integer of a specific width (although most platforms provided similar types on a per-platform basis).</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="c-char-array-initialization-score-523179-in-2015" class="level3">
<h3>47: C char array initialization (score <a href="https://stackoverflow.com/q/18688971.html">523179</a> in 2015)</h3>
<section id="question-46" class="level4">
<h4>Question</h4>
<p>I’m not sure what will be in the char array after initialization in the following ways.</p>
<p>
1.<code>char buf[10] = "";</code><br> 2. <code>char buf[10] = " ";</code><br> 3. <code>char buf[10] = "a";</code>
</p>
<p>For case 2, I think <code>buf[0]</code> should be <code>' '</code>, <code>buf[1]</code> should be <code>'\0'</code>, and from <code>buf[2]</code> to <code>buf[9]</code> will be random content. For case 3, I think <code>buf[0]</code> should be <code>'a'</code>, <code>buf[1]</code> should be ‘\0’, and from <code>buf[2]</code> to <code>buf[9]</code> will be random content.</p>
<p>Is that correct?</p>
<p>And for the case 1, what will be in the <code>buf</code>? <code>buf[0] == '\0'</code> and from <code>buf[1]</code> to <code>buf[9]</code> will be random content?</p>
</section>
<section id="answer-accepted-score-193" class="level4">
<h4>Answer accepted (score 193)</h4>
<p>This is not how you initialize an array, but for:</p>
<ol>
<li>
<p>
The first declaration:
</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb310-1"><a href="#cb310-1" aria-hidden="true"></a><span class="dt">char</span> buf[<span class="dv">10</span>] = <span class="st">&quot;&quot;</span>;</span></code></pre></div>
<p>is equivalent to</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true"></a><span class="dt">char</span> buf[<span class="dv">10</span>] = {<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>};</span>
<span id="cb311-2"><a href="#cb311-2" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb311-3"><a href="#cb311-3" aria-hidden="true"></a>&lt;li&gt;&lt;p&gt;The second declaration:&lt;/p&gt;</span>
<span id="cb311-4"><a href="#cb311-4" aria-hidden="true"></a></span>
<span id="cb311-5"><a href="#cb311-5" aria-hidden="true"></a>```c</span>
<span id="cb311-6"><a href="#cb311-6" aria-hidden="true"></a><span class="dt">char</span> buf[<span class="dv">10</span>] = <span class="st">&quot; &quot;</span>;</span></code></pre></div>
<p>is equivalent to</p>
<div class="sourceCode" id="cb312"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true"></a><span class="dt">char</span> buf[<span class="dv">10</span>] = {<span class="ch">&#39; &#39;</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>};</span>
<span id="cb312-2"><a href="#cb312-2" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb312-3"><a href="#cb312-3" aria-hidden="true"></a>&lt;li&gt;&lt;p&gt;The third declaration:&lt;/p&gt;</span>
<span id="cb312-4"><a href="#cb312-4" aria-hidden="true"></a></span>
<span id="cb312-5"><a href="#cb312-5" aria-hidden="true"></a>```c</span>
<span id="cb312-6"><a href="#cb312-6" aria-hidden="true"></a><span class="dt">char</span> buf[<span class="dv">10</span>] = <span class="st">&quot;a&quot;</span>;</span></code></pre></div>
<p>is equivalent to</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true"></a><span class="dt">char</span> buf[<span class="dv">10</span>] = {<span class="ch">&#39;a&#39;</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>};</span>
<span id="cb313-2"><a href="#cb313-2" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb313-3"><a href="#cb313-3" aria-hidden="true"></a>&lt;/ol&gt;</span>
<span id="cb313-4"><a href="#cb313-4" aria-hidden="true"></a></span>
<span id="cb313-5"><a href="#cb313-5" aria-hidden="true"></a>As you can see, no random content: <span class="cf">if</span> there are fewer initializers, the remaining of the array is initialized with `<span class="dv">0</span>`. This the <span class="cf">case</span> even <span class="cf">if</span> the array is declared inside a function.  </span>
<span id="cb313-6"><a href="#cb313-6" aria-hidden="true"></a></span>
<span id="cb313-7"><a href="#cb313-7" aria-hidden="true"></a></span>
<span id="cb313-8"><a href="#cb313-8" aria-hidden="true"></a><span class="er">#### Answer 2 (score 22)</span></span>
<span id="cb313-9"><a href="#cb313-9" aria-hidden="true"></a>&lt;em&gt;Edit: OP (or an editor) silently changed some of the single quotes in the original question to <span class="dt">double</span> quotes at some point after I provided this answer.&lt;/em&gt;   </span>
<span id="cb313-10"><a href="#cb313-10" aria-hidden="true"></a></span>
<span id="cb313-11"><a href="#cb313-11" aria-hidden="true"></a>Your code will result in compiler errors. Your first code fragment:  </span>
<span id="cb313-12"><a href="#cb313-12" aria-hidden="true"></a></span>
<span id="cb313-13"><a href="#cb313-13" aria-hidden="true"></a>```c</span>
<span id="cb313-14"><a href="#cb313-14" aria-hidden="true"></a><span class="dt">char</span> buf[<span class="dv">10</span>] ; buf = &#39;&#39;</span></code></pre></div>
<p>is doubly illegal. First, in C, there is no such thing as an empty <code>char</code>. You can use double quotes to designate an empty string, as with:</p>
<div class="sourceCode" id="cb314"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb314-1"><a href="#cb314-1" aria-hidden="true"></a><span class="dt">char</span>* buf = <span class="st">&quot;&quot;</span>; </span></code></pre></div>
<p>That will give you a pointer to a <code>NUL</code> string, i.e., a single-character string with only the <code>NUL</code> character in it. But you cannot use single quotes with nothing inside them–that is undefined. If you need to designate the <code>NUL</code> character, you have to specify it:</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true"></a><span class="dt">char</span> buf = <span class="ch">&#39;\0&#39;</span>;</span></code></pre></div>
<p>The backslash is necessary to disambiguate from character <code>'0'</code>.</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb316-1"><a href="#cb316-1" aria-hidden="true"></a><span class="dt">char</span> buf = <span class="dv">0</span>;</span></code></pre></div>
<p>accomplishes the same thing, but the former is a tad less ambiguous to read, I think.</p>
<p>Secondly, you cannot initialize arrays after they have been defined.</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true"></a><span class="dt">char</span> buf[<span class="dv">10</span>];</span></code></pre></div>
<p>declares and defines the array. The array identifier <code>buf</code> is now an address in memory, and you cannot change where <code>buf</code> points through assignment. So</p>
<div class="sourceCode" id="cb318"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb318-1"><a href="#cb318-1" aria-hidden="true"></a>buf =     <span class="co">// anything on RHS</span></span></code></pre></div>
<p>is illegal. Your second and third code fragments are illegal for this reason.</p>
<p>To initialize an array, you have to do it at the time of definition:</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true"></a><span class="dt">char</span> buf [<span class="dv">10</span>] = <span class="ch">&#39; &#39;</span>;</span></code></pre></div>
<p>will give you a 10-character array with the first char being the space <code>'\040'</code> and the rest being <code>NUL</code>, i.e., <code>'\0'</code>. When an array is declared and defined with an initializer, the array elements (if any) past the ones with specified initial values are automatically padded with <code>0</code>. There will not be any “random content”.</p>
<p>If you declare and define the array but don’t initialize it, as in the following:</p>
<div class="sourceCode" id="cb320"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb320-1"><a href="#cb320-1" aria-hidden="true"></a><span class="dt">char</span> buf [<span class="dv">10</span>];</span></code></pre></div>
<p>you will have random content in all the elements.</p>
</section>
<section id="answer-3-score-19" class="level4">
<h4>Answer 3 (score 19)</h4>
<ol>
<li>
<p>
These are equivalent
</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true"></a><span class="dt">char</span> buf[<span class="dv">10</span>] = <span class="st">&quot;&quot;</span>;</span>
<span id="cb321-2"><a href="#cb321-2" aria-hidden="true"></a><span class="dt">char</span> buf[<span class="dv">10</span>] = {<span class="dv">0</span>};</span>
<span id="cb321-3"><a href="#cb321-3" aria-hidden="true"></a><span class="dt">char</span> buf[<span class="dv">10</span>] = {<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>};</span>
<span id="cb321-4"><a href="#cb321-4" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb321-5"><a href="#cb321-5" aria-hidden="true"></a>&lt;li&gt;&lt;p&gt;These are equivalent&lt;/p&gt;</span>
<span id="cb321-6"><a href="#cb321-6" aria-hidden="true"></a></span>
<span id="cb321-7"><a href="#cb321-7" aria-hidden="true"></a>```c</span>
<span id="cb321-8"><a href="#cb321-8" aria-hidden="true"></a><span class="dt">char</span> buf[<span class="dv">10</span>] = <span class="st">&quot; &quot;</span>;</span>
<span id="cb321-9"><a href="#cb321-9" aria-hidden="true"></a><span class="dt">char</span> buf[<span class="dv">10</span>] = {<span class="ch">&#39; &#39;</span>};</span>
<span id="cb321-10"><a href="#cb321-10" aria-hidden="true"></a><span class="dt">char</span> buf[<span class="dv">10</span>] = {<span class="ch">&#39; &#39;</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>};</span>
<span id="cb321-11"><a href="#cb321-11" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb321-12"><a href="#cb321-12" aria-hidden="true"></a>&lt;li&gt;&lt;p&gt;These are equivalent&lt;/p&gt;</span>
<span id="cb321-13"><a href="#cb321-13" aria-hidden="true"></a></span>
<span id="cb321-14"><a href="#cb321-14" aria-hidden="true"></a>```c</span>
<span id="cb321-15"><a href="#cb321-15" aria-hidden="true"></a><span class="dt">char</span> buf[<span class="dv">10</span>] = <span class="st">&quot;a&quot;</span>;</span>
<span id="cb321-16"><a href="#cb321-16" aria-hidden="true"></a><span class="dt">char</span> buf[<span class="dv">10</span>] = {<span class="ch">&#39;a&#39;</span>};</span>
<span id="cb321-17"><a href="#cb321-17" aria-hidden="true"></a><span class="dt">char</span> buf[<span class="dv">10</span>] = {<span class="ch">&#39;a&#39;</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>};</span>
<span id="cb321-18"><a href="#cb321-18" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb321-19"><a href="#cb321-19" aria-hidden="true"></a>&lt;/ol&gt;</span>
<span id="cb321-20"><a href="#cb321-20" aria-hidden="true"></a></span>
<span id="cb321-21"><a href="#cb321-21" aria-hidden="true"></a>&lt;/b&gt; &lt;/em&gt; &lt;/i&gt; &lt;/small&gt; &lt;/strong&gt; &lt;/sub&gt; &lt;/sup&gt;</span>
<span id="cb321-22"><a href="#cb321-22" aria-hidden="true"></a></span>
<span id="cb321-23"><a href="#cb321-23" aria-hidden="true"></a></span>
<span id="cb321-24"><a href="#cb321-24" aria-hidden="true"></a><span class="er">### 48: What does &quot;dereferencing&quot; a pointer mean? (score [519585](https://stackoverflow.com/q/4955198.html) in 2017)</span></span>
<span id="cb321-25"><a href="#cb321-25" aria-hidden="true"></a></span>
<span id="cb321-26"><a href="#cb321-26" aria-hidden="true"></a></span>
<span id="cb321-27"><a href="#cb321-27" aria-hidden="true"></a><span class="er">#### Question</span></span>
<span id="cb321-28"><a href="#cb321-28" aria-hidden="true"></a>Please include an example with the explanation.  </span>
<span id="cb321-29"><a href="#cb321-29" aria-hidden="true"></a></span>
<span id="cb321-30"><a href="#cb321-30" aria-hidden="true"></a></span>
<span id="cb321-31"><a href="#cb321-31" aria-hidden="true"></a><span class="er">#### Answer accepted (score 676)</span></span>
<span id="cb321-32"><a href="#cb321-32" aria-hidden="true"></a>&lt;h5&gt;Reviewing the basic terminology&lt;/h2&gt;</span>
<span id="cb321-33"><a href="#cb321-33" aria-hidden="true"></a></span>
<span id="cb321-34"><a href="#cb321-34" aria-hidden="true"></a>It&#39;s &lt;em&gt;usually&lt;/em&gt; good enough - unless you&#39;re programming assembly - to envisage a &lt;strong&gt;&lt;em&gt;pointer&lt;/em&gt;&lt;/strong&gt; containing a numeric memory address, with <span class="dv">1</span> referring to the second byte in the process&#39;s memory, <span class="dv">2</span> the third, <span class="dv">3</span> the fourth and so on....  </span>
<span id="cb321-35"><a href="#cb321-35" aria-hidden="true"></a></span>
<span id="cb321-36"><a href="#cb321-36" aria-hidden="true"></a>&lt;ul&gt;</span>
<span id="cb321-37"><a href="#cb321-37" aria-hidden="true"></a>&lt;li&gt;What happened to <span class="dv">0</span> and the first byte?  Well, we&#39;ll get to that later - see &lt;em&gt;null pointers&lt;/em&gt; below.&lt;/li&gt;</span>
<span id="cb321-38"><a href="#cb321-38" aria-hidden="true"></a>&lt;li&gt;For a more accurate definition of what pointers store, and how memory and addresses relate, see &lt;em&gt;<span class="st">&quot;More about memory addresses, and why you probably don&#39;t need to know&quot;</span>&lt;/em&gt;.&lt;/li&gt;</span>
<span id="cb321-39"><a href="#cb321-39" aria-hidden="true"></a>&lt;/ul&gt;</span>
<span id="cb321-40"><a href="#cb321-40" aria-hidden="true"></a></span>
<span id="cb321-41"><a href="#cb321-41" aria-hidden="true"></a>When you want to access the data/value in the memory that the pointer points to - the contents of the address with that numerical index - then you &lt;strong&gt;&lt;em&gt;dereference&lt;/em&gt;&lt;/strong&gt; the pointer.  </span>
<span id="cb321-42"><a href="#cb321-42" aria-hidden="true"></a></span>
<span id="cb321-43"><a href="#cb321-43" aria-hidden="true"></a>Different computer languages have different notations to tell the compiler or interpreter that you&#39;re now interested in the pointed-to value - I focus below on C and C++.  </span>
<span id="cb321-44"><a href="#cb321-44" aria-hidden="true"></a></span>
<span id="cb321-45"><a href="#cb321-45" aria-hidden="true"></a>&lt;h5&gt;A pointer scenario&lt;/h2&gt;</span>
<span id="cb321-46"><a href="#cb321-46" aria-hidden="true"></a></span>
<span id="cb321-47"><a href="#cb321-47" aria-hidden="true"></a>Consider in C, given a pointer such as `p` below...  </span>
<span id="cb321-48"><a href="#cb321-48" aria-hidden="true"></a></span>
<span id="cb321-49"><a href="#cb321-49" aria-hidden="true"></a>```c</span>
<span id="cb321-50"><a href="#cb321-50" aria-hidden="true"></a><span class="dt">const</span> <span class="dt">char</span>* p = <span class="st">&quot;abc&quot;</span>;</span></code></pre></div>
<p>…four bytes with the numerical values used to encode the letters ‘a’, ‘b’, ‘c’, and a 0 byte to denote the end of the textual data, are stored somewhere in memory and the numerical address of that data is stored in <code>p</code>.</p>
<p>For example, if the string literal happened to be at address 0x1000 and <code>p</code> a 32-bit pointer at 0x2000, the memory content would be:</p>
<div class="sourceCode" id="cb322"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb322-1"><a href="#cb322-1" aria-hidden="true"></a>Memory Address (hex)    Variable name    Contents</span>
<span id="cb322-2"><a href="#cb322-2" aria-hidden="true"></a><span class="dv">1000</span>                                     <span class="ch">&#39;a&#39;</span> == <span class="dv">97</span> (ASCII)</span>
<span id="cb322-3"><a href="#cb322-3" aria-hidden="true"></a><span class="dv">1001</span>                                     <span class="ch">&#39;b&#39;</span> == <span class="dv">98</span></span>
<span id="cb322-4"><a href="#cb322-4" aria-hidden="true"></a><span class="dv">1002</span>                                     <span class="ch">&#39;c&#39;</span> == <span class="dv">99</span></span>
<span id="cb322-5"><a href="#cb322-5" aria-hidden="true"></a><span class="dv">1003</span>                                     <span class="dv">0</span></span>
<span id="cb322-6"><a href="#cb322-6" aria-hidden="true"></a>...</span>
<span id="cb322-7"><a href="#cb322-7" aria-hidden="true"></a><span class="dv">2000</span>-<span class="dv">2003</span>               p                <span class="dv">1000</span> hex</span></code></pre></div>
<p>Note that there is no variable name/identifier for address 0x1000, but we can indirectly refer to the string literal using a pointer storing its address: <code>p</code>.</p>
<h5>
Dereferencing the pointer
</h2>
<p>To refer to the characters <code>p</code> points to, we dereference <code>p</code> using one of these notations (again, for C):</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true"></a>assert(*p == <span class="ch">&#39;a&#39;</span>);  <span class="co">// The first character at address p will be &#39;a&#39;</span></span>
<span id="cb323-2"><a href="#cb323-2" aria-hidden="true"></a>assert(p[<span class="dv">1</span>] == <span class="ch">&#39;b&#39;</span>); <span class="co">// p[1] actually dereferences a pointer created by adding</span></span>
<span id="cb323-3"><a href="#cb323-3" aria-hidden="true"></a>                     <span class="co">// p and 1 times the size of the things to which p points:</span></span>
<span id="cb323-4"><a href="#cb323-4" aria-hidden="true"></a>                     <span class="co">// In this case they&#39;re char which are 1 byte in C...</span></span>
<span id="cb323-5"><a href="#cb323-5" aria-hidden="true"></a>assert(*(p + <span class="dv">1</span>) == <span class="ch">&#39;b&#39;</span>);  <span class="co">// Another notation for p[1]</span></span></code></pre></div>
<p>You can also move pointers through the pointed-to data, dereferencing them as you go:</p>
<div class="sourceCode" id="cb324"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb324-1"><a href="#cb324-1" aria-hidden="true"></a>++p;  <span class="co">// Increment p so it&#39;s now 0x1001</span></span>
<span id="cb324-2"><a href="#cb324-2" aria-hidden="true"></a>assert(*p == <span class="ch">&#39;b&#39;</span>);  <span class="co">// p == 0x1001 which is where the &#39;b&#39; is...</span></span></code></pre></div>
<p>If you have some data that can be written to, then you can do things like this:</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb325-1"><a href="#cb325-1" aria-hidden="true"></a><span class="dt">int</span> x = <span class="dv">2</span>;</span>
<span id="cb325-2"><a href="#cb325-2" aria-hidden="true"></a><span class="dt">int</span>* p_x = &amp;x;  <span class="co">// Put the address of the x variable into the pointer p_x</span></span>
<span id="cb325-3"><a href="#cb325-3" aria-hidden="true"></a>*p_x = <span class="dv">4</span>;       <span class="co">// Change the memory at the address in p_x to be 4</span></span>
<span id="cb325-4"><a href="#cb325-4" aria-hidden="true"></a>assert(x == <span class="dv">4</span>); <span class="co">// Check x is now 4</span></span></code></pre></div>
<p>Above, you must have known at compile time that you would need a variable called <code>x</code>, and the code asks the compiler to arrange where it should be stored, ensuring the address will be available via <code>&amp;amp;x</code>.</p>
<h5>
Dereferencing and accessing a structure data member
</h2>
<p>In C, if you have a variable that is a pointer to a structure with data members, you can access those members using the <code>-&amp;gt;</code> dereferencing operator:</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb326-1"><a href="#cb326-1" aria-hidden="true"></a><span class="kw">typedef</span> <span class="kw">struct</span> X { <span class="dt">int</span> i_; <span class="dt">double</span> d_; } X;</span>
<span id="cb326-2"><a href="#cb326-2" aria-hidden="true"></a>X x;</span>
<span id="cb326-3"><a href="#cb326-3" aria-hidden="true"></a>X* p = &amp;x;</span>
<span id="cb326-4"><a href="#cb326-4" aria-hidden="true"></a>p-&gt;d_ = <span class="fl">3.14159</span>;  <span class="co">// Dereference and access data member x.d_</span></span>
<span id="cb326-5"><a href="#cb326-5" aria-hidden="true"></a>(*p).d_ *= -<span class="dv">1</span>;    <span class="co">// Another equivalent notation for accessing x.d_</span></span></code></pre></div>
<h5>
Multi-byte data types
</h2>
<p>To use a pointer, a computer program also needs some insight into the type of data that is being pointed at - if that data type needs more than one byte to represent, then the pointer normally points to the lowest-numbered byte in the data.</p>
<p>So, looking at a slightly more complex example:</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb327-1"><a href="#cb327-1" aria-hidden="true"></a><span class="dt">double</span> sizes[] = { <span class="fl">10.3</span>, <span class="fl">13.4</span>, <span class="fl">11.2</span>, <span class="fl">19.4</span> };</span>
<span id="cb327-2"><a href="#cb327-2" aria-hidden="true"></a><span class="dt">double</span>* p = sizes;</span>
<span id="cb327-3"><a href="#cb327-3" aria-hidden="true"></a>assert(p[<span class="dv">0</span>] == <span class="fl">10.3</span>);  <span class="co">// Knows to look at all the bytes in the first double value</span></span>
<span id="cb327-4"><a href="#cb327-4" aria-hidden="true"></a>assert(p[<span class="dv">1</span>] == <span class="fl">13.4</span>);  <span class="co">// Actually looks at bytes from address p + 1 * sizeof(double)</span></span>
<span id="cb327-5"><a href="#cb327-5" aria-hidden="true"></a>                       <span class="co">// (sizeof(double) is almost always eight bytes)</span></span>
<span id="cb327-6"><a href="#cb327-6" aria-hidden="true"></a>assert(++p);           <span class="co">// Advance p by sizeof(double)</span></span>
<span id="cb327-7"><a href="#cb327-7" aria-hidden="true"></a>assert(*p == <span class="fl">13.4</span>);    <span class="co">// The double at memory beginning at address p has value 13.4</span></span>
<span id="cb327-8"><a href="#cb327-8" aria-hidden="true"></a>*(p + <span class="dv">2</span>) = <span class="fl">29.8</span>;       <span class="co">// Change sizes[3] from 19.4 to 29.8</span></span>
<span id="cb327-9"><a href="#cb327-9" aria-hidden="true"></a>                       <span class="co">// Note: earlier ++p and + 2 here =&gt; sizes[3]</span></span></code></pre></div>
<h5>
Pointers to dynamically allocated memory
</h2>
<p>Sometimes you don’t know how much memory you’ll need until your program is running and sees what data is thrown at it… then you can dynamically allocate memory using <code>malloc</code>. It is common practice to store the address in a pointer…</p>
<div class="sourceCode" id="cb328"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb328-1"><a href="#cb328-1" aria-hidden="true"></a><span class="dt">int</span>* p = malloc(<span class="kw">sizeof</span>(<span class="dt">int</span>)); <span class="co">// Get some memory somewhere...</span></span>
<span id="cb328-2"><a href="#cb328-2" aria-hidden="true"></a>*p = <span class="dv">10</span>;            <span class="co">// Dereference the pointer to the memory, then write a value in</span></span>
<span id="cb328-3"><a href="#cb328-3" aria-hidden="true"></a>fn(*p);             <span class="co">// Call a function, passing it the value at address p</span></span>
<span id="cb328-4"><a href="#cb328-4" aria-hidden="true"></a>(*p) += <span class="dv">3</span>;          <span class="co">// Change the value, adding 3 to it</span></span>
<span id="cb328-5"><a href="#cb328-5" aria-hidden="true"></a>free(p);            <span class="co">// Release the memory back to the heap allocation library</span></span></code></pre></div>
<p>In C++, memory allocation is normally done with the <code>new</code> operator, and deallocation with <code>delete</code>:</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb329-1"><a href="#cb329-1" aria-hidden="true"></a><span class="dt">int</span>* p = new <span class="dt">int</span>(<span class="dv">10</span>); <span class="co">// Memory for one int with initial value 10</span></span>
<span id="cb329-2"><a href="#cb329-2" aria-hidden="true"></a>delete p;</span>
<span id="cb329-3"><a href="#cb329-3" aria-hidden="true"></a></span>
<span id="cb329-4"><a href="#cb329-4" aria-hidden="true"></a>p = new <span class="dt">int</span>[<span class="dv">10</span>];      <span class="co">// Memory for ten ints with unspecified initial value</span></span>
<span id="cb329-5"><a href="#cb329-5" aria-hidden="true"></a>delete[] p;</span>
<span id="cb329-6"><a href="#cb329-6" aria-hidden="true"></a></span>
<span id="cb329-7"><a href="#cb329-7" aria-hidden="true"></a>p = new <span class="dt">int</span>[<span class="dv">10</span>]();    <span class="co">// Memory for ten ints that are value initialised (to 0)</span></span>
<span id="cb329-8"><a href="#cb329-8" aria-hidden="true"></a>delete[] p;</span></code></pre></div>
<p>See also <em>C++ smart pointers</em> below.</p>
<h5>
Losing and leaking addresses
</h2>
<p>Often a pointer may be the only indication of where some data or buffer exists in memory. If ongoing use of that data/buffer is needed, or the ability to call <code>free()</code> or <code>delete</code> to avoid leaking the memory, then the programmer must operate on a copy of the pointer…</p>
<div class="sourceCode" id="cb330"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb330-1"><a href="#cb330-1" aria-hidden="true"></a><span class="dt">const</span> <span class="dt">char</span>* p = asprintf(<span class="st">&quot;name: %s&quot;</span>, name);  <span class="co">// Common but non-Standard printf-on-heap</span></span>
<span id="cb330-2"><a href="#cb330-2" aria-hidden="true"></a></span>
<span id="cb330-3"><a href="#cb330-3" aria-hidden="true"></a><span class="co">// Replace non-printable characters with underscores....</span></span>
<span id="cb330-4"><a href="#cb330-4" aria-hidden="true"></a><span class="cf">for</span> (<span class="dt">const</span> <span class="dt">char</span>* q = p; *q; ++q)</span>
<span id="cb330-5"><a href="#cb330-5" aria-hidden="true"></a>    <span class="cf">if</span> (!isprint(*q))</span>
<span id="cb330-6"><a href="#cb330-6" aria-hidden="true"></a>        *q = <span class="ch">&#39;_&#39;</span>;</span>
<span id="cb330-7"><a href="#cb330-7" aria-hidden="true"></a></span>
<span id="cb330-8"><a href="#cb330-8" aria-hidden="true"></a>printf(<span class="st">&quot;%s</span><span class="sc">\n</span><span class="st">&quot;</span>, p); <span class="co">// Only q was modified</span></span>
<span id="cb330-9"><a href="#cb330-9" aria-hidden="true"></a>free(p);</span></code></pre></div>
<p>…or carefully orchestrate reversal of any changes…</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb331-1"><a href="#cb331-1" aria-hidden="true"></a><span class="dt">const</span> <span class="dt">size_t</span> n = ...;</span>
<span id="cb331-2"><a href="#cb331-2" aria-hidden="true"></a>p += n;</span>
<span id="cb331-3"><a href="#cb331-3" aria-hidden="true"></a>...</span>
<span id="cb331-4"><a href="#cb331-4" aria-hidden="true"></a>p -= n;  <span class="co">// Restore earlier value...</span></span></code></pre></div>
<h5>
C++ smart pointers
</h2>
<p>In C++, it’s best practice to use <a href="http://en.wikipedia.org/wiki/Smart_pointer" rel="noreferrer">smart pointer</a> objects to store and manage the pointers, automatically deallocating them when the smart pointers’ destructors run. Since C++11 the Standard Library provides two, <a href="http://en.cppreference.com/w/cpp/memory/unique_ptr" rel="noreferrer"><code>unique_ptr</code></a> for when there’s a single owner for an allocated object…</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true"></a>{</span>
<span id="cb332-2"><a href="#cb332-2" aria-hidden="true"></a>    std::unique_ptr&lt;T&gt; p{new T(<span class="dv">42</span>, <span class="st">&quot;meaning&quot;</span>)};</span>
<span id="cb332-3"><a href="#cb332-3" aria-hidden="true"></a>    call_a_function(p);</span>
<span id="cb332-4"><a href="#cb332-4" aria-hidden="true"></a>    <span class="co">// The function above might throw, so delete here is unreliable, but...</span></span>
<span id="cb332-5"><a href="#cb332-5" aria-hidden="true"></a>} <span class="co">// p&#39;s destructor&#39;s guaranteed to run &quot;here&quot;, calling delete</span></span></code></pre></div>
<p>…and <a href="http://en.cppreference.com/w/cpp/memory/shared_ptr" rel="noreferrer"><code>shared_ptr</code></a> for share ownership (using <a href="http://en.wikipedia.org/wiki/Reference_counting" rel="noreferrer">reference counting</a>)…</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb333-1"><a href="#cb333-1" aria-hidden="true"></a>{</span>
<span id="cb333-2"><a href="#cb333-2" aria-hidden="true"></a>    std::shared_ptr&lt;T&gt; p(new T(<span class="fl">3.14</span>, <span class="st">&quot;pi&quot;</span>));</span>
<span id="cb333-3"><a href="#cb333-3" aria-hidden="true"></a>    number_storage.may_add(p); <span class="co">// Might copy p into its container</span></span>
<span id="cb333-4"><a href="#cb333-4" aria-hidden="true"></a>} <span class="co">// p&#39;s destructor will only delete the T if number_storage didn&#39;t copy</span></span></code></pre></div>
<h5>
Null pointers
</h2>
<p>In C, <code>NULL</code> and <code>0</code> - and additionally in C++ <code>nullptr</code> - can be used to indicate that a pointer doesn’t currently hold the memory address of a variable, and shouldn’t be dereferenced or used in pointer arithmetic. For example:</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb334-1"><a href="#cb334-1" aria-hidden="true"></a><span class="dt">const</span> <span class="dt">char</span>* p_filename = NULL; <span class="co">// Or &quot;= 0&quot;, or &quot;= nullptr&quot; in C++</span></span>
<span id="cb334-2"><a href="#cb334-2" aria-hidden="true"></a><span class="dt">char</span> c;</span>
<span id="cb334-3"><a href="#cb334-3" aria-hidden="true"></a><span class="cf">while</span> ((c = getopt(argc, argv, <span class="st">&quot;f:&quot;</span>)) != EOF)</span>
<span id="cb334-4"><a href="#cb334-4" aria-hidden="true"></a>    <span class="cf">switch</span> (c) {</span>
<span id="cb334-5"><a href="#cb334-5" aria-hidden="true"></a>      <span class="cf">case</span> f: p_filename = optarg; <span class="cf">break</span>;</span>
<span id="cb334-6"><a href="#cb334-6" aria-hidden="true"></a>    }</span>
<span id="cb334-7"><a href="#cb334-7" aria-hidden="true"></a><span class="cf">if</span> (p_filename)  <span class="co">// Only NULL converts to false</span></span>
<span id="cb334-8"><a href="#cb334-8" aria-hidden="true"></a>    ...   <span class="co">// Only get here if -f flag specified</span></span></code></pre></div>
<p>In C and C++, just as inbuilt numeric types don’t necessarily default to <code>0</code>, nor <code>bools</code> to <code>false</code>, pointers are not always set to <code>NULL</code>. All these are set to 0/false/NULL when they’re <code>static</code> variables or (C++ only) direct or indirect member variables of static objects or their bases, or undergo zero initialisation (e.g. <code>new T();</code> and <code>new T(x, y, z);</code> perform zero-initialisation on T’s members including pointers, whereas <code>new T;</code> does not).</p>
<p>Further, when you assign <code>0</code>, <code>NULL</code> and <code>nullptr</code> to a pointer the bits in the pointer are not necessarily all reset: the pointer may not contain “0” at the hardware level, or refer to address 0 in your virtual address space. The compiler is allowed to store something else there if it has reason to, but whatever it does - if you come along and compare the pointer to <code>0</code>, <code>NULL</code>, <code>nullptr</code> or another pointer that was assigned any of those, the comparison must work as expected. So, below the source code at the compiler level, “NULL” is potentially a bit “magical” in the C and C++ languages…</p>
<h5>
More about memory addresses, and why you probably don’t need to know
</h2>
<p>More strictly, initialised pointers store a bit-pattern identifying either <code>NULL</code> or a (often <a href="http://en.wikipedia.org/wiki/Virtual_address_space" rel="noreferrer">virtual</a>) memory address.</p>
<p>The simple case is where this is a numeric offset into the process’s entire virtual address space; in more complex cases the pointer may be relative to some specific memory area, which the CPU may select based on CPU “segment” registers or some manner of segment id encoded in the bit-pattern, and/or looking in different places depending on the machine code instructions using the address.</p>
<p>For example, an <code>int*</code> properly initialised to point to an <code>int</code> variable might - after casting to a <code>float*</code> - access a value in “GPU” memory quite distinct from the <code>int</code> variable, then once cast to a function pointer might refer to distinct memory holding the machine opcodes for the function.</p>
<p>3GL programming languages like C and C++ tend to hide this complexity, such that:</p>
<ul>
<li>
<p>
If the compiler gives you a pointer to a variable or function, you can dereference it freely (as long as the variable’s not destructed/deallocated meanwhile) and it’s the compiler’s problem whether e.g. a particular CPU register needs to be restored beforehand, or a distinct machine code instruction used
</p>
</li>
<li>
<p>
If you get a pointer to an element in an array, you can use pointer arithmetic to move anywhere else in the array, or even to form an address one-past-the-end of the array that’s legal to compare with other pointers to elements in the array (or that have similarly been moved by pointer arithmetic to the same one-past-the-end value); again in C and C++, it’s up to the compiler to ensure this “just works”
</p>
</li>
<li>
<p>
Specific OS functions, e.g. shared memory mapping, may give you pointers, and they’ll “just work” within the range of addresses that makes sense for them
</p>
</li>
<li>
<p>
Attempts to move legal pointers beyond these boundaries, or to cast arbitrary numbers to pointers, or use pointers cast to unrelated types, typically have <a href="http://en.wikipedia.org/wiki/Undefined_behavior" rel="noreferrer"><em>undefined behaviour</em></a>, so should be avoided in higher level libraries and applications, but code for OSes, device drivers, etc. may need to rely on behaviour left undefined by C or C++, that is nevertheless well defined by their specific hardware.
</p>
</li>
</ul>
</section>
<section id="answer-2-score-90" class="level4">
<h4>Answer 2 (score 90)</h4>
<p>Dereferencing a pointer means getting the value that is stored in the memory location pointed by the pointer. The operator * is used to do this, and is called the dereferencing operator.</p>
<div class="sourceCode" id="cb335"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb335-1"><a href="#cb335-1" aria-hidden="true"></a><span class="dt">int</span> a = <span class="dv">10</span>;</span>
<span id="cb335-2"><a href="#cb335-2" aria-hidden="true"></a><span class="dt">int</span>* ptr = &amp;a;</span>
<span id="cb335-3"><a href="#cb335-3" aria-hidden="true"></a></span>
<span id="cb335-4"><a href="#cb335-4" aria-hidden="true"></a>printf(<span class="st">&quot;%d&quot;</span>, *ptr); <span class="co">// With *ptr I&#39;m dereferencing the pointer. </span></span>
<span id="cb335-5"><a href="#cb335-5" aria-hidden="true"></a>                    <span class="co">// Which means, I am asking the value pointed at by the pointer.</span></span>
<span id="cb335-6"><a href="#cb335-6" aria-hidden="true"></a>                    <span class="co">// ptr is pointing to the location in memory of the variable a.</span></span>
<span id="cb335-7"><a href="#cb335-7" aria-hidden="true"></a>                    <span class="co">// In a&#39;s location, we have 10. So, dereferencing gives this value.</span></span>
<span id="cb335-8"><a href="#cb335-8" aria-hidden="true"></a></span>
<span id="cb335-9"><a href="#cb335-9" aria-hidden="true"></a><span class="co">// Since we have indirect control over a&#39;s location, we can modify its content using the pointer. This is an indirect way to access a.</span></span>
<span id="cb335-10"><a href="#cb335-10" aria-hidden="true"></a></span>
<span id="cb335-11"><a href="#cb335-11" aria-hidden="true"></a> *ptr = <span class="dv">20</span>;         <span class="co">// Now a&#39;s content is no longer 10, and has been modified to 20.</span></span></code></pre></div>
</section>
<section id="answer-3-score-16" class="level4">
<h4>Answer 3 (score 16)</h4>
<p>A pointer is a “reference” to a value.. much like a library call number is a reference to a book. “Dereferencing” the call number is physically going through and retrieving that book.</p>
<div class="sourceCode" id="cb336"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb336-1"><a href="#cb336-1" aria-hidden="true"></a><span class="dt">int</span> a=<span class="dv">4</span> ;</span>
<span id="cb336-2"><a href="#cb336-2" aria-hidden="true"></a><span class="dt">int</span> *pA = &amp;a ;</span>
<span id="cb336-3"><a href="#cb336-3" aria-hidden="true"></a>printf( <span class="st">&quot;The REFERENCE/call number for the variable `a` is %p</span><span class="sc">\n</span><span class="st">&quot;</span>, pA ) ;</span>
<span id="cb336-4"><a href="#cb336-4" aria-hidden="true"></a></span>
<span id="cb336-5"><a href="#cb336-5" aria-hidden="true"></a><span class="co">// The * causes pA to DEREFERENCE...  `a` via &quot;callnumber&quot; `pA`.</span></span>
<span id="cb336-6"><a href="#cb336-6" aria-hidden="true"></a>printf( <span class="st">&quot;%d</span><span class="sc">\n</span><span class="st">&quot;</span>, *pA ) ; <span class="co">// prints 4.. </span></span></code></pre></div>
<p>If the book isn’t there, the librarian starts shouting, shuts the library down, and a couple of people are set to investigate the cause of a person going to find a book that isn’t there.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="printf-formatting-for-hex-score-506267-in" class="level3">
<h3>49: printf() formatting for hex (score <a href="https://stackoverflow.com/q/14733761.html">506267</a> in )</h3>
<section id="question-47" class="level4">
<h4>Question</h4>
<p>This is more of a curious query than an important question, but why when printing hex as an 8 digit number with leading zeros, does this <code>% #08X</code> Not display the same result as <code>0x%08X</code>?</p>
<p>When I try to use the former, the <code>08</code> formatting flag is removed, and it doesn’t work with just <code>8</code>.</p>
<p>Again I was just curious.</p>
</section>
<section id="answer-2-score-252" class="level4">
<h4>Answer 2 (score 252)</h4>
<p>The <code>#</code> part gives you a <code>0x</code> in the output string. The <code>0</code> and the <code>x</code> count against your “8” characters listed in the <code>08</code> part. You need to ask for 10 characters if you want it to be the same.</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb337-1"><a href="#cb337-1" aria-hidden="true"></a><span class="dt">int</span> i = <span class="dv">7</span>;</span>
<span id="cb337-2"><a href="#cb337-2" aria-hidden="true"></a></span>
<span id="cb337-3"><a href="#cb337-3" aria-hidden="true"></a>printf(<span class="st">&quot;%</span></span>
<span id="cb337-4"><a href="#cb337-4" aria-hidden="true"></a><span class="er">#010x\n&quot;, i);  // gives 0x00000007</span></span>
<span id="cb337-5"><a href="#cb337-5" aria-hidden="true"></a>printf(<span class="st">&quot;0x%08x</span><span class="sc">\n</span><span class="st">&quot;</span>, i);  <span class="co">// gives 0x00000007</span></span>
<span id="cb337-6"><a href="#cb337-6" aria-hidden="true"></a>printf(<span class="st">&quot;%</span></span>
<span id="cb337-7"><a href="#cb337-7" aria-hidden="true"></a><span class="er">#08x\n&quot;, i);   // gives 0x000007</span></span></code></pre></div>
<p>Also changing the case of <code>x</code>, affects the casing of the outputted characters.</p>
<div class="sourceCode" id="cb338"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb338-1"><a href="#cb338-1" aria-hidden="true"></a>printf(<span class="st">&quot;%04x&quot;</span>, <span class="dv">4779</span>); <span class="co">// gives 12ab</span></span>
<span id="cb338-2"><a href="#cb338-2" aria-hidden="true"></a>printf(<span class="st">&quot;%04X&quot;</span>, <span class="dv">4779</span>); <span class="co">// gives 12AB</span></span></code></pre></div>
</section>
<section id="answer-3-score-51-1" class="level4">
<h4>Answer 3 (score 51)</h4>
<p>The “0x” counts towards the eight character count. You need <code>"% #010x"</code>.</p>
<p>Note that <code>#</code> does <em>not</em> append the 0x to 0 - the result will be <code>0000000000</code> - so you probably actually should just use <code>"0x%08x"</code> anyway.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-do-you-pass-a-function-as-a-parameter-in-c-score-506257-in-2016" class="level3">
<h3>50: How do you pass a function as a parameter in C? (score <a href="https://stackoverflow.com/q/9410.html">506257</a> in 2016)</h3>
<section id="question-48" class="level4">
<h4>Question</h4>
<p>I want to create a function that performs a function passed by parameter on a set of data. How do you pass a function as a parameter in C?</p>
</section>
<section id="answer-accepted-score-686" class="level4">
<h4>Answer accepted (score 686)</h4>
<p><strong>Declaration</strong></p>
<p>A prototype for a function which takes a function parameter looks like the following:</p>
<div class="sourceCode" id="cb339"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb339-1"><a href="#cb339-1" aria-hidden="true"></a><span class="dt">void</span> func ( <span class="dt">void</span> (*f)(<span class="dt">int</span>) );</span></code></pre></div>
<p>This states that the parameter <code>f</code> will be a pointer to a function which has a <code>void</code> return type and which takes a single <code>int</code> parameter. The following function (<code>print</code>) is an example of a function which could be passed to <code>func</code> as a parameter because it is the proper type:</p>
<div class="sourceCode" id="cb340"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb340-1"><a href="#cb340-1" aria-hidden="true"></a><span class="dt">void</span> print ( <span class="dt">int</span> x ) {</span>
<span id="cb340-2"><a href="#cb340-2" aria-hidden="true"></a>  printf(<span class="st">&quot;%d</span><span class="sc">\n</span><span class="st">&quot;</span>, x);</span>
<span id="cb340-3"><a href="#cb340-3" aria-hidden="true"></a>}</span></code></pre></div>
<p><strong>Function Call</strong></p>
<p>When calling a function with a function parameter, the value passed must be a pointer to a function. Use the function’s name (without parentheses) for this:</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb341-1"><a href="#cb341-1" aria-hidden="true"></a>func(print);</span></code></pre></div>
<p>would call <code>func</code>, passing the print function to it.</p>
<p><strong>Function Body</strong></p>
<p>As with any parameter, func can now use the parameter’s name in the function body to access the value of the parameter. Let’s say that func will apply the function it is passed to the numbers 0-4. Consider, first, what the loop would look like to call print directly:</p>
<div class="sourceCode" id="cb342"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb342-1"><a href="#cb342-1" aria-hidden="true"></a><span class="cf">for</span> ( <span class="dt">int</span> ctr = <span class="dv">0</span> ; ctr &lt; <span class="dv">5</span> ; ctr++ ) {</span>
<span id="cb342-2"><a href="#cb342-2" aria-hidden="true"></a>  print(ctr);</span>
<span id="cb342-3"><a href="#cb342-3" aria-hidden="true"></a>}</span></code></pre></div>
<p>Since <code>func</code>’s parameter declaration says that <code>f</code> is the name for a pointer to the desired function, we recall first that if <code>f</code> is a pointer then <code>*f</code> is the thing that <code>f</code> points to (i.e. the function <code>print</code> in this case). As a result, just replace every occurrence of print in the loop above with <code>*f</code>:</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb343-1"><a href="#cb343-1" aria-hidden="true"></a><span class="dt">void</span> func ( <span class="dt">void</span> (*f)(<span class="dt">int</span>) ) {</span>
<span id="cb343-2"><a href="#cb343-2" aria-hidden="true"></a>  <span class="cf">for</span> ( <span class="dt">int</span> ctr = <span class="dv">0</span> ; ctr &lt; <span class="dv">5</span> ; ctr++ ) {</span>
<span id="cb343-3"><a href="#cb343-3" aria-hidden="true"></a>    (*f)(ctr);</span>
<span id="cb343-4"><a href="#cb343-4" aria-hidden="true"></a>  }</span>
<span id="cb343-5"><a href="#cb343-5" aria-hidden="true"></a>}</span></code></pre></div>
<p>From <a href="http://math.hws.edu/bridgeman/courses/331/f05/handouts/c-c++-notes.html" rel="noreferrer">http://math.hws.edu/bridgeman/courses/331/f05/handouts/c-c++-notes.html</a></p>
</section>
<section id="answer-2-score-119" class="level4">
<h4>Answer 2 (score 119)</h4>
<p>This question already has the answer for defining function pointers, however they can get very messy, especially if you are going to be passing them around your application. To avoid this unpleasantness I would recommend that you typedef the function pointer into something more readable. For example.</p>
<div class="sourceCode" id="cb344"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb344-1"><a href="#cb344-1" aria-hidden="true"></a><span class="kw">typedef</span> <span class="dt">void</span> (*functiontype)();</span></code></pre></div>
<p>Declares a function that returns void and takes no arguments. To create a function pointer to this type you can now do:</p>
<div class="sourceCode" id="cb345"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb345-1"><a href="#cb345-1" aria-hidden="true"></a><span class="dt">void</span> dosomething() { }</span>
<span id="cb345-2"><a href="#cb345-2" aria-hidden="true"></a></span>
<span id="cb345-3"><a href="#cb345-3" aria-hidden="true"></a>functiontype func = &amp;dosomething;</span>
<span id="cb345-4"><a href="#cb345-4" aria-hidden="true"></a>func();</span></code></pre></div>
<p>For a function that returns an int and takes a char you would do</p>
<div class="sourceCode" id="cb346"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb346-1"><a href="#cb346-1" aria-hidden="true"></a><span class="kw">typedef</span> <span class="dt">int</span> (*functiontype2)(<span class="dt">char</span>);</span></code></pre></div>
<p>and to use it</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb347-1"><a href="#cb347-1" aria-hidden="true"></a><span class="dt">int</span> dosomethingwithchar(<span class="dt">char</span> a) { <span class="cf">return</span> <span class="dv">1</span>; }</span>
<span id="cb347-2"><a href="#cb347-2" aria-hidden="true"></a></span>
<span id="cb347-3"><a href="#cb347-3" aria-hidden="true"></a>functiontype2 func2 = &amp;dosomethingwithchar</span>
<span id="cb347-4"><a href="#cb347-4" aria-hidden="true"></a><span class="dt">int</span> result = func2(<span class="ch">&#39;a&#39;</span>);</span></code></pre></div>
<p>There are libraries that can help with turning function pointers into nice readable types. The <a href="http://www.boost.org/doc/libs/1_36_0/doc/html/function.html" rel="noreferrer">boost function</a> library is great and is well worth the effort!</p>
<div class="sourceCode" id="cb348"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb348-1"><a href="#cb348-1" aria-hidden="true"></a>boost::function&lt;<span class="dt">int</span> (<span class="dt">char</span> a)&gt; functiontype2;</span></code></pre></div>
<p>is so much nicer than the above.</p>
</section>
<section id="answer-3-score-60" class="level4">
<h4>Answer 3 (score 60)</h4>
<p>Since C++11 you can use the <a href="http://www.cplusplus.com/reference/functional/function/function/" rel="noreferrer">functional library</a> to do this in a succinct and generic fashion. The syntax is, e.g.,</p>
<div class="sourceCode" id="cb349"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb349-1"><a href="#cb349-1" aria-hidden="true"></a>std::function&lt;<span class="dt">bool</span> (<span class="dt">int</span>)&gt;</span></code></pre></div>
<p>where <code>bool</code> is the return type here of a one-argument function whose first argument is of type <code>int</code>.</p>
<p>I have included an example program below:</p>
<div class="sourceCode" id="cb350"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb350-1"><a href="#cb350-1" aria-hidden="true"></a><span class="co">// g++ test.cpp --std=c++11</span></span>
<span id="cb350-2"><a href="#cb350-2" aria-hidden="true"></a></span>
<span id="cb350-3"><a href="#cb350-3" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;functional&gt;</span></span>
<span id="cb350-4"><a href="#cb350-4" aria-hidden="true"></a></span>
<span id="cb350-5"><a href="#cb350-5" aria-hidden="true"></a><span class="dt">double</span> Combiner(<span class="dt">double</span> a, <span class="dt">double</span> b, std::function&lt;<span class="dt">double</span> (<span class="dt">double</span>,<span class="dt">double</span>)&gt; func){</span>
<span id="cb350-6"><a href="#cb350-6" aria-hidden="true"></a>  <span class="cf">return</span> func(a,b);</span>
<span id="cb350-7"><a href="#cb350-7" aria-hidden="true"></a>}</span>
<span id="cb350-8"><a href="#cb350-8" aria-hidden="true"></a></span>
<span id="cb350-9"><a href="#cb350-9" aria-hidden="true"></a><span class="dt">double</span> Add(<span class="dt">double</span> a, <span class="dt">double</span> b){</span>
<span id="cb350-10"><a href="#cb350-10" aria-hidden="true"></a>  <span class="cf">return</span> a+b;</span>
<span id="cb350-11"><a href="#cb350-11" aria-hidden="true"></a>}</span>
<span id="cb350-12"><a href="#cb350-12" aria-hidden="true"></a></span>
<span id="cb350-13"><a href="#cb350-13" aria-hidden="true"></a><span class="dt">double</span> Mult(<span class="dt">double</span> a, <span class="dt">double</span> b){</span>
<span id="cb350-14"><a href="#cb350-14" aria-hidden="true"></a>  <span class="cf">return</span> a*b;</span>
<span id="cb350-15"><a href="#cb350-15" aria-hidden="true"></a>}</span>
<span id="cb350-16"><a href="#cb350-16" aria-hidden="true"></a></span>
<span id="cb350-17"><a href="#cb350-17" aria-hidden="true"></a><span class="dt">int</span> main(){</span>
<span id="cb350-18"><a href="#cb350-18" aria-hidden="true"></a>  Combiner(<span class="dv">12</span>,<span class="dv">13</span>,Add);</span>
<span id="cb350-19"><a href="#cb350-19" aria-hidden="true"></a>  Combiner(<span class="dv">12</span>,<span class="dv">13</span>,Mult);</span>
<span id="cb350-20"><a href="#cb350-20" aria-hidden="true"></a>}</span></code></pre></div>
<p>Sometimes, though, it is more convenient to use a template function:</p>
<div class="sourceCode" id="cb351"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb351-1"><a href="#cb351-1" aria-hidden="true"></a><span class="co">// g++ test.cpp --std=c++11</span></span>
<span id="cb351-2"><a href="#cb351-2" aria-hidden="true"></a></span>
<span id="cb351-3"><a href="#cb351-3" aria-hidden="true"></a>template&lt;class T&gt;</span>
<span id="cb351-4"><a href="#cb351-4" aria-hidden="true"></a><span class="dt">double</span> Combiner(<span class="dt">double</span> a, <span class="dt">double</span> b, T func){</span>
<span id="cb351-5"><a href="#cb351-5" aria-hidden="true"></a>  <span class="cf">return</span> func(a,b);</span>
<span id="cb351-6"><a href="#cb351-6" aria-hidden="true"></a>}</span>
<span id="cb351-7"><a href="#cb351-7" aria-hidden="true"></a></span>
<span id="cb351-8"><a href="#cb351-8" aria-hidden="true"></a><span class="dt">double</span> Add(<span class="dt">double</span> a, <span class="dt">double</span> b){</span>
<span id="cb351-9"><a href="#cb351-9" aria-hidden="true"></a>  <span class="cf">return</span> a+b;</span>
<span id="cb351-10"><a href="#cb351-10" aria-hidden="true"></a>}</span>
<span id="cb351-11"><a href="#cb351-11" aria-hidden="true"></a></span>
<span id="cb351-12"><a href="#cb351-12" aria-hidden="true"></a><span class="dt">double</span> Mult(<span class="dt">double</span> a, <span class="dt">double</span> b){</span>
<span id="cb351-13"><a href="#cb351-13" aria-hidden="true"></a>  <span class="cf">return</span> a*b;</span>
<span id="cb351-14"><a href="#cb351-14" aria-hidden="true"></a>}</span>
<span id="cb351-15"><a href="#cb351-15" aria-hidden="true"></a></span>
<span id="cb351-16"><a href="#cb351-16" aria-hidden="true"></a><span class="dt">int</span> main(){</span>
<span id="cb351-17"><a href="#cb351-17" aria-hidden="true"></a>  Combiner(<span class="dv">12</span>,<span class="dv">13</span>,Add);</span>
<span id="cb351-18"><a href="#cb351-18" aria-hidden="true"></a>  Combiner(<span class="dv">12</span>,<span class="dv">13</span>,Mult);</span>
<span id="cb351-19"><a href="#cb351-19" aria-hidden="true"></a>}</span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="get-a-substring-of-a-char-score-504615-in-2015" class="level3">
<h3>51: Get a substring of a char* (score <a href="https://stackoverflow.com/q/4214314.html">504615</a> in 2015)</h3>
<section id="question-49" class="level4">
<h4>Question</h4>
<p>For example, I have this</p>
<div class="sourceCode" id="cb352"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb352-1"><a href="#cb352-1" aria-hidden="true"></a><span class="dt">char</span> *buff = <span class="st">&quot;this is a test string&quot;</span>;</span></code></pre></div>
<p>and want to get <code>"test"</code>. How can I do that?</p>
</section>
<section id="answer-accepted-score-202-1" class="level4">
<h4>Answer accepted (score 202)</h4>
<div class="sourceCode" id="cb353"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb353-1"><a href="#cb353-1" aria-hidden="true"></a><span class="dt">char</span> subbuff[<span class="dv">5</span>];</span>
<span id="cb353-2"><a href="#cb353-2" aria-hidden="true"></a>memcpy( subbuff, &amp;buff[<span class="dv">10</span>], <span class="dv">4</span> );</span>
<span id="cb353-3"><a href="#cb353-3" aria-hidden="true"></a>subbuff[<span class="dv">4</span>] = <span class="ch">&#39;\0&#39;</span>;</span></code></pre></div>
<p>Job done :)</p>
</section>
<section id="answer-2-score-81" class="level4">
<h4>Answer 2 (score 81)</h4>
<p>Assuming you know the position and the length of the substring:</p>
<div class="sourceCode" id="cb354"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb354-1"><a href="#cb354-1" aria-hidden="true"></a><span class="dt">char</span> *buff = <span class="st">&quot;this is a test string&quot;</span>;</span>
<span id="cb354-2"><a href="#cb354-2" aria-hidden="true"></a>printf(<span class="st">&quot;%.*s&quot;</span>, <span class="dv">4</span>, buff + <span class="dv">10</span>);</span></code></pre></div>
<p>You could achieve the same thing by copying the substring to another memory destination, but it’s not reasonable since you already have it in memory.</p>
<p>This is a good example of avoiding unnecessary copying by using pointers.</p>
</section>
<section id="answer-3-score-62" class="level4">
<h4>Answer 3 (score 62)</h4>
<p>Use <code>char* strncpy(char* dest, char* src, int n)</code> from <code>&amp;lt;cstring&amp;gt;</code>. In your case you will need to use the following code:</p>
<div class="sourceCode" id="cb355"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb355-1"><a href="#cb355-1" aria-hidden="true"></a><span class="dt">char</span>* substr = malloc(<span class="dv">4</span>);</span>
<span id="cb355-2"><a href="#cb355-2" aria-hidden="true"></a>strncpy(substr, buff+<span class="dv">10</span>, <span class="dv">4</span>);</span></code></pre></div>
<p>Full documentation on the <code>strncpy</code> function <a href="http://www.cplusplus.com/reference/clibrary/cstring/strncpy/" rel="noreferrer">here</a>.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="difference-between-malloc-and-calloc-score-499399-in-2013" class="level3">
<h3>52: Difference between malloc and calloc? (score <a href="https://stackoverflow.com/q/1538420.html">499399</a> in 2013)</h3>
<section id="question-50" class="level4">
<h4>Question</h4>
<p>What is the difference between doing:</p>
<div class="sourceCode" id="cb356"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb356-1"><a href="#cb356-1" aria-hidden="true"></a>ptr = (<span class="dt">char</span> **) malloc (MAXELEMS * <span class="kw">sizeof</span>(<span class="dt">char</span> *));</span></code></pre></div>
<p>or:</p>
<div class="sourceCode" id="cb357"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb357-1"><a href="#cb357-1" aria-hidden="true"></a>ptr = (<span class="dt">char</span> **) calloc (MAXELEMS, <span class="kw">sizeof</span>(<span class="dt">char</span>*));</span></code></pre></div>
<p>When is it a good idea to use calloc over malloc or vice versa?</p>
</section>
<section id="answer-accepted-score-808" class="level4">
<h4>Answer accepted (score 808)</h4>
<p><code>calloc()</code> zero-initializes the buffer, while <code>malloc()</code> leaves the memory uninitialized.</p>
<p><strong>EDIT:</strong></p>
<p>Zeroing out the memory may take a little time, so you probably want to use <code>malloc()</code> if that performance is an issue. If initializing the memory is more important, use <code>calloc()</code>. For example, <code>calloc()</code> might save you a call to <code>memset()</code>.</p>
</section>
<section id="answer-2-score-354" class="level4">
<h4>Answer 2 (score 354)</h4>
<p>A less known difference is that in operating systems with optimistic memory allocation, like Linux, the pointer returned by <code>malloc</code> isn’t backed by real memory until the program actually touches it.</p>
<p><code>calloc</code> does indeed touch the memory (it writes zeroes on it) and thus you’ll be sure the OS is backing the allocation with actual RAM (or swap). This is also why it is slower than malloc (not only does it have to zero it, the OS must also find a suitable memory area by possibly swapping out other processes)</p>
<p>See for instance <a href="https://stackoverflow.com/questions/911860/does-malloc-lazily-create-the-backing-pages-for-an-allocation-on-linux-and-other">this SO question</a> for further discussion about the behavior of malloc</p>
</section>
<section id="answer-3-score-105" class="level4">
<h4>Answer 3 (score 105)</h4>
<p>One often-overlooked advantage of <code>calloc</code> is that (conformant implementations of) it will help protect you against integer overflow vulnerabilities. Compare:</p>
<div class="sourceCode" id="cb358"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb358-1"><a href="#cb358-1" aria-hidden="true"></a><span class="dt">size_t</span> count = get_int32(file);</span>
<span id="cb358-2"><a href="#cb358-2" aria-hidden="true"></a><span class="kw">struct</span> foo *bar = malloc(count * <span class="kw">sizeof</span> *bar);</span></code></pre></div>
<p>vs. </p>
<div class="sourceCode" id="cb359"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb359-1"><a href="#cb359-1" aria-hidden="true"></a><span class="dt">size_t</span> count = get_int32(file);</span>
<span id="cb359-2"><a href="#cb359-2" aria-hidden="true"></a><span class="kw">struct</span> foo *bar = calloc(count, <span class="kw">sizeof</span> *bar);</span></code></pre></div>
<p>The former could result in a tiny allocation and subsequent buffer overflows, if <code>count</code> is greater than <code>SIZE_MAX/sizeof *bar</code>. The latter will automatically fail in this case since an object that large cannot be created.</p>
<p>Of course you may have to be on the lookout for non-conformant implementations which simply ignore the possibility of overflow… If this is a concern on platforms you target, you’ll have to do a manual test for overflow anyway.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-to-compile-and-run-cc-in-a-unix-consolemac-terminal-score-496686-in-2018" class="level3">
<h3>53: How to compile and run C/C++ in a Unix console/Mac terminal? (score <a href="https://stackoverflow.com/q/221185.html">496686</a> in 2018)</h3>
<section id="question-51" class="level4">
<h4>Question</h4>
<p>How can I compile/run C or C++ in Unix console or a Mac terminal?</p>
<p>(I know it, forget it, and relearn it again. Time to write it down.)</p>
</section>
<section id="answer-accepted-score-173" class="level4">
<h4>Answer accepted (score 173)</h4>
<p>If it is a simple single source program:</p>
<div class="sourceCode" id="cb360"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb360-1"><a href="#cb360-1" aria-hidden="true"></a>make foo</span></code></pre></div>
<p>where the source file is foo.c or foo.cpp, etc.</p>
<p>You dont even need a makefile. Make has enough built-in rules to build your source file into an executable of the same name, minus extension.</p>
<p>Running the executable just built is the same as running any program - but you will most often need to specify the path to the executable as the shell will only search what is in <code>$PATH</code> to find executables, and most often that does not include the current directory (<code>.</code>).</p>
<p>So to run the built executable <code>foo</code>:</p>
<div class="sourceCode" id="cb361"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb361-1"><a href="#cb361-1" aria-hidden="true"></a>./foo</span></code></pre></div>
</section>
<section id="answer-2-score-107" class="level4">
<h4>Answer 2 (score 107)</h4>
<div class="sourceCode" id="cb362"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb362-1"><a href="#cb362-1" aria-hidden="true"></a>gcc main.cpp -o main.out  </span>
<span id="cb362-2"><a href="#cb362-2" aria-hidden="true"></a>./main.out</span></code></pre></div>
</section>
<section id="answer-3-score-67" class="level4">
<h4>Answer 3 (score 67)</h4>
<p>This is the command that works on all Unix machines… I use it on Linux/Ubuntu, but it works in OS X as well. Type the following command in <strong>Terminal.app</strong>.</p>
<div class="sourceCode" id="cb363"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb363-1"><a href="#cb363-1" aria-hidden="true"></a>$ g++ -o lab21 iterative.cpp</span></code></pre></div>
<p><code>-o</code> is the letter O not zero</p>
<p><code>lab21</code> will be your executable file</p>
<p><code>iterative.cpp</code> is your c++ file</p>
<p>After you run that command type the following in terminal to run your program:</p>
<div class="sourceCode" id="cb364"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb364-1"><a href="#cb364-1" aria-hidden="true"></a>$ ./lab21</span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="reading-string-from-input-with-space-character-score-492341-in-2018" class="level3">
<h3>54: Reading string from input with space character? (score <a href="https://stackoverflow.com/q/6282198.html">492341</a> in 2018)</h3>
<section id="question-52" class="level4">
<h4>Question</h4>
<p>
I’m using Ubuntu and I’m also using Geany and CodeBlock as my IDE. What I’m trying to do is reading a string (like <code>"Barack Obama"</code>) and put it in a variable:
</p>
<div class="sourceCode" id="cb365"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb365-1"><a href="#cb365-1" aria-hidden="true"></a></span>
<span id="cb365-2"><a href="#cb365-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb365-3"><a href="#cb365-3" aria-hidden="true"></a></span>
<span id="cb365-4"><a href="#cb365-4" aria-hidden="true"></a><span class="dt">int</span> main(<span class="dt">void</span>)</span>
<span id="cb365-5"><a href="#cb365-5" aria-hidden="true"></a>{</span>
<span id="cb365-6"><a href="#cb365-6" aria-hidden="true"></a>    <span class="dt">char</span> name[<span class="dv">100</span>];</span>
<span id="cb365-7"><a href="#cb365-7" aria-hidden="true"></a></span>
<span id="cb365-8"><a href="#cb365-8" aria-hidden="true"></a>    printf(<span class="st">&quot;Enter your name: &quot;</span>);</span>
<span id="cb365-9"><a href="#cb365-9" aria-hidden="true"></a>    scanf(<span class="st">&quot;%s&quot;</span>, name);</span>
<span id="cb365-10"><a href="#cb365-10" aria-hidden="true"></a>    printf(<span class="st">&quot;Your Name is: %s&quot;</span>, name);</span>
<span id="cb365-11"><a href="#cb365-11" aria-hidden="true"></a></span>
<span id="cb365-12"><a href="#cb365-12" aria-hidden="true"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb365-13"><a href="#cb365-13" aria-hidden="true"></a>}</span></code></pre></div>
<p>Output:</p>
<div class="sourceCode" id="cb366"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb366-1"><a href="#cb366-1" aria-hidden="true"></a>Enter your name: Barack Obama</span>
<span id="cb366-2"><a href="#cb366-2" aria-hidden="true"></a>Your Name is: Barack</span></code></pre></div>
<p>How can I make the program read the whole name?</p>
</section>
<section id="answer-accepted-score-166" class="level4">
<h4>Answer accepted (score 166)</h4>
<p>Use:</p>
<div class="sourceCode" id="cb367"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb367-1"><a href="#cb367-1" aria-hidden="true"></a>fgets (name, <span class="dv">100</span>, stdin);</span></code></pre></div>
<p><code>100</code> is the max length of the buffer. You should adjust it as per your need.</p>
<p>Use:</p>
<div class="sourceCode" id="cb368"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb368-1"><a href="#cb368-1" aria-hidden="true"></a>scanf (<span class="st">&quot;%[^</span><span class="sc">\n</span><span class="st">]%*c&quot;</span>, name);</span></code></pre></div>
<p>The <code>[]</code> is the scanset character. <code>[^\n]</code> tells that while the input is <em>not</em> a newline (<code>'\n'</code>) take input. Then with the <code>%*c</code> it reads the newline character from the input buffer (which is not read), and the <code>*</code> indicates that this read in input is discarded (assignment suppression), as you do not need it, and this newline in the buffer does not create any problem for next inputs that you might take.</p>
<p>Read here about the <a href="http://pubs.opengroup.org/onlinepubs/009695399/functions/scanf.html">scanset</a> and the <a href="http://pubs.opengroup.org/onlinepubs/009695399/functions/scanf.html">assignment suppression</a> operators.</p>
<p>Note you can also use <code>gets</code> but ….</p>
<blockquote>
Never use <code>gets()</code>. Because it is impossible to tell without knowing the data in advance how many characters gets() will read, and because <code>gets()</code> will continue to store characters past the end of the buffer, it is extremely dangerous to use. It has been used to break computer security. Use <code>fgets()</code> instead.
</blockquote>
</section>
<section id="answer-2-score-21" class="level4">
<h4>Answer 2 (score 21)</h4>
<p>Try this:</p>
<div class="sourceCode" id="cb369"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb369-1"><a href="#cb369-1" aria-hidden="true"></a>scanf(<span class="st">&quot;%[^</span><span class="sc">\n</span><span class="st">]s&quot;</span>,name);</span></code></pre></div>
<p><code>\n</code> just sets the delimiter for the scanned string.</p>
</section>
<section id="answer-3-score-6" class="level4">
<h4>Answer 3 (score 6)</h4>
<p>Here is an example of how you can get input containing spaces by using the <code>fgets</code> function.</p>
<div class="sourceCode" id="cb370"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb370-1"><a href="#cb370-1" aria-hidden="true"></a></span>
<span id="cb370-2"><a href="#cb370-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb370-3"><a href="#cb370-3" aria-hidden="true"></a></span>
<span id="cb370-4"><a href="#cb370-4" aria-hidden="true"></a><span class="dt">int</span> main()</span>
<span id="cb370-5"><a href="#cb370-5" aria-hidden="true"></a>{</span>
<span id="cb370-6"><a href="#cb370-6" aria-hidden="true"></a>    <span class="dt">char</span> name[<span class="dv">100</span>];</span>
<span id="cb370-7"><a href="#cb370-7" aria-hidden="true"></a>    printf(<span class="st">&quot;Enter your name: &quot;</span>);</span>
<span id="cb370-8"><a href="#cb370-8" aria-hidden="true"></a>    fgets(name, <span class="dv">100</span>, stdin); </span>
<span id="cb370-9"><a href="#cb370-9" aria-hidden="true"></a>    printf(<span class="st">&quot;Your Name is: %s&quot;</span>, name);</span>
<span id="cb370-10"><a href="#cb370-10" aria-hidden="true"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb370-11"><a href="#cb370-11" aria-hidden="true"></a>}</span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="reading-a-string-with-scanf-score-489645-in-2018" class="level3">
<h3>55: Reading a string with scanf (score <a href="https://stackoverflow.com/q/5406935.html">489645</a> in 2018)</h3>
<section id="question-53" class="level4">
<h4>Question</h4>
<p>I’m a little bit confused about something. I was under the impression that the correct way of reading a C string with <code>scanf()</code> went along the lines of</p>
<p>(never mind the possible buffer overflow, it’s just a simple example)</p>
<div class="sourceCode" id="cb371"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb371-1"><a href="#cb371-1" aria-hidden="true"></a><span class="dt">char</span> string[<span class="dv">256</span>];</span>
<span id="cb371-2"><a href="#cb371-2" aria-hidden="true"></a>scanf( <span class="st">&quot;%s&quot;</span> , string );</span></code></pre></div>
<p>However, the following seems to work too,</p>
<div class="sourceCode" id="cb372"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb372-1"><a href="#cb372-1" aria-hidden="true"></a>scanf( <span class="st">&quot;%s&quot;</span> , &amp;string );</span></code></pre></div>
<p>Is this just my compiler (gcc), pure luck, or something else?</p>
</section>
<section id="answer-accepted-score-130" class="level4">
<h4>Answer accepted (score 130)</h4>
<p>An array “decays” into a pointer to its first element, so <code>scanf("%s", string)</code> is equivalent to <code>scanf("%s", &amp;amp;string[0])</code>. On the other hand, <code>scanf("%s", &amp;amp;string)</code> passes a pointer-to-<code>char[256]</code>, but it points to the same place.</p>
<p>Then <code>scanf</code>, when processing the tail of its argument list, will try to pull out a <code>char *</code>. That’s the Right Thing when you’ve passed in <code>string</code> or <code>&amp;amp;string[0]</code>, but when you’ve passed in <code>&amp;amp;string</code> you’re depending on something that the language standard doesn’t guarantee, namely that the pointers <code>&amp;amp;string</code> and <code>&amp;amp;string[0]</code> – pointers to objects of different types and sizes that start at the same place – are represented the same way.</p>
<p>I don’t believe I’ve ever encountered a system on which that doesn’t work, and in practice you’re probably safe. None the less, it’s wrong, and it could fail on some platforms. (Hypothetical example: a “debugging” implementation that includes type information with every pointer. I <em>think</em> the C implementation on the Symbolics “Lisp Machines” did something like this.)</p>
</section>
<section id="answer-2-score--7" class="level4">
<h4>Answer 2 (score -7)</h4>
<p>
I think that this below is accurate and it may help. Feel free to correct it if you find any errors. I’m new at C.
</p>
<div class="sourceCode" id="cb373"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb373-1"><a href="#cb373-1" aria-hidden="true"></a><span class="dt">char</span> str[]  </span></code></pre></div>
<ol>
<li>
array of values of type char, with its own address in memory
</li>
<li>
array of values of type char, with its own address in memory as many consecutive addresses as elements in the array
</li>
<li>
<p>
including termination null character <code>'\0'</code> <code>&amp;amp;str</code>, <code>&amp;amp;str[0]</code> and <code>str</code>, all three represent the same location in memory which is address of the first element of the array <code>str</code>
</p>
char *strPtr = &amp;str[0]; //declaration and initialization
</li>
</ol>
<p>alternatively, you can split this in two:</p>
<div class="sourceCode" id="cb374"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb374-1"><a href="#cb374-1" aria-hidden="true"></a><span class="dt">char</span> *strPtr; strPtr = &amp;str[<span class="dv">0</span>];</span></code></pre></div>
<ol start="4">
<li>
<code>strPtr</code> is a pointer to a <code>char</code>
</li>
<li>
<code>strPtr</code> points at array <code>str</code>
</li>
<li>
<code>strPtr</code> is a variable with its own address in memory
</li>
<li>
<code>strPtr</code> is a variable that stores value of address <code>&amp;amp;str[0]</code>
</li>
<li>
<code>strPtr</code> own address in memory is different from the memory address that it stores (address of array in memory a.k.a &amp;str[0])
</li>
<li>
<code>&amp;amp;strPtr</code> represents the address of strPtr itself
</li>
</ol>
<p>I think that you could declare a pointer to a pointer as:</p>
<div class="sourceCode" id="cb375"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb375-1"><a href="#cb375-1" aria-hidden="true"></a><span class="dt">char</span> **vPtr = &amp;strPtr;  </span></code></pre></div>
<p>declares and initializes with address of strPtr pointer</p>
<p>Alternatively you could split in two:</p>
<div class="sourceCode" id="cb376"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb376-1"><a href="#cb376-1" aria-hidden="true"></a><span class="dt">char</span> **vPtr;</span>
<span id="cb376-2"><a href="#cb376-2" aria-hidden="true"></a>*vPtr = &amp;strPtr</span></code></pre></div>
<ol start="10">
<li>
<code>*vPtr</code> points at strPtr pointer
</li>
<li>
<code>*vPtr</code> is a variable with its own address in memory
</li>
<li>
<code>*vPtr</code> is a variable that stores value of address &amp;strPtr
</li>
<li>
final comment: you can not do <code>str++</code>, <code>str</code> address is a <code>const</code>, but you can do <code>strPtr++</code>
</li>
</ol>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="why-should-we-typedef-a-struct-so-often-in-c-score-487703-in-2016" class="level3">
<h3>56: Why should we typedef a struct so often in C? (score <a href="https://stackoverflow.com/q/252780.html">487703</a> in 2016)</h3>
<section id="question-54" class="level4">
<h4>Question</h4>
<p>I have seen many programs consisting of structures like the one below</p>
<div class="sourceCode" id="cb377"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb377-1"><a href="#cb377-1" aria-hidden="true"></a><span class="kw">typedef</span> <span class="kw">struct</span> </span>
<span id="cb377-2"><a href="#cb377-2" aria-hidden="true"></a>{</span>
<span id="cb377-3"><a href="#cb377-3" aria-hidden="true"></a>    <span class="dt">int</span> i;</span>
<span id="cb377-4"><a href="#cb377-4" aria-hidden="true"></a>    <span class="dt">char</span> k;</span>
<span id="cb377-5"><a href="#cb377-5" aria-hidden="true"></a>} elem;</span>
<span id="cb377-6"><a href="#cb377-6" aria-hidden="true"></a></span>
<span id="cb377-7"><a href="#cb377-7" aria-hidden="true"></a>elem user;</span></code></pre></div>
<p>Why is it needed so often? Any specific reason or applicable area?</p>
</section>
<section id="answer-accepted-score-433" class="level4">
<h4>Answer accepted (score 433)</h4>
<p>As Greg Hewgill said, the typedef means you no longer have to write <code>struct</code> all over the place. That not only saves keystrokes, it also can make the code cleaner since it provides a smidgen more abstraction.</p>
<p>Stuff like</p>
<div class="sourceCode" id="cb378"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb378-1"><a href="#cb378-1" aria-hidden="true"></a><span class="kw">typedef</span> <span class="kw">struct</span> {</span>
<span id="cb378-2"><a href="#cb378-2" aria-hidden="true"></a>  <span class="dt">int</span> x, y;</span>
<span id="cb378-3"><a href="#cb378-3" aria-hidden="true"></a>} Point;</span>
<span id="cb378-4"><a href="#cb378-4" aria-hidden="true"></a></span>
<span id="cb378-5"><a href="#cb378-5" aria-hidden="true"></a>Point point_new(<span class="dt">int</span> x, <span class="dt">int</span> y)</span>
<span id="cb378-6"><a href="#cb378-6" aria-hidden="true"></a>{</span>
<span id="cb378-7"><a href="#cb378-7" aria-hidden="true"></a>  Point a;</span>
<span id="cb378-8"><a href="#cb378-8" aria-hidden="true"></a>  a.x = x;</span>
<span id="cb378-9"><a href="#cb378-9" aria-hidden="true"></a>  a.y = y;</span>
<span id="cb378-10"><a href="#cb378-10" aria-hidden="true"></a>  <span class="cf">return</span> a;</span>
<span id="cb378-11"><a href="#cb378-11" aria-hidden="true"></a>}</span></code></pre></div>
<p>becomes cleaner when you don’t need to see the “struct” keyword all over the place, it looks more as if there really is a type called “Point” in your language. Which, after the <code>typedef</code>, is the case I guess.</p>
<p>Also note that while your example (and mine) omitted naming the <code>struct</code> itself, actually naming it is also useful for when you want to provide an opaque type. Then you’d have code like this in the header, for instance:</p>
<div class="sourceCode" id="cb379"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb379-1"><a href="#cb379-1" aria-hidden="true"></a><span class="kw">typedef</span> <span class="kw">struct</span> Point Point;</span>
<span id="cb379-2"><a href="#cb379-2" aria-hidden="true"></a></span>
<span id="cb379-3"><a href="#cb379-3" aria-hidden="true"></a>Point * point_new(<span class="dt">int</span> x, <span class="dt">int</span> y);</span></code></pre></div>
<p>and then provide the <code>struct</code> definition in the implementation file:</p>
<div class="sourceCode" id="cb380"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb380-1"><a href="#cb380-1" aria-hidden="true"></a><span class="kw">struct</span> Point</span>
<span id="cb380-2"><a href="#cb380-2" aria-hidden="true"></a>{</span>
<span id="cb380-3"><a href="#cb380-3" aria-hidden="true"></a>  <span class="dt">int</span> x, y;</span>
<span id="cb380-4"><a href="#cb380-4" aria-hidden="true"></a>};</span>
<span id="cb380-5"><a href="#cb380-5" aria-hidden="true"></a></span>
<span id="cb380-6"><a href="#cb380-6" aria-hidden="true"></a>Point * point_new(<span class="dt">int</span> x, <span class="dt">int</span> y)</span>
<span id="cb380-7"><a href="#cb380-7" aria-hidden="true"></a>{</span>
<span id="cb380-8"><a href="#cb380-8" aria-hidden="true"></a>  Point *p;</span>
<span id="cb380-9"><a href="#cb380-9" aria-hidden="true"></a>  <span class="cf">if</span>((p = malloc(<span class="kw">sizeof</span> *p)) != NULL)</span>
<span id="cb380-10"><a href="#cb380-10" aria-hidden="true"></a>  {</span>
<span id="cb380-11"><a href="#cb380-11" aria-hidden="true"></a>    p-&gt;x = x;</span>
<span id="cb380-12"><a href="#cb380-12" aria-hidden="true"></a>    p-&gt;y = y;</span>
<span id="cb380-13"><a href="#cb380-13" aria-hidden="true"></a>  }</span>
<span id="cb380-14"><a href="#cb380-14" aria-hidden="true"></a>  <span class="cf">return</span> p;</span>
<span id="cb380-15"><a href="#cb380-15" aria-hidden="true"></a>}</span></code></pre></div>
<p>In this latter case, you cannot return the Point by value, since its definition is hidden from users of the header file. This is a technique used widely in <a href="http://www.gtk.org/" rel="noreferrer">GTK+</a>, for instance.</p>
<p><strong>UPDATE</strong> Note that there are also highly-regarded C projects where this use of <code>typedef</code> to hide <code>struct</code> is considered a bad idea, the Linux kernel is probably the most well-known such project. See Chapter 5 of <a href="https://www.kernel.org/doc/html/latest/process/coding-style.html
#typedefs" rel="noreferrer">The Linux Kernel CodingStyle document</a> for Linus’ angry words. :) My point is that the “should” in the question is perhaps not set in stone, after all.</p>
</section>
<section id="answer-2-score-198" class="level4">
<h4>Answer 2 (score 198)</h4>
<p>It’s amazing how many people get this wrong. PLEASE don’t typedef structs in C, it needlessly pollutes the global namespace which is typically very polluted already in large C programs.</p>
<p>Also, typedef’d structs without a tag name are a major cause of needless imposition of ordering relationships among header files.</p>
<p>Consider:</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb381-1"><a href="#cb381-1" aria-hidden="true"></a></span>
<span id="cb381-2"><a href="#cb381-2" aria-hidden="true"></a><span class="pp">#ifndef FOO_H</span></span>
<span id="cb381-3"><a href="#cb381-3" aria-hidden="true"></a></span>
<span id="cb381-4"><a href="#cb381-4" aria-hidden="true"></a><span class="pp">#define FOO_H 1</span></span>
<span id="cb381-5"><a href="#cb381-5" aria-hidden="true"></a></span>
<span id="cb381-6"><a href="#cb381-6" aria-hidden="true"></a></span>
<span id="cb381-7"><a href="#cb381-7" aria-hidden="true"></a><span class="pp">#define FOO_DEF (0xDEADBABE)</span></span>
<span id="cb381-8"><a href="#cb381-8" aria-hidden="true"></a></span>
<span id="cb381-9"><a href="#cb381-9" aria-hidden="true"></a><span class="kw">struct</span> bar; <span class="co">/* forward declaration, defined in bar.h*/</span></span>
<span id="cb381-10"><a href="#cb381-10" aria-hidden="true"></a></span>
<span id="cb381-11"><a href="#cb381-11" aria-hidden="true"></a><span class="kw">struct</span> foo {</span>
<span id="cb381-12"><a href="#cb381-12" aria-hidden="true"></a>  <span class="kw">struct</span> bar *bar;</span>
<span id="cb381-13"><a href="#cb381-13" aria-hidden="true"></a>};</span>
<span id="cb381-14"><a href="#cb381-14" aria-hidden="true"></a></span>
<span id="cb381-15"><a href="#cb381-15" aria-hidden="true"></a></span>
<span id="cb381-16"><a href="#cb381-16" aria-hidden="true"></a><span class="pp">#endif</span></span></code></pre></div>
<p>With such a definition, not using typedefs, it is possible for a compiland unit to include foo.h to get at the <code>FOO_DEF</code> definition. If it doesn’t attempt to dereference the ‘bar’ member of the <code>foo</code> struct then there will be no need to include the “bar.h” file.</p>
<p>Also, since the namespaces are different between the tag names and the member names, it is possible to write very readable code such as:</p>
<div class="sourceCode" id="cb382"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb382-1"><a href="#cb382-1" aria-hidden="true"></a><span class="kw">struct</span> foo *foo;</span>
<span id="cb382-2"><a href="#cb382-2" aria-hidden="true"></a></span>
<span id="cb382-3"><a href="#cb382-3" aria-hidden="true"></a>printf(<span class="st">&quot;foo-&gt;bar = %p&quot;</span>, foo-&gt;bar);</span></code></pre></div>
<p>Since the namespaces are separate, there is no conflict in naming variables coincident with their struct tag name.</p>
<p>If I have to maintain your code, I will remove your typedef’d structs.</p>
</section>
<section id="answer-3-score-137" class="level4">
<h4>Answer 3 (score 137)</h4>
<p>From an old article by Dan Saks (<a href="http://www.ddj.com/cpp/184403396?pgno=3" rel="noreferrer">http://www.ddj.com/cpp/184403396?pgno=3</a>):</p>
<hr>
<blockquote>
<p>
The C language rules for naming structs are a little eccentric, but they’re pretty harmless. However, when extended to classes in C++, those same rules open little cracks for bugs to crawl through.
</p>
<p>In C, the name s appearing in</p>
<div class="sourceCode" id="cb383"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb383-1"><a href="#cb383-1" aria-hidden="true"></a><span class="kw">struct</span> s</span>
<span id="cb383-2"><a href="#cb383-2" aria-hidden="true"></a>    {</span>
<span id="cb383-3"><a href="#cb383-3" aria-hidden="true"></a>    ...</span>
<span id="cb383-4"><a href="#cb383-4" aria-hidden="true"></a>    };</span></code></pre></div>
<p>
is a tag. A tag name is not a type name. Given the definition above, declarations such as
</p>
<div class="sourceCode" id="cb384"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb384-1"><a href="#cb384-1" aria-hidden="true"></a>s x;    <span class="co">/* error in C */</span></span>
<span id="cb384-2"><a href="#cb384-2" aria-hidden="true"></a>s *p;   <span class="co">/* error in C */</span></span></code></pre></div>
<p>
are errors in C. You must write them as
</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb385-1"><a href="#cb385-1" aria-hidden="true"></a><span class="kw">struct</span> s x;     <span class="co">/* OK */</span></span>
<span id="cb385-2"><a href="#cb385-2" aria-hidden="true"></a><span class="kw">struct</span> s *p;    <span class="co">/* OK */</span></span></code></pre></div>
<p>
The names of unions and enumerations are also tags rather than types.
</p>
<p>
In C, tags are distinct from all other names (for functions, types, variables, and enumeration constants). C compilers maintain tags in a symbol table that’s conceptually if not physically separate from the table that holds all other names. Thus, it is possible for a C program to have both a tag and an another name with the same spelling in the same scope. For example,
</p>
<div class="sourceCode" id="cb386"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb386-1"><a href="#cb386-1" aria-hidden="true"></a><span class="kw">struct</span> s s;</span></code></pre></div>
<p>
is a valid declaration which declares variable s of type struct s. It may not be good practice, but C compilers must accept it. I have never seen a rationale for why C was designed this way. I have always thought it was a mistake, but there it is.
</p>
<p>
Many programmers (including yours truly) prefer to think of struct names as type names, so they define an alias for the tag using a typedef. For example, defining
</p>
<div class="sourceCode" id="cb387"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb387-1"><a href="#cb387-1" aria-hidden="true"></a><span class="kw">struct</span> s</span>
<span id="cb387-2"><a href="#cb387-2" aria-hidden="true"></a>    {</span>
<span id="cb387-3"><a href="#cb387-3" aria-hidden="true"></a>    ...</span>
<span id="cb387-4"><a href="#cb387-4" aria-hidden="true"></a>    };</span>
<span id="cb387-5"><a href="#cb387-5" aria-hidden="true"></a><span class="kw">typedef</span> <span class="kw">struct</span> s S;</span></code></pre></div>
<p>
lets you use S in place of struct s, as in
</p>
<div class="sourceCode" id="cb388"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb388-1"><a href="#cb388-1" aria-hidden="true"></a>S x;</span>
<span id="cb388-2"><a href="#cb388-2" aria-hidden="true"></a>S *p;</span></code></pre></div>
<p>
A program cannot use S as the name of both a type and a variable (or function or enumeration constant):
</p>
<div class="sourceCode" id="cb389"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb389-1"><a href="#cb389-1" aria-hidden="true"></a>S S;    <span class="co">// error</span></span></code></pre></div>
<p>This is good.</p>
<p>
The tag name in a struct, union, or enum definition is optional. Many programmers fold the struct definition into the typedef and dispense with the tag altogether, as in:
</p>
<div class="sourceCode" id="cb390"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb390-1"><a href="#cb390-1" aria-hidden="true"></a><span class="kw">typedef</span> <span class="kw">struct</span></span>
<span id="cb390-2"><a href="#cb390-2" aria-hidden="true"></a>    {</span>
<span id="cb390-3"><a href="#cb390-3" aria-hidden="true"></a>    ...</span>
<span id="cb390-4"><a href="#cb390-4" aria-hidden="true"></a>    } S;</span></code></pre></div>
</blockquote>
<hr>
<p>The linked article also has a discussion about how the C++ behavior of not requireing a <code>typedef</code> can cause subtle name hiding problems. To prevent these problems, it’s a good idea to <code>typedef</code> your classes and structs in C++, too, even though at first glance it appears to be unnecessary. In C++, with the <code>typedef</code> the name hiding become an error that the compiler tells you about rather than a hidden source of potential problems.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-to-convert-char-to-integer-in-c-score-487261-in-2017" class="level3">
<h3>57: How to convert char to integer in C? (score <a href="https://stackoverflow.com/q/868496.html">487261</a> in 2017)</h3>
<section id="question-55" class="level4">
<h4>Question</h4>
<blockquote>
<p>
<strong>Possible Duplicates:</strong><br> <a href="https://stackoverflow.com/questions/439573/how-to-convert-a-single-char-into-an-int">How to convert a single char into an int</a><br> <a href="https://stackoverflow.com/questions/628761/character-to-integer-in-c">Character to integer in C</a>
</p>
</blockquote>
<p>Can any body tell me how to convert a <code>char</code> to <code>int</code>?</p>
<div class="sourceCode" id="cb391"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb391-1"><a href="#cb391-1" aria-hidden="true"></a><span class="dt">char</span> c[]={<span class="ch">&#39;1&#39;</span>,<span class="ch">&#39;:&#39;</span>,<span class="ch">&#39;3&#39;</span>};</span>
<span id="cb391-2"><a href="#cb391-2" aria-hidden="true"></a></span>
<span id="cb391-3"><a href="#cb391-3" aria-hidden="true"></a><span class="dt">int</span> i=<span class="dt">int</span>(c[<span class="dv">0</span>]);</span>
<span id="cb391-4"><a href="#cb391-4" aria-hidden="true"></a></span>
<span id="cb391-5"><a href="#cb391-5" aria-hidden="true"></a>printf(<span class="st">&quot;%d&quot;</span>,i);</span></code></pre></div>
<p>When I try this it gives 49.</p>
</section>
<section id="answer-2-score-152" class="level4">
<h4>Answer 2 (score 152)</h4>
<p>In the old days, when we could assume that most computers used ASCII, we would just do</p>
<div class="sourceCode" id="cb392"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb392-1"><a href="#cb392-1" aria-hidden="true"></a><span class="dt">int</span> i = c[<span class="dv">0</span>] - <span class="ch">&#39;0&#39;</span>;</span></code></pre></div>
<p><strike>But in these days of Unicode, it’s not a good idea. It was never a good idea if your code had to run on a non-ASCII computer.</strike></p>
<p>Edit: Although it looks hackish, evidently it <em>is</em> guaranteed by the standard to work. Thanks <span class="citation" data-cites="Earwicker">@Earwicker</span>.</p>
</section>
<section id="answer-3-score-38-1" class="level4">
<h4>Answer 3 (score 38)</h4>
<p>The standard function <code>atoi()</code> will likely do what you want.</p>
<p>A simple example using “atoi”:</p>
<div class="sourceCode" id="cb393"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb393-1"><a href="#cb393-1" aria-hidden="true"></a></span>
<span id="cb393-2"><a href="#cb393-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;unistd.h&gt;</span></span>
<span id="cb393-3"><a href="#cb393-3" aria-hidden="true"></a></span>
<span id="cb393-4"><a href="#cb393-4" aria-hidden="true"></a><span class="dt">int</span> main(<span class="dt">int</span> argc, <span class="dt">char</span> *argv[])</span>
<span id="cb393-5"><a href="#cb393-5" aria-hidden="true"></a>{</span>
<span id="cb393-6"><a href="#cb393-6" aria-hidden="true"></a>    <span class="dt">int</span> useconds = atoi(argv[<span class="dv">1</span>]); </span>
<span id="cb393-7"><a href="#cb393-7" aria-hidden="true"></a>    usleep(useconds);</span>
<span id="cb393-8"><a href="#cb393-8" aria-hidden="true"></a>}</span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-to-define-an-enumerated-type-enum-in-c-score-487173-in-2011" class="level3">
<h3>58: How to define an enumerated type (enum) in C? (score <a href="https://stackoverflow.com/q/1102542.html">487173</a> in 2011)</h3>
<section id="question-56" class="level4">
<h4>Question</h4>
<p>I’m not sure what is the proper syntax for using C enums. I have the following code:</p>
<div class="sourceCode" id="cb394"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb394-1"><a href="#cb394-1" aria-hidden="true"></a><span class="kw">enum</span> {RANDOM, IMMEDIATE, SEARCH} strategy;</span>
<span id="cb394-2"><a href="#cb394-2" aria-hidden="true"></a>strategy = IMMEDIATE;</span></code></pre></div>
<p>But this does not compile, with the following error:</p>
<div class="sourceCode" id="cb395"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb395-1"><a href="#cb395-1" aria-hidden="true"></a>error: conflicting types <span class="cf">for</span> ‘strategy’</span>
<span id="cb395-2"><a href="#cb395-2" aria-hidden="true"></a>error: previous declaration of ‘strategy’ was here</span></code></pre></div>
<p>What am I doing wrong?</p>
</section>
<section id="answer-accepted-score-367" class="level4">
<h4>Answer accepted (score 367)</h4>
<p>Declaring an enum variable is done like this:</p>
<div class="sourceCode" id="cb396"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb396-1"><a href="#cb396-1" aria-hidden="true"></a><span class="kw">enum</span> strategy {RANDOM, IMMEDIATE, SEARCH};</span>
<span id="cb396-2"><a href="#cb396-2" aria-hidden="true"></a><span class="kw">enum</span> strategy my_strategy = IMMEDIATE;</span></code></pre></div>
<p>However, you can use a <code>typedef</code> to shorten the variable declarations, like so:</p>
<div class="sourceCode" id="cb397"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb397-1"><a href="#cb397-1" aria-hidden="true"></a><span class="kw">typedef</span> <span class="kw">enum</span> {RANDOM, IMMEDIATE, SEARCH} strategy;</span>
<span id="cb397-2"><a href="#cb397-2" aria-hidden="true"></a>strategy my_strategy = IMMEDIATE;</span></code></pre></div>
<p>Having a naming convention to distinguish between types and variables is a good idea:</p>
<div class="sourceCode" id="cb398"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb398-1"><a href="#cb398-1" aria-hidden="true"></a><span class="kw">typedef</span> <span class="kw">enum</span> {RANDOM, IMMEDIATE, SEARCH} strategy_type;</span>
<span id="cb398-2"><a href="#cb398-2" aria-hidden="true"></a>strategy_type my_strategy = IMMEDIATE;</span></code></pre></div>
</section>
<section id="answer-2-score-447" class="level4">
<h4>Answer 2 (score 447)</h4>
<p>It’s worth pointing out that you don’t <em>need</em> a <code>typedef</code>. You can just do it like the following</p>
<div class="sourceCode" id="cb399"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb399-1"><a href="#cb399-1" aria-hidden="true"></a><span class="kw">enum</span> strategy { RANDOM, IMMEDIATE, SEARCH };</span>
<span id="cb399-2"><a href="#cb399-2" aria-hidden="true"></a><span class="kw">enum</span> strategy my_strategy = IMMEDIATE;</span></code></pre></div>
<p>It’s a style question whether you prefer <code>typedef</code>. Without it, if you want to refer to the enumeration type, you need to use <code>enum strategy</code>. With it, you can just say <code>strategy</code>.</p>
<p>Both ways have their pro and cons. The one is more wordy, but keeps type identifiers into the tag-namespace where they won’t conflict with ordinary identifiers (think of <code>struct stat</code> and the <code>stat</code> function: these don’t conflict either), and where you immediately see that it’s a type. The other is shorter, but brings type identifiers into the ordinary namespace.</p>
</section>
<section id="answer-3-score-57" class="level4">
<h4>Answer 3 (score 57)</h4>
<p>You’re trying to declare <code>strategy</code> twice, and that’s why you’re getting the above error. The following works without any complaints (compiled with <code>gcc -ansi -pendantic -Wall</code>):</p>
<div class="sourceCode" id="cb400"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb400-1"><a href="#cb400-1" aria-hidden="true"></a></span>
<span id="cb400-2"><a href="#cb400-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb400-3"><a href="#cb400-3" aria-hidden="true"></a></span>
<span id="cb400-4"><a href="#cb400-4" aria-hidden="true"></a><span class="kw">enum</span> { RANDOM, IMMEDIATE, SEARCH } strategy = IMMEDIATE;</span>
<span id="cb400-5"><a href="#cb400-5" aria-hidden="true"></a></span>
<span id="cb400-6"><a href="#cb400-6" aria-hidden="true"></a><span class="dt">int</span> main(<span class="dt">int</span> argc, <span class="dt">char</span>** argv){</span>
<span id="cb400-7"><a href="#cb400-7" aria-hidden="true"></a>    printf(<span class="st">&quot;strategy: %d</span><span class="sc">\n</span><span class="st">&quot;</span>, strategy);</span>
<span id="cb400-8"><a href="#cb400-8" aria-hidden="true"></a></span>
<span id="cb400-9"><a href="#cb400-9" aria-hidden="true"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb400-10"><a href="#cb400-10" aria-hidden="true"></a>}</span></code></pre></div>
<p>If instead of the above, the second line were changed to:</p>
<div class="sourceCode" id="cb401"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb401-1"><a href="#cb401-1" aria-hidden="true"></a>...</span>
<span id="cb401-2"><a href="#cb401-2" aria-hidden="true"></a><span class="kw">enum</span> { RANDOM, IMMEDIATE, SEARCH } strategy;</span>
<span id="cb401-3"><a href="#cb401-3" aria-hidden="true"></a>strategy = IMMEDIATE;</span>
<span id="cb401-4"><a href="#cb401-4" aria-hidden="true"></a>...</span></code></pre></div>
<p>From the warnings, you could easily see your mistake:</p>
<div class="sourceCode" id="cb402"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb402-1"><a href="#cb402-1" aria-hidden="true"></a>enums.c:<span class="dv">5</span>:<span class="dv">1</span>: warning: data definition has no type or storage class [enabled by <span class="cf">default</span>]</span>
<span id="cb402-2"><a href="#cb402-2" aria-hidden="true"></a>enums.c:<span class="dv">5</span>:<span class="dv">1</span>: warning: type defaults to ‘int’ in declaration of ‘strategy’ [-Wimplicit-<span class="dt">int</span>]</span>
<span id="cb402-3"><a href="#cb402-3" aria-hidden="true"></a>enums.c:<span class="dv">5</span>:<span class="dv">1</span>: error: conflicting types <span class="cf">for</span> ‘strategy’</span>
<span id="cb402-4"><a href="#cb402-4" aria-hidden="true"></a>enums.c:<span class="dv">4</span>:<span class="dv">36</span>: note: previous declaration of ‘strategy’ was here</span></code></pre></div>
<p>So the compiler took <code>strategy = IMMEDIATE</code> for a declaration of a variable called <code>strategy</code> with default type <code>int</code>, but there was already a previous declaration of a variable with this name.</p>
<p>However, if you placed the assignment in the <code>main()</code> function, it would be a valid code:</p>
<div class="sourceCode" id="cb403"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb403-1"><a href="#cb403-1" aria-hidden="true"></a></span>
<span id="cb403-2"><a href="#cb403-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb403-3"><a href="#cb403-3" aria-hidden="true"></a></span>
<span id="cb403-4"><a href="#cb403-4" aria-hidden="true"></a><span class="kw">enum</span> { RANDOM, IMMEDIATE, SEARCH } strategy = IMMEDIATE;</span>
<span id="cb403-5"><a href="#cb403-5" aria-hidden="true"></a></span>
<span id="cb403-6"><a href="#cb403-6" aria-hidden="true"></a><span class="dt">int</span> main(<span class="dt">int</span> argc, <span class="dt">char</span>** argv){</span>
<span id="cb403-7"><a href="#cb403-7" aria-hidden="true"></a>    strategy=SEARCH;</span>
<span id="cb403-8"><a href="#cb403-8" aria-hidden="true"></a>    printf(<span class="st">&quot;strategy: %d</span><span class="sc">\n</span><span class="st">&quot;</span>, strategy);</span>
<span id="cb403-9"><a href="#cb403-9" aria-hidden="true"></a></span>
<span id="cb403-10"><a href="#cb403-10" aria-hidden="true"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb403-11"><a href="#cb403-11" aria-hidden="true"></a>}</span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="whats-the-best-way-to-check-if-a-file-exists-in-c-score-483699-in-2019" class="level3">
<h3>59: What’s the best way to check if a file exists in C? (score <a href="https://stackoverflow.com/q/230062.html">483699</a> in 2019)</h3>
<section id="question-57" class="level4">
<h4>Question</h4>
<p>Is there a better way than simply trying to open the file?</p>
<div class="sourceCode" id="cb404"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb404-1"><a href="#cb404-1" aria-hidden="true"></a><span class="dt">int</span> exists(<span class="dt">const</span> <span class="dt">char</span> *fname)</span>
<span id="cb404-2"><a href="#cb404-2" aria-hidden="true"></a>{</span>
<span id="cb404-3"><a href="#cb404-3" aria-hidden="true"></a>    <span class="dt">FILE</span> *file;</span>
<span id="cb404-4"><a href="#cb404-4" aria-hidden="true"></a>    <span class="cf">if</span> ((file = fopen(fname, <span class="st">&quot;r&quot;</span>)))</span>
<span id="cb404-5"><a href="#cb404-5" aria-hidden="true"></a>    {</span>
<span id="cb404-6"><a href="#cb404-6" aria-hidden="true"></a>        fclose(file);</span>
<span id="cb404-7"><a href="#cb404-7" aria-hidden="true"></a>        <span class="cf">return</span> <span class="dv">1</span>;</span>
<span id="cb404-8"><a href="#cb404-8" aria-hidden="true"></a>    }</span>
<span id="cb404-9"><a href="#cb404-9" aria-hidden="true"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb404-10"><a href="#cb404-10" aria-hidden="true"></a>}</span></code></pre></div>
</section>
<section id="answer-accepted-score-535" class="level4">
<h4>Answer accepted (score 535)</h4>
<p>Look up the <code>access()</code> function, found in <code>unistd.h</code>. You can replace your function with</p>
<div class="sourceCode" id="cb405"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb405-1"><a href="#cb405-1" aria-hidden="true"></a><span class="cf">if</span>( access( fname, F_OK ) != -<span class="dv">1</span> ) {</span>
<span id="cb405-2"><a href="#cb405-2" aria-hidden="true"></a>    <span class="co">// file exists</span></span>
<span id="cb405-3"><a href="#cb405-3" aria-hidden="true"></a>} <span class="cf">else</span> {</span>
<span id="cb405-4"><a href="#cb405-4" aria-hidden="true"></a>    <span class="co">// file doesn&#39;t exist</span></span>
<span id="cb405-5"><a href="#cb405-5" aria-hidden="true"></a>}</span></code></pre></div>
<p>You can also use <code>R_OK</code>, <code>W_OK</code>, and <code>X_OK</code> in place of <code>F_OK</code> to check for read permission, write permission, and execute permission (respectively) rather than existence, and you can OR any of them together (i.e. check for both read <em>and</em> write permission using <code>R_OK|W_OK</code>)</p>
<p><em>Update</em>: Note that on Windows, you can’t use <code>W_OK</code> to reliably test for write permission, since the access function does not take DACLs into account. <code>access( fname, W_OK )</code> may return 0 (success) because the file does not have the read-only attribute set, but you still may not have permission to write to the file.</p>
</section>
<section id="answer-2-score-109" class="level4">
<h4>Answer 2 (score 109)</h4>
<p>Use stat like this:</p>
<div class="sourceCode" id="cb406"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb406-1"><a href="#cb406-1" aria-hidden="true"></a><span class="dt">bool</span> file_exist (<span class="dt">char</span> *filename)</span>
<span id="cb406-2"><a href="#cb406-2" aria-hidden="true"></a>{</span>
<span id="cb406-3"><a href="#cb406-3" aria-hidden="true"></a>  <span class="kw">struct</span> stat   buffer;   </span>
<span id="cb406-4"><a href="#cb406-4" aria-hidden="true"></a>  <span class="cf">return</span> (stat (filename, &amp;buffer) == <span class="dv">0</span>);</span>
<span id="cb406-5"><a href="#cb406-5" aria-hidden="true"></a>}</span></code></pre></div>
<p>and call it like this:</p>
<div class="sourceCode" id="cb407"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb407-1"><a href="#cb407-1" aria-hidden="true"></a><span class="cf">if</span> (file_exist (<span class="st">&quot;myfile.txt&quot;</span>))</span>
<span id="cb407-2"><a href="#cb407-2" aria-hidden="true"></a>{</span>
<span id="cb407-3"><a href="#cb407-3" aria-hidden="true"></a>  printf (<span class="st">&quot;It exists</span><span class="sc">\n</span><span class="st">&quot;</span>);</span>
<span id="cb407-4"><a href="#cb407-4" aria-hidden="true"></a>}</span></code></pre></div>
</section>
<section id="answer-3-score-77" class="level4">
<h4>Answer 3 (score 77)</h4>
<p>Usually when you want to check if a file exists, it’s because you want to <em>create</em> that file if it doesn’t. Graeme Perrow’s answer is good if you <strong>don’t</strong> want to create that file, but it’s vulnerable to a race condition if you do: another process could create the file in between you checking if it exists, and you actually opening it to write to it. (Don’t laugh… this could have <strong>bad</strong> security implications if the file created was a symlink!)</p>
<p>If you want to check for existence <em>and</em> create the file if it doesn’t exist, <strong>atomically</strong> so that there are no race conditions, then use this:</p>
<div class="sourceCode" id="cb408"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb408-1"><a href="#cb408-1" aria-hidden="true"></a></span>
<span id="cb408-2"><a href="#cb408-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;fcntl.h&gt;</span></span>
<span id="cb408-3"><a href="#cb408-3" aria-hidden="true"></a></span>
<span id="cb408-4"><a href="#cb408-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;errno.h&gt;</span></span>
<span id="cb408-5"><a href="#cb408-5" aria-hidden="true"></a></span>
<span id="cb408-6"><a href="#cb408-6" aria-hidden="true"></a>fd = open(pathname, O_CREAT | O_WRONLY | O_EXCL, S_IRUSR | S_IWUSR);</span>
<span id="cb408-7"><a href="#cb408-7" aria-hidden="true"></a><span class="cf">if</span> (fd &lt; <span class="dv">0</span>) {</span>
<span id="cb408-8"><a href="#cb408-8" aria-hidden="true"></a>  <span class="co">/* failure */</span></span>
<span id="cb408-9"><a href="#cb408-9" aria-hidden="true"></a>  <span class="cf">if</span> (errno == EEXIST) {</span>
<span id="cb408-10"><a href="#cb408-10" aria-hidden="true"></a>    <span class="co">/* the file already existed */</span></span>
<span id="cb408-11"><a href="#cb408-11" aria-hidden="true"></a>    ...</span>
<span id="cb408-12"><a href="#cb408-12" aria-hidden="true"></a>  }</span>
<span id="cb408-13"><a href="#cb408-13" aria-hidden="true"></a>} <span class="cf">else</span> {</span>
<span id="cb408-14"><a href="#cb408-14" aria-hidden="true"></a>  <span class="co">/* now you can use the file */</span></span>
<span id="cb408-15"><a href="#cb408-15" aria-hidden="true"></a>}</span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-do-i-get-the-directory-that-a-program-is-running-from-score-477268-in-2013" class="level3">
<h3>60: How do I get the directory that a program is running from? (score <a href="https://stackoverflow.com/q/143174.html">477268</a> in 2013)</h3>
<section id="question-58" class="level4">
<h4>Question</h4>
<p>Is there a platform-agnostic and filesystem-agnostic method to obtain the full path of the directory from where a program is running using C/C++? Not to be confused with the current working directory. (Please don’t suggest libraries unless they’re standard ones like clib or STL.)</p>
<p>(If there’s no platform/filesystem-agnostic method, suggestions that work in Windows and Linux for specific filesystems are welcome too.)</p>
</section>
<section id="answer-accepted-score-171" class="level4">
<h4>Answer accepted (score 171)</h4>
<p>Here’s code to get the full path to the executing app:</p>
<p>Windows:</p>
<div class="sourceCode" id="cb409"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb409-1"><a href="#cb409-1" aria-hidden="true"></a><span class="dt">int</span> bytes = GetModuleFileName(NULL, pBuf, len);</span>
<span id="cb409-2"><a href="#cb409-2" aria-hidden="true"></a><span class="cf">if</span>(bytes == <span class="dv">0</span>)</span>
<span id="cb409-3"><a href="#cb409-3" aria-hidden="true"></a>    <span class="cf">return</span> -<span class="dv">1</span>;</span>
<span id="cb409-4"><a href="#cb409-4" aria-hidden="true"></a><span class="cf">else</span></span>
<span id="cb409-5"><a href="#cb409-5" aria-hidden="true"></a>    <span class="cf">return</span> bytes;</span></code></pre></div>
<p>Linux:</p>
<div class="sourceCode" id="cb410"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb410-1"><a href="#cb410-1" aria-hidden="true"></a><span class="dt">char</span> szTmp[<span class="dv">32</span>];</span>
<span id="cb410-2"><a href="#cb410-2" aria-hidden="true"></a>sprintf(szTmp, <span class="st">&quot;/proc/%d/exe&quot;</span>, getpid());</span>
<span id="cb410-3"><a href="#cb410-3" aria-hidden="true"></a><span class="dt">int</span> bytes = MIN(readlink(szTmp, pBuf, len), len - <span class="dv">1</span>);</span>
<span id="cb410-4"><a href="#cb410-4" aria-hidden="true"></a><span class="cf">if</span>(bytes &gt;= <span class="dv">0</span>)</span>
<span id="cb410-5"><a href="#cb410-5" aria-hidden="true"></a>    pBuf[bytes] = <span class="ch">&#39;\0&#39;</span>;</span>
<span id="cb410-6"><a href="#cb410-6" aria-hidden="true"></a><span class="cf">return</span> bytes;</span></code></pre></div>
</section>
<section id="answer-2-score-165" class="level4">
<h4>Answer 2 (score 165)</h4>
<p>If you fetch the current directory when your program first starts, then you effectively have the directory your program was started from. Store the value in a variable and refer to it later in your program. This is distinct from <a href="https://stackoverflow.com/q/933850/33732">the directory that holds the current executable program file</a>. It isn’t necessarily the same directory; if someone runs the program from a command prompt, then the program is being <em>run from</em> the command prompt’s current working directory even though the program file lives elsewhere.</p>
<p>getcwd is a POSIX function and supported out of the box by all POSIX compliant platforms. You would not have to do anything special (apart from incliding the right headers unistd.h on Unix and direct.h on windows).</p>
<p>Since you are creating a C program it will link with the default c run time library which is linked to by ALL processes in the system (specially crafted exceptions avoided) and it will include this function by default. The CRT is never considered an external library because that provides the basic standard compliant interface to the OS.</p>
<p>On windows getcwd function has been deprecated in favour of _getcwd. I think you could use it in this fashion.</p>
<div class="sourceCode" id="cb411"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb411-1"><a href="#cb411-1" aria-hidden="true"></a></span>
<span id="cb411-2"><a href="#cb411-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span><span class="pp">  </span><span class="co">/* defines FILENAME_MAX */</span></span>
<span id="cb411-3"><a href="#cb411-3" aria-hidden="true"></a></span>
<span id="cb411-4"><a href="#cb411-4" aria-hidden="true"></a><span class="pp">#ifdef WINDOWS</span></span>
<span id="cb411-5"><a href="#cb411-5" aria-hidden="true"></a></span>
<span id="cb411-6"><a href="#cb411-6" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;direct.h&gt;</span></span>
<span id="cb411-7"><a href="#cb411-7" aria-hidden="true"></a></span>
<span id="cb411-8"><a href="#cb411-8" aria-hidden="true"></a><span class="pp">#define GetCurrentDir _getcwd</span></span>
<span id="cb411-9"><a href="#cb411-9" aria-hidden="true"></a></span>
<span id="cb411-10"><a href="#cb411-10" aria-hidden="true"></a><span class="pp">#else</span></span>
<span id="cb411-11"><a href="#cb411-11" aria-hidden="true"></a></span>
<span id="cb411-12"><a href="#cb411-12" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;unistd.h&gt;</span></span>
<span id="cb411-13"><a href="#cb411-13" aria-hidden="true"></a></span>
<span id="cb411-14"><a href="#cb411-14" aria-hidden="true"></a><span class="pp">#define GetCurrentDir getcwd</span></span>
<span id="cb411-15"><a href="#cb411-15" aria-hidden="true"></a></span>
<span id="cb411-16"><a href="#cb411-16" aria-hidden="true"></a><span class="pp">#endif</span></span>
<span id="cb411-17"><a href="#cb411-17" aria-hidden="true"></a></span>
<span id="cb411-18"><a href="#cb411-18" aria-hidden="true"></a> <span class="dt">char</span> cCurrentPath[FILENAME_MAX];</span>
<span id="cb411-19"><a href="#cb411-19" aria-hidden="true"></a></span>
<span id="cb411-20"><a href="#cb411-20" aria-hidden="true"></a> <span class="cf">if</span> (!GetCurrentDir(cCurrentPath, <span class="kw">sizeof</span>(cCurrentPath)))</span>
<span id="cb411-21"><a href="#cb411-21" aria-hidden="true"></a>     {</span>
<span id="cb411-22"><a href="#cb411-22" aria-hidden="true"></a>     <span class="cf">return</span> errno;</span>
<span id="cb411-23"><a href="#cb411-23" aria-hidden="true"></a>     }</span>
<span id="cb411-24"><a href="#cb411-24" aria-hidden="true"></a></span>
<span id="cb411-25"><a href="#cb411-25" aria-hidden="true"></a>cCurrentPath[<span class="kw">sizeof</span>(cCurrentPath) - <span class="dv">1</span>] = <span class="ch">&#39;\0&#39;</span>; <span class="co">/* not really required */</span></span>
<span id="cb411-26"><a href="#cb411-26" aria-hidden="true"></a></span>
<span id="cb411-27"><a href="#cb411-27" aria-hidden="true"></a>printf (<span class="st">&quot;The current working directory is %s&quot;</span>, cCurrentPath);</span></code></pre></div>
</section>
<section id="answer-3-score-39" class="level4">
<h4>Answer 3 (score 39)</h4>
<p>This is from the <a href="http://www.cplusplus.com/forum/general/11104/">cplusplus forum</a></p>
<p><strong>On windows:</strong></p>
<div class="sourceCode" id="cb412"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb412-1"><a href="#cb412-1" aria-hidden="true"></a></span>
<span id="cb412-2"><a href="#cb412-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;string&gt;</span></span>
<span id="cb412-3"><a href="#cb412-3" aria-hidden="true"></a></span>
<span id="cb412-4"><a href="#cb412-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;windows.h&gt;</span></span>
<span id="cb412-5"><a href="#cb412-5" aria-hidden="true"></a></span>
<span id="cb412-6"><a href="#cb412-6" aria-hidden="true"></a>std::string getexepath()</span>
<span id="cb412-7"><a href="#cb412-7" aria-hidden="true"></a>{</span>
<span id="cb412-8"><a href="#cb412-8" aria-hidden="true"></a>  <span class="dt">char</span> result[ MAX_PATH ];</span>
<span id="cb412-9"><a href="#cb412-9" aria-hidden="true"></a>  <span class="cf">return</span> std::string( result, GetModuleFileName( NULL, result, MAX_PATH ) );</span>
<span id="cb412-10"><a href="#cb412-10" aria-hidden="true"></a>}</span></code></pre></div>
<p><strong>On Linux:</strong></p>
<div class="sourceCode" id="cb413"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb413-1"><a href="#cb413-1" aria-hidden="true"></a></span>
<span id="cb413-2"><a href="#cb413-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;string&gt;</span></span>
<span id="cb413-3"><a href="#cb413-3" aria-hidden="true"></a></span>
<span id="cb413-4"><a href="#cb413-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;limits.h&gt;</span></span>
<span id="cb413-5"><a href="#cb413-5" aria-hidden="true"></a></span>
<span id="cb413-6"><a href="#cb413-6" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;unistd.h&gt;</span></span>
<span id="cb413-7"><a href="#cb413-7" aria-hidden="true"></a></span>
<span id="cb413-8"><a href="#cb413-8" aria-hidden="true"></a>std::string getexepath()</span>
<span id="cb413-9"><a href="#cb413-9" aria-hidden="true"></a>{</span>
<span id="cb413-10"><a href="#cb413-10" aria-hidden="true"></a>  <span class="dt">char</span> result[ PATH_MAX ];</span>
<span id="cb413-11"><a href="#cb413-11" aria-hidden="true"></a>  <span class="dt">ssize_t</span> count = readlink( <span class="st">&quot;/proc/self/exe&quot;</span>, result, PATH_MAX );</span>
<span id="cb413-12"><a href="#cb413-12" aria-hidden="true"></a>  <span class="cf">return</span> std::string( result, (count &gt; <span class="dv">0</span>) ? count : <span class="dv">0</span> );</span>
<span id="cb413-13"><a href="#cb413-13" aria-hidden="true"></a>}</span></code></pre></div>
<p><strong>On HP-UX:</strong></p>
<div class="sourceCode" id="cb414"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb414-1"><a href="#cb414-1" aria-hidden="true"></a></span>
<span id="cb414-2"><a href="#cb414-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;string&gt;</span></span>
<span id="cb414-3"><a href="#cb414-3" aria-hidden="true"></a></span>
<span id="cb414-4"><a href="#cb414-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;limits.h&gt;</span></span>
<span id="cb414-5"><a href="#cb414-5" aria-hidden="true"></a></span>
<span id="cb414-6"><a href="#cb414-6" aria-hidden="true"></a><span class="pp">#define _PSTAT64</span></span>
<span id="cb414-7"><a href="#cb414-7" aria-hidden="true"></a></span>
<span id="cb414-8"><a href="#cb414-8" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;sys/pstat.h&gt;</span></span>
<span id="cb414-9"><a href="#cb414-9" aria-hidden="true"></a></span>
<span id="cb414-10"><a href="#cb414-10" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;sys/types.h&gt;</span></span>
<span id="cb414-11"><a href="#cb414-11" aria-hidden="true"></a></span>
<span id="cb414-12"><a href="#cb414-12" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;unistd.h&gt;</span></span>
<span id="cb414-13"><a href="#cb414-13" aria-hidden="true"></a></span>
<span id="cb414-14"><a href="#cb414-14" aria-hidden="true"></a>std::string getexepath()</span>
<span id="cb414-15"><a href="#cb414-15" aria-hidden="true"></a>{</span>
<span id="cb414-16"><a href="#cb414-16" aria-hidden="true"></a>  <span class="dt">char</span> result[ PATH_MAX ];</span>
<span id="cb414-17"><a href="#cb414-17" aria-hidden="true"></a>  <span class="kw">struct</span> pst_status ps;</span>
<span id="cb414-18"><a href="#cb414-18" aria-hidden="true"></a></span>
<span id="cb414-19"><a href="#cb414-19" aria-hidden="true"></a>  <span class="cf">if</span> (pstat_getproc( &amp;ps, <span class="kw">sizeof</span>( ps ), <span class="dv">0</span>, getpid() ) &lt; <span class="dv">0</span>)</span>
<span id="cb414-20"><a href="#cb414-20" aria-hidden="true"></a>    <span class="cf">return</span> std::string();</span>
<span id="cb414-21"><a href="#cb414-21" aria-hidden="true"></a></span>
<span id="cb414-22"><a href="#cb414-22" aria-hidden="true"></a>  <span class="cf">if</span> (pstat_getpathname( result, PATH_MAX, &amp;ps.pst_fid_text ) &lt; <span class="dv">0</span>)</span>
<span id="cb414-23"><a href="#cb414-23" aria-hidden="true"></a>    <span class="cf">return</span> std::string();</span>
<span id="cb414-24"><a href="#cb414-24" aria-hidden="true"></a></span>
<span id="cb414-25"><a href="#cb414-25" aria-hidden="true"></a>  <span class="cf">return</span> std::string( result );</span>
<span id="cb414-26"><a href="#cb414-26" aria-hidden="true"></a>}</span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="regarding-mainint-argc-char-argv-score-474856-in-2018" class="level3">
<h3>61: Regarding ’main(int argc, char *argv[])’ (score <a href="https://stackoverflow.com/q/3898021.html">474856</a> in 2018)</h3>
<section id="question-59" class="level4">
<h4>Question</h4>
<blockquote>
<p>
<strong>Possible Duplicates:</strong><br> <a href="https://stackoverflow.com/questions/3734111/what-are-the-arguments-to-main-for">What are the arguments to main() for?</a><br> <a href="https://stackoverflow.com/questions/3024197/what-does-int-argc-char-argv-mean">What does int argc, char *argv[] mean?</a>
</p>
</blockquote>
<p>Every program is starting with the <code>main(int argc, char *argv[])</code> definition.</p>
<p>I don’t understand what it means. I would be very glad if somebody could explain why we use these arguments if we don’t use them in the program? Why not just: <code>int main()</code>?</p>
<p>Is the name of the program one of the elements of <code>*argv[]</code> and <code>argc</code> is the count of the number of arguments in <code>*argv[]</code>? What are the other arguments sent to <code>*argv[]</code>? How do we send them?</p>
</section>
<section id="answer-accepted-score-114" class="level4">
<h4>Answer accepted (score 114)</h4>
<p>The arguments <code>argc</code> and <code>argv</code> of <code>main</code> is used as a way to send arguments to a program, the possibly most familiar way is to use the good ol’ terminal where an user could type <kbd><code>cat file</code></kbd>. Here the word <code>cat</code> is a program that takes a file and outputs it to standard output (<code>stdout</code>).</p>
<p>The program receives the number of arguments in <code>argc</code> and the vector of arguments in <code>argv</code>, in the above the <strong>arg</strong>ument <strong>c</strong>ount would be two (The program name counts as the first argument) and the <strong>arg</strong>ument <strong>v</strong>ector would contain [<code>cat</code>,<code>file</code>,<em>null</em>]. While the last element being a null-pointer.</p>
<p>Commonly, you would write it like this:</p>
<div class="sourceCode" id="cb415"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb415-1"><a href="#cb415-1" aria-hidden="true"></a><span class="dt">int</span>  <span class="co">// Specifies that type of variable the function returns.</span></span>
<span id="cb415-2"><a href="#cb415-2" aria-hidden="true"></a>     <span class="co">// main() must return an integer</span></span>
<span id="cb415-3"><a href="#cb415-3" aria-hidden="true"></a>main ( <span class="dt">int</span> argc, <span class="dt">char</span> **argv ) {</span>
<span id="cb415-4"><a href="#cb415-4" aria-hidden="true"></a>     <span class="co">// code</span></span>
<span id="cb415-5"><a href="#cb415-5" aria-hidden="true"></a>     <span class="cf">return</span> <span class="dv">0</span>; <span class="co">// Indicates that everything went well.</span></span>
<span id="cb415-6"><a href="#cb415-6" aria-hidden="true"></a>}</span></code></pre></div>
<p>If your program does not require any arguments, it is equally valid to write a <code>main</code>-function in the following fashion:</p>
<div class="sourceCode" id="cb416"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb416-1"><a href="#cb416-1" aria-hidden="true"></a><span class="dt">int</span> main() {</span>
<span id="cb416-2"><a href="#cb416-2" aria-hidden="true"></a>  <span class="co">// code</span></span>
<span id="cb416-3"><a href="#cb416-3" aria-hidden="true"></a>  <span class="cf">return</span> <span class="dv">0</span>; <span class="co">// Zero indicates success, while any </span></span>
<span id="cb416-4"><a href="#cb416-4" aria-hidden="true"></a>  <span class="co">// Non-Zero value indicates a failure/error</span></span>
<span id="cb416-5"><a href="#cb416-5" aria-hidden="true"></a>}</span></code></pre></div>
<p>In the early versions of the C language, there was no <code>int</code> before <code>main</code> as this was implied. Today, this is considered to be an error.</p>
<p>On <strong>POSIX</strong>-compliant systems (and Windows), there exists the possibility to use a third parameter <code>char **envp</code> which contains a vector of the programs <a href="http://en.wikipedia.org/wiki/Environment_variable" rel="noreferrer"><strong>env</strong>ironment variables</a>. Further variations of the argument list of the <code>main</code> function exists, but I will not detail it here since it is non-standard.</p>
<p>Also, the naming of the variables is a <em>convention</em> and has no actual meaning. It is always a good idea to adhere to this so that you do not confuse others, but it would be equally valid to define <code>main</code> as</p>
<div class="sourceCode" id="cb417"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb417-1"><a href="#cb417-1" aria-hidden="true"></a><span class="dt">int</span> main(<span class="dt">int</span> c, <span class="dt">char</span> **v, <span class="dt">char</span> **e) {</span>
<span id="cb417-2"><a href="#cb417-2" aria-hidden="true"></a>   <span class="co">// code</span></span>
<span id="cb417-3"><a href="#cb417-3" aria-hidden="true"></a>   <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb417-4"><a href="#cb417-4" aria-hidden="true"></a>}</span></code></pre></div>
<p>And for your second question, there are several ways to send arguments to a program. I would recommend you to look at the <a href="http://linux.die.net/man/3/exec" rel="noreferrer"><code>exec*()</code>family of functions</a> which is <strong>POSIX</strong>-standard, but it is probably <strong>easier</strong> to just use <a href="http://linux.die.net/man/3/system" rel="noreferrer"><code>system</code></a><code>("command arg1 arg2")</code>, but the use of <code>system()</code> is usually frowned upon as it is not guaranteed to work on every system. I have not tested it myself; but if there is no <code>bash</code>,<code>zsh</code>, or other shell installed on a *NIX-system, <code>system()</code> will fail.</p>
</section>
<section id="answer-2-score-58" class="level4">
<h4>Answer 2 (score 58)</h4>
<p>Those are for passing arguments to your program, for example from command line, when a program is invoked</p>
<div class="sourceCode" id="cb418"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb418-1"><a href="#cb418-1" aria-hidden="true"></a>$ gcc mysort.c -o mysort</span>
<span id="cb418-2"><a href="#cb418-2" aria-hidden="true"></a></span>
<span id="cb418-3"><a href="#cb418-3" aria-hidden="true"></a>$ mysort <span class="dv">2</span> <span class="dv">8</span> <span class="dv">9</span> <span class="dv">1</span> <span class="dv">4</span> <span class="dv">5</span></span></code></pre></div>
<p>Above, the program <code>mysort</code> is executed with some command line parameters. Inside <code>main( int argc, char * argv[])</code>, this would result in</p>
<div class="sourceCode" id="cb419"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb419-1"><a href="#cb419-1" aria-hidden="true"></a>Argument Count, argc = <span class="dv">7</span> </span></code></pre></div>
<p>since there are 7 arguments (counting the program), and</p>
<div class="sourceCode" id="cb420"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb420-1"><a href="#cb420-1" aria-hidden="true"></a>Argument Vector, argv[] = { <span class="st">&quot;mysort&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;8&quot;</span>, <span class="st">&quot;9&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;4&quot;</span>, <span class="st">&quot;5&quot;</span> };</span></code></pre></div>
<p>Following is a complete example.</p>
<div class="sourceCode" id="cb421"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb421-1"><a href="#cb421-1" aria-hidden="true"></a>$ cat mysort.c</span>
<span id="cb421-2"><a href="#cb421-2" aria-hidden="true"></a></span>
<span id="cb421-3"><a href="#cb421-3" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb421-4"><a href="#cb421-4" aria-hidden="true"></a><span class="dt">int</span> main( <span class="dt">int</span> argc, <span class="dt">char</span> * argv [] ) {</span>
<span id="cb421-5"><a href="#cb421-5" aria-hidden="true"></a>    printf( <span class="st">&quot;argc = %d</span><span class="sc">\n</span><span class="st">&quot;</span>, argc );</span>
<span id="cb421-6"><a href="#cb421-6" aria-hidden="true"></a>    <span class="cf">for</span>( <span class="dt">int</span> i = <span class="dv">0</span>; i &lt; argc; ++i ) {</span>
<span id="cb421-7"><a href="#cb421-7" aria-hidden="true"></a>        printf( <span class="st">&quot;argv[ %d ] = %s</span><span class="sc">\n</span><span class="st">&quot;</span>, i, argv[ i ] );</span>
<span id="cb421-8"><a href="#cb421-8" aria-hidden="true"></a>    }</span>
<span id="cb421-9"><a href="#cb421-9" aria-hidden="true"></a>}</span>
<span id="cb421-10"><a href="#cb421-10" aria-hidden="true"></a></span>
<span id="cb421-11"><a href="#cb421-11" aria-hidden="true"></a>$ gcc mysort.c -o mysort</span>
<span id="cb421-12"><a href="#cb421-12" aria-hidden="true"></a></span>
<span id="cb421-13"><a href="#cb421-13" aria-hidden="true"></a>$ ./mysort <span class="dv">2</span> <span class="dv">8</span> <span class="dv">9</span> <span class="dv">1</span> <span class="dv">4</span> <span class="dv">5</span></span>
<span id="cb421-14"><a href="#cb421-14" aria-hidden="true"></a>argc = <span class="dv">7</span></span>
<span id="cb421-15"><a href="#cb421-15" aria-hidden="true"></a>argv[ <span class="dv">0</span> ] = ./mysort</span>
<span id="cb421-16"><a href="#cb421-16" aria-hidden="true"></a>argv[ <span class="dv">1</span> ] = <span class="dv">2</span></span>
<span id="cb421-17"><a href="#cb421-17" aria-hidden="true"></a>argv[ <span class="dv">2</span> ] = <span class="dv">8</span></span>
<span id="cb421-18"><a href="#cb421-18" aria-hidden="true"></a>argv[ <span class="dv">3</span> ] = <span class="dv">9</span></span>
<span id="cb421-19"><a href="#cb421-19" aria-hidden="true"></a>argv[ <span class="dv">4</span> ] = <span class="dv">1</span></span>
<span id="cb421-20"><a href="#cb421-20" aria-hidden="true"></a>argv[ <span class="dv">5</span> ] = <span class="dv">4</span></span>
<span id="cb421-21"><a href="#cb421-21" aria-hidden="true"></a>argv[ <span class="dv">6</span> ] = <span class="dv">5</span></span></code></pre></div>
<p>[The <code>char</code> strings “2”, “8” etc. can be converted to number using some character to number conversion function, e.g. <code>atol()</code> <a href="http://www.cplusplus.com/reference/clibrary/cstdlib/atol/" rel="noreferrer">(link</a>)]</p>
</section>
<section id="answer-3-score-15" class="level4">
<h4>Answer 3 (score 15)</h4>
<p>With <code>argc</code> (argument count) and <code>argv</code> (argument vector) you can get the number and the values of passed arguments when your application has been launched.</p>
<p>This way you can use parameters (such as <code>-version</code>) when your application is started to act a different way.</p>
<p>But you can also use <code>int main(void)</code> as a prototype in C.</p>
<p>There is a third (less known and nonstandard) prototype with a third argument which is <code>envp</code>. It contains environment variables.</p>
<hr>
<p><strong>Resources:</strong></p>
<ul>
<li>
<a href="http://en.wikipedia.org/wiki/Main_function_(programming)
#C_and_C.2B.2B" rel="noreferrer">Wikipedia - Main function, C and C++</a>
</li>
</ul>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="easily-measure-elapsed-time-score-469449-in-2013" class="level3">
<h3>62: Easily measure elapsed time (score <a href="https://stackoverflow.com/q/2808398.html">469449</a> in 2013)</h3>
<section id="question-60" class="level4">
<h4>Question</h4>
<p>I am trying to use <a href="http://en.cppreference.com/w/cpp/chrono/c/time" rel="noreferrer">time()</a> to measure various points of my program.</p>
<p>What I don’t understand is why the values in the before and after are the same? I understand this is not the best way to profile my program, I just want to see how long something take.</p>
<div class="sourceCode" id="cb422"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb422-1"><a href="#cb422-1" aria-hidden="true"></a>printf(<span class="st">&quot;**MyProgram::before time= %ld</span><span class="sc">\n</span><span class="st">&quot;</span>, time(NULL));</span>
<span id="cb422-2"><a href="#cb422-2" aria-hidden="true"></a></span>
<span id="cb422-3"><a href="#cb422-3" aria-hidden="true"></a>doSomthing();</span>
<span id="cb422-4"><a href="#cb422-4" aria-hidden="true"></a>doSomthingLong();</span>
<span id="cb422-5"><a href="#cb422-5" aria-hidden="true"></a></span>
<span id="cb422-6"><a href="#cb422-6" aria-hidden="true"></a>printf(<span class="st">&quot;**MyProgram::after time= %ld</span><span class="sc">\n</span><span class="st">&quot;</span>, time(NULL));</span></code></pre></div>
<p>I have tried:</p>
<div class="sourceCode" id="cb423"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb423-1"><a href="#cb423-1" aria-hidden="true"></a><span class="kw">struct</span> timeval diff, startTV, endTV;</span>
<span id="cb423-2"><a href="#cb423-2" aria-hidden="true"></a></span>
<span id="cb423-3"><a href="#cb423-3" aria-hidden="true"></a>gettimeofday(&amp;startTV, NULL); </span>
<span id="cb423-4"><a href="#cb423-4" aria-hidden="true"></a></span>
<span id="cb423-5"><a href="#cb423-5" aria-hidden="true"></a>doSomething();</span>
<span id="cb423-6"><a href="#cb423-6" aria-hidden="true"></a>doSomethingLong();</span>
<span id="cb423-7"><a href="#cb423-7" aria-hidden="true"></a></span>
<span id="cb423-8"><a href="#cb423-8" aria-hidden="true"></a>gettimeofday(&amp;endTV, NULL); </span>
<span id="cb423-9"><a href="#cb423-9" aria-hidden="true"></a></span>
<span id="cb423-10"><a href="#cb423-10" aria-hidden="true"></a>timersub(&amp;endTV, &amp;startTV, &amp;diff);</span>
<span id="cb423-11"><a href="#cb423-11" aria-hidden="true"></a></span>
<span id="cb423-12"><a href="#cb423-12" aria-hidden="true"></a>printf(<span class="st">&quot;**time taken = %ld %ld</span><span class="sc">\n</span><span class="st">&quot;</span>, diff.tv_sec, diff.tv_usec);</span></code></pre></div>
<p>How do I read a result of <code>**time taken = 0 26339</code>? Does that mean 26,339 nanoseconds = 26.3 msec?</p>
<p>What about <code>**time taken = 4 45025</code>, does that mean 4 seconds and 25 msec?</p>
</section>
<section id="answer-2-score-263" class="level4">
<h4>Answer 2 (score 263)</h4>
<div class="sourceCode" id="cb424"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb424-1"><a href="#cb424-1" aria-hidden="true"></a></span>
<span id="cb424-2"><a href="#cb424-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;ctime&gt;</span></span>
<span id="cb424-3"><a href="#cb424-3" aria-hidden="true"></a></span>
<span id="cb424-4"><a href="#cb424-4" aria-hidden="true"></a><span class="dt">void</span> f() {</span>
<span id="cb424-5"><a href="#cb424-5" aria-hidden="true"></a>  using namespace std;</span>
<span id="cb424-6"><a href="#cb424-6" aria-hidden="true"></a>  clock_t begin = clock();</span>
<span id="cb424-7"><a href="#cb424-7" aria-hidden="true"></a></span>
<span id="cb424-8"><a href="#cb424-8" aria-hidden="true"></a>  code_to_time();</span>
<span id="cb424-9"><a href="#cb424-9" aria-hidden="true"></a></span>
<span id="cb424-10"><a href="#cb424-10" aria-hidden="true"></a>  clock_t end = clock();</span>
<span id="cb424-11"><a href="#cb424-11" aria-hidden="true"></a>  <span class="dt">double</span> elapsed_secs = <span class="dt">double</span>(end - begin) / CLOCKS_PER_SEC;</span>
<span id="cb424-12"><a href="#cb424-12" aria-hidden="true"></a>}</span></code></pre></div>
<p>The <code>time()</code> function is only accurate to within a second, but there are <a href="http://en.cppreference.com/w/cpp/chrono/c/CLOCKS_PER_SEC" rel="noreferrer"><code>CLOCKS_PER_SEC</code></a> “clocks” within a second. This is an easy, portable measurement, even though it’s over-simplified.</p>
</section>
<section id="answer-3-score-261" class="level4">
<h4>Answer 3 (score 261)</h4>
<p>You can <strong>abstract the time measuring mechanism</strong> and have each callable’s run time measured with <strong>minimal extra code</strong>, just by being called through a timer structure. Plus, at compile time you can <strong>parametrize the timing type</strong> (milliseconds, nanoseconds etc).</p>
<p>
<sup>Thanks to the review by <a href="https://stackoverflow.com/users/14065/loki-astari">Loki Astari</a> and the suggestion to use variadic templates.</sup> <sup><a href="https://stackoverflow.com/q/31253334/2567683">This</a> is why the forwarded function call.</sup>
</p>
<div class="sourceCode" id="cb425"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb425-1"><a href="#cb425-1" aria-hidden="true"></a></span>
<span id="cb425-2"><a href="#cb425-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb425-3"><a href="#cb425-3" aria-hidden="true"></a></span>
<span id="cb425-4"><a href="#cb425-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;chrono&gt;</span></span>
<span id="cb425-5"><a href="#cb425-5" aria-hidden="true"></a></span>
<span id="cb425-6"><a href="#cb425-6" aria-hidden="true"></a>template&lt;typename TimeT = std::chrono::milliseconds&gt;</span>
<span id="cb425-7"><a href="#cb425-7" aria-hidden="true"></a><span class="kw">struct</span> measure</span>
<span id="cb425-8"><a href="#cb425-8" aria-hidden="true"></a>{</span>
<span id="cb425-9"><a href="#cb425-9" aria-hidden="true"></a>    template&lt;typename F, typename ...Args&gt;</span>
<span id="cb425-10"><a href="#cb425-10" aria-hidden="true"></a>    <span class="dt">static</span> typename TimeT::rep execution(F&amp;&amp; func, Args&amp;&amp;... args)</span>
<span id="cb425-11"><a href="#cb425-11" aria-hidden="true"></a>    {</span>
<span id="cb425-12"><a href="#cb425-12" aria-hidden="true"></a>        <span class="dt">auto</span> start = std::chrono::steady_clock::now();</span>
<span id="cb425-13"><a href="#cb425-13" aria-hidden="true"></a>        std::forward&lt;decltype(func)&gt;(func)(std::forward&lt;Args&gt;(args)...);</span>
<span id="cb425-14"><a href="#cb425-14" aria-hidden="true"></a>        <span class="dt">auto</span> duration = std::chrono::duration_cast&lt; TimeT&gt; </span>
<span id="cb425-15"><a href="#cb425-15" aria-hidden="true"></a>                            (std::chrono::steady_clock::now() - start);</span>
<span id="cb425-16"><a href="#cb425-16" aria-hidden="true"></a>        <span class="cf">return</span> duration.count();</span>
<span id="cb425-17"><a href="#cb425-17" aria-hidden="true"></a>    }</span>
<span id="cb425-18"><a href="#cb425-18" aria-hidden="true"></a>};</span>
<span id="cb425-19"><a href="#cb425-19" aria-hidden="true"></a></span>
<span id="cb425-20"><a href="#cb425-20" aria-hidden="true"></a><span class="dt">int</span> main() {</span>
<span id="cb425-21"><a href="#cb425-21" aria-hidden="true"></a>    std::cout &lt;&lt; measure&lt;&gt;::execution(functor(dummy)) &lt;&lt; std::endl;</span>
<span id="cb425-22"><a href="#cb425-22" aria-hidden="true"></a>}</span></code></pre></div>
<p><a href="http://ideone.com/JbUkPq" rel="noreferrer"><kbd><strong>Demo</strong></kbd></a></p>
<p>According to the comment by <a href="https://stackoverflow.com/users/576911/howard-hinnant"><strong>Howard Hinnant</strong></a> it’s best not to escape out of the chrono system until we have to. So the above class could give the user the choice to call <code>count</code> manually by providing an extra static method (shown in C++14)</p>
<div class="sourceCode" id="cb426"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb426-1"><a href="#cb426-1" aria-hidden="true"></a>template&lt;typename F, typename ...Args&gt;</span>
<span id="cb426-2"><a href="#cb426-2" aria-hidden="true"></a><span class="dt">static</span> <span class="dt">auto</span> duration(F&amp;&amp; func, Args&amp;&amp;... args)</span>
<span id="cb426-3"><a href="#cb426-3" aria-hidden="true"></a>{</span>
<span id="cb426-4"><a href="#cb426-4" aria-hidden="true"></a>    <span class="dt">auto</span> start = std::chrono::steady_clock::now();</span>
<span id="cb426-5"><a href="#cb426-5" aria-hidden="true"></a>    std::forward&lt;decltype(func)&gt;(func)(std::forward&lt;Args&gt;(args)...);</span>
<span id="cb426-6"><a href="#cb426-6" aria-hidden="true"></a>    <span class="cf">return</span> std::chrono::duration_cast&lt;TimeT&gt;(std::chrono::steady_clock::now()-start);</span>
<span id="cb426-7"><a href="#cb426-7" aria-hidden="true"></a>} </span>
<span id="cb426-8"><a href="#cb426-8" aria-hidden="true"></a></span>
<span id="cb426-9"><a href="#cb426-9" aria-hidden="true"></a><span class="co">// call .count() manually later when needed (eg IO)</span></span>
<span id="cb426-10"><a href="#cb426-10" aria-hidden="true"></a><span class="dt">auto</span> avg = (measure&lt;&gt;::duration(func) + measure&lt;&gt;::duration(func)) / <span class="fl">2.0</span>;</span></code></pre></div>
<p>and be most useful for clients that</p>
<blockquote>
“want to post-process a bunch of durations prior to I/O (e.g. average)”
</blockquote>
<hr>
<p>The complete <a href="https://github.com/picanumber/bureaucrat/blob/master/time_lapse.h" rel="noreferrer"><strong>code can be found here</strong></a>. My attempt to build a <strong>benchmarking tool</strong> based on chrono is recorded <a href="https://isocpp.org/blog/2015/04/https-ngathanasiou.wordpress.com-2015-04-01-benchmarking-in-c" rel="noreferrer"><strong>here</strong></a>.</p>
<hr>
<p>If C++17’s <a href="http://en.cppreference.com/w/cpp/utility/functional/invoke" rel="noreferrer"><code>std::invoke</code></a> is available, the invocation of the callable in <code>execution</code> could be done like this :</p>
<div class="sourceCode" id="cb427"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb427-1"><a href="#cb427-1" aria-hidden="true"></a>invoke(forward&lt;decltype(func)&gt;(func), forward&lt;Args&gt;(args)...);</span></code></pre></div>
<p>to provide for callables that are pointers to member functions.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="strings-and-character-with-printf-score-465676-in-2013" class="level3">
<h3>63: Strings and character with printf (score <a href="https://stackoverflow.com/q/8019615.html">465676</a> in 2013)</h3>
<section id="question-61" class="level4">
<h4>Question</h4>
<p>I was confused with usage of <code>%c</code> and <code>%s</code> in the following C program</p>
<div class="sourceCode" id="cb428"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb428-1"><a href="#cb428-1" aria-hidden="true"></a></span>
<span id="cb428-2"><a href="#cb428-2" aria-hidden="true"></a><span class="pp">#include</span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb428-3"><a href="#cb428-3" aria-hidden="true"></a></span>
<span id="cb428-4"><a href="#cb428-4" aria-hidden="true"></a>    <span class="dt">void</span> main()</span>
<span id="cb428-5"><a href="#cb428-5" aria-hidden="true"></a>    {</span>
<span id="cb428-6"><a href="#cb428-6" aria-hidden="true"></a>     <span class="dt">char</span> name[]=<span class="st">&quot;siva&quot;</span>;</span>
<span id="cb428-7"><a href="#cb428-7" aria-hidden="true"></a>     printf(<span class="st">&quot;%s</span><span class="sc">\n</span><span class="st">&quot;</span>,name);</span>
<span id="cb428-8"><a href="#cb428-8" aria-hidden="true"></a>     printf(<span class="st">&quot;%c</span><span class="sc">\n</span><span class="st">&quot;</span>,*name);</span>
<span id="cb428-9"><a href="#cb428-9" aria-hidden="true"></a>    }</span></code></pre></div>
<p>Output is</p>
<div class="sourceCode" id="cb429"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb429-1"><a href="#cb429-1" aria-hidden="true"></a>siva</span>
<span id="cb429-2"><a href="#cb429-2" aria-hidden="true"></a>s</span></code></pre></div>
<p>Why we need to use pointer to display a character %c, and pointer is not needed for a string</p>
<p>I am getting error when i use</p>
<div class="sourceCode" id="cb430"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb430-1"><a href="#cb430-1" aria-hidden="true"></a>printf(<span class="st">&quot;%c</span><span class="sc">\n</span><span class="st">&quot;</span>, name);</span></code></pre></div>
<p>Error i got is</p>
<div class="sourceCode" id="cb431"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb431-1"><a href="#cb431-1" aria-hidden="true"></a>str.c: In function ‘main’:</span>
<span id="cb431-2"><a href="#cb431-2" aria-hidden="true"></a>str.c:<span class="dv">9</span>:<span class="dv">2</span>: warning: format ‘%c’ expects type ‘int’, but argument <span class="dv">2</span> has type ‘char *’</span></code></pre></div>
</section>
<section id="answer-accepted-score-70" class="level4">
<h4>Answer accepted (score 70)</h4>
<p>If you try this:</p>
<div class="sourceCode" id="cb432"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb432-1"><a href="#cb432-1" aria-hidden="true"></a></span>
<span id="cb432-2"><a href="#cb432-2" aria-hidden="true"></a><span class="pp">#include</span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb432-3"><a href="#cb432-3" aria-hidden="true"></a></span>
<span id="cb432-4"><a href="#cb432-4" aria-hidden="true"></a><span class="dt">void</span> main()</span>
<span id="cb432-5"><a href="#cb432-5" aria-hidden="true"></a>{</span>
<span id="cb432-6"><a href="#cb432-6" aria-hidden="true"></a> <span class="dt">char</span> name[]=<span class="st">&quot;siva&quot;</span>;</span>
<span id="cb432-7"><a href="#cb432-7" aria-hidden="true"></a> printf(<span class="st">&quot;name = %p</span><span class="sc">\n</span><span class="st">&quot;</span>, name);</span>
<span id="cb432-8"><a href="#cb432-8" aria-hidden="true"></a> printf(<span class="st">&quot;&amp;name[0] = %p</span><span class="sc">\n</span><span class="st">&quot;</span>, &amp;name[<span class="dv">0</span>]);</span>
<span id="cb432-9"><a href="#cb432-9" aria-hidden="true"></a> printf(<span class="st">&quot;name printed as %%s is %s</span><span class="sc">\n</span><span class="st">&quot;</span>,name);</span>
<span id="cb432-10"><a href="#cb432-10" aria-hidden="true"></a> printf(<span class="st">&quot;*name = %c</span><span class="sc">\n</span><span class="st">&quot;</span>,*name);</span>
<span id="cb432-11"><a href="#cb432-11" aria-hidden="true"></a> printf(<span class="st">&quot;name[0] = %c</span><span class="sc">\n</span><span class="st">&quot;</span>, name[<span class="dv">0</span>]);</span>
<span id="cb432-12"><a href="#cb432-12" aria-hidden="true"></a>}</span></code></pre></div>
<p>Output is:</p>
<div class="sourceCode" id="cb433"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb433-1"><a href="#cb433-1" aria-hidden="true"></a>name = <span class="bn">0xbff5391b</span>  </span>
<span id="cb433-2"><a href="#cb433-2" aria-hidden="true"></a>&amp;name[<span class="dv">0</span>] = <span class="bn">0xbff5391b</span></span>
<span id="cb433-3"><a href="#cb433-3" aria-hidden="true"></a>name printed as %s is siva</span>
<span id="cb433-4"><a href="#cb433-4" aria-hidden="true"></a>*name = s</span>
<span id="cb433-5"><a href="#cb433-5" aria-hidden="true"></a>name[<span class="dv">0</span>] = s</span></code></pre></div>
<p>So ‘name’ is actually a pointer to the array of characters in memory. If you try reading the first four bytes at 0xbff5391b, you will see ‘s’, ‘i’, ‘v’ and ‘a’</p>
<div class="sourceCode" id="cb434"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb434-1"><a href="#cb434-1" aria-hidden="true"></a>Location     Data</span>
<span id="cb434-2"><a href="#cb434-2" aria-hidden="true"></a>=========   ======</span>
<span id="cb434-3"><a href="#cb434-3" aria-hidden="true"></a></span>
<span id="cb434-4"><a href="#cb434-4" aria-hidden="true"></a><span class="bn">0xbff5391b</span>    <span class="bn">0x73</span>  <span class="ch">&#39;s&#39;</span>  ---&gt; name[<span class="dv">0</span>]</span>
<span id="cb434-5"><a href="#cb434-5" aria-hidden="true"></a><span class="bn">0xbff5391c</span>    <span class="bn">0x69</span>  <span class="ch">&#39;i&#39;</span>  ---&gt; name[<span class="dv">1</span>]</span>
<span id="cb434-6"><a href="#cb434-6" aria-hidden="true"></a><span class="bn">0xbff5391d</span>    <span class="bn">0x76</span>  <span class="ch">&#39;v&#39;</span>  ---&gt; name[<span class="dv">2</span>]</span>
<span id="cb434-7"><a href="#cb434-7" aria-hidden="true"></a><span class="bn">0xbff5391e</span>    <span class="bn">0x61</span>  <span class="ch">&#39;a&#39;</span>  ---&gt; name[<span class="dv">3</span>]</span>
<span id="cb434-8"><a href="#cb434-8" aria-hidden="true"></a><span class="bn">0xbff5391f</span>    <span class="bn">0x00</span>  <span class="ch">&#39;\0&#39;</span> ---&gt; This is the NULL termination of the string</span></code></pre></div>
<p>To print a character you need to pass the value of the character to printf. The value can be referenced as name[0] or *name (since for an array name = &amp;name[0]).</p>
<p>To print a string you need to pass a pointer to the string to printf (in this case ‘name’ or ‘&amp;name[0]’).</p>
</section>
<section id="answer-2-score-11" class="level4">
<h4>Answer 2 (score 11)</h4>
<div class="sourceCode" id="cb435"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb435-1"><a href="#cb435-1" aria-hidden="true"></a>%c</span></code></pre></div>
<p>is designed for a single character a char, so it print only one element.Passing the char array as a pointer you are passing the address of the first element of the array(that is a single char) and then will be printed :</p>
<p><strong>s</strong></p>
<div class="sourceCode" id="cb436"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb436-1"><a href="#cb436-1" aria-hidden="true"></a>printf(<span class="st">&quot;%c</span><span class="sc">\n</span><span class="st">&quot;</span>,*name++);</span></code></pre></div>
<p>will print</p>
<p><strong>i</strong></p>
<p>and so on …</p>
<p>Pointer is not needed for the %s because it can work directly with String of characters.</p>
</section>
<section id="answer-3-score-6-1" class="level4">
<h4>Answer 3 (score 6)</h4>
<p>
You’re confusing the dereference operator * with pointer type annotation <em>. Basically, in C </em> means different things in different places:
</p>
<ul>
<li>
In a type, * means a pointer. int is an integer type, int* is a pointer to integer type
</li>
<li>
As a prefix operator, * means ‘dereference’. name is a pointer, *name is the result of dereferencing it (i.e. getting the value that the pointer points to)
</li>
<li>
Of course, as an infix operator, * means ‘multiply’.
</li>
</ul>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="what-is-the-difference-between-const-int-const-int-const-and-int-const-score-459578-in-2017" class="level3">
<h3>64: What is the difference between const int<em>, const int </em> const, and int const *? (score <a href="https://stackoverflow.com/q/1143262.html">459578</a> in 2017)</h3>
<section id="question-62" class="level4">
<h4>Question</h4>
<p>I always mess up how to use <code>const int*</code>, <code>const int * const</code>, and <code>int const *</code> correctly. Is there a set of rules defining what you can and cannot do?</p>
<p>I want to know all the do’s and all don’ts in terms of assignments, passing to the functions, etc.</p>
</section>
<section id="answer-accepted-score-2072" class="level4">
<h4>Answer accepted (score 2072)</h4>
<p>Read it backwards (as driven by <a href="http://c-faq.com/decl/spiral.anderson.html" rel="noreferrer">Clockwise/Spiral Rule</a>):</p>
<ul>
<li>
<code>int*</code> - pointer to int
</li>
<li>
<code>int const *</code> - pointer to const int
</li>
<li>
<code>int * const</code> - const pointer to int
</li>
<li>
<code>int const * const</code> - const pointer to const int
</li>
</ul>
<p>Now the first <code>const</code> can be on either side of the type so:</p>
<ul>
<li>
<code>const int *</code> == <code>int const *</code>
</li>
<li>
<code>const int * const</code> == <code>int const * const</code>
</li>
</ul>
<p>If you want to go really crazy you can do things like this:</p>
<ul>
<li>
<code>int **</code> - pointer to pointer to int
</li>
<li>
<code>int ** const</code> - a const pointer to a pointer to an int
</li>
<li>
<code>int * const *</code> - a pointer to a const pointer to an int
</li>
<li>
<code>int const **</code> - a pointer to a pointer to a const int
</li>
<li>
<code>int * const * const</code> - a const pointer to a const pointer to an int
</li>
<li>
…
</li>
</ul>
<p>And to make sure we are clear on the meaning of const</p>
<div class="sourceCode" id="cb437"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb437-1"><a href="#cb437-1" aria-hidden="true"></a><span class="dt">const</span> <span class="dt">int</span>* foo;</span>
<span id="cb437-2"><a href="#cb437-2" aria-hidden="true"></a><span class="dt">int</span> *<span class="dt">const</span> bar; <span class="co">//note, you actually need to set the pointer </span></span>
<span id="cb437-3"><a href="#cb437-3" aria-hidden="true"></a>                <span class="co">//here because you can&#39;t change it later ;)</span></span></code></pre></div>
<p><code>foo</code> is a variable pointer to a constant integer. This lets you change what you point to but not the value that you point to. Most often this is seen with C-style strings where you have a pointer to a <code>const char</code>. You may change which string you point to but you can’t change the content of these strings. This is important when the string itself is in the data segment of a program and shouldn’t be changed.</p>
<p><code>bar</code> is a constant or fixed pointer to a value that can be changed. This is like a reference without the extra syntactic sugar. Because of this fact, usually you would use a reference where you would use a <code>T* const</code> pointer unless you need to allow <code>NULL</code> pointers.</p>
</section>
<section id="answer-2-score-322" class="level4">
<h4>Answer 2 (score 322)</h4>
<p>
For those who don’t know about Clockwise/Spiral Rule: Start from the name of the variable, move clockwisely (in this case, move backward) to the next <strong>pointer</strong> or <strong>type</strong>. Repeat until expression ends.
</p>
<p>Here is a demo:</p>
<p><img src="https://i.stack.imgur.com/sT6ng.png" alt="pointer to int"></p>
<p><img src="https://i.stack.imgur.com/Zt0G2.png" alt="const pointer to int const"></p>
<p><img src="https://i.stack.imgur.com/kXH8P.png" alt="pointer to int const"></p>
<p><img src="https://i.stack.imgur.com/UeqZO.png" alt="pointer to const int"></p>
<p><img src="https://i.stack.imgur.com/f5ftV.png" alt="const pointer to int"></p>
</section>
<section id="answer-3-score-137-1" class="level4">
<h4>Answer 3 (score 137)</h4>
<p>I think everything is answered here already, but I just want to add that you should beware of <code>typedef</code>s! They’re NOT just text replacements.</p>
<p>For example:</p>
<div class="sourceCode" id="cb438"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb438-1"><a href="#cb438-1" aria-hidden="true"></a><span class="kw">typedef</span> <span class="dt">char</span> *ASTRING;</span>
<span id="cb438-2"><a href="#cb438-2" aria-hidden="true"></a><span class="dt">const</span> ASTRING astring;</span></code></pre></div>
<p>The type of <code>astring</code> is <code>char * const</code>, not <code>const char *</code>. This is one reason I always tend to put <code>const</code> to the right of the type, and never at the start.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="float-vs.-double-precision-score-457932-in-2017" class="level3">
<h3>65: ‘float’ vs. ‘double’ precision (score <a href="https://stackoverflow.com/q/5098558.html">457932</a> in 2017)</h3>
<section id="question-63" class="level4">
<h4>Question</h4>
<p>The code</p>
<div class="sourceCode" id="cb439"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb439-1"><a href="#cb439-1" aria-hidden="true"></a><span class="dt">float</span> x  = <span class="fl">3.141592653589793238</span>;</span>
<span id="cb439-2"><a href="#cb439-2" aria-hidden="true"></a><span class="dt">double</span> z = <span class="fl">3.141592653589793238</span>;</span>
<span id="cb439-3"><a href="#cb439-3" aria-hidden="true"></a>printf(<span class="st">&quot;x=%f</span><span class="sc">\n</span><span class="st">&quot;</span>, x);</span>
<span id="cb439-4"><a href="#cb439-4" aria-hidden="true"></a>printf(<span class="st">&quot;z=%f</span><span class="sc">\n</span><span class="st">&quot;</span>, z);</span>
<span id="cb439-5"><a href="#cb439-5" aria-hidden="true"></a>printf(<span class="st">&quot;x=%20.18f</span><span class="sc">\n</span><span class="st">&quot;</span>, x);</span>
<span id="cb439-6"><a href="#cb439-6" aria-hidden="true"></a>printf(<span class="st">&quot;z=%20.18f</span><span class="sc">\n</span><span class="st">&quot;</span>, z);</span></code></pre></div>
<p>will give you the output</p>
<div class="sourceCode" id="cb440"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb440-1"><a href="#cb440-1" aria-hidden="true"></a>x=<span class="fl">3.141593</span></span>
<span id="cb440-2"><a href="#cb440-2" aria-hidden="true"></a>z=<span class="fl">3.141593</span></span>
<span id="cb440-3"><a href="#cb440-3" aria-hidden="true"></a>x=<span class="fl">3.141592741012573242</span></span>
<span id="cb440-4"><a href="#cb440-4" aria-hidden="true"></a>z=<span class="fl">3.141592653589793116</span></span></code></pre></div>
<p>where on the third line of output <code>741012573242</code> is garbage and on the fourth line <code>116</code> is garbage. Do doubles always have 16 significant figures while floats always have 7 significant figures? Why don’t doubles have 14 significant figures?</p>
</section>
<section id="answer-accepted-score-138" class="level4">
<h4>Answer accepted (score 138)</h4>
<p>Floating point numbers in C use <a href="http://en.wikipedia.org/wiki/IEEE_754-2008" rel="noreferrer">IEEE 754</a> encoding.</p>
<p>This type of encoding uses a sign, a significand, and an exponent.</p>
<p>Because of this encoding, many numbers will have small changes to allow them to be stored.</p>
<p>Also, the number of significant digits can change slightly since it is a binary representation, not a decimal one.</p>
<p>Single precision (float) gives you 23 bits of significand, 8 bits of exponent, and 1 sign bit.</p>
<p>Double precision (double) gives you 52 bits of significand, 11 bits of exponent, and 1 sign bit.</p>
</section>
<section id="answer-2-score-38" class="level4">
<h4>Answer 2 (score 38)</h4>
<blockquote>
<p>
Do doubles always have 16 significant figures while floats always have 7 significant figures?
</p>
</blockquote>
<p>No. Doubles always have 53 significant <strong>bits</strong> and floats always have 24 significant <strong>bits</strong> (except for denormals, infinities, and NaN values, but those are subjects for a different question). These are binary formats, and you can only speak clearly about the precision of their representations in terms of binary digits (bits).</p>
<p>This is analogous to the question of how many digits can be stored in a binary integer: an unsigned 32 bit integer can store integers with up to 32 bits, which doesn’t precisely map to any number of decimal digits: all integers of up to 9 decimal digits can be stored, but a lot of 10-digit numbers can be stored as well.</p>
<blockquote>
<p>
Why don’t doubles have 14 significant figures?
</p>
</blockquote>
<p>The encoding of a double uses 64 bits (1 bit for the sign, 11 bits for the exponent, 52 explicit significant bits and one implicit bit), which is <em>double</em> the number of bits used to represent a float (32 bits).</p>
</section>
<section id="answer-3-score-11-1" class="level4">
<h4>Answer 3 (score 11)</h4>
<p><strong><em>float : 23 bits of significand, 8 bits of exponent, and 1 sign bit.</em></strong></p>
<p><strong><em>double : 52 bits of significand, 11 bits of exponent, and 1 sign bit.</em></strong></p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-do-you-make-an-array-of-structs-in-c-score-438475-in-2019" class="level3">
<h3>66: How do you make an array of structs in C? (score <a href="https://stackoverflow.com/q/10468128.html">438475</a> in 2019)</h3>
<section id="question-64" class="level4">
<h4>Question</h4>
<p>I’m trying to make an array of structs where each struct represents a celestial body.</p>
<p>I don’t have that much experience with structs, which is why I decided to try to use them instead of a whole bunch of arrays. However, I keep on running into numerous different errors. I’ve tried to implement the techniques that I’ve seen on various threads and on StackOverflow (such as <a href="https://stackoverflow.com/questions/2575921/array-of-structs-in-c">Array of structs in C</a> and <a href="https://stackoverflow.com/questions/4173518/c-initialize-array-of-structs">C - initialize array of structs</a>), however not all of them were applicable.</p>
<p>Further information for those who have read this far: I don’t need any of this to be dynamic, I know/define the size of everything beforehand. I also need this to be a global array as I’m accessing this in several different methods which have defined arguments (i.e. GLUT methods).</p>
<p>This is how I’m defining the struct in my header:</p>
<div class="sourceCode" id="cb441"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb441-1"><a href="#cb441-1" aria-hidden="true"></a><span class="kw">struct</span> body</span>
<span id="cb441-2"><a href="#cb441-2" aria-hidden="true"></a>{</span>
<span id="cb441-3"><a href="#cb441-3" aria-hidden="true"></a>    <span class="dt">double</span> p[<span class="dv">3</span>];<span class="co">//position</span></span>
<span id="cb441-4"><a href="#cb441-4" aria-hidden="true"></a>    <span class="dt">double</span> v[<span class="dv">3</span>];<span class="co">//velocity</span></span>
<span id="cb441-5"><a href="#cb441-5" aria-hidden="true"></a>    <span class="dt">double</span> a[<span class="dv">3</span>];<span class="co">//acceleration</span></span>
<span id="cb441-6"><a href="#cb441-6" aria-hidden="true"></a>    <span class="dt">double</span> radius;</span>
<span id="cb441-7"><a href="#cb441-7" aria-hidden="true"></a>    <span class="dt">double</span> mass;</span>
<span id="cb441-8"><a href="#cb441-8" aria-hidden="true"></a>};</span></code></pre></div>
<p>I have a list of other global variables that I’m defining before I define the interior of the struct, and one of those is the array of this struct (basically, if I’m being too unclear in my fogged speak, the line below is above the stuff above):</p>
<div class="sourceCode" id="cb442"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb442-1"><a href="#cb442-1" aria-hidden="true"></a><span class="kw">struct</span> body bodies[n];</span></code></pre></div>
<p>Just so you know, <code>n</code> is something that I’ve legitimately defined (i.e. <code>#define n 1</code>).</p>
<p>I use this array in several different methods, but the easiest and least space consuming one is a simplified form of my main. Here I initialize all of the variables in each of the structs, just to set the variables for certain before I modify them in some way:</p>
<div class="sourceCode" id="cb443"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb443-1"><a href="#cb443-1" aria-hidden="true"></a>  <span class="dt">int</span> a, b;</span>
<span id="cb443-2"><a href="#cb443-2" aria-hidden="true"></a> <span class="cf">for</span>(a = <span class="dv">0</span>; a &lt; n; a++)</span>
<span id="cb443-3"><a href="#cb443-3" aria-hidden="true"></a> {</span>
<span id="cb443-4"><a href="#cb443-4" aria-hidden="true"></a>        <span class="cf">for</span>(b = <span class="dv">0</span>; b &lt; <span class="dv">3</span>; b++)</span>
<span id="cb443-5"><a href="#cb443-5" aria-hidden="true"></a>        {</span>
<span id="cb443-6"><a href="#cb443-6" aria-hidden="true"></a>            bodies[a].p[b] = <span class="dv">0</span>;</span>
<span id="cb443-7"><a href="#cb443-7" aria-hidden="true"></a>            bodies[a].v[b] = <span class="dv">0</span>;</span>
<span id="cb443-8"><a href="#cb443-8" aria-hidden="true"></a>            bodies[a].a[b] = <span class="dv">0</span>;</span>
<span id="cb443-9"><a href="#cb443-9" aria-hidden="true"></a>        }</span>
<span id="cb443-10"><a href="#cb443-10" aria-hidden="true"></a>        bodies[a].mass = <span class="dv">0</span>;</span>
<span id="cb443-11"><a href="#cb443-11" aria-hidden="true"></a>        bodies[a].radius = <span class="fl">1.0</span>;</span>
<span id="cb443-12"><a href="#cb443-12" aria-hidden="true"></a> }</span></code></pre></div>
<p>The current error that I’m facing is <code>nbody.c:32:13: error: array type has incomplete element type</code> where line 32 is where I’m making the array of the structs.</p>
<p>One last clarification, by header I mean the space above <code>int main(void)</code> but in the same <code>*.c</code> file.</p>
</section>
<section id="answer-accepted-score-97" class="level4">
<h4>Answer accepted (score 97)</h4>
<div class="sourceCode" id="cb444"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb444-1"><a href="#cb444-1" aria-hidden="true"></a></span>
<span id="cb444-2"><a href="#cb444-2" aria-hidden="true"></a><span class="pp">#include</span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb444-3"><a href="#cb444-3" aria-hidden="true"></a></span>
<span id="cb444-4"><a href="#cb444-4" aria-hidden="true"></a><span class="pp">#define n 3</span></span>
<span id="cb444-5"><a href="#cb444-5" aria-hidden="true"></a><span class="kw">struct</span> body</span>
<span id="cb444-6"><a href="#cb444-6" aria-hidden="true"></a>{</span>
<span id="cb444-7"><a href="#cb444-7" aria-hidden="true"></a>    <span class="dt">double</span> p[<span class="dv">3</span>];<span class="co">//position</span></span>
<span id="cb444-8"><a href="#cb444-8" aria-hidden="true"></a>    <span class="dt">double</span> v[<span class="dv">3</span>];<span class="co">//velocity</span></span>
<span id="cb444-9"><a href="#cb444-9" aria-hidden="true"></a>    <span class="dt">double</span> a[<span class="dv">3</span>];<span class="co">//acceleration</span></span>
<span id="cb444-10"><a href="#cb444-10" aria-hidden="true"></a>    <span class="dt">double</span> radius;</span>
<span id="cb444-11"><a href="#cb444-11" aria-hidden="true"></a>    <span class="dt">double</span> mass;</span>
<span id="cb444-12"><a href="#cb444-12" aria-hidden="true"></a>};</span>
<span id="cb444-13"><a href="#cb444-13" aria-hidden="true"></a></span>
<span id="cb444-14"><a href="#cb444-14" aria-hidden="true"></a><span class="kw">struct</span> body bodies[n];</span>
<span id="cb444-15"><a href="#cb444-15" aria-hidden="true"></a></span>
<span id="cb444-16"><a href="#cb444-16" aria-hidden="true"></a><span class="dt">int</span> main()</span>
<span id="cb444-17"><a href="#cb444-17" aria-hidden="true"></a>{</span>
<span id="cb444-18"><a href="#cb444-18" aria-hidden="true"></a>    <span class="dt">int</span> a, b;</span>
<span id="cb444-19"><a href="#cb444-19" aria-hidden="true"></a>     <span class="cf">for</span>(a = <span class="dv">0</span>; a &lt; n; a++)</span>
<span id="cb444-20"><a href="#cb444-20" aria-hidden="true"></a>     {</span>
<span id="cb444-21"><a href="#cb444-21" aria-hidden="true"></a>            <span class="cf">for</span>(b = <span class="dv">0</span>; b &lt; <span class="dv">3</span>; b++)</span>
<span id="cb444-22"><a href="#cb444-22" aria-hidden="true"></a>            {</span>
<span id="cb444-23"><a href="#cb444-23" aria-hidden="true"></a>                bodies[a].p[b] = <span class="dv">0</span>;</span>
<span id="cb444-24"><a href="#cb444-24" aria-hidden="true"></a>                bodies[a].v[b] = <span class="dv">0</span>;</span>
<span id="cb444-25"><a href="#cb444-25" aria-hidden="true"></a>                bodies[a].a[b] = <span class="dv">0</span>;</span>
<span id="cb444-26"><a href="#cb444-26" aria-hidden="true"></a>            }</span>
<span id="cb444-27"><a href="#cb444-27" aria-hidden="true"></a>            bodies[a].mass = <span class="dv">0</span>;</span>
<span id="cb444-28"><a href="#cb444-28" aria-hidden="true"></a>            bodies[a].radius = <span class="fl">1.0</span>;</span>
<span id="cb444-29"><a href="#cb444-29" aria-hidden="true"></a>     }</span>
<span id="cb444-30"><a href="#cb444-30" aria-hidden="true"></a></span>
<span id="cb444-31"><a href="#cb444-31" aria-hidden="true"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb444-32"><a href="#cb444-32" aria-hidden="true"></a>}</span></code></pre></div>
<p>this works fine. your question was not very clear by the way, so match the layout of your source code with the above.</p>
</section>
<section id="answer-2-score-11-1" class="level4">
<h4>Answer 2 (score 11)</h4>
<p>I think you could write it that way too. I am also a student so I understand your struggle. A bit late response but ok .</p>
<div class="sourceCode" id="cb445"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb445-1"><a href="#cb445-1" aria-hidden="true"></a></span>
<span id="cb445-2"><a href="#cb445-2" aria-hidden="true"></a><span class="pp">#include</span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb445-3"><a href="#cb445-3" aria-hidden="true"></a></span>
<span id="cb445-4"><a href="#cb445-4" aria-hidden="true"></a><span class="pp">#define n 3</span></span>
<span id="cb445-5"><a href="#cb445-5" aria-hidden="true"></a></span>
<span id="cb445-6"><a href="#cb445-6" aria-hidden="true"></a><span class="kw">struct</span> {</span>
<span id="cb445-7"><a href="#cb445-7" aria-hidden="true"></a>    <span class="dt">double</span> p[<span class="dv">3</span>];<span class="co">//position</span></span>
<span id="cb445-8"><a href="#cb445-8" aria-hidden="true"></a>    <span class="dt">double</span> v[<span class="dv">3</span>];<span class="co">//velocity</span></span>
<span id="cb445-9"><a href="#cb445-9" aria-hidden="true"></a>    <span class="dt">double</span> a[<span class="dv">3</span>];<span class="co">//acceleration</span></span>
<span id="cb445-10"><a href="#cb445-10" aria-hidden="true"></a>    <span class="dt">double</span> radius;</span>
<span id="cb445-11"><a href="#cb445-11" aria-hidden="true"></a>    <span class="dt">double</span> mass;</span>
<span id="cb445-12"><a href="#cb445-12" aria-hidden="true"></a>}bodies[n];</span></code></pre></div>
</section>
<section id="answer-3-score-10" class="level4">
<h4>Answer 3 (score 10)</h4>
<p>So to put it all together by using <code>malloc()</code>:</p>
<div class="sourceCode" id="cb446"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb446-1"><a href="#cb446-1" aria-hidden="true"></a><span class="dt">int</span> main(<span class="dt">int</span> argc, <span class="dt">char</span>** argv) {</span>
<span id="cb446-2"><a href="#cb446-2" aria-hidden="true"></a>    <span class="kw">typedef</span> <span class="kw">struct</span>{</span>
<span id="cb446-3"><a href="#cb446-3" aria-hidden="true"></a>        <span class="dt">char</span>* firstName;</span>
<span id="cb446-4"><a href="#cb446-4" aria-hidden="true"></a>        <span class="dt">char</span>* lastName;</span>
<span id="cb446-5"><a href="#cb446-5" aria-hidden="true"></a>        <span class="dt">int</span> day;</span>
<span id="cb446-6"><a href="#cb446-6" aria-hidden="true"></a>        <span class="dt">int</span> month;</span>
<span id="cb446-7"><a href="#cb446-7" aria-hidden="true"></a>        <span class="dt">int</span> year;</span>
<span id="cb446-8"><a href="#cb446-8" aria-hidden="true"></a></span>
<span id="cb446-9"><a href="#cb446-9" aria-hidden="true"></a>    }STUDENT;</span>
<span id="cb446-10"><a href="#cb446-10" aria-hidden="true"></a></span>
<span id="cb446-11"><a href="#cb446-11" aria-hidden="true"></a>    <span class="dt">int</span> numStudents=<span class="dv">3</span>;</span>
<span id="cb446-12"><a href="#cb446-12" aria-hidden="true"></a>    <span class="dt">int</span> x;</span>
<span id="cb446-13"><a href="#cb446-13" aria-hidden="true"></a>    STUDENT* students = malloc(numStudents * <span class="kw">sizeof</span> *students);</span>
<span id="cb446-14"><a href="#cb446-14" aria-hidden="true"></a>    <span class="cf">for</span> (x = <span class="dv">0</span>; x &lt; numStudents; x++){</span>
<span id="cb446-15"><a href="#cb446-15" aria-hidden="true"></a>        students[x].firstName=(<span class="dt">char</span>*)malloc(<span class="kw">sizeof</span>(<span class="dt">char</span>*));</span>
<span id="cb446-16"><a href="#cb446-16" aria-hidden="true"></a>        scanf(<span class="st">&quot;%s&quot;</span>,students[x].firstName);</span>
<span id="cb446-17"><a href="#cb446-17" aria-hidden="true"></a>        students[x].lastName=(<span class="dt">char</span>*)malloc(<span class="kw">sizeof</span>(<span class="dt">char</span>*));</span>
<span id="cb446-18"><a href="#cb446-18" aria-hidden="true"></a>        scanf(<span class="st">&quot;%s&quot;</span>,students[x].lastName);</span>
<span id="cb446-19"><a href="#cb446-19" aria-hidden="true"></a>        scanf(<span class="st">&quot;%d&quot;</span>,&amp;students[x].day);</span>
<span id="cb446-20"><a href="#cb446-20" aria-hidden="true"></a>        scanf(<span class="st">&quot;%d&quot;</span>,&amp;students[x].month);</span>
<span id="cb446-21"><a href="#cb446-21" aria-hidden="true"></a>        scanf(<span class="st">&quot;%d&quot;</span>,&amp;students[x].year);</span>
<span id="cb446-22"><a href="#cb446-22" aria-hidden="true"></a>    }</span>
<span id="cb446-23"><a href="#cb446-23" aria-hidden="true"></a></span>
<span id="cb446-24"><a href="#cb446-24" aria-hidden="true"></a>    <span class="cf">for</span> (x = <span class="dv">0</span>; x &lt; numStudents; x++)</span>
<span id="cb446-25"><a href="#cb446-25" aria-hidden="true"></a>        printf(<span class="st">&quot;first name: %s, surname: %s, day: %d, month: %d, year: %d</span><span class="sc">\n</span><span class="st">&quot;</span>,students[x].firstName,students[x].lastName,students[x].day,students[x].month,students[x].year);</span>
<span id="cb446-26"><a href="#cb446-26" aria-hidden="true"></a></span>
<span id="cb446-27"><a href="#cb446-27" aria-hidden="true"></a>    <span class="cf">return</span> (EXIT_SUCCESS);</span>
<span id="cb446-28"><a href="#cb446-28" aria-hidden="true"></a>}</span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="what-can-be-the-reasons-of-connection-refused-errors-score-436704-in-2017" class="level3">
<h3>67: What can be the reasons of connection refused errors? (score <a href="https://stackoverflow.com/q/2333400.html">436704</a> in 2017)</h3>
<section id="question-65" class="level4">
<h4>Question</h4>
<p>
I’m trying to write a server program in C, using another client, I get this error when I try to connect through port 2080 for example.
</p>
<div class="sourceCode" id="cb447"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb447-1"><a href="#cb447-1" aria-hidden="true"></a>connection refused</span></code></pre></div>
<p>What can be the reasons of this error?</p>
</section>
<section id="answer-accepted-score-78" class="level4">
<h4>Answer accepted (score 78)</h4>
<p>There could be many reasons, but the most common are:</p>
<ol>
<li>
<p>
The port is not open on the destination machine.
</p>
</li>
<li>
<p>
The port is open on the destination machine, but its backlog of pending connections is full.
</p>
</li>
<li>
<p>
A firewall between the client and server is blocking access (also check local firewalls).
</p>
</li>
</ol>
<p>After checking for firewalls and that the port is open, use telnet to connect to the ip/port to test connectivity. This removes any potential issues from your application.</p>
</section>
<section id="answer-2-score-66-1" class="level4">
<h4>Answer 2 (score 66)</h4>
<p>The error means the OS of the listening socket recognized the inbound connection request but chose to intentionally reject it.</p>
<p>Assuming an intermediate firewall is not getting in the way, there are only two reasons (that I know of) for the OS to reject an inbound connection request. One reason has already been mentioned several times - the listening port being connected to is not open.</p>
<p>There is another reason that has not been mentioned yet - the listening port is actually open and actively being used, but its backlog of queued inbound connection requests has reached its maximum so there is no room available for the inbound connection request to be queued at that moment. The server code has not called accept() enough times yet to finish clearing out available slots for new queue items.</p>
<p>Wait a moment or so and try the connection again. Unfortunately, there is no way to differentiate between “the port is not open at all” and “the port is open but too busy right now”. They both use the same generic error code.</p>
</section>
<section id="answer-3-score-19-1" class="level4">
<h4>Answer 3 (score 19)</h4>
<p>If you try to open a TCP connection to another host and see the error “Connection refused,” it means that</p>
<ol>
<li>
You sent a TCP SYN packet to the other host.
</li>
<li>
Then you received a TCP RST packet in reply.
</li>
</ol>
<p>RST is a bit on the TCP packet which indicates that the connection should be reset. Usually it means that the other host has received your connection attempt and is actively refusing your TCP connection, but sometimes an intervening firewall may block your TCP SYN packet and send a TCP RST back to you.</p>
<p>See <a href="https://tools.ietf.org/html/rfc793" rel="noreferrer">https://tools.ietf.org/html/rfc793</a> page 69:</p>
<blockquote>
<p>SYN-RECEIVED STATE</p>
<div class="sourceCode" id="cb448"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb448-1"><a href="#cb448-1" aria-hidden="true"></a>   If the RST bit is set</span>
<span id="cb448-2"><a href="#cb448-2" aria-hidden="true"></a></span>
<span id="cb448-3"><a href="#cb448-3" aria-hidden="true"></a>     If this connection was initiated with a passive OPEN (i.e.,</span>
<span id="cb448-4"><a href="#cb448-4" aria-hidden="true"></a>     came from the LISTEN state), then <span class="cf">return</span> this connection to</span>
<span id="cb448-5"><a href="#cb448-5" aria-hidden="true"></a>     LISTEN state and <span class="cf">return</span>.  The user need not be informed.  If</span>
<span id="cb448-6"><a href="#cb448-6" aria-hidden="true"></a>     this connection was initiated with an active OPEN (i.e., came</span>
<span id="cb448-7"><a href="#cb448-7" aria-hidden="true"></a>     from SYN-SENT state) then the connection was refused, signal</span>
<span id="cb448-8"><a href="#cb448-8" aria-hidden="true"></a>     the user <span class="st">&quot;connection refused&quot;</span>.  In either <span class="cf">case</span>, all segments</span>
<span id="cb448-9"><a href="#cb448-9" aria-hidden="true"></a>     on the retransmission queue should be removed.  And in the</span>
<span id="cb448-10"><a href="#cb448-10" aria-hidden="true"></a>     active OPEN <span class="cf">case</span>, enter the CLOSED state and delete the TCB,</span>
<span id="cb448-11"><a href="#cb448-11" aria-hidden="true"></a>     and <span class="cf">return</span>.</span></code></pre></div>
</blockquote>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="arrow-operator---usage-in-c-score-433083-in-2019" class="level3">
<h3>68: Arrow operator (-&gt;) usage in C (score <a href="https://stackoverflow.com/q/2575048.html">433083</a> in 2019)</h3>
<section id="question-66" class="level4">
<h4>Question</h4>
<p>I am reading a book called “Teach Yourself C in 21 Days” (I have already learned Java and C # so I am moving at a much faster pace). I was reading the chapter on pointers and the <code>-&amp;gt;</code> (arrow) <em>operator</em> came up without explanation. I think that it is used to call members and functions (like the equivalent of the <code>.</code> (dot) operator, but for pointers instead of members). But I am not entirely sure.</p>
<p>Could I please get an explanation and a code sample?</p>
</section>
<section id="answer-accepted-score-432" class="level4">
<h4>Answer accepted (score 432)</h4>
<p><code>foo-&amp;gt;bar</code> is equivalent to <code>(*foo).bar</code>, i.e. it gets the member called <code>bar</code> from the struct that <code>foo</code> points to.</p>
</section>
<section id="answer-2-score-116" class="level4">
<h4>Answer 2 (score 116)</h4>
<p>Yes, that’s it.</p>
<p>It’s just the dot version when you want to access elements of a struct/class that is a pointer instead of a reference.</p>
<div class="sourceCode" id="cb449"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb449-1"><a href="#cb449-1" aria-hidden="true"></a><span class="kw">struct</span> foo</span>
<span id="cb449-2"><a href="#cb449-2" aria-hidden="true"></a>{</span>
<span id="cb449-3"><a href="#cb449-3" aria-hidden="true"></a>  <span class="dt">int</span> x;     <span class="co">// 5</span></span>
<span id="cb449-4"><a href="#cb449-4" aria-hidden="true"></a>  <span class="dt">float</span> y;</span>
<span id="cb449-5"><a href="#cb449-5" aria-hidden="true"></a>};</span>
<span id="cb449-6"><a href="#cb449-6" aria-hidden="true"></a></span>
<span id="cb449-7"><a href="#cb449-7" aria-hidden="true"></a><span class="kw">struct</span> foo var;</span>
<span id="cb449-8"><a href="#cb449-8" aria-hidden="true"></a><span class="kw">struct</span> foo* pvar;</span>
<span id="cb449-9"><a href="#cb449-9" aria-hidden="true"></a>pvar = malloc(<span class="kw">sizeof</span>(pvar));</span>
<span id="cb449-10"><a href="#cb449-10" aria-hidden="true"></a></span>
<span id="cb449-11"><a href="#cb449-11" aria-hidden="true"></a>var.x = <span class="dv">5</span>;   <span class="co">// var.x is 5</span></span>
<span id="cb449-12"><a href="#cb449-12" aria-hidden="true"></a>(&amp;var)-&gt;y = <span class="fl">14.3</span>;</span>
<span id="cb449-13"><a href="#cb449-13" aria-hidden="true"></a>pvar-&gt;y = <span class="fl">22.4</span>;</span>
<span id="cb449-14"><a href="#cb449-14" aria-hidden="true"></a>(*pvar).x = <span class="dv">6</span>;   <span class="co">// (*pvar).x is 5</span></span></code></pre></div>
<p>That’s it!</p>
</section>
<section id="answer-3-score-31" class="level4">
<h4>Answer 3 (score 31)</h4>
<p><code>a-&amp;gt;b</code> is just short for <code>(*a).b</code> in every way (same for functions: <code>a-&amp;gt;b()</code> is short for <code>(*a).b()</code>).</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="preventing-console-window-from-closing-on-visual-studio-cc-console-application-score-425965-in-2013" class="level3">
<h3>69: Preventing console window from closing on Visual Studio C/C++ Console application (score <a href="https://stackoverflow.com/q/1775865.html">425965</a> in 2013)</h3>
<section id="question-67" class="level4">
<h4>Question</h4>
<p>This is a probably an embarasing question as no doubt the answer is blindingly obvious.</p>
<p>I’ve used Visual Studio for years, but this is the first time I’ve done any ‘Console Application’ development.</p>
<p>When I run my application the console window pops up, the program output appears and then the window closes as the application exits.</p>
<p>Is there a way to either keep it open until I have checked the output, or view the results after the window has closed?</p>
</section>
<section id="answer-accepted-score-446" class="level4">
<h4>Answer accepted (score 446)</h4>
<p>If you run without debugging (Ctrl+F5) then by default it prompts your to press return to close the window. If you want to use the debugger, you should put a breakpoint on the last line.</p>
</section>
<section id="answer-2-score-218" class="level4">
<h4>Answer 2 (score 218)</h4>
<p>Right click on your project</p>
<blockquote>
Properties &gt; Configuration Properties &gt; Linker &gt; System
</blockquote>
<p>Select <strong>Console (/SUBSYSTEM:CONSOLE)</strong> in <code>SubSystem</code> option or you can just type <strong>Console</strong> in the text field!</p>
<p>Now try it…it should work</p>
</section>
<section id="answer-3-score-45" class="level4">
<h4>Answer 3 (score 45)</h4>
<p>Here is a way for C/C++:</p>
<div class="sourceCode" id="cb450"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb450-1"><a href="#cb450-1" aria-hidden="true"></a></span>
<span id="cb450-2"><a href="#cb450-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdlib.h&gt;</span></span>
<span id="cb450-3"><a href="#cb450-3" aria-hidden="true"></a></span>
<span id="cb450-4"><a href="#cb450-4" aria-hidden="true"></a></span>
<span id="cb450-5"><a href="#cb450-5" aria-hidden="true"></a><span class="pp">#ifdef _WIN32</span></span>
<span id="cb450-6"><a href="#cb450-6" aria-hidden="true"></a></span>
<span id="cb450-7"><a href="#cb450-7" aria-hidden="true"></a><span class="pp">#define WINPAUSE system(&quot;pause&quot;)</span></span>
<span id="cb450-8"><a href="#cb450-8" aria-hidden="true"></a></span>
<span id="cb450-9"><a href="#cb450-9" aria-hidden="true"></a><span class="pp">#endif</span></span></code></pre></div>
<p>Put this at the top of your program, and IF it is on a Windows system (<code>#ifdef _WIN32</code>), then it will create a macro called <code>WINPAUSE</code>. Whenever you want your program to pause, call <code>WINPAUSE;</code> and it will pause the program, using the DOS command. For other systems like Unix/Linux, the console should not quit on program exit anyway.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-to-declare-strings-in-c-score-424760-in-2017" class="level3">
<h3>70: How to declare strings in C (score <a href="https://stackoverflow.com/q/8732325.html">424760</a> in 2017)</h3>
<section id="question-68" class="level4">
<h4>Question</h4>
<blockquote>
<p>
<strong>Possible Duplicate:</strong><br> <a href="https://stackoverflow.com/questions/4680431/memory-allocation-char-and-char">Memory Allocation char* and char[]</a>
</p>
</blockquote>
<p>Can anyone explain me what is a difference between these lines of code</p>
<div class="sourceCode" id="cb451"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb451-1"><a href="#cb451-1" aria-hidden="true"></a><span class="dt">char</span> *p = <span class="st">&quot;String&quot;</span>;</span>
<span id="cb451-2"><a href="#cb451-2" aria-hidden="true"></a><span class="dt">char</span> p2[] = <span class="st">&quot;String&quot;</span>;</span>
<span id="cb451-3"><a href="#cb451-3" aria-hidden="true"></a><span class="dt">char</span> p3[<span class="dv">7</span>] = <span class="st">&quot;String&quot;</span>;</span></code></pre></div>
<p>In what case should I use each of the above ?</p>
</section>
<section id="answer-accepted-score-44" class="level4">
<h4>Answer accepted (score 44)</h4>
<p><a href="http://www.lysator.liu.se/c/c-faq/c-2.html" rel="noreferrer">This link</a> should satisfy your curiosity.</p>
<p>Basically (forgetting your third example which is bad), the different between 1 and 2 is that 1 allocates space for a pointer to the array.</p>
<p>But in the code, you can manipulate them as pointers all the same – only thing, you cannot reallocate the second.</p>
</section>
<section id="answer-2-score-40" class="level4">
<h4>Answer 2 (score 40)</h4>
<p>Strings in C are represented as arrays of characters.</p>
<div class="sourceCode" id="cb452"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb452-1"><a href="#cb452-1" aria-hidden="true"></a><span class="dt">char</span> *p = <span class="st">&quot;String&quot;</span>;</span></code></pre></div>
<p>You are declaring a pointer that points to a string stored some where in your program (modifying this string is undefined behavior) according to the C programming language 2 ed. </p>
<div class="sourceCode" id="cb453"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb453-1"><a href="#cb453-1" aria-hidden="true"></a><span class="dt">char</span> p2[] = <span class="st">&quot;String&quot;</span>;</span></code></pre></div>
<p>You are declaring an array of char initialized with the string “String” leaving to the compiler the job to count the size of the array.</p>
<div class="sourceCode" id="cb454"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb454-1"><a href="#cb454-1" aria-hidden="true"></a><span class="dt">char</span> p3[<span class="dv">5</span>] = <span class="st">&quot;String&quot;</span>;</span></code></pre></div>
<p>You are declaring an array of size 5 and initializing it with “String”. This is an error be cause “String” don’t fit in 5 elements.</p>
<p><code>char p3[7] = "String";</code> is the correct declaration (‘\0’ is the terminating character in c strings).</p>
<p><a href="http://c-faq.com/~scs/cclass/notes/sx8.html" rel="noreferrer">http://c-faq.com/~scs/cclass/notes/sx8.html</a></p>
</section>
<section id="answer-3-score-21" class="level4">
<h4>Answer 3 (score 21)</h4>
<p>You shouldn’t use the third one because its wrong. “String” takes 7 bytes, not 5.</p>
<p>The first one is a pointer (can be reassigned to a different address), the other two are declared as arrays, and cannot be reassigned to different memory locations (but their content may change, use <code>const</code> to avoid that).</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-to-print-the-array-score-420176-in-2012" class="level3">
<h3>71: How to print the array? (score <a href="https://stackoverflow.com/q/9726922.html">420176</a> in 2012)</h3>
<section id="question-69" class="level4">
<h4>Question</h4>
<div class="sourceCode" id="cb455"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb455-1"><a href="#cb455-1" aria-hidden="true"></a><span class="dt">int</span> main() {  </span>
<span id="cb455-2"><a href="#cb455-2" aria-hidden="true"></a>  <span class="dt">int</span> my array[<span class="dv">3</span>][<span class="dv">3</span>] =</span>
<span id="cb455-3"><a href="#cb455-3" aria-hidden="true"></a>    <span class="dv">10</span>, <span class="dv">23</span>, <span class="dv">42</span>,    </span>
<span id="cb455-4"><a href="#cb455-4" aria-hidden="true"></a>    <span class="dv">1</span>, <span class="dv">654</span>, <span class="dv">0</span>,  </span>
<span id="cb455-5"><a href="#cb455-5" aria-hidden="true"></a>    <span class="dv">40652</span>, <span class="dv">22</span>, <span class="dv">0</span>  </span>
<span id="cb455-6"><a href="#cb455-6" aria-hidden="true"></a>  };  </span>
<span id="cb455-7"><a href="#cb455-7" aria-hidden="true"></a></span>
<span id="cb455-8"><a href="#cb455-8" aria-hidden="true"></a>  printf(<span class="st">&quot;%d</span><span class="sc">\n</span><span class="st">&quot;</span>, my_array[<span class="dv">3</span>][<span class="dv">3</span>]);  </span>
<span id="cb455-9"><a href="#cb455-9" aria-hidden="true"></a>  <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb455-10"><a href="#cb455-10" aria-hidden="true"></a>}</span></code></pre></div>
<p>I am not able to get the array to print.. Any ideas why? I am a beginning programmer so any words of advice are appreciated.</p>
</section>
<section id="answer-accepted-score-27" class="level4">
<h4>Answer accepted (score 27)</h4>
<p>What you are doing is printing the value in the array at spot [3][3], which is invalid for a 3by3 array, you need to loop over all the spots and print them.</p>
<div class="sourceCode" id="cb456"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb456-1"><a href="#cb456-1" aria-hidden="true"></a><span class="cf">for</span>(<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; <span class="dv">3</span>; i++) {</span>
<span id="cb456-2"><a href="#cb456-2" aria-hidden="true"></a>    <span class="cf">for</span>(<span class="dt">int</span> j = <span class="dv">0</span>; j &lt; <span class="dv">3</span>; j++) {</span>
<span id="cb456-3"><a href="#cb456-3" aria-hidden="true"></a>        printf(<span class="st">&quot;%d &quot;</span>, array[i][j]);</span>
<span id="cb456-4"><a href="#cb456-4" aria-hidden="true"></a>    }</span>
<span id="cb456-5"><a href="#cb456-5" aria-hidden="true"></a>    printf(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>);</span>
<span id="cb456-6"><a href="#cb456-6" aria-hidden="true"></a>} </span></code></pre></div>
<p>This will print it in the following format</p>
<div class="sourceCode" id="cb457"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb457-1"><a href="#cb457-1" aria-hidden="true"></a><span class="dv">10</span> <span class="dv">23</span> <span class="dv">42</span></span>
<span id="cb457-2"><a href="#cb457-2" aria-hidden="true"></a><span class="dv">1</span> <span class="dv">654</span> <span class="dv">0</span></span>
<span id="cb457-3"><a href="#cb457-3" aria-hidden="true"></a><span class="dv">40652</span> <span class="dv">22</span> <span class="dv">0</span></span></code></pre></div>
<p>if you want more exact formatting you’ll have to change how the printf is formatted.</p>
</section>
<section id="answer-2-score-11-2" class="level4">
<h4>Answer 2 (score 11)</h4>
<p>There is no .length property in C. The .length property can only be applied to arrays in object oriented programming (OOP) languages. The .length property is inherited from the object class; the class all other classes &amp; objects inherit from in an OOP language. Also, one would use .length-1 to return the number of the last index in an array; using just the .length will return the total length of the array.</p>
<p>I would suggest something like this:</p>
<div class="sourceCode" id="cb458"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb458-1"><a href="#cb458-1" aria-hidden="true"></a><span class="dt">int</span> index;</span>
<span id="cb458-2"><a href="#cb458-2" aria-hidden="true"></a><span class="dt">int</span> jdex;</span>
<span id="cb458-3"><a href="#cb458-3" aria-hidden="true"></a><span class="cf">for</span>( index = <span class="dv">0</span>; index &lt; (<span class="kw">sizeof</span>( my_array ) / <span class="kw">sizeof</span>( my_array[<span class="dv">0</span>] )); index++){</span>
<span id="cb458-4"><a href="#cb458-4" aria-hidden="true"></a>   <span class="cf">for</span>( jdex = <span class="dv">0</span>; jdex &lt; (<span class="kw">sizeof</span>( my_array ) / <span class="kw">sizeof</span>( my_array[<span class="dv">0</span>] )); jdex++){</span>
<span id="cb458-5"><a href="#cb458-5" aria-hidden="true"></a>        printf( <span class="st">&quot;%d&quot;</span>, my_array[index][jdex] );</span>
<span id="cb458-6"><a href="#cb458-6" aria-hidden="true"></a>        printf( <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span> );</span>
<span id="cb458-7"><a href="#cb458-7" aria-hidden="true"></a>   }</span>
<span id="cb458-8"><a href="#cb458-8" aria-hidden="true"></a>}</span></code></pre></div>
<p>The line (sizeof( my_array ) / sizeof( my_array[0] )) will give you the size of the array in question. The sizeof property will return the length in bytes, so one must divide the total size of the array in bytes by how many bytes make up each element, each element takes up 4 bytes because each element is of type int, respectively. The array is of total size 16 bytes and each element is of 4 bytes so 16/4 yields 4 the total number of elements in your array because indexing starts at 0 and not 1.</p>
</section>
<section id="answer-3-score-3" class="level4">
<h4>Answer 3 (score 3)</h4>
<p>It looks like you have a typo on your array, it should read:</p>
<div class="sourceCode" id="cb459"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb459-1"><a href="#cb459-1" aria-hidden="true"></a><span class="dt">int</span> my_array[<span class="dv">3</span>][<span class="dv">3</span>] = {...</span></code></pre></div>
<p>You don’t have the <code>_</code> or the <code>{</code>.</p>
<p>Also <code>my_array[3][3]</code> is an invalid location. Since computers begin counting at <code>0</code>, you are accessing position <code>4</code>. (Arrays are weird like that).</p>
<p>If you want just the last element:</p>
<div class="sourceCode" id="cb460"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb460-1"><a href="#cb460-1" aria-hidden="true"></a>printf(<span class="st">&quot;%d</span><span class="sc">\n</span><span class="st">&quot;</span>, my_array[<span class="dv">2</span>][<span class="dv">2</span>]);</span></code></pre></div>
<p>If you want the entire array:</p>
<div class="sourceCode" id="cb461"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb461-1"><a href="#cb461-1" aria-hidden="true"></a><span class="cf">for</span>(<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; my_array.length; i++) {</span>
<span id="cb461-2"><a href="#cb461-2" aria-hidden="true"></a>  <span class="cf">for</span>(<span class="dt">int</span> j = <span class="dv">0</span>; j &lt; my_array[i].length; j++)</span>
<span id="cb461-3"><a href="#cb461-3" aria-hidden="true"></a>    printf(<span class="st">&quot;%d &quot;</span>, my_array[i][j]);</span>
<span id="cb461-4"><a href="#cb461-4" aria-hidden="true"></a>  printf(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>);</span>
<span id="cb461-5"><a href="#cb461-5" aria-hidden="true"></a>}</span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="convert-a-character-digit-to-the-corresponding-integer-in-c-score-415138-in-2017" class="level3">
<h3>72: Convert a character digit to the corresponding integer in C (score <a href="https://stackoverflow.com/q/628761.html">415138</a> in 2017)</h3>
<section id="question-70" class="level4">
<h4>Question</h4>
<p>Is there a way to convert a character to an integer in C?</p>
<p>For example, from <code>'5'</code> to 5?</p>
</section>
<section id="answer-accepted-score-126" class="level4">
<h4>Answer accepted (score 126)</h4>
<p>As per other replies, this is fine:</p>
<div class="sourceCode" id="cb462"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb462-1"><a href="#cb462-1" aria-hidden="true"></a><span class="dt">char</span> c = <span class="ch">&#39;5&#39;</span>;</span>
<span id="cb462-2"><a href="#cb462-2" aria-hidden="true"></a><span class="dt">int</span> x = c - <span class="ch">&#39;0&#39;</span>;</span></code></pre></div>
<p>Also, for error checking, you may wish to check isdigit(c) is true first. Note that you cannot completely portably do the same for letters, for example:</p>
<div class="sourceCode" id="cb463"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb463-1"><a href="#cb463-1" aria-hidden="true"></a><span class="dt">char</span> c = <span class="ch">&#39;b&#39;</span>;</span>
<span id="cb463-2"><a href="#cb463-2" aria-hidden="true"></a><span class="dt">int</span> x = c - <span class="ch">&#39;a&#39;</span>; <span class="co">// x is now not necessarily 1</span></span></code></pre></div>
<p>The standard guarantees that the char values for the digits ‘0’ to ‘9’ are contiguous, but makes no guarantees for other characters like letters of the alphabet.</p>
</section>
<section id="answer-2-score-39-1" class="level4">
<h4>Answer 2 (score 39)</h4>
<p>Subtract ‘0’ like this:</p>
<div class="sourceCode" id="cb464"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb464-1"><a href="#cb464-1" aria-hidden="true"></a><span class="dt">int</span> i = c - <span class="ch">&#39;0&#39;</span>;</span></code></pre></div>
<p>The C Standard guarantees each digit in the range <code>'0'..'9'</code> is one greater than its previous digit (in section <code>5.2.1/3</code> of the <a href="http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1124.pdf" rel="noreferrer">C99 draft</a>). The same counts for C++.</p>
</section>
<section id="answer-3-score-27" class="level4">
<h4>Answer 3 (score 27)</h4>
<p>If, by some crazy coincidence, you want to convert a <em>string</em> of characters to an integer, you can do that too!</p>
<div class="sourceCode" id="cb465"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb465-1"><a href="#cb465-1" aria-hidden="true"></a><span class="dt">char</span> *num = <span class="st">&quot;1024&quot;</span>;</span>
<span id="cb465-2"><a href="#cb465-2" aria-hidden="true"></a><span class="dt">int</span> val = atoi(num); <span class="co">// atoi = ASCII TO Int</span></span></code></pre></div>
<p><code>val</code> is now 1024. Apparently <code>atoi()</code> is fine, and what I said about it earlier only applies to me (on OS X (maybe (insert Lisp joke here))). I have heard it is a macro that maps roughly to the next example, which uses <code>strtol()</code>, a more general-purpose function, to do the conversion instead:</p>
<div class="sourceCode" id="cb466"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb466-1"><a href="#cb466-1" aria-hidden="true"></a><span class="dt">char</span> *num = <span class="st">&quot;1024&quot;</span>;</span>
<span id="cb466-2"><a href="#cb466-2" aria-hidden="true"></a><span class="dt">int</span> val = (<span class="dt">int</span>)strtol(num, (<span class="dt">char</span> **)NULL, <span class="dv">10</span>); <span class="co">// strtol = STRing TO Long</span></span></code></pre></div>
<p><code>strtol()</code> works like this:</p>
<div class="sourceCode" id="cb467"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb467-1"><a href="#cb467-1" aria-hidden="true"></a><span class="dt">long</span> strtol(<span class="dt">const</span> <span class="dt">char</span> *str, <span class="dt">char</span> **endptr, <span class="dt">int</span> base);</span></code></pre></div>
<p>It converts <code>*str</code> to a <code>long</code>, treating it as if it were a base <code>base</code> number. If <code>**endptr</code> isn’t null, it holds the first non-digit character <code>strtol()</code> found (but who cares about that).</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="get-the-current-time-in-c-score-411745-in-2016" class="level3">
<h3>73: Get the current time in C (score <a href="https://stackoverflow.com/q/5141960.html">411745</a> in 2016)</h3>
<section id="question-71" class="level4">
<h4>Question</h4>
<p>I want to get the current time of my system. For that I’m using the following code in C:</p>
<div class="sourceCode" id="cb468"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb468-1"><a href="#cb468-1" aria-hidden="true"></a><span class="dt">time_t</span> now;</span>
<span id="cb468-2"><a href="#cb468-2" aria-hidden="true"></a><span class="kw">struct</span> tm *mytime = localtime(&amp;now); </span>
<span id="cb468-3"><a href="#cb468-3" aria-hidden="true"></a><span class="cf">if</span> ( strftime(buffer, <span class="kw">sizeof</span> buffer, <span class="st">&quot;%X&quot;</span>, mytime) )</span>
<span id="cb468-4"><a href="#cb468-4" aria-hidden="true"></a>{</span>
<span id="cb468-5"><a href="#cb468-5" aria-hidden="true"></a>    printf(<span class="st">&quot;time1 = </span><span class="sc">\&quot;</span><span class="st">%s</span><span class="sc">\&quot;\n</span><span class="st">&quot;</span>, buffer);</span>
<span id="cb468-6"><a href="#cb468-6" aria-hidden="true"></a>}</span></code></pre></div>
<p>The problem is that this code is giving some random time. Also, the random time is different everytime. I want the current time of my system.</p>
</section>
<section id="answer-accepted-score-115" class="level4">
<h4>Answer accepted (score 115)</h4>
<p>Copy-pasted from <a href="http://www.cplusplus.com/reference/clibrary/ctime/localtime/" rel="noreferrer">here</a>:</p>
<div class="sourceCode" id="cb469"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb469-1"><a href="#cb469-1" aria-hidden="true"></a><span class="co">/* localtime example */</span></span>
<span id="cb469-2"><a href="#cb469-2" aria-hidden="true"></a></span>
<span id="cb469-3"><a href="#cb469-3" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb469-4"><a href="#cb469-4" aria-hidden="true"></a></span>
<span id="cb469-5"><a href="#cb469-5" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;time.h&gt;</span></span>
<span id="cb469-6"><a href="#cb469-6" aria-hidden="true"></a></span>
<span id="cb469-7"><a href="#cb469-7" aria-hidden="true"></a><span class="dt">int</span> main ()</span>
<span id="cb469-8"><a href="#cb469-8" aria-hidden="true"></a>{</span>
<span id="cb469-9"><a href="#cb469-9" aria-hidden="true"></a>  <span class="dt">time_t</span> rawtime;</span>
<span id="cb469-10"><a href="#cb469-10" aria-hidden="true"></a>  <span class="kw">struct</span> tm * timeinfo;</span>
<span id="cb469-11"><a href="#cb469-11" aria-hidden="true"></a></span>
<span id="cb469-12"><a href="#cb469-12" aria-hidden="true"></a>  time ( &amp;rawtime );</span>
<span id="cb469-13"><a href="#cb469-13" aria-hidden="true"></a>  timeinfo = localtime ( &amp;rawtime );</span>
<span id="cb469-14"><a href="#cb469-14" aria-hidden="true"></a>  printf ( <span class="st">&quot;Current local time and date: %s&quot;</span>, asctime (timeinfo) );</span>
<span id="cb469-15"><a href="#cb469-15" aria-hidden="true"></a></span>
<span id="cb469-16"><a href="#cb469-16" aria-hidden="true"></a>  <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb469-17"><a href="#cb469-17" aria-hidden="true"></a>}</span></code></pre></div>
<p>(just add “void” to the main() arguments list in order for this to work in C)</p>
</section>
<section id="answer-2-score-63" class="level4">
<h4>Answer 2 (score 63)</h4>
<p>Initialize your <code>now</code> variable.</p>
<div class="sourceCode" id="cb470"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb470-1"><a href="#cb470-1" aria-hidden="true"></a><span class="dt">time_t</span> now = time(<span class="dv">0</span>); <span class="co">// Get the system time</span></span></code></pre></div>
<p>The <code>localtime</code> function is used to convert the time value in the passed <code>time_t</code> to a <code>struct tm</code>, it doesn’t actually retrieve the system time.</p>
</section>
<section id="answer-3-score-33-1" class="level4">
<h4>Answer 3 (score 33)</h4>
<p>Easy way:</p>
<div class="sourceCode" id="cb471"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb471-1"><a href="#cb471-1" aria-hidden="true"></a></span>
<span id="cb471-2"><a href="#cb471-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;time.h&gt;</span></span>
<span id="cb471-3"><a href="#cb471-3" aria-hidden="true"></a></span>
<span id="cb471-4"><a href="#cb471-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb471-5"><a href="#cb471-5" aria-hidden="true"></a></span>
<span id="cb471-6"><a href="#cb471-6" aria-hidden="true"></a><span class="dt">int</span> main(<span class="dt">void</span>)</span>
<span id="cb471-7"><a href="#cb471-7" aria-hidden="true"></a>{</span>
<span id="cb471-8"><a href="#cb471-8" aria-hidden="true"></a>    <span class="dt">time_t</span> mytime = time(NULL);</span>
<span id="cb471-9"><a href="#cb471-9" aria-hidden="true"></a>    <span class="dt">char</span> * time_str = ctime(&amp;mytime);</span>
<span id="cb471-10"><a href="#cb471-10" aria-hidden="true"></a>    time_str[strlen(time_str)-<span class="dv">1</span>] = <span class="ch">&#39;\0&#39;</span>;</span>
<span id="cb471-11"><a href="#cb471-11" aria-hidden="true"></a>    printf(<span class="st">&quot;Current Time : %s</span><span class="sc">\n</span><span class="st">&quot;</span>, time_str);</span>
<span id="cb471-12"><a href="#cb471-12" aria-hidden="true"></a></span>
<span id="cb471-13"><a href="#cb471-13" aria-hidden="true"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb471-14"><a href="#cb471-14" aria-hidden="true"></a>}</span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="c-compiler-for-windows-score-405559-in-2013" class="level3">
<h3>74: C compiler for Windows? (score <a href="https://stackoverflow.com/q/116368.html">405559</a> in 2013)</h3>
<section id="question-72" class="level4">
<h4>Question</h4>
<p>I’m fine working on Linux using gcc as my C compiler but would like a Windows solution. Any ideas? I’ve looked at <a href="http://en.wikipedia.org/wiki/Dev-C%2B%2B" rel="noreferrer">Dev-C++ from Bloodshed</a> but looking for more options.</p>
</section>
<section id="answer-accepted-score-78-1" class="level4">
<h4>Answer accepted (score 78)</h4>
<p>You can use GCC on Windows by downloading <a href="http://www.mingw.org/" rel="nofollow noreferrer">MingW</a> (<em>discontinued</em>) or its successor <a href="https://mingw-w64.org/" rel="nofollow noreferrer">Mingw-w64</a>.</p>
</section>
<section id="answer-2-score-36" class="level4">
<h4>Answer 2 (score 36)</h4>
<p>You can get <a href="http://www.microsoft.com/express/vc/" rel="noreferrer">Visual C++ Express Edition</a> straight from Microsoft, if you want something targeting Win32. Otherwise MinGW or lcc, as suggested elsewhere.</p>
</section>
<section id="answer-3-score-24-1" class="level4">
<h4>Answer 3 (score 24)</h4>
<p>GCC is ubiquitous. It is trusted and well understood by thousands of folks across dozens of communities.</p>
<p>Visual Studio is perhaps the best IDE ever developed. It has a great compiler underneath it. But it is strictly Windows-only.</p>
<p>If you’re just playing, get GCC –it’s free. If you’re concerned about multiple platfroms, it’s GCC. If you’re talking serious Windows development, get Visual Studio.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-do-i-properly-compare-strings-score-401772-in-2017" class="level3">
<h3>75: How do I properly compare strings? (score <a href="https://stackoverflow.com/q/8004237.html">401772</a> in 2017)</h3>
<section id="question-73" class="level4">
<h4>Question</h4>
<p>I am trying to get a program to let a user enter a word or character, store it, and then print it until the user types it again, exiting the program. My code looks like this:</p>
<div class="sourceCode" id="cb472"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb472-1"><a href="#cb472-1" aria-hidden="true"></a></span>
<span id="cb472-2"><a href="#cb472-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb472-3"><a href="#cb472-3" aria-hidden="true"></a></span>
<span id="cb472-4"><a href="#cb472-4" aria-hidden="true"></a><span class="dt">int</span> main()</span>
<span id="cb472-5"><a href="#cb472-5" aria-hidden="true"></a>{</span>
<span id="cb472-6"><a href="#cb472-6" aria-hidden="true"></a>    <span class="dt">char</span> input[<span class="dv">40</span>];</span>
<span id="cb472-7"><a href="#cb472-7" aria-hidden="true"></a>    <span class="dt">char</span> check[<span class="dv">40</span>];</span>
<span id="cb472-8"><a href="#cb472-8" aria-hidden="true"></a>    <span class="dt">int</span> i=<span class="dv">0</span>;</span>
<span id="cb472-9"><a href="#cb472-9" aria-hidden="true"></a>    printf(<span class="st">&quot;Hello!</span><span class="sc">\n</span><span class="st">Please enter a word or character:</span><span class="sc">\n</span><span class="st">&quot;</span>);</span>
<span id="cb472-10"><a href="#cb472-10" aria-hidden="true"></a>    gets(input);</span>
<span id="cb472-11"><a href="#cb472-11" aria-hidden="true"></a>    printf(<span class="st">&quot;I will now repeat this until you type it back to me.</span><span class="sc">\n</span><span class="st">&quot;</span>);</span>
<span id="cb472-12"><a href="#cb472-12" aria-hidden="true"></a></span>
<span id="cb472-13"><a href="#cb472-13" aria-hidden="true"></a>    <span class="cf">while</span> (check != input)</span>
<span id="cb472-14"><a href="#cb472-14" aria-hidden="true"></a>    {</span>
<span id="cb472-15"><a href="#cb472-15" aria-hidden="true"></a>        printf(<span class="st">&quot;%s</span><span class="sc">\n</span><span class="st">&quot;</span>, input);</span>
<span id="cb472-16"><a href="#cb472-16" aria-hidden="true"></a>        gets(check); </span>
<span id="cb472-17"><a href="#cb472-17" aria-hidden="true"></a>    }</span>
<span id="cb472-18"><a href="#cb472-18" aria-hidden="true"></a></span>
<span id="cb472-19"><a href="#cb472-19" aria-hidden="true"></a>    printf(<span class="st">&quot;Good bye!&quot;</span>);</span>
<span id="cb472-20"><a href="#cb472-20" aria-hidden="true"></a></span>
<span id="cb472-21"><a href="#cb472-21" aria-hidden="true"></a></span>
<span id="cb472-22"><a href="#cb472-22" aria-hidden="true"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb472-23"><a href="#cb472-23" aria-hidden="true"></a>}</span></code></pre></div>
<p>The problem is that I keep getting the printing of the input string, even when the input by the user (check) matches the original (input). Am I comparing the two incorrectly?</p>
</section>
<section id="answer-accepted-score-252" class="level4">
<h4>Answer accepted (score 252)</h4>
<p>You can’t (usefully) compare strings using <code>!=</code> or <code>==</code>, you need to use <code>strcmp</code>:</p>
<div class="sourceCode" id="cb473"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb473-1"><a href="#cb473-1" aria-hidden="true"></a><span class="cf">while</span> (strcmp(check,input) != <span class="dv">0</span>)</span></code></pre></div>
<p>The reason for this is because <code>!=</code> and <code>==</code> will only compare the base addresses of those strings. Not the contents of the strings themselves.</p>
</section>
<section id="answer-2-score-31" class="level4">
<h4>Answer 2 (score 31)</h4>
<p>Ok a few things: <code>gets</code> is unsafe and should be replaced with <code>fgets(input, sizeof(input), stdin)</code> so that you don’t get a buffer overflow.</p>
<p>Next, to compare strings, you must use <code>strcmp</code>, where a return value of 0 indicates that the two strings match. Using the equality operators (ie. <code>!=</code>) compares the address of the two strings, as opposed to the individual <code>char</code>s inside them.</p>
<p>And also note that, while in this example it won’t cause a problem, <code>fgets</code> stores the newline character, <code>'\n'</code> in the buffers also; <code>gets()</code> does not. If you compared the user input from <code>fgets()</code> to a string literal such as <code>"abc"</code> it would never match (unless the buffer was too small so that the <code>'\n'</code> wouldn’t fit in it).</p>
<p>EDIT: and beaten by the super fast Mysticial once again.</p>
</section>
<section id="answer-3-score-8" class="level4">
<h4>Answer 3 (score 8)</h4>
<p>Use <a href="http://www.tutorialspoint.com/c_standard_library/c_function_strcmp.htm" rel="noreferrer"><code>strcmp</code></a>.</p>
<p>This is in <code>string.h</code> library, and is very popular. <code>strcmp</code> return 0 if the strings are equal. See <a href="https://stackoverflow.com/questions/34824838/what-does-strcmp-exactly-returns-in-c/34825545
#34825545">this</a> for an better explanation of what <code>strcmp</code> returns.</p>
<p>Basically, you have to do:</p>
<div class="sourceCode" id="cb474"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb474-1"><a href="#cb474-1" aria-hidden="true"></a><span class="cf">while</span> (strcmp(check,input) != <span class="dv">0</span>)</span></code></pre></div>
<p>or</p>
<div class="sourceCode" id="cb475"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb475-1"><a href="#cb475-1" aria-hidden="true"></a><span class="cf">while</span> (!strcmp(check,input))</span></code></pre></div>
<p>or</p>
<div class="sourceCode" id="cb476"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb476-1"><a href="#cb476-1" aria-hidden="true"></a><span class="cf">while</span> (strcmp(check,input))</span></code></pre></div>
<p>You can check <a href="http://www.programiz.com/c-programming/library-function/string.h/strcmp" rel="noreferrer">this</a>, a tutorial on <code>strcmp</code>.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="debug-vs-release-in-cmake-score-398790-in-2018" class="level3">
<h3>76: Debug vs Release in CMake (score <a href="https://stackoverflow.com/q/7724569.html">398790</a> in 2018)</h3>
<section id="question-74" class="level4">
<h4>Question</h4>
<p>In a GCC compiled project,</p>
<ul>
<li>
How do I run CMake for each target type (debug/release)?
</li>
<li>
How do I specify debug and release C/C++ flags using CMake?
</li>
<li>
How do I express that the main executable will be compiled with <code>g++</code> and one nested library with <code>gcc</code>?
</li>
</ul>
</section>
<section id="answer-accepted-score-602" class="level4">
<h4>Answer accepted (score 602)</h4>
<p>With CMake, it’s generally recommended to do an <a href="https://gitlab.kitware.com/cmake/community/wikis/FAQ
#out-of-source-build-trees" rel="noreferrer">“out of source” build</a>. Create your <code>CMakeLists.txt</code> in the root of your project. Then from the root of your project:</p>
<div class="sourceCode" id="cb477"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb477-1"><a href="#cb477-1" aria-hidden="true"></a>mkdir Release</span>
<span id="cb477-2"><a href="#cb477-2" aria-hidden="true"></a>cd Release</span>
<span id="cb477-3"><a href="#cb477-3" aria-hidden="true"></a>cmake -DCMAKE_BUILD_TYPE=Release ..</span>
<span id="cb477-4"><a href="#cb477-4" aria-hidden="true"></a>make</span></code></pre></div>
<p>And for <code>Debug</code> (again from the root of your project):</p>
<div class="sourceCode" id="cb478"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb478-1"><a href="#cb478-1" aria-hidden="true"></a>mkdir Debug</span>
<span id="cb478-2"><a href="#cb478-2" aria-hidden="true"></a>cd Debug</span>
<span id="cb478-3"><a href="#cb478-3" aria-hidden="true"></a>cmake -DCMAKE_BUILD_TYPE=Debug ..</span>
<span id="cb478-4"><a href="#cb478-4" aria-hidden="true"></a>make</span></code></pre></div>
<p><code>Release</code> / <code>Debug</code> will add the appropriate flags for your compiler. There are also <code>RelWithDebInfo</code> and <code>MinSizeRel</code> build configurations.</p>
<hr>
<p>You can modify/add to the flags by specifying a <a href="https://cmake.org/cmake/help/v3.6/manual/cmake-toolchains.7.html" rel="noreferrer">toolchain file</a> in which you can add <code>CMAKE_C_FLAGS_DEBUG</code> and <code>CMAKE_C_FLAGS_RELEASE</code> variables, e.g.:</p>
<div class="sourceCode" id="cb479"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb479-1"><a href="#cb479-1" aria-hidden="true"></a>set(CMAKE_CXX_FLAGS_DEBUG <span class="st">&quot;${CMAKE_CXX_FLAGS_DEBUG} -Wall&quot;</span>)</span>
<span id="cb479-2"><a href="#cb479-2" aria-hidden="true"></a>set(CMAKE_CXX_FLAGS_RELEASE <span class="st">&quot;${CMAKE_CXX_FLAGS_RELEASE} -Wall&quot;</span>)</span></code></pre></div>
<p>See <a href="https://cmake.org/cmake/help/latest/variable/CMAKE_BUILD_TYPE.html" rel="noreferrer">CMAKE_BUILD_TYPE</a> for more details.</p>
<hr>
<p>As for your third question, I’m not sure what you are asking exactly. CMake should automatically detect and use the compiler appropriate for your different source files.</p>
</section>
<section id="answer-2-score-21-1" class="level4">
<h4>Answer 2 (score 21)</h4>
<p>For debug/release flags, see the <code>CMAKE_BUILD_TYPE</code> variable (you pass it as <code>cmake -DCMAKE_BUILD_TYPE=value</code>). It takes values like <code>Release</code>, <code>Debug</code>, etc.</p>
<p><a href="http://cmake.org/Wiki/CMake_Useful_Variables
#Compilers_and_Tools" rel="noreferrer">http://cmake.org/Wiki/CMake_Useful_Variables#Compilers_and_Tools</a></p>
<p>cmake uses the extension to choose the compiler, so just name your files .c.</p>
<p>You can override this with various settings:</p>
<p>For example:</p>
<div class="sourceCode" id="cb480"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb480-1"><a href="#cb480-1" aria-hidden="true"></a>set_source_files_properties(yourfile.c LANGUAGE CXX) </span></code></pre></div>
<p>Would compile .c files with g++. The link above also shows how to select a specific compiler for C/C++.</p>
</section>
<section id="answer-3-score-14" class="level4">
<h4>Answer 3 (score 14)</h4>
<p>Instead of manipulating the <code>CMAKE_CXX_FLAGS</code> strings directly (which could be done more nicely using <code>string(APPEND CMAKE_CXX_FLAGS_DEBUG " -g3")</code> btw), you can use <code>add_compiler_options</code>:</p>
<div class="sourceCode" id="cb481"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb481-1"><a href="#cb481-1" aria-hidden="true"></a>add_compile_options(</span>
<span id="cb481-2"><a href="#cb481-2" aria-hidden="true"></a>  <span class="st">&quot;-Wall&quot;</span> <span class="st">&quot;-Wpedantic&quot;</span> <span class="st">&quot;-Wextra&quot;</span> <span class="st">&quot;-fexceptions&quot;</span></span>
<span id="cb481-3"><a href="#cb481-3" aria-hidden="true"></a>  <span class="st">&quot;$&lt;$&lt;CONFIG:DEBUG&gt;:-O0;-g3;-ggdb&gt;&quot;</span></span>
<span id="cb481-4"><a href="#cb481-4" aria-hidden="true"></a>)</span></code></pre></div>
<p>This would add the specified warnings to all build types, but only the given debugging flags to the <code>DEBUG</code> build. Note that compile options are stored as a CMake list, which is just a string separating its elements by semicolons <code>;</code>.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="the-definitive-c-book-guide-and-list-score-398612-in-2019" class="level3">
<h3>77: The Definitive C Book Guide and List (score <a href="https://stackoverflow.com/q/562303.html">398612</a> in 2019)</h3>
<section id="question-75" class="level4">
<h4>Question</h4>
<p>This question attempts to collect a community-maintained list of <strong><em>quality</em></strong> books on the <a href="/questions/tagged/c" class="post-tag" title="show questions tagged &
#39;c&#39;" rel="tag">c</a> programming language, targeted at various skill levels.</p>
<p>C is a complex programming language that is difficult to pick up on-the-go by reading online tutorials. A comprehensive book is often the best way to learn the language, and finding a good book is the first step. It is important to avoid badly-written books, and even more importantly, books that contain serious technical errors.</p>
<p>Please suggest edits to the accepted answer to add quality books, with an approximate skill level and a short blurb/description about each book. (<em>Note that the question is locked, so no new answers will be accepted. A single answer is being maintained with the list</em>)</p>
<p>Feel free to debate book choices, quality, headings, summaries, skill levels, and anything else you see that is wrong. Books that are deemed satisfactory by the C community here will stick around on the list; the rest will be regularly removed.</p>
<p>For books that have reviews by the Association of C and C++ Users (ACCU), a link to those reviews should be added along with the book.</p>
<p>See also:</p>
<ul>
<li>
Other C-related resources in the <a href="/questions/tagged/c" class="post-tag" title="show questions tagged &
#39;c&#39;" rel="tag">c</a> <a href="https://stackoverflow.com/tags/c/info">tag wiki</a>
</li>
<li>
A similar list for <a href="/questions/tagged/c%2b%2b" class="post-tag" title="show questions tagged &
#39;c++&#39;" rel="tag">c++</a>: <a href="https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list">The Definitive C++ Book Guide and List</a>
</li>
</ul>
<hr>
<p><sub>This question was discussed on <a href="https://meta.stackoverflow.com/a/378475">Meta</a> as part of the <a href="https://meta.stackoverflow.com/questions/378437/deleted-question-audit-2018">Deleted Questions Audit 2018</a>.<br>The consensus was to keep it undeleted and actively maintained.</sub></p>
</section>
<section id="answer-2-score-471" class="level4">
<h4>Answer 2 (score 471)</h4>
<p><sup><strong><em>Warning</em></strong></sup></p>
<p>
<sup> This is a list of random books of diverse quality. In the view of some people (with some justification), it is no longer a list of recommended books. Some of the listed books contain blatantly incorrect statements or teach wrong/harmful practices. People who are aware of such books can edit this answer to help improve it. See <a href="https://meta.stackoverflow.com/questions/355588/the-c-book-list-has-gone-haywire-what-to-do-with-it">The C book list has gone haywire. What to do with it?</a>, and also <a href="https://meta.stackoverflow.com/questions/378437/deleted-question-audit-2018">Deleted question audit 2018</a>. </sup>
</p>
<h5>
Reference (All Levels)
</h1>
<ul>
<li>
<p>
<a href="https://rads.stackoverflow.com/amzn/click/com/0131103628" rel="nofollow noreferrer" rel="nofollow noreferrer">The C Programming Language (2nd Edition)</a> - Brian W. Kernighan and Dennis M. Ritchie (1988). Still a good, short but complete introduction to C (C90, not C99 or later versions), written by the inventor of C. However, the language has changed and good C style has developed in the last 25 years, and there are parts of the book that show its age.
</p>
</li>
<li>
<p>
<a href="https://rads.stackoverflow.com/amzn/click/com/013089592X" rel="nofollow noreferrer" rel="nofollow noreferrer">C: A Reference Manual (5th Edition)</a> - Samuel P. Harbison and Guy R. Steele (2002). An excellent reference book on C, up to and including C99. It is not a tutorial, and probably unfit for beginners. It’s great if you need to write a compiler for C, as the authors had to do when they started.
</p>
</li>
<li>
<p>
<a href="https://rads.stackoverflow.com/amzn/click/com/0596004362" rel="nofollow noreferrer" rel="nofollow noreferrer">C Pocket Reference (O’Reilly)</a> - Peter Prinz and Ulla Kirch-Prinz (2002).
</p>
</li>
<li>
<p>
<a href="http://c-faq.com/" rel="nofollow noreferrer">The comp.lang.c FAQ</a> - Steve Summit. Web site with answers to many questions about C.
</p>
</li>
<li>
<p>
Various versions of the C language standards can be found <a href="http://www.iso-9899.info/wiki/The_Standard" rel="nofollow noreferrer">here</a>. There is an online version of the <a href="http://port70.net/~nsz/c/c11/n1570.html" rel="nofollow noreferrer">draft C11 standard</a>.
</p>
</li>
<li>
<p>
<a href="http://www.knosof.co.uk/cbook/cbook.html" rel="nofollow noreferrer">The new C standard - an annotated reference</a> (Free PDF) - Derek M. Jones (2009). The “new standard” referred to is the old C99 standard rather than C11.
</p>
</li>
<li>
<p>
<a href="http://www.open-std.org/JTC1/SC22/WG14/www/C99RationaleV5.10.pdf" rel="nofollow noreferrer">Rationale for C99 Standard</a>.
</p>
</li>
</ul>
<hr>
<h5>
Beginner
</h1>
<ul>
<li>
<p>
<a href="https://rads.stackoverflow.com/amzn/click/com/0321776410" rel="nofollow noreferrer" rel="nofollow noreferrer">Programming in C (4th Edition)</a> - Stephen Kochan (2014). A good general introduction and tutorial.
</p>
</li>
<li>
<p>
<a href="https://rads.stackoverflow.com/amzn/click/com/0672326965" rel="nofollow noreferrer" rel="nofollow noreferrer">C Primer Plus (5th Edition)</a> - Stephen Prata (2004)
</p>
</li>
<li>
<p>
<a href="http://knking.com/books/c2/index.html" rel="nofollow noreferrer">C Programming: A Modern Approach (2nd Edition)</a> - K. N. King (2008). A good book for learning C.
</p>
</li>
<li>
<p>
<a href="https://rads.stackoverflow.com/amzn/click/com/0201183994" rel="nofollow noreferrer" rel="nofollow noreferrer">A Book on C</a> - Al Kelley/Ira Pohl (1998).
</p>
</li>
<li>
<p>
<a href="http://publications.gbdirect.co.uk/c_book/" rel="nofollow noreferrer">The C Book</a> (Free Online) - Mike Banahan, Declan Brady, and Mark Doran (1991).
</p>
</li>
<li>
<p>
<a href="https://www.amazon.com//dp/0133976890" rel="nofollow noreferrer">C: How to Program (8th Edition)</a> - Paul Deitel and Harvey M. Deitel (2015). Lots of good tips and best practices for beginners. The index is very good and serves as a decent reference (just not fully comprehensive, and very shallow).
</p>
</li>
<li>
<p>
<a href="https://rads.stackoverflow.com/amzn/click/com/1449399916" rel="nofollow noreferrer" rel="nofollow noreferrer">Head First C</a> - David Griffiths and Dawn Griffiths (2012).
</p>
</li>
<li>
<p>
<a href="https://www.apress.com/book/9781430248811" rel="nofollow noreferrer">Beginning C (5th Edition)</a> - Ivor Horton (2013). Very good explanation of pointers, using lots of small but complete programs.
</p>
</li>
<li>
<p>
<a href="https://rads.stackoverflow.com/amzn/click/com/0672324482" rel="nofollow noreferrer" rel="nofollow noreferrer">Sams Teach Yourself C in 21 Days</a> - Bradley L. Jones and Peter Aitken (2002). Very good introductory stuff.
</p>
</li>
<li>
<p>
<a href="https://rads.stackoverflow.com/amzn/click/com/0023611413" rel="nofollow noreferrer" rel="nofollow noreferrer">Applications Programming in ANSI C</a> - Richard Johnsonbaugh and Martin Kalin (1996).
</p>
</li>
</ul>
<h5>
Intermediate
</h1>
<ul>
<li>
<p>
<a href="http://www.planetpdf.com/codecuts/pdfs/ooc.pdf" rel="nofollow noreferrer">Object-oriented Programming with ANSI-C</a> (Free PDF) - Axel-Tobias Schreiner (1993). The code gets a bit convoluted. If you want C++, use C++.
</p>
</li>
<li>
<p>
<a href="http://www.cs.princeton.edu/software/cii/" rel="nofollow noreferrer">C Interfaces and Implementations</a> - David R. Hanson (1997). Provides information on how to define a boundary between an interface and implementation in C in a generic and reusable fashion. It also demonstrates this principle by applying it to the implementation of common mechanisms and data structures in C, such as lists, sets, exceptions, string manipulation, memory allocators, and more. Basically, Hanson took all the code he’d written as part of building <a href="http://www.cs.arizona.edu/icon" rel="nofollow noreferrer">Icon</a> and <a href="http://www.cs.princeton.edu/software/lcc/" rel="nofollow noreferrer">lcc</a> and pulled out the best bits in a form that other people could reuse for their own projects. It’s a model of good C programming using modern design techniques (including Liskov’s data abstraction), showing how to organize a big C project as a bunch of useful libraries.
</p>
</li>
<li>
<p>
<a href="https://rads.stackoverflow.com/amzn/click/com/0201604612" rel="nofollow noreferrer" rel="nofollow noreferrer">The C Puzzle Book</a> - Alan R. Feuer (1998)
</p>
</li>
<li>
<p>
<a href="https://rads.stackoverflow.com/amzn/click/com/0131315099" rel="nofollow noreferrer" rel="nofollow noreferrer">The Standard C Library</a> - P.J. Plauger (1992). It contains the complete source code to an implementation of the C89 standard library, along with extensive discussion about the design and why the code is designed as shown.
</p>
</li>
<li>
<p>
<a href="https://rads.stackoverflow.com/amzn/click/com/1449327141" rel="nofollow noreferrer" rel="nofollow noreferrer">21st Century C: C Tips from the New School</a> - Ben Klemens (2012). In addition to the C language, the book explains gdb, valgrind, autotools, and git. The comments on style are found in the last part (Chapter 6 and beyond).
</p>
</li>
<li>
<p>
<a href="https://rads.stackoverflow.com/amzn/click/com/0201314525" rel="nofollow noreferrer" rel="nofollow noreferrer">Algorithms in C</a> - Robert Sedgewick (1997). Gives you a real grasp of implementing algorithms in C. Very lucid and clear; will probably make you want to throw away all of your other algorithms books and keep this one.
</p>
</li>
<li>
<p>
<a href="https://rads.stackoverflow.com/amzn/click/com/0673999866" rel="nofollow noreferrer" rel="nofollow noreferrer">Pointers on C</a> - Kenneth Reek (1997).
</p>
</li>
<li>
<p>
<a href="http://www.apress.com/9781430259114" rel="nofollow noreferrer">Pointers in C</a> - Naveen Toppo and Hrishikesh Dewan (2013).
</p>
</li>
<li>
<p>
<a href="https://rads.stackoverflow.com/amzn/click/com/0321535421" rel="nofollow noreferrer" rel="nofollow noreferrer">Problem Solving and Program Design in C (6th Edition)</a> - Jeri R. Hanly and Elliot B. Koffman (2009).
</p>
</li>
<li>
<p>
<a href="https://rads.stackoverflow.com/amzn/click/com/B00101Y58Q" rel="nofollow noreferrer" rel="nofollow noreferrer">Data Structures - An Advanced Approach Using C</a> - Jeffrey Esakov and Tom Weiss (1989).
</p>
</li>
<li>
<p>
<a href="https://rads.stackoverflow.com/amzn/click/com/0672318962" rel="nofollow noreferrer" rel="nofollow noreferrer">C Unleashed</a> - Richard Heathfield, Lawrence Kirby, et al. (2000). Not ideal, but it is worth intermediate programmers practicing problems written in this book. This is a good cookbook-like approach suggested by comp.lang.c contributors.
</p>
</li>
</ul>
<ul>
<li>
<a href="http://icube-icps.unistra.fr/index.php/File:ModernC.pdf" rel="nofollow noreferrer">Modern C</a> — Jens Gustedt (2017). Covers C in 5 levels (encounter, acquaintance, cognition, experience, ambition) from beginning C to advanced C. It covers C11 threads and atomic access, which few other books do and not all compilers recognize in all environments.
</li>
</ul>
<h5>
Expert
</h1>
<ul>
<li>
<p>
<a href="https://rads.stackoverflow.com/amzn/click/com/0131774298" rel="nofollow noreferrer" rel="nofollow noreferrer">Expert C Programming: Deep C Secrets</a> - Peter van der Linden (1994). Lots of interesting information and war stories from the Sun compiler team, but a little dated in places.
</p>
</li>
<li>
<p>
<a href="https://rads.stackoverflow.com/amzn/click/com/0534951406" rel="nofollow noreferrer" rel="nofollow noreferrer">Advanced C Programming by Example</a> - John W. Perry (1998).
</p>
</li>
<li>
<p>
<a href="https://rads.stackoverflow.com/amzn/click/com/0321637739" rel="nofollow noreferrer" rel="nofollow noreferrer">Advanced Programming in the UNIX Environment</a> - Richard W. Stevens and Stephen A. Rago (2013). Comprehensive description of how to use the Unix APIs from C code, but not so much about the mechanics of C coding.
</p>
</li>
</ul>
<hr>
<h5>
Uncategorized
</h1>
<ul>
<li>
<p>
<a href="http://cslibrary.stanford.edu/101/EssentialC.pdf" rel="nofollow noreferrer">Essential C</a> (Free PDF) - Nick Parlante (2003). Note that this describes the C90 language at several points (<em>e.g.</em>, in discussing <code>//</code> comments and placement of variable declarations at arbitrary points in the code), so it should be treated with some caution.
</p>
</li>
<li>
<p>
<a href="https://rads.stackoverflow.com/amzn/click/com/0201845199" rel="nofollow noreferrer" rel="nofollow noreferrer">C Programming FAQs: Frequently Asked Questions</a> - Steve Summit (1995). This is the book of the web site listed earlier. It doesn’t cover C99 or the later standards.
</p>
</li>
<li>
<p>
<a href="https://rads.stackoverflow.com/amzn/click/com/0596006977" rel="nofollow noreferrer" rel="nofollow noreferrer">C in a Nutshell</a> - Peter Prinz and Tony Crawford (2005). Excellent book if you need a reference for C99.
</p>
</li>
<li>
<p>
<a href="https://rads.stackoverflow.com/amzn/click/com/0201419505" rel="nofollow noreferrer" rel="nofollow noreferrer">Functional C</a> - Pieter Hartel and Henk Muller (1997). Teaches modern practices that are invaluable for low-level programming, with concurrency and modularity in mind.
</p>
</li>
<li>
<p>
<a href="https://rads.stackoverflow.com/amzn/click/com/020161586X" rel="nofollow noreferrer" rel="nofollow noreferrer">The Practice of Programming</a> - Brian W. Kernighan and Rob Pike (1999). A very good book to accompany K&amp;R. It uses C++ and Java too.
</p>
</li>
</ul>
<ul>
<li>
<p>
<a href="https://rads.stackoverflow.com/amzn/click/com/0201179288" rel="nofollow noreferrer" rel="nofollow noreferrer">C Traps and Pitfalls</a> by A. Koenig (1989). Very good, but the C style pre-dates standard C, which makes it less recommendable these days.
</p>
<sup>Some have argued for the removal of ‘Traps and Pitfalls’ from this list because it has trapped some people into making mistakes; others continue to argue for its inclusion. Perhaps it should be regarded as an ‘expert’ book because it requires a moderately extensive knowledge of C to understand what’s changed since it was published.</sup>
</li>
</ul>
<ul>
<li>
<p>
<a href="http://www.buildyourownlisp.com/" rel="nofollow noreferrer">Build Your Own Lisp</a> — Daniel Holden (2014). An enjoyable way to learn C.
</p>
</li>
<li>
<p>
<a href="http://www.misra-c.com/Activities/MISRAC/tabid/160/Default.aspx" rel="nofollow noreferrer">MISRA-C</a> - industry standard published and maintained by the Motor Industry Software Reliability Association. Covers C89 and C99.
</p>
<p>
<sup>Although this isn’t a book as such, many programmers recommend reading and implementing as much of it as possible. MISRA-C was originally intended as guidelines for safety-critical applications in particular, but it applies to any area of application where stable, bug-free C code is desired (who doesn’t want fewer bugs?). MISRA-C is becoming the de facto standard in the whole embedded industry and is getting increasingly popular even in other programming branches. There are (at least) three publications of the standard (1998, 2004, and the current version from 2012). There is also a MISRA Compliance Guidelines document from 2016, and MISRA C:2012 Amendment 1 — Additional Security Guidelines for MISRA C:2012 (published in April 2016).<br> Note that some of the strictures in the MISRA rules are not appropriate to every context. For example, directive 4.12 states “Dynamic memory allocation shall not be used”. This is appropriate in the embedded systems for which the MISRA rules are designed; it is not appropriate everywhere. (Compilers, for instance, generally use dynamic memory allocation for things like symbol tables, and to do without dynamic memory allocation would be difficult, if not preposterous.)</sup>
</p>
</li>
<li>
<p>
Archived lists of ACCU-reviewed books on <a href="https://web.archive.org/web/20071105015557/http://www.accu.informika.ru/bookreviews/public/reviews/0sb/beginner_s_c.htm" rel="nofollow noreferrer">Beginner’s C</a> (116 titles) from 2007 and <a href="https://web.archive.org/web/20081020081215/http://www.accu.informika.ru/bookreviews/public/reviews/0sb/advanced_c.htm" rel="nofollow noreferrer">Advanced C</a> (76 titles) from 2008. Most of these don’t look to be on the main site anymore, and you can’t browse that by subject anyway.
</p>
</li>
</ul>
<hr>
<h5>
Warnings
</h1>
<p>Be wary of books written by <a href="http://catb.org/~esr/jargon/html/B/bullschildt.html" rel="nofollow noreferrer">Herbert Schildt</a>. In particular, you should stay away from <a href="https://rads.stackoverflow.com/amzn/click/com/0072121246" rel="nofollow noreferrer" rel="nofollow noreferrer">C: The Complete Reference</a> (4th Edition, 2000), known in some circles as C: The Complete Nonsense.</p>
<p>Also do not use the book <a href="https://smile.amazon.com/dp/9387284492/" rel="nofollow noreferrer">Let Us C</a> (16<sup>th</sup> Edition, 2017) by Yashwant Kanetkar. Many people view it as an outdated book that teaches Turbo C and has lots of obsolete, misleading and incorrect material. For example, page 137 discusses the expected output from <code>printf("%d %d %d\n", a, ++a, a++)</code> and does not categorize it as <a href="https://stackoverflow.com/questions/949433/why-are-these-constructs-using-pre-and-post-increment-undefined-behavior">undefined behaviour</a> as it should.</p>
<p>
<a href="https://learncodethehardway.org/c/" rel="nofollow noreferrer">Learn C The Hard Way</a> (2015) by Zed Shaw. A book with mixed reviews. <a href="http://hentenaar.com/dont-learn-c-the-wrong-way" rel="nofollow noreferrer">A critique of this book</a> by Tim Hentenaar:
</p>
<blockquote>
To summarize my views, which are laid out below, the author presents the material in a greatly oversimplified and misleading way, the whole corpus is a bundled mess, and some of the opinions and analyses he offers are just plain wrong. I’ve tried to view this book through the eyes of a novice, but unfortunately I am biased by years of experience writing code in C. It’s obvious to me that either the author has a flawed understanding of C, or he’s deliberately oversimplifying to the point where he’s actually misleading the reader (intentionally or otherwise.)
</blockquote>
<p>“Learn C The Hard Way” is not a book that I could recommend to someone who is both learning to program and learning C. If you’re already a competent programmer in some other related language, then it represents an interesting and unusual exposition on C, though I have reservations about parts of the book. <sub><em>Jonathan Leffler</em></sub></p>
<hr>
<h5>
Outdated
</h1>
<ul>
<li>
<a href="https://rads.stackoverflow.com/amzn/click/com/1565923065" rel="nofollow noreferrer" rel="nofollow noreferrer">Practical C Programming (3rd Edition)</a> - Steve Oualline (1997)(Beginner)
</li>
</ul>
<hr>
<p>
<sub><strong>Other contributors</strong>, not necessarily credited in the revision history, include:<br> <a href="https://stackoverflow.com/users/844882/alex-lockwood">Alex Lockwood</a>, <a href="https://stackoverflow.com/users/479989/ben-jackson">Ben Jackson</a>, <a href="https://stackoverflow.com/users/631423/bubbles">Bubbles</a>, <a href="https://stackoverflow.com/users/193653/claws">claws</a>, <a href="https://stackoverflow.com/users/14463/coledot">coledot</a>, <a href="https://stackoverflow.com/users/3161/dana-robinson">Dana Robinson</a>, <a href="https://stackoverflow.com/users/1322636/daniel-holden">Daniel Holden</a>, <a href="https://stackoverflow.com/users/50305/dervin-thunk">Dervin Thunk</a>, <a href="https://stackoverflow.com/users/57301/dwc">dwc</a>, <a href="https://stackoverflow.com/users/2226524/eric-hou">Erci Hou</a>, <a href="https://stackoverflow.com/users/102600/garen">Garen</a>, <a href="https://stackoverflow.com/users/714232/haziz">haziz</a>, <a href="https://stackoverflow.com/users/1029106/johan-bezem">Johan Bezem</a>, <a href="https://stackoverflow.com/users/15168/jonathan-leffler">Jonathan Leffler</a>, <a href="https://stackoverflow.com/users/141186/joshua-partogi">Joshua Partogi</a>, <a href="https://stackoverflow.com/users/74660/lucas">Lucas</a>, <a href="https://stackoverflow.com/users/584518/lundin">Lundin</a>, <a href="https://stackoverflow.com/users/52734/mattk">Matt K.</a>, <a href="https://stackoverflow.com/users/487623/mossplix">mossplix</a>, <a href="https://stackoverflow.com/users/147192/matthieu-m">Matthieu M.</a>, <a href="https://stackoverflow.com/users/3991400/midor">midor</a>, <a href="https://stackoverflow.com/users/39892/nietzche-jou">Nietzche-jou</a>, <a href="https://stackoverflow.com/users/41661/norman-ramsey">Norman Ramsey</a>, <a href="https://stackoverflow.com/users/416623/r3st0r3">r3st0r3</a>, <a href="https://stackoverflow.com/users/2395058/ridthyself">ridthyself</a>, <a href="https://stackoverflow.com/users/71074/robert-s-barnes">Robert S. Barnes</a>, <a href="https://stackoverflow.com/users/3923896/steve-summit">Steve Summit</a>, <a href="https://stackoverflow.com/users/3685/tim-ring">Tim Ring</a>, <a href="https://stackoverflow.com/users/207003/tony-bai">Tony Bai</a>, <a href="https://stackoverflow.com/users/213550/vmatm">VMAtm</a> </sub>
</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="execution-time-of-c-program-score-396880-in-2016" class="level3">
<h3>78: Execution time of C program (score <a href="https://stackoverflow.com/q/5248915.html">396880</a> in 2016)</h3>
<section id="question-76" class="level4">
<h4>Question</h4>
<p>I have a C program that aims to be run in parallel on several processors. I need to be able to record the execution time (which could be anywhere from 1 second to several minutes). I have searched for answers, but they all seem to suggest using the <code>clock()</code> function, which then involves calculating the number of clocks the program took divided by the <code>Clocks_per_second</code> value.</p>
<p>I’m not sure how the <code>Clocks_per_second</code> value is calculated?</p>
<p>In Java, I just take the current time in milliseconds before and after execution.</p>
<p>Is there a similar thing in C? I’ve had a look, but I can’t seem to find a way of getting anything better than a second resolution.</p>
<p>I’m also aware a profiler would be an option, but am looking to implement a timer myself.</p>
<p>Thanks</p>
</section>
<section id="answer-accepted-score-314" class="level4">
<h4>Answer accepted (score 314)</h4>
<p><code>CLOCKS_PER_SEC</code> is a constant which is declared in <code>&amp;lt;time.h&amp;gt;</code>. To get the CPU time used by a task within a C application, use:</p>
<div class="sourceCode" id="cb482"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb482-1"><a href="#cb482-1" aria-hidden="true"></a>clock_t begin = clock();</span>
<span id="cb482-2"><a href="#cb482-2" aria-hidden="true"></a></span>
<span id="cb482-3"><a href="#cb482-3" aria-hidden="true"></a><span class="co">/* here, do your time-consuming job */</span></span>
<span id="cb482-4"><a href="#cb482-4" aria-hidden="true"></a></span>
<span id="cb482-5"><a href="#cb482-5" aria-hidden="true"></a>clock_t end = clock();</span>
<span id="cb482-6"><a href="#cb482-6" aria-hidden="true"></a><span class="dt">double</span> time_spent = (<span class="dt">double</span>)(end - begin) / CLOCKS_PER_SEC;</span></code></pre></div>
<p>Note that this returns the time as a floating point type. This can be more precise than a second (e.g. you measure 4.52 seconds). Precision depends on the architecture; on modern systems you easily get 10ms or lower, but on older Windows machines (from the Win98 era) it was closer to 60ms.</p>
<p><code>clock()</code> is standard C; it works “everywhere”. There are system-specific functions, such as <code>getrusage()</code> on Unix-like systems.</p>
<p>Java’s <code>System.currentTimeMillis()</code> does not measure the same thing. It is a “wall clock”: it can help you measure how much time it took for the program to execute, but it does not tell you how much CPU time was used. On a multitasking systems (i.e. all of them), these can be widely different.</p>
</section>
<section id="answer-2-score-107-1" class="level4">
<h4>Answer 2 (score 107)</h4>
<p>If you are using the Unix shell for running, you can use the time command.</p>
<p>doing</p>
<div class="sourceCode" id="cb483"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb483-1"><a href="#cb483-1" aria-hidden="true"></a>$ time ./a.out</span></code></pre></div>
<p>assuming a.out as the executable will give u the time taken to run this</p>
</section>
<section id="answer-3-score-58" class="level4">
<h4>Answer 3 (score 58)</h4>
<p>You functionally want this:</p>
<div class="sourceCode" id="cb484"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb484-1"><a href="#cb484-1" aria-hidden="true"></a></span>
<span id="cb484-2"><a href="#cb484-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;sys/time.h&gt;</span></span>
<span id="cb484-3"><a href="#cb484-3" aria-hidden="true"></a></span>
<span id="cb484-4"><a href="#cb484-4" aria-hidden="true"></a><span class="kw">struct</span> timeval  tv1, tv2;</span>
<span id="cb484-5"><a href="#cb484-5" aria-hidden="true"></a>gettimeofday(&amp;tv1, NULL);</span>
<span id="cb484-6"><a href="#cb484-6" aria-hidden="true"></a><span class="co">/* stuff to do! */</span></span>
<span id="cb484-7"><a href="#cb484-7" aria-hidden="true"></a>gettimeofday(&amp;tv2, NULL);</span>
<span id="cb484-8"><a href="#cb484-8" aria-hidden="true"></a></span>
<span id="cb484-9"><a href="#cb484-9" aria-hidden="true"></a>printf (<span class="st">&quot;Total time = %f seconds</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb484-10"><a href="#cb484-10" aria-hidden="true"></a>         (<span class="dt">double</span>) (tv2.tv_usec - tv1.tv_usec) / <span class="dv">1000000</span> +</span>
<span id="cb484-11"><a href="#cb484-11" aria-hidden="true"></a>         (<span class="dt">double</span>) (tv2.tv_sec - tv1.tv_sec));</span></code></pre></div>
<p>Note that this measures in microseconds, not just seconds.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="makefile4-missing-separator.-stop-score-394642-in-2013" class="level3">
<h3>79: makefile:4: *** missing separator. Stop (score <a href="https://stackoverflow.com/q/16931770.html">394642</a> in 2013)</h3>
<section id="question-77" class="level4">
<h4>Question</h4>
<p>This is my makefile:</p>
<div class="sourceCode" id="cb485"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb485-1"><a href="#cb485-1" aria-hidden="true"></a>all:ll</span>
<span id="cb485-2"><a href="#cb485-2" aria-hidden="true"></a></span>
<span id="cb485-3"><a href="#cb485-3" aria-hidden="true"></a>ll:ll.c   </span>
<span id="cb485-4"><a href="#cb485-4" aria-hidden="true"></a>  gcc  -c  -Wall -Werror -<span class="bn">02</span> c.c ll.c  -o  ll  $@  $&lt;</span>
<span id="cb485-5"><a href="#cb485-5" aria-hidden="true"></a></span>
<span id="cb485-6"><a href="#cb485-6" aria-hidden="true"></a>clean :</span>
<span id="cb485-7"><a href="#cb485-7" aria-hidden="true"></a>  \rm -fr ll</span></code></pre></div>
<p>When I try to <code>make clean</code> or <code>make make</code>, I get this error:</p>
<div class="sourceCode" id="cb486"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb486-1"><a href="#cb486-1" aria-hidden="true"></a>:makefile:<span class="dv">4</span>: *** missing separator.  Stop.</span></code></pre></div>
<p>How can I fix it?</p>
</section>
<section id="answer-accepted-score-808-1" class="level4">
<h4>Answer accepted (score 808)</h4>
<p>makefile has a very stupid relation with tabs, all actions of every rule are identified by tabs …… and No 4 spaces don’t make a tab, only a tab makes a tab…</p>
<p>to check I use the command <code>cat -e -t -v makefile_name</code></p>
<p>It shows the presence of tabs with <code>^I</code> and line endings with <code>$</code> both are vital to ensure that dependencies end properly and tabs mark the action for the rules so that they are easily identifiable to the make utility…..</p>
<p>Example:</p>
<div class="sourceCode" id="cb487"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb487-1"><a href="#cb487-1" aria-hidden="true"></a>Kaizen ~/so_test $ cat -e -t -v  mk.t</span>
<span id="cb487-2"><a href="#cb487-2" aria-hidden="true"></a>all:ll$</span>
<span id="cb487-3"><a href="#cb487-3" aria-hidden="true"></a><span class="er">## here the $ is end of line ...                   </span></span>
<span id="cb487-4"><a href="#cb487-4" aria-hidden="true"></a>$</span>
<span id="cb487-5"><a href="#cb487-5" aria-hidden="true"></a>ll:ll.c   $</span>
<span id="cb487-6"><a href="#cb487-6" aria-hidden="true"></a>^Igcc  -c  -Wall -Werror -<span class="bn">02</span> c.c ll.c  -o  ll  $@  $&lt;$ </span>
<span id="cb487-7"><a href="#cb487-7" aria-hidden="true"></a></span>
<span id="cb487-8"><a href="#cb487-8" aria-hidden="true"></a><span class="er">## the ^I above means a tab was there before the action part, so this line is ok .</span></span>
<span id="cb487-9"><a href="#cb487-9" aria-hidden="true"></a> $</span>
<span id="cb487-10"><a href="#cb487-10" aria-hidden="true"></a>clean :$</span>
<span id="cb487-11"><a href="#cb487-11" aria-hidden="true"></a>   \rm -fr ll$</span>
<span id="cb487-12"><a href="#cb487-12" aria-hidden="true"></a></span>
<span id="cb487-13"><a href="#cb487-13" aria-hidden="true"></a><span class="er">## see here there is no ^I which means , tab is not present .... </span></span>
<span id="cb487-14"><a href="#cb487-14" aria-hidden="true"></a></span>
<span id="cb487-15"><a href="#cb487-15" aria-hidden="true"></a><span class="er">## in this case you need to open the file again and edit/ensure a tab </span></span>
<span id="cb487-16"><a href="#cb487-16" aria-hidden="true"></a></span>
<span id="cb487-17"><a href="#cb487-17" aria-hidden="true"></a><span class="er">## starts the action part</span></span></code></pre></div>
<p>hope this helps !!</p>
</section>
<section id="answer-2-score-26" class="level4">
<h4>Answer 2 (score 26)</h4>
<p>You should always write command after a “tab” and not white space.</p>
<p>This applies to “gcc” line (line #4) in your case. You need to insert tab before gcc.</p>
<p>Also replace </p>
</section>
<section id="answer-3-score-23-1" class="level4">
<h4>Answer 3 (score 23)</h4>
<p>On VS Code, just click the “Space: 4” on the downright corner and change it to tab when editing your Makefile.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="initialization-of-a-normal-array-with-one-default-value-score-390258-in-2016" class="level3">
<h3>80: Initialization of a normal array with one default value (score <a href="https://stackoverflow.com/q/1065774.html">390258</a> in 2016)</h3>
<section id="question-78" class="level4">
<h4>Question</h4>
<p><a href="http://www.fredosaurus.com/notes-cpp/arrayptr/array-initialization.html" rel="noreferrer">C++ Notes: Array Initialization</a> has a nice list over initialization of arrays. I have a</p>
<div class="sourceCode" id="cb488"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb488-1"><a href="#cb488-1" aria-hidden="true"></a><span class="dt">int</span> array[<span class="dv">100</span>] = {-<span class="dv">1</span>};</span></code></pre></div>
<p>expecting it to be full with -1’s but its not, only first value is and the rest are 0’s mixed with random values.</p>
<p>The code</p>
<div class="sourceCode" id="cb489"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb489-1"><a href="#cb489-1" aria-hidden="true"></a><span class="dt">int</span> array[<span class="dv">100</span>] = {<span class="dv">0</span>};</span></code></pre></div>
<p>works just fine and sets each element to 0.</p>
<p>What am I missing here.. Can’t one initialize it if the value isn’t zero ?</p>
<p>2: Is the default initialization (as above ) faster than the usual loop through the whole array and assign a value or does it do the same thing?</p>
</section>
<section id="answer-accepted-score-328" class="level4">
<h4>Answer accepted (score 328)</h4>
<p>Using the syntax that you used,</p>
<div class="sourceCode" id="cb490"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb490-1"><a href="#cb490-1" aria-hidden="true"></a><span class="dt">int</span> array[<span class="dv">100</span>] = {-<span class="dv">1</span>};</span></code></pre></div>
<p>says “set the first element to <code>-1</code> and the rest to <code>0</code>” since all omitted elements are set to <code>0</code>.</p>
<p>In C++, to set them all to <code>-1</code>, you can use something like <a href="http://en.cppreference.com/w/cpp/algorithm/fill_n" rel="noreferrer"><code>std::fill_n</code></a> (from <code>&amp;lt;algorithm&amp;gt;</code>):</p>
<div class="sourceCode" id="cb491"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb491-1"><a href="#cb491-1" aria-hidden="true"></a>std::fill_n(array, <span class="dv">100</span>, -<span class="dv">1</span>);</span></code></pre></div>
<p>In portable C, you have to roll your own loop. There are compiler-extensions or you can depend on implementation-defined behavior as a shortcut if that’s acceptable.</p>
</section>
<section id="answer-2-score-130" class="level4">
<h4>Answer 2 (score 130)</h4>
<p>There is an extension to the gcc compiler which allows the syntax:</p>
<div class="sourceCode" id="cb492"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb492-1"><a href="#cb492-1" aria-hidden="true"></a><span class="dt">int</span> array[<span class="dv">100</span>] = { [<span class="dv">0</span> ... <span class="dv">99</span>] = -<span class="dv">1</span> };</span></code></pre></div>
<p>This would set all of the elements to -1.</p>
<p>This is known as “Designated Initializers” see <a href="http://gcc.gnu.org/onlinedocs/gcc/Designated-Inits.html" rel="noreferrer">here</a> for further information.</p>
<p>Note this isn’t implemented for the gcc c++ compiler.</p>
</section>
<section id="answer-3-score-31-1" class="level4">
<h4>Answer 3 (score 31)</h4>
<p>The page you linked to already gave the answer to the first part:</p>
<blockquote>
<p>
If an explicit array size is specified, but an shorter initiliazation list is specified, the unspecified elements are set to zero.
</p>
</blockquote>
<p>There is no built-in way to initialize the entire array to some non-zero value.</p>
<p>As for which is faster, the usual rule applies: “The method that gives the compiler the most freedom is probably faster”.</p>
<div class="sourceCode" id="cb493"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb493-1"><a href="#cb493-1" aria-hidden="true"></a><span class="dt">int</span> array[<span class="dv">100</span>] = {<span class="dv">0</span>};</span></code></pre></div>
<p>simply tells the compiler “set these 100 ints to zero”, which the compiler can optimize freely.</p>
<div class="sourceCode" id="cb494"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb494-1"><a href="#cb494-1" aria-hidden="true"></a><span class="cf">for</span> (<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; <span class="dv">100</span>; ++i){</span>
<span id="cb494-2"><a href="#cb494-2" aria-hidden="true"></a>  array[i] = <span class="dv">0</span>;</span>
<span id="cb494-3"><a href="#cb494-3" aria-hidden="true"></a>}</span></code></pre></div>
<p>is a lot more specific. It tells the compiler to create an iteration variable <code>i</code>, it tells it the <em>order</em> in which the elements should be initialized, and so on. Of course, the compiler is likely to optimize that away, but the point is that here you are overspecifying the problem, forcing the compiler to work harder to get to the same result.</p>
<p>Finally, if you want to set the array to a non-zero value, you should (in C++, at least) use <code>std::fill</code>:</p>
<div class="sourceCode" id="cb495"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb495-1"><a href="#cb495-1" aria-hidden="true"></a>std::fill(array, array+<span class="dv">100</span>, <span class="dv">42</span>); <span class="co">// sets every value in the array to 42</span></span></code></pre></div>
<p>Again, you could do the same with an array, but this is more concise, and gives the compiler more freedom. You’re just saying that you want the entire array filled with the value 42. You don’t say anything about in which order it should be done, or anything else.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="check-substring-exists-in-a-string-in-c-score-385439-in-2017" class="level3">
<h3>81: Check substring exists in a string in C (score <a href="https://stackoverflow.com/q/12784766.html">385439</a> in 2017)</h3>
<section id="question-79" class="level4">
<h4>Question</h4>
<p>I’m trying to check whether a string contains a substring in C like:</p>
<div class="sourceCode" id="cb496"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb496-1"><a href="#cb496-1" aria-hidden="true"></a><span class="dt">char</span> *sent = <span class="st">&quot;this is my sample example&quot;</span>;</span>
<span id="cb496-2"><a href="#cb496-2" aria-hidden="true"></a><span class="dt">char</span> *word = <span class="st">&quot;sample&quot;</span>;</span>
<span id="cb496-3"><a href="#cb496-3" aria-hidden="true"></a><span class="cf">if</span> (<span class="co">/* sentence contains word */</span>) {</span>
<span id="cb496-4"><a href="#cb496-4" aria-hidden="true"></a>    <span class="co">/* .. */</span></span>
<span id="cb496-5"><a href="#cb496-5" aria-hidden="true"></a>}</span></code></pre></div>
<p>What is something to use instead of <code>string::find</code> in C++?</p>
</section>
<section id="answer-accepted-score-241" class="level4">
<h4>Answer accepted (score 241)</h4>
<div class="sourceCode" id="cb497"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb497-1"><a href="#cb497-1" aria-hidden="true"></a><span class="cf">if</span>(strstr(sent, word) != NULL) {</span>
<span id="cb497-2"><a href="#cb497-2" aria-hidden="true"></a>    <span class="co">/* ... */</span></span>
<span id="cb497-3"><a href="#cb497-3" aria-hidden="true"></a>}</span></code></pre></div>
<p>Note that <code>strstr</code> returns a pointer to the start of the word in <code>sent</code> if the word <code>word</code> is found.</p>
</section>
<section id="answer-2-score-29" class="level4">
<h4>Answer 2 (score 29)</h4>
<p>Use <code>strstr</code> for this.</p>
<p><a href="http://www.cplusplus.com/reference/clibrary/cstring/strstr/">http://www.cplusplus.com/reference/clibrary/cstring/strstr/</a></p>
<p>So, you’d write it like..</p>
<div class="sourceCode" id="cb498"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb498-1"><a href="#cb498-1" aria-hidden="true"></a><span class="dt">char</span> *sent = <span class="st">&quot;this is my sample example&quot;</span>;</span>
<span id="cb498-2"><a href="#cb498-2" aria-hidden="true"></a><span class="dt">char</span> *word = <span class="st">&quot;sample&quot;</span>;</span>
<span id="cb498-3"><a href="#cb498-3" aria-hidden="true"></a></span>
<span id="cb498-4"><a href="#cb498-4" aria-hidden="true"></a><span class="dt">char</span> *pch = strstr(sent, word);</span>
<span id="cb498-5"><a href="#cb498-5" aria-hidden="true"></a></span>
<span id="cb498-6"><a href="#cb498-6" aria-hidden="true"></a><span class="cf">if</span>(pch)</span>
<span id="cb498-7"><a href="#cb498-7" aria-hidden="true"></a>{</span>
<span id="cb498-8"><a href="#cb498-8" aria-hidden="true"></a>    ...</span>
<span id="cb498-9"><a href="#cb498-9" aria-hidden="true"></a>}</span></code></pre></div>
</section>
<section id="answer-3-score-11-2" class="level4">
<h4>Answer 3 (score 11)</h4>
<p>Try to use pointers…</p>
<div class="sourceCode" id="cb499"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb499-1"><a href="#cb499-1" aria-hidden="true"></a></span>
<span id="cb499-2"><a href="#cb499-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb499-3"><a href="#cb499-3" aria-hidden="true"></a></span>
<span id="cb499-4"><a href="#cb499-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;string.h&gt;</span></span>
<span id="cb499-5"><a href="#cb499-5" aria-hidden="true"></a></span>
<span id="cb499-6"><a href="#cb499-6" aria-hidden="true"></a><span class="dt">int</span> main()</span>
<span id="cb499-7"><a href="#cb499-7" aria-hidden="true"></a>{</span>
<span id="cb499-8"><a href="#cb499-8" aria-hidden="true"></a></span>
<span id="cb499-9"><a href="#cb499-9" aria-hidden="true"></a>  <span class="dt">char</span> str[] = <span class="st">&quot;String1 subString1 Strinstrnd subStr ing1subString&quot;</span>;</span>
<span id="cb499-10"><a href="#cb499-10" aria-hidden="true"></a>  <span class="dt">char</span> sub[] = <span class="st">&quot;subString&quot;</span>;</span>
<span id="cb499-11"><a href="#cb499-11" aria-hidden="true"></a></span>
<span id="cb499-12"><a href="#cb499-12" aria-hidden="true"></a>  <span class="dt">char</span> *p1, *p2, *p3;</span>
<span id="cb499-13"><a href="#cb499-13" aria-hidden="true"></a>  <span class="dt">int</span> i=<span class="dv">0</span>,j=<span class="dv">0</span>,flag=<span class="dv">0</span>;</span>
<span id="cb499-14"><a href="#cb499-14" aria-hidden="true"></a></span>
<span id="cb499-15"><a href="#cb499-15" aria-hidden="true"></a>  p1 = str;</span>
<span id="cb499-16"><a href="#cb499-16" aria-hidden="true"></a>  p2 = sub;</span>
<span id="cb499-17"><a href="#cb499-17" aria-hidden="true"></a></span>
<span id="cb499-18"><a href="#cb499-18" aria-hidden="true"></a>  <span class="cf">for</span>(i = <span class="dv">0</span>; i&lt;strlen(str); i++)</span>
<span id="cb499-19"><a href="#cb499-19" aria-hidden="true"></a>  {</span>
<span id="cb499-20"><a href="#cb499-20" aria-hidden="true"></a>    <span class="cf">if</span>(*p1 == *p2)</span>
<span id="cb499-21"><a href="#cb499-21" aria-hidden="true"></a>      {</span>
<span id="cb499-22"><a href="#cb499-22" aria-hidden="true"></a>          p3 = p1;</span>
<span id="cb499-23"><a href="#cb499-23" aria-hidden="true"></a>          <span class="cf">for</span>(j = <span class="dv">0</span>;j&lt;strlen(sub);j++)</span>
<span id="cb499-24"><a href="#cb499-24" aria-hidden="true"></a>          {</span>
<span id="cb499-25"><a href="#cb499-25" aria-hidden="true"></a>            <span class="cf">if</span>(*p3 == *p2)</span>
<span id="cb499-26"><a href="#cb499-26" aria-hidden="true"></a>            {</span>
<span id="cb499-27"><a href="#cb499-27" aria-hidden="true"></a>              p3++;p2++;</span>
<span id="cb499-28"><a href="#cb499-28" aria-hidden="true"></a>            } </span>
<span id="cb499-29"><a href="#cb499-29" aria-hidden="true"></a>            <span class="cf">else</span></span>
<span id="cb499-30"><a href="#cb499-30" aria-hidden="true"></a>              <span class="cf">break</span>;</span>
<span id="cb499-31"><a href="#cb499-31" aria-hidden="true"></a>          }</span>
<span id="cb499-32"><a href="#cb499-32" aria-hidden="true"></a>          p2 = sub;</span>
<span id="cb499-33"><a href="#cb499-33" aria-hidden="true"></a>          <span class="cf">if</span>(j == strlen(sub))</span>
<span id="cb499-34"><a href="#cb499-34" aria-hidden="true"></a>          {</span>
<span id="cb499-35"><a href="#cb499-35" aria-hidden="true"></a>             flag = <span class="dv">1</span>;</span>
<span id="cb499-36"><a href="#cb499-36" aria-hidden="true"></a>            printf(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Substring found at index : %d</span><span class="sc">\n</span><span class="st">&quot;</span>,i);</span>
<span id="cb499-37"><a href="#cb499-37" aria-hidden="true"></a>          }</span>
<span id="cb499-38"><a href="#cb499-38" aria-hidden="true"></a>      }</span>
<span id="cb499-39"><a href="#cb499-39" aria-hidden="true"></a>    p1++; </span>
<span id="cb499-40"><a href="#cb499-40" aria-hidden="true"></a>  }</span>
<span id="cb499-41"><a href="#cb499-41" aria-hidden="true"></a>  <span class="cf">if</span>(flag==<span class="dv">0</span>)</span>
<span id="cb499-42"><a href="#cb499-42" aria-hidden="true"></a>  {</span>
<span id="cb499-43"><a href="#cb499-43" aria-hidden="true"></a>       printf(<span class="st">&quot;Substring NOT found&quot;</span>);</span>
<span id="cb499-44"><a href="#cb499-44" aria-hidden="true"></a>  }</span>
<span id="cb499-45"><a href="#cb499-45" aria-hidden="true"></a><span class="cf">return</span> (<span class="dv">0</span>);</span>
<span id="cb499-46"><a href="#cb499-46" aria-hidden="true"></a>}</span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-do-i-concatenate-two-strings-in-c-score-384554-in-2017" class="level3">
<h3>82: How do I concatenate two strings in C? (score <a href="https://stackoverflow.com/q/8465006.html">384554</a> in 2017)</h3>
<section id="question-80" class="level4">
<h4>Question</h4>
<p>How do I add two strings?</p>
<p>I tried <code>name = "derp" + "herp";</code>, but I got an error:</p>
<blockquote>
Expression must have integral or enum type
</blockquote>
</section>
<section id="answer-accepted-score-153" class="level4">
<h4>Answer accepted (score 153)</h4>
<p>C does not have the support for strings that some other languages have. A string in C is just a pointer to an array of <code>char</code> that is terminated by the first null character. There is no string concatenation operator in C.</p>
<p>Use <code>strcat</code> to concatenate two strings. You could use the following function to do it:</p>
<div class="sourceCode" id="cb500"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb500-1"><a href="#cb500-1" aria-hidden="true"></a></span>
<span id="cb500-2"><a href="#cb500-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdlib.h&gt;</span></span>
<span id="cb500-3"><a href="#cb500-3" aria-hidden="true"></a></span>
<span id="cb500-4"><a href="#cb500-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;string.h&gt;</span></span>
<span id="cb500-5"><a href="#cb500-5" aria-hidden="true"></a></span>
<span id="cb500-6"><a href="#cb500-6" aria-hidden="true"></a><span class="dt">char</span>* concat(<span class="dt">const</span> <span class="dt">char</span> *s1, <span class="dt">const</span> <span class="dt">char</span> *s2)</span>
<span id="cb500-7"><a href="#cb500-7" aria-hidden="true"></a>{</span>
<span id="cb500-8"><a href="#cb500-8" aria-hidden="true"></a>    <span class="dt">char</span> *result = malloc(strlen(s1) + strlen(s2) + <span class="dv">1</span>); <span class="co">// +1 for the null-terminator</span></span>
<span id="cb500-9"><a href="#cb500-9" aria-hidden="true"></a>    <span class="co">// in real code you would check for errors in malloc here</span></span>
<span id="cb500-10"><a href="#cb500-10" aria-hidden="true"></a>    strcpy(result, s1);</span>
<span id="cb500-11"><a href="#cb500-11" aria-hidden="true"></a>    strcat(result, s2);</span>
<span id="cb500-12"><a href="#cb500-12" aria-hidden="true"></a>    <span class="cf">return</span> result;</span>
<span id="cb500-13"><a href="#cb500-13" aria-hidden="true"></a>}</span></code></pre></div>
<p>This is not the fastest way to do this, but you shouldn’t be worrying about that now. Note that the function returns a block of heap allocated memory to the caller and passes on ownership of that memory. It is the responsibility of the caller to <code>free</code> the memory when it is no longer needed.</p>
<p>Call the function like this:</p>
<div class="sourceCode" id="cb501"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb501-1"><a href="#cb501-1" aria-hidden="true"></a><span class="dt">char</span>* s = concat(<span class="st">&quot;derp&quot;</span>, <span class="st">&quot;herp&quot;</span>);</span>
<span id="cb501-2"><a href="#cb501-2" aria-hidden="true"></a><span class="co">// do things with s</span></span>
<span id="cb501-3"><a href="#cb501-3" aria-hidden="true"></a>free(s); <span class="co">// deallocate the string</span></span></code></pre></div>
<p>If you did happen to be bothered by performance then you would want to avoid repeatedly scanning the input buffers looking for the null-terminator.</p>
<div class="sourceCode" id="cb502"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb502-1"><a href="#cb502-1" aria-hidden="true"></a><span class="dt">char</span>* concat(<span class="dt">const</span> <span class="dt">char</span> *s1, <span class="dt">const</span> <span class="dt">char</span> *s2)</span>
<span id="cb502-2"><a href="#cb502-2" aria-hidden="true"></a>{</span>
<span id="cb502-3"><a href="#cb502-3" aria-hidden="true"></a>    <span class="dt">const</span> <span class="dt">size_t</span> len1 = strlen(s1);</span>
<span id="cb502-4"><a href="#cb502-4" aria-hidden="true"></a>    <span class="dt">const</span> <span class="dt">size_t</span> len2 = strlen(s2);</span>
<span id="cb502-5"><a href="#cb502-5" aria-hidden="true"></a>    <span class="dt">char</span> *result = malloc(len1 + len2 + <span class="dv">1</span>); <span class="co">// +1 for the null-terminator</span></span>
<span id="cb502-6"><a href="#cb502-6" aria-hidden="true"></a>    <span class="co">// in real code you would check for errors in malloc here</span></span>
<span id="cb502-7"><a href="#cb502-7" aria-hidden="true"></a>    memcpy(result, s1, len1);</span>
<span id="cb502-8"><a href="#cb502-8" aria-hidden="true"></a>    memcpy(result + len1, s2, len2 + <span class="dv">1</span>); <span class="co">// +1 to copy the null-terminator</span></span>
<span id="cb502-9"><a href="#cb502-9" aria-hidden="true"></a>    <span class="cf">return</span> result;</span>
<span id="cb502-10"><a href="#cb502-10" aria-hidden="true"></a>}</span></code></pre></div>
<p>If you are planning to do a lot of work with strings then you may be better off using a different language that has first class support for strings.</p>
</section>
<section id="answer-2-score-16" class="level4">
<h4>Answer 2 (score 16)</h4>
<div class="sourceCode" id="cb503"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb503-1"><a href="#cb503-1" aria-hidden="true"></a></span>
<span id="cb503-2"><a href="#cb503-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb503-3"><a href="#cb503-3" aria-hidden="true"></a></span>
<span id="cb503-4"><a href="#cb503-4" aria-hidden="true"></a><span class="dt">int</span> main(){</span>
<span id="cb503-5"><a href="#cb503-5" aria-hidden="true"></a>    <span class="dt">char</span> name[] =  <span class="st">&quot;derp&quot;</span> <span class="st">&quot;herp&quot;</span>;</span>
<span id="cb503-6"><a href="#cb503-6" aria-hidden="true"></a>    printf(<span class="st">&quot;</span><span class="sc">\&quot;</span><span class="st">%s</span><span class="sc">\&quot;\n</span><span class="st">&quot;</span>, name);<span class="co">//&quot;derpherp&quot;</span></span>
<span id="cb503-7"><a href="#cb503-7" aria-hidden="true"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb503-8"><a href="#cb503-8" aria-hidden="true"></a>}</span></code></pre></div>
</section>
<section id="answer-3-score-13" class="level4">
<h4>Answer 3 (score 13)</h4>
<p>David Heffernan <a href="https://stackoverflow.com/a/8465083/471214">explained</a> the issue in his answer, and I wrote the improved code. See below.</p>
<h5>
A generic function
</h1>
<p>We can write a useful <a href="http://en.wikipedia.org/wiki/Variadic_function" rel="nofollow noreferrer">variadic function</a> to concatenate any number of strings:</p>
<div class="sourceCode" id="cb504"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb504-1"><a href="#cb504-1" aria-hidden="true"></a></span>
<span id="cb504-2"><a href="#cb504-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdlib.h&gt;</span><span class="pp">       </span><span class="co">// calloc</span></span>
<span id="cb504-3"><a href="#cb504-3" aria-hidden="true"></a></span>
<span id="cb504-4"><a href="#cb504-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdarg.h&gt;</span><span class="pp">       </span><span class="co">// va_*</span></span>
<span id="cb504-5"><a href="#cb504-5" aria-hidden="true"></a></span>
<span id="cb504-6"><a href="#cb504-6" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;string.h&gt;</span><span class="pp">       </span><span class="co">// strlen, strcpy</span></span>
<span id="cb504-7"><a href="#cb504-7" aria-hidden="true"></a></span>
<span id="cb504-8"><a href="#cb504-8" aria-hidden="true"></a><span class="dt">char</span>* concat(<span class="dt">int</span> count, ...)</span>
<span id="cb504-9"><a href="#cb504-9" aria-hidden="true"></a>{</span>
<span id="cb504-10"><a href="#cb504-10" aria-hidden="true"></a>    <span class="dt">va_list</span> ap;</span>
<span id="cb504-11"><a href="#cb504-11" aria-hidden="true"></a>    <span class="dt">int</span> i;</span>
<span id="cb504-12"><a href="#cb504-12" aria-hidden="true"></a></span>
<span id="cb504-13"><a href="#cb504-13" aria-hidden="true"></a>    <span class="co">// Find required length to store merged string</span></span>
<span id="cb504-14"><a href="#cb504-14" aria-hidden="true"></a>    <span class="dt">int</span> len = <span class="dv">1</span>; <span class="co">// room for NULL</span></span>
<span id="cb504-15"><a href="#cb504-15" aria-hidden="true"></a>    va_start(ap, count);</span>
<span id="cb504-16"><a href="#cb504-16" aria-hidden="true"></a>    <span class="cf">for</span>(i=<span class="dv">0</span> ; i&lt;count ; i++)</span>
<span id="cb504-17"><a href="#cb504-17" aria-hidden="true"></a>        len += strlen(va_arg(ap, <span class="dt">char</span>*));</span>
<span id="cb504-18"><a href="#cb504-18" aria-hidden="true"></a>    va_end(ap);</span>
<span id="cb504-19"><a href="#cb504-19" aria-hidden="true"></a></span>
<span id="cb504-20"><a href="#cb504-20" aria-hidden="true"></a>    <span class="co">// Allocate memory to concat strings</span></span>
<span id="cb504-21"><a href="#cb504-21" aria-hidden="true"></a>    <span class="dt">char</span> *merged = calloc(<span class="kw">sizeof</span>(<span class="dt">char</span>),len);</span>
<span id="cb504-22"><a href="#cb504-22" aria-hidden="true"></a>    <span class="dt">int</span> null_pos = <span class="dv">0</span>;</span>
<span id="cb504-23"><a href="#cb504-23" aria-hidden="true"></a></span>
<span id="cb504-24"><a href="#cb504-24" aria-hidden="true"></a>    <span class="co">// Actually concatenate strings</span></span>
<span id="cb504-25"><a href="#cb504-25" aria-hidden="true"></a>    va_start(ap, count);</span>
<span id="cb504-26"><a href="#cb504-26" aria-hidden="true"></a>    <span class="cf">for</span>(i=<span class="dv">0</span> ; i&lt;count ; i++)</span>
<span id="cb504-27"><a href="#cb504-27" aria-hidden="true"></a>    {</span>
<span id="cb504-28"><a href="#cb504-28" aria-hidden="true"></a>        <span class="dt">char</span> *s = va_arg(ap, <span class="dt">char</span>*);</span>
<span id="cb504-29"><a href="#cb504-29" aria-hidden="true"></a>        strcpy(merged+null_pos, s);</span>
<span id="cb504-30"><a href="#cb504-30" aria-hidden="true"></a>        null_pos += strlen(s);</span>
<span id="cb504-31"><a href="#cb504-31" aria-hidden="true"></a>    }</span>
<span id="cb504-32"><a href="#cb504-32" aria-hidden="true"></a>    va_end(ap);</span>
<span id="cb504-33"><a href="#cb504-33" aria-hidden="true"></a></span>
<span id="cb504-34"><a href="#cb504-34" aria-hidden="true"></a>    <span class="cf">return</span> merged;</span>
<span id="cb504-35"><a href="#cb504-35" aria-hidden="true"></a>}</span></code></pre></div>
<h5>
Usage
</h1>
<div class="sourceCode" id="cb505"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb505-1"><a href="#cb505-1" aria-hidden="true"></a></span>
<span id="cb505-2"><a href="#cb505-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span><span class="pp">        </span><span class="co">// printf</span></span>
<span id="cb505-3"><a href="#cb505-3" aria-hidden="true"></a></span>
<span id="cb505-4"><a href="#cb505-4" aria-hidden="true"></a><span class="dt">void</span> println(<span class="dt">char</span> *line)</span>
<span id="cb505-5"><a href="#cb505-5" aria-hidden="true"></a>{</span>
<span id="cb505-6"><a href="#cb505-6" aria-hidden="true"></a>    printf(<span class="st">&quot;%s</span><span class="sc">\n</span><span class="st">&quot;</span>, line);</span>
<span id="cb505-7"><a href="#cb505-7" aria-hidden="true"></a>}</span>
<span id="cb505-8"><a href="#cb505-8" aria-hidden="true"></a></span>
<span id="cb505-9"><a href="#cb505-9" aria-hidden="true"></a><span class="dt">int</span> main(<span class="dt">int</span> argc, <span class="dt">char</span>* argv[])</span>
<span id="cb505-10"><a href="#cb505-10" aria-hidden="true"></a>{</span>
<span id="cb505-11"><a href="#cb505-11" aria-hidden="true"></a>    <span class="dt">char</span> *str;</span>
<span id="cb505-12"><a href="#cb505-12" aria-hidden="true"></a></span>
<span id="cb505-13"><a href="#cb505-13" aria-hidden="true"></a>    str = concat(<span class="dv">0</span>);             println(str); free(str);</span>
<span id="cb505-14"><a href="#cb505-14" aria-hidden="true"></a>    str = concat(<span class="dv">1</span>,<span class="st">&quot;a&quot;</span>);         println(str); free(str);</span>
<span id="cb505-15"><a href="#cb505-15" aria-hidden="true"></a>    str = concat(<span class="dv">2</span>,<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>);     println(str); free(str);</span>
<span id="cb505-16"><a href="#cb505-16" aria-hidden="true"></a>    str = concat(<span class="dv">3</span>,<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>); println(str); free(str);</span>
<span id="cb505-17"><a href="#cb505-17" aria-hidden="true"></a></span>
<span id="cb505-18"><a href="#cb505-18" aria-hidden="true"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb505-19"><a href="#cb505-19" aria-hidden="true"></a>}</span></code></pre></div>
<p>Output:</p>
<div class="sourceCode" id="cb506"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb506-1"><a href="#cb506-1" aria-hidden="true"></a>  <span class="co">// Empty line</span></span>
<span id="cb506-2"><a href="#cb506-2" aria-hidden="true"></a>a</span>
<span id="cb506-3"><a href="#cb506-3" aria-hidden="true"></a>ab</span>
<span id="cb506-4"><a href="#cb506-4" aria-hidden="true"></a>abc</span></code></pre></div>
<h5>
Clean-up
</h1>
<p>Note that you should free up the allocated memory when it becomes unneeded to avoid memory leaks:</p>
<div class="sourceCode" id="cb507"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb507-1"><a href="#cb507-1" aria-hidden="true"></a><span class="dt">char</span> *str = concat(<span class="dv">2</span>,<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>);</span>
<span id="cb507-2"><a href="#cb507-2" aria-hidden="true"></a>println(str);</span>
<span id="cb507-3"><a href="#cb507-3" aria-hidden="true"></a>free(str);</span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="why-are-ifndef-and-define-used-in-c-header-files-score-381732-in-2019" class="level3">
<h3>83: Why are #ifndef and #define used in C++ header files? (score <a href="https://stackoverflow.com/q/1653958.html">381732</a> in 2019)</h3>
<section id="question-81" class="level4">
<h4>Question</h4>
<p>I have been seeing code like this usually in the start of header files:</p>
<div class="sourceCode" id="cb508"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb508-1"><a href="#cb508-1" aria-hidden="true"></a></span>
<span id="cb508-2"><a href="#cb508-2" aria-hidden="true"></a><span class="pp">#ifndef HEADERFILE_H</span></span>
<span id="cb508-3"><a href="#cb508-3" aria-hidden="true"></a></span>
<span id="cb508-4"><a href="#cb508-4" aria-hidden="true"></a><span class="pp">#define HEADERFILE_H</span></span></code></pre></div>
<p>And at the end of the file is</p>
<div class="sourceCode" id="cb509"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb509-1"><a href="#cb509-1" aria-hidden="true"></a></span>
<span id="cb509-2"><a href="#cb509-2" aria-hidden="true"></a><span class="pp">#endif</span></span></code></pre></div>
<p>What is the purpose of this?</p>
</section>
<section id="answer-accepted-score-488" class="level4">
<h4>Answer accepted (score 488)</h4>
<p>Those are called <a href="http://en.wikipedia.org/wiki/Include_guard" rel="noreferrer"> #include guards</a>.</p>
<p>Once the header is included, it checks if a unique value (in this case <code>HEADERFILE_H</code>) is defined. Then if it’s not defined, it defines it and continues to the rest of the page.</p>
<p>When the code is included again, the first <code>ifndef</code> fails, resulting in a blank file.</p>
<p>That prevents double declaration of any identifiers such as types, enums and static variables.</p>
</section>
<section id="answer-2-score-31-1" class="level4">
<h4>Answer 2 (score 31)</h4>
<div class="sourceCode" id="cb510"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb510-1"><a href="#cb510-1" aria-hidden="true"></a></span>
<span id="cb510-2"><a href="#cb510-2" aria-hidden="true"></a><span class="pp">#ifndef &lt;token&gt;</span></span>
<span id="cb510-3"><a href="#cb510-3" aria-hidden="true"></a><span class="co">/* code */</span></span>
<span id="cb510-4"><a href="#cb510-4" aria-hidden="true"></a></span>
<span id="cb510-5"><a href="#cb510-5" aria-hidden="true"></a><span class="pp">#else</span></span>
<span id="cb510-6"><a href="#cb510-6" aria-hidden="true"></a><span class="co">/* code to include if the token is defined */</span></span>
<span id="cb510-7"><a href="#cb510-7" aria-hidden="true"></a></span>
<span id="cb510-8"><a href="#cb510-8" aria-hidden="true"></a><span class="pp">#endif</span></span></code></pre></div>
<p><code>#ifndef</code> checks whether the given token has been <code>#defined</code> earlier in the file or in an included file; if not, it includes the code between it and the closing <code>#else</code> or, if no <code>#else</code> is present, <code>#endif</code> statement. <code>#ifndef</code> is often used to make header files idempotent by defining a token once the file has been included and checking that the token was not set at the top of that file.</p>
<div class="sourceCode" id="cb511"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb511-1"><a href="#cb511-1" aria-hidden="true"></a></span>
<span id="cb511-2"><a href="#cb511-2" aria-hidden="true"></a><span class="pp">#ifndef _INCL_GUARD</span></span>
<span id="cb511-3"><a href="#cb511-3" aria-hidden="true"></a></span>
<span id="cb511-4"><a href="#cb511-4" aria-hidden="true"></a><span class="pp">#define _INCL_GUARD</span></span>
<span id="cb511-5"><a href="#cb511-5" aria-hidden="true"></a></span>
<span id="cb511-6"><a href="#cb511-6" aria-hidden="true"></a><span class="pp">#endif</span></span></code></pre></div>
</section>
<section id="answer-3-score-8-1" class="level4">
<h4>Answer 3 (score 8)</h4>
<p>This prevent from the multiple inclusion of same header file multiple time.</p>
<div class="sourceCode" id="cb512"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb512-1"><a href="#cb512-1" aria-hidden="true"></a></span>
<span id="cb512-2"><a href="#cb512-2" aria-hidden="true"></a><span class="pp">#ifndef __COMMON_H__</span></span>
<span id="cb512-3"><a href="#cb512-3" aria-hidden="true"></a></span>
<span id="cb512-4"><a href="#cb512-4" aria-hidden="true"></a><span class="pp">#define __COMMON_H__</span></span>
<span id="cb512-5"><a href="#cb512-5" aria-hidden="true"></a><span class="co">//header file content</span></span>
<span id="cb512-6"><a href="#cb512-6" aria-hidden="true"></a></span>
<span id="cb512-7"><a href="#cb512-7" aria-hidden="true"></a><span class="pp">#endif</span></span></code></pre></div>
<p>
Suppose you have included this header file in multiple files. So first time <strong>COMMON_H</strong> is not defined, it will get defined and header file included.
</p>
<p>Next time <strong>COMMON_H</strong> is defined, so it will not include again.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="c-pointer-to-arrayarray-of-pointers-disambiguation-score-380998-in-2014" class="level3">
<h3>84: C pointer to array/array of pointers disambiguation (score <a href="https://stackoverflow.com/q/859634.html">380998</a> in 2014)</h3>
<section id="question-82" class="level4">
<h4>Question</h4>
<p>What is the difference between the following declarations:</p>
<div class="sourceCode" id="cb513"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb513-1"><a href="#cb513-1" aria-hidden="true"></a><span class="dt">int</span>* arr1[<span class="dv">8</span>];</span>
<span id="cb513-2"><a href="#cb513-2" aria-hidden="true"></a><span class="dt">int</span> (*arr2)[<span class="dv">8</span>];</span>
<span id="cb513-3"><a href="#cb513-3" aria-hidden="true"></a><span class="dt">int</span> *(arr3[<span class="dv">8</span>]);</span></code></pre></div>
<p>What is the general rule for understanding more complex declarations?</p>
</section>
<section id="answer-accepted-score-424" class="level4">
<h4>Answer accepted (score 424)</h4>
<div class="sourceCode" id="cb514"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb514-1"><a href="#cb514-1" aria-hidden="true"></a><span class="dt">int</span>* arr[<span class="dv">8</span>]; <span class="co">// An array of int pointers.</span></span>
<span id="cb514-2"><a href="#cb514-2" aria-hidden="true"></a><span class="dt">int</span> (*arr)[<span class="dv">8</span>]; <span class="co">// A pointer to an array of integers</span></span></code></pre></div>
<p>The third one is same as the first.</p>
<p>The general rule is <a href="http://unixwiz.net/techtips/reading-cdecl.html" rel="noreferrer">operator precedence</a>. It can get even much more complex as function pointers come into the picture.</p>
</section>
<section id="answer-2-score-260" class="level4">
<h4>Answer 2 (score 260)</h4>
<p>Use the <a href="http://cdecl.org/" rel="noreferrer">cdecl</a> program, as suggested by K&amp;R.</p>
<div class="sourceCode" id="cb515"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb515-1"><a href="#cb515-1" aria-hidden="true"></a>$ cdecl</span>
<span id="cb515-2"><a href="#cb515-2" aria-hidden="true"></a>Type `help&#39; or `?&#39; <span class="cf">for</span> help</span>
<span id="cb515-3"><a href="#cb515-3" aria-hidden="true"></a>cdecl&gt; explain <span class="dt">int</span>* arr1[<span class="dv">8</span>];</span>
<span id="cb515-4"><a href="#cb515-4" aria-hidden="true"></a>declare arr1 as array <span class="dv">8</span> of pointer to <span class="dt">int</span></span>
<span id="cb515-5"><a href="#cb515-5" aria-hidden="true"></a>cdecl&gt; explain <span class="dt">int</span> (*arr2)[<span class="dv">8</span>]</span>
<span id="cb515-6"><a href="#cb515-6" aria-hidden="true"></a>declare arr2 as pointer to array <span class="dv">8</span> of <span class="dt">int</span></span>
<span id="cb515-7"><a href="#cb515-7" aria-hidden="true"></a>cdecl&gt; explain <span class="dt">int</span> *(arr3[<span class="dv">8</span>])</span>
<span id="cb515-8"><a href="#cb515-8" aria-hidden="true"></a>declare arr3 as array <span class="dv">8</span> of pointer to <span class="dt">int</span></span>
<span id="cb515-9"><a href="#cb515-9" aria-hidden="true"></a>cdecl&gt;</span></code></pre></div>
<p>It works the other way too.</p>
<div class="sourceCode" id="cb516"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb516-1"><a href="#cb516-1" aria-hidden="true"></a>cdecl&gt; declare x as pointer to function(<span class="dt">void</span>) returning pointer to <span class="dt">float</span></span>
<span id="cb516-2"><a href="#cb516-2" aria-hidden="true"></a><span class="dt">float</span> *(*x)(<span class="dt">void</span> )</span></code></pre></div>
</section>
<section id="answer-3-score-124" class="level4">
<h4>Answer 3 (score 124)</h4>
<p>I don’t know if it has an official name, but I call it the Right-Left Thingy(TM).</p>
<p>Start at the variable, then go right, and left, and right…and so on.</p>
<div class="sourceCode" id="cb517"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb517-1"><a href="#cb517-1" aria-hidden="true"></a><span class="dt">int</span>* arr1[<span class="dv">8</span>];</span></code></pre></div>
<p><em>arr1 is an array of 8 pointers to integers.</em></p>
<div class="sourceCode" id="cb518"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb518-1"><a href="#cb518-1" aria-hidden="true"></a><span class="dt">int</span> (*arr2)[<span class="dv">8</span>];</span></code></pre></div>
<p><em>arr2 is a pointer (the parenthesis block the right-left) to an array of 8 integers.</em></p>
<div class="sourceCode" id="cb519"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb519-1"><a href="#cb519-1" aria-hidden="true"></a><span class="dt">int</span> *(arr3[<span class="dv">8</span>]);</span></code></pre></div>
<p><em>arr3 is an array of 8 pointers to integers.</em></p>
<p>This should help you out with complex declarations.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="calling-cc-from-python-score-380797-in-2017" class="level3">
<h3>85: Calling C/C++ from Python? (score <a href="https://stackoverflow.com/q/145270.html">380797</a> in 2017)</h3>
<section id="question-83" class="level4">
<h4>Question</h4>
<p>What would be the quickest way to construct a Python binding to a C or C++ library?</p>
<p>(I am using Windows if this matters.)</p>
</section>
<section id="answer-accepted-score-154-1" class="level4">
<h4>Answer accepted (score 154)</h4>
<p>You should have a look at <a href="http://www.boost.org/doc/libs/1_49_0/libs/python/doc/" rel="noreferrer">Boost.Python</a>. Here is the short introduction taken from their website:</p>
<blockquote>
<p>
The Boost Python Library is a framework for interfacing Python and C++. It allows you to quickly and seamlessly expose C++ classes functions and objects to Python, and vice-versa, using no special tools – just your C++ compiler. It is designed to wrap C++ interfaces non-intrusively, so that you should not have to change the C++ code at all in order to wrap it, making Boost.Python ideal for exposing 3rd-party libraries to Python. The library’s use of advanced metaprogramming techniques simplifies its syntax for users, so that wrapping code takes on the look of a kind of declarative interface definition language (IDL).
</p>
</blockquote>
</section>
<section id="answer-2-score-616" class="level4">
<h4>Answer 2 (score 616)</h4>
<p><a href="http://docs.python.org/2/library/ctypes.html" rel="noreferrer">ctypes</a> is part of the standard library, and therefore is more stable and widely available than <a href="http://www.swig.org/" rel="noreferrer">swig</a>, which always tended to give me <a href="http://groups.google.com/group/comp.lang.python/browse_thread/thread/d94badd9847fe43a?pli=1" rel="noreferrer">problems</a>.</p>
<p>With ctypes, you need to satisfy any compile time dependency on python, and your binding will work on any python that has ctypes, not just the one it was compiled against.</p>
<p>Suppose you have a simple C++ example class you want to talk to in a file called foo.cpp:</p>
<div class="sourceCode" id="cb520"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb520-1"><a href="#cb520-1" aria-hidden="true"></a></span>
<span id="cb520-2"><a href="#cb520-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb520-3"><a href="#cb520-3" aria-hidden="true"></a></span>
<span id="cb520-4"><a href="#cb520-4" aria-hidden="true"></a>class Foo{</span>
<span id="cb520-5"><a href="#cb520-5" aria-hidden="true"></a>    public:</span>
<span id="cb520-6"><a href="#cb520-6" aria-hidden="true"></a>        <span class="dt">void</span> bar(){</span>
<span id="cb520-7"><a href="#cb520-7" aria-hidden="true"></a>            std::cout &lt;&lt; <span class="st">&quot;Hello&quot;</span> &lt;&lt; std::endl;</span>
<span id="cb520-8"><a href="#cb520-8" aria-hidden="true"></a>        }</span>
<span id="cb520-9"><a href="#cb520-9" aria-hidden="true"></a>};</span></code></pre></div>
<p>Since ctypes can only talk to C functions, you need to provide those declaring them as extern “C”</p>
<div class="sourceCode" id="cb521"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb521-1"><a href="#cb521-1" aria-hidden="true"></a><span class="kw">extern</span> <span class="st">&quot;C&quot;</span> {</span>
<span id="cb521-2"><a href="#cb521-2" aria-hidden="true"></a>    Foo* Foo_new(){ <span class="cf">return</span> new Foo(); }</span>
<span id="cb521-3"><a href="#cb521-3" aria-hidden="true"></a>    <span class="dt">void</span> Foo_bar(Foo* foo){ foo-&gt;bar(); }</span>
<span id="cb521-4"><a href="#cb521-4" aria-hidden="true"></a>}</span></code></pre></div>
<p>Next you have to compile this to a shared library</p>
<div class="sourceCode" id="cb522"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb522-1"><a href="#cb522-1" aria-hidden="true"></a>g++ -c -fPIC foo.cpp -o foo.o</span>
<span id="cb522-2"><a href="#cb522-2" aria-hidden="true"></a>g++ -shared -Wl,-soname,libfoo.so -o libfoo.so  foo.o</span></code></pre></div>
<p>And finally you have to write your python wrapper (e.g. in fooWrapper.py)</p>
<div class="sourceCode" id="cb523"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb523-1"><a href="#cb523-1" aria-hidden="true"></a>from ctypes import cdll</span>
<span id="cb523-2"><a href="#cb523-2" aria-hidden="true"></a>lib = cdll.LoadLibrary(&#39;./libfoo.so&#39;)</span>
<span id="cb523-3"><a href="#cb523-3" aria-hidden="true"></a></span>
<span id="cb523-4"><a href="#cb523-4" aria-hidden="true"></a>class Foo(object):</span>
<span id="cb523-5"><a href="#cb523-5" aria-hidden="true"></a>    def __init__(self):</span>
<span id="cb523-6"><a href="#cb523-6" aria-hidden="true"></a>        self.obj = lib.Foo_new()</span>
<span id="cb523-7"><a href="#cb523-7" aria-hidden="true"></a></span>
<span id="cb523-8"><a href="#cb523-8" aria-hidden="true"></a>    def bar(self):</span>
<span id="cb523-9"><a href="#cb523-9" aria-hidden="true"></a>        lib.Foo_bar(self.obj)</span></code></pre></div>
<p>Once you have that you can call it like</p>
<div class="sourceCode" id="cb524"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb524-1"><a href="#cb524-1" aria-hidden="true"></a>f = Foo()</span>
<span id="cb524-2"><a href="#cb524-2" aria-hidden="true"></a>f.bar()</span>
<span id="cb524-3"><a href="#cb524-3" aria-hidden="true"></a><span class="er">#and you will see &quot;Hello&quot; on the screen</span></span></code></pre></div>
</section>
<section id="answer-3-score-51-2" class="level4">
<h4>Answer 3 (score 51)</h4>
<p>The quickest way to do this is using <a href="http://www.swig.org/" rel="noreferrer">SWIG</a>.</p>
<p>Example from SWIG <a href="http://www.swig.org/tutorial.html" rel="noreferrer">tutorial</a>:</p>
<div class="sourceCode" id="cb525"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb525-1"><a href="#cb525-1" aria-hidden="true"></a><span class="co">/* File : example.c */</span></span>
<span id="cb525-2"><a href="#cb525-2" aria-hidden="true"></a><span class="dt">int</span> fact(<span class="dt">int</span> n) {</span>
<span id="cb525-3"><a href="#cb525-3" aria-hidden="true"></a>    <span class="cf">if</span> (n &lt;= <span class="dv">1</span>) <span class="cf">return</span> <span class="dv">1</span>;</span>
<span id="cb525-4"><a href="#cb525-4" aria-hidden="true"></a>    <span class="cf">else</span> <span class="cf">return</span> n*fact(n-<span class="dv">1</span>);</span>
<span id="cb525-5"><a href="#cb525-5" aria-hidden="true"></a>}</span></code></pre></div>
<p>Interface file:</p>
<div class="sourceCode" id="cb526"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb526-1"><a href="#cb526-1" aria-hidden="true"></a><span class="co">/* example.i */</span></span>
<span id="cb526-2"><a href="#cb526-2" aria-hidden="true"></a>%module example</span>
<span id="cb526-3"><a href="#cb526-3" aria-hidden="true"></a>%{</span>
<span id="cb526-4"><a href="#cb526-4" aria-hidden="true"></a><span class="co">/* Put header files here or function declarations like below */</span></span>
<span id="cb526-5"><a href="#cb526-5" aria-hidden="true"></a><span class="kw">extern</span> <span class="dt">int</span> fact(<span class="dt">int</span> n);</span>
<span id="cb526-6"><a href="#cb526-6" aria-hidden="true"></a>%}</span>
<span id="cb526-7"><a href="#cb526-7" aria-hidden="true"></a></span>
<span id="cb526-8"><a href="#cb526-8" aria-hidden="true"></a><span class="kw">extern</span> <span class="dt">int</span> fact(<span class="dt">int</span> n);</span></code></pre></div>
<p>Building a Python module on Unix:</p>
<div class="sourceCode" id="cb527"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb527-1"><a href="#cb527-1" aria-hidden="true"></a>swig -python example.i</span>
<span id="cb527-2"><a href="#cb527-2" aria-hidden="true"></a>gcc -fPIC -c example.c example_wrap.c -I/usr/local/include/python2<span class="fl">.7</span></span>
<span id="cb527-3"><a href="#cb527-3" aria-hidden="true"></a>gcc -shared example.o example_wrap.o -o _example.so</span></code></pre></div>
<p>Usage:</p>
<div class="sourceCode" id="cb528"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb528-1"><a href="#cb528-1" aria-hidden="true"></a>&gt;&gt;&gt; import example</span>
<span id="cb528-2"><a href="#cb528-2" aria-hidden="true"></a>&gt;&gt;&gt; example.fact(<span class="dv">5</span>)</span>
<span id="cb528-3"><a href="#cb528-3" aria-hidden="true"></a><span class="dv">120</span></span></code></pre></div>
<p>Note that you have to have python-dev. Also in some systems python header files will be in /usr/include/python2.7 based on the way you have installed it.</p>
<p>From the tutorial:</p>
<blockquote>
SWIG is a fairly complete C++ compiler with support for nearly every language feature. This includes preprocessing, pointers, classes, inheritance, and even C++ templates. SWIG can also be used to package structures and classes into proxy classes in the target language — exposing the underlying functionality in a very natural manner.
</blockquote>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="improve-insert-per-second-performance-of-sqlite-score-379997-in-2019" class="level3">
<h3>86: Improve INSERT-per-second performance of SQLite? (score <a href="https://stackoverflow.com/q/1711631.html">379997</a> in 2019)</h3>
<section id="question-84" class="level4">
<h4>Question</h4>
<p>Optimizing SQLite is tricky. Bulk-insert performance of a C application can vary from 85 inserts per second to over 96,000 inserts per second!</p>
<p><strong>Background:</strong> We are using SQLite as part of a desktop application. We have large amounts of configuration data stored in XML files that are parsed and loaded into an SQLite database for further processing when the application is initialized. SQLite is ideal for this situation because it’s fast, it requires no specialized configuration, and the database is stored on disk as a single file.</p>
<p><strong>Rationale:</strong> <em>Initially I was disappointed with the performance I was seeing.</em> It turns-out that the performance of SQLite can vary significantly (both for bulk-inserts and selects) depending on how the database is configured and how you’re using the API. It was not a trivial matter to figure out what all of the options and techniques were, so I thought it prudent to create this community wiki entry to share the results with Stack Overflow readers in order to save others the trouble of the same investigations.</p>
<p><strong>The Experiment:</strong> Rather than simply talking about performance tips in the general sense (i.e. <em>“Use a transaction!”</em>), I thought it best to write some C code and <em>actually measure</em> the impact of various options. We’re going to start with some simple data:</p>
<ul>
<li>
A 28 MB TAB-delimited text file (approximately 865,000 records) of the <a href="http://www.toronto.ca/open/datasets/ttc-routes" rel="nofollow noreferrer">complete transit schedule for the city of Toronto</a>
</li>
<li>
My test machine is a 3.60 GHz P4 running Windows XP.
</li>
<li>
The code is compiled with <a href="http://en.wikipedia.org/wiki/Visual_C%2B%2B
#32-bit_versions" rel="nofollow noreferrer">Visual C++</a> 2005 as “Release” with “Full Optimization” (/Ox) and Favor Fast Code (/Ot).
</li>
<li>
I’m using the SQLite “Amalgamation”, compiled directly into my test application. The SQLite version I happen to have is a bit older (3.6.7), but I suspect these results will be comparable to the latest release (please leave a comment if you think otherwise).
</li>
</ul>
<p><em>Let’s write some code!</em></p>
<p><strong>The Code:</strong> A simple C program that reads the text file line-by-line, splits the string into values and then inserts the data into an SQLite database. In this “baseline” version of the code, the database is created, but we won’t actually insert data:</p>
<div class="sourceCode" id="cb529"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb529-1"><a href="#cb529-1" aria-hidden="true"></a><span class="co">/*************************************************************</span></span>
<span id="cb529-2"><a href="#cb529-2" aria-hidden="true"></a><span class="co">    Baseline code to experiment with SQLite performance.</span></span>
<span id="cb529-3"><a href="#cb529-3" aria-hidden="true"></a></span>
<span id="cb529-4"><a href="#cb529-4" aria-hidden="true"></a><span class="co">    Input data is a 28 MB TAB-delimited text file of the</span></span>
<span id="cb529-5"><a href="#cb529-5" aria-hidden="true"></a><span class="co">    complete Toronto Transit System schedule/route info</span></span>
<span id="cb529-6"><a href="#cb529-6" aria-hidden="true"></a><span class="co">    from http://www.toronto.ca/open/datasets/ttc-routes/</span></span>
<span id="cb529-7"><a href="#cb529-7" aria-hidden="true"></a></span>
<span id="cb529-8"><a href="#cb529-8" aria-hidden="true"></a><span class="co">**************************************************************/</span></span>
<span id="cb529-9"><a href="#cb529-9" aria-hidden="true"></a></span>
<span id="cb529-10"><a href="#cb529-10" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb529-11"><a href="#cb529-11" aria-hidden="true"></a></span>
<span id="cb529-12"><a href="#cb529-12" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdlib.h&gt;</span></span>
<span id="cb529-13"><a href="#cb529-13" aria-hidden="true"></a></span>
<span id="cb529-14"><a href="#cb529-14" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;time.h&gt;</span></span>
<span id="cb529-15"><a href="#cb529-15" aria-hidden="true"></a></span>
<span id="cb529-16"><a href="#cb529-16" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;string.h&gt;</span></span>
<span id="cb529-17"><a href="#cb529-17" aria-hidden="true"></a></span>
<span id="cb529-18"><a href="#cb529-18" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;sqlite3.h&quot;</span></span>
<span id="cb529-19"><a href="#cb529-19" aria-hidden="true"></a></span>
<span id="cb529-20"><a href="#cb529-20" aria-hidden="true"></a></span>
<span id="cb529-21"><a href="#cb529-21" aria-hidden="true"></a><span class="pp">#define INPUTDATA &quot;C:\\TTC_schedule_scheduleitem_10-27-2009.txt&quot;</span></span>
<span id="cb529-22"><a href="#cb529-22" aria-hidden="true"></a></span>
<span id="cb529-23"><a href="#cb529-23" aria-hidden="true"></a><span class="pp">#define DATABASE &quot;c:\\TTC_schedule_scheduleitem_10-27-2009.sqlite&quot;</span></span>
<span id="cb529-24"><a href="#cb529-24" aria-hidden="true"></a></span>
<span id="cb529-25"><a href="#cb529-25" aria-hidden="true"></a><span class="pp">#define TABLE &quot;CREATE TABLE IF NOT EXISTS TTC (id INTEGER PRIMARY KEY, Route_ID TEXT, Branch_Code TEXT, Version INTEGER, Stop INTEGER, Vehicle_Index INTEGER, Day Integer, Time TEXT)&quot;</span></span>
<span id="cb529-26"><a href="#cb529-26" aria-hidden="true"></a></span>
<span id="cb529-27"><a href="#cb529-27" aria-hidden="true"></a><span class="pp">#define BUFFER_SIZE 256</span></span>
<span id="cb529-28"><a href="#cb529-28" aria-hidden="true"></a></span>
<span id="cb529-29"><a href="#cb529-29" aria-hidden="true"></a><span class="dt">int</span> main(<span class="dt">int</span> argc, <span class="dt">char</span> **argv) {</span>
<span id="cb529-30"><a href="#cb529-30" aria-hidden="true"></a></span>
<span id="cb529-31"><a href="#cb529-31" aria-hidden="true"></a>    sqlite3 * db;</span>
<span id="cb529-32"><a href="#cb529-32" aria-hidden="true"></a>    sqlite3_stmt * stmt;</span>
<span id="cb529-33"><a href="#cb529-33" aria-hidden="true"></a>    <span class="dt">char</span> * sErrMsg = <span class="dv">0</span>;</span>
<span id="cb529-34"><a href="#cb529-34" aria-hidden="true"></a>    <span class="dt">char</span> * tail = <span class="dv">0</span>;</span>
<span id="cb529-35"><a href="#cb529-35" aria-hidden="true"></a>    <span class="dt">int</span> nRetCode;</span>
<span id="cb529-36"><a href="#cb529-36" aria-hidden="true"></a>    <span class="dt">int</span> n = <span class="dv">0</span>;</span>
<span id="cb529-37"><a href="#cb529-37" aria-hidden="true"></a></span>
<span id="cb529-38"><a href="#cb529-38" aria-hidden="true"></a>    clock_t cStartClock;</span>
<span id="cb529-39"><a href="#cb529-39" aria-hidden="true"></a></span>
<span id="cb529-40"><a href="#cb529-40" aria-hidden="true"></a>    <span class="dt">FILE</span> * pFile;</span>
<span id="cb529-41"><a href="#cb529-41" aria-hidden="true"></a>    <span class="dt">char</span> sInputBuf [BUFFER_SIZE] = <span class="st">&quot;</span><span class="sc">\0</span><span class="st">&quot;</span>;</span>
<span id="cb529-42"><a href="#cb529-42" aria-hidden="true"></a></span>
<span id="cb529-43"><a href="#cb529-43" aria-hidden="true"></a>    <span class="dt">char</span> * sRT = <span class="dv">0</span>;  <span class="co">/* Route */</span></span>
<span id="cb529-44"><a href="#cb529-44" aria-hidden="true"></a>    <span class="dt">char</span> * sBR = <span class="dv">0</span>;  <span class="co">/* Branch */</span></span>
<span id="cb529-45"><a href="#cb529-45" aria-hidden="true"></a>    <span class="dt">char</span> * sVR = <span class="dv">0</span>;  <span class="co">/* Version */</span></span>
<span id="cb529-46"><a href="#cb529-46" aria-hidden="true"></a>    <span class="dt">char</span> * sST = <span class="dv">0</span>;  <span class="co">/* Stop Number */</span></span>
<span id="cb529-47"><a href="#cb529-47" aria-hidden="true"></a>    <span class="dt">char</span> * sVI = <span class="dv">0</span>;  <span class="co">/* Vehicle */</span></span>
<span id="cb529-48"><a href="#cb529-48" aria-hidden="true"></a>    <span class="dt">char</span> * sDT = <span class="dv">0</span>;  <span class="co">/* Date */</span></span>
<span id="cb529-49"><a href="#cb529-49" aria-hidden="true"></a>    <span class="dt">char</span> * sTM = <span class="dv">0</span>;  <span class="co">/* Time */</span></span>
<span id="cb529-50"><a href="#cb529-50" aria-hidden="true"></a></span>
<span id="cb529-51"><a href="#cb529-51" aria-hidden="true"></a>    <span class="dt">char</span> sSQL [BUFFER_SIZE] = <span class="st">&quot;</span><span class="sc">\0</span><span class="st">&quot;</span>;</span>
<span id="cb529-52"><a href="#cb529-52" aria-hidden="true"></a></span>
<span id="cb529-53"><a href="#cb529-53" aria-hidden="true"></a>    <span class="co">/*********************************************/</span></span>
<span id="cb529-54"><a href="#cb529-54" aria-hidden="true"></a>    <span class="co">/* Open the Database and create the Schema */</span></span>
<span id="cb529-55"><a href="#cb529-55" aria-hidden="true"></a>    sqlite3_open(DATABASE, &amp;db);</span>
<span id="cb529-56"><a href="#cb529-56" aria-hidden="true"></a>    sqlite3_exec(db, TABLE, NULL, NULL, &amp;sErrMsg);</span>
<span id="cb529-57"><a href="#cb529-57" aria-hidden="true"></a></span>
<span id="cb529-58"><a href="#cb529-58" aria-hidden="true"></a>    <span class="co">/*********************************************/</span></span>
<span id="cb529-59"><a href="#cb529-59" aria-hidden="true"></a>    <span class="co">/* Open input file and import into Database*/</span></span>
<span id="cb529-60"><a href="#cb529-60" aria-hidden="true"></a>    cStartClock = clock();</span>
<span id="cb529-61"><a href="#cb529-61" aria-hidden="true"></a></span>
<span id="cb529-62"><a href="#cb529-62" aria-hidden="true"></a>    pFile = fopen (INPUTDATA,<span class="st">&quot;r&quot;</span>);</span>
<span id="cb529-63"><a href="#cb529-63" aria-hidden="true"></a>    <span class="cf">while</span> (!feof(pFile)) {</span>
<span id="cb529-64"><a href="#cb529-64" aria-hidden="true"></a></span>
<span id="cb529-65"><a href="#cb529-65" aria-hidden="true"></a>        fgets (sInputBuf, BUFFER_SIZE, pFile);</span>
<span id="cb529-66"><a href="#cb529-66" aria-hidden="true"></a></span>
<span id="cb529-67"><a href="#cb529-67" aria-hidden="true"></a>        sRT = strtok (sInputBuf, <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>);     <span class="co">/* Get Route */</span></span>
<span id="cb529-68"><a href="#cb529-68" aria-hidden="true"></a>        sBR = strtok (NULL, <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>);            <span class="co">/* Get Branch */</span></span>
<span id="cb529-69"><a href="#cb529-69" aria-hidden="true"></a>        sVR = strtok (NULL, <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>);            <span class="co">/* Get Version */</span></span>
<span id="cb529-70"><a href="#cb529-70" aria-hidden="true"></a>        sST = strtok (NULL, <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>);            <span class="co">/* Get Stop Number */</span></span>
<span id="cb529-71"><a href="#cb529-71" aria-hidden="true"></a>        sVI = strtok (NULL, <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>);            <span class="co">/* Get Vehicle */</span></span>
<span id="cb529-72"><a href="#cb529-72" aria-hidden="true"></a>        sDT = strtok (NULL, <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>);            <span class="co">/* Get Date */</span></span>
<span id="cb529-73"><a href="#cb529-73" aria-hidden="true"></a>        sTM = strtok (NULL, <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>);            <span class="co">/* Get Time */</span></span>
<span id="cb529-74"><a href="#cb529-74" aria-hidden="true"></a></span>
<span id="cb529-75"><a href="#cb529-75" aria-hidden="true"></a>        <span class="co">/* ACTUAL INSERT WILL GO HERE */</span></span>
<span id="cb529-76"><a href="#cb529-76" aria-hidden="true"></a></span>
<span id="cb529-77"><a href="#cb529-77" aria-hidden="true"></a>        n++;</span>
<span id="cb529-78"><a href="#cb529-78" aria-hidden="true"></a>    }</span>
<span id="cb529-79"><a href="#cb529-79" aria-hidden="true"></a>    fclose (pFile);</span>
<span id="cb529-80"><a href="#cb529-80" aria-hidden="true"></a></span>
<span id="cb529-81"><a href="#cb529-81" aria-hidden="true"></a>    printf(<span class="st">&quot;Imported %d records in %4.2f seconds</span><span class="sc">\n</span><span class="st">&quot;</span>, n, (clock() - cStartClock) / (<span class="dt">double</span>)CLOCKS_PER_SEC);</span>
<span id="cb529-82"><a href="#cb529-82" aria-hidden="true"></a></span>
<span id="cb529-83"><a href="#cb529-83" aria-hidden="true"></a>    sqlite3_close(db);</span>
<span id="cb529-84"><a href="#cb529-84" aria-hidden="true"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb529-85"><a href="#cb529-85" aria-hidden="true"></a>}</span></code></pre></div>
<hr>
<h5>
The “Control”
</h2>
<p>Running the code as-is doesn’t actually perform any database operations, but it will give us an idea of how fast the raw C file I/O and string processing operations are.</p>
<blockquote>
<p>
Imported 864913 records in 0.94 seconds
</p>
</blockquote>
<p>Great! We can do 920,000 inserts per second, provided we don’t actually do any inserts :-)</p>
<hr>
<h5>
The “Worst-Case-Scenario”
</h2>
<p>We’re going to generate the SQL string using the values read from the file and invoke that SQL operation using sqlite3_exec:</p>
<div class="sourceCode" id="cb530"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb530-1"><a href="#cb530-1" aria-hidden="true"></a>sprintf(sSQL, <span class="st">&quot;INSERT INTO TTC VALUES (NULL, &#39;%s&#39;, &#39;%s&#39;, &#39;%s&#39;, &#39;%s&#39;, &#39;%s&#39;, &#39;%s&#39;, &#39;%s&#39;)&quot;</span>, sRT, sBR, sVR, sST, sVI, sDT, sTM);</span>
<span id="cb530-2"><a href="#cb530-2" aria-hidden="true"></a>sqlite3_exec(db, sSQL, NULL, NULL, &amp;sErrMsg);</span></code></pre></div>
<p>This is going to be slow because the SQL will be compiled into VDBE code for every insert and every insert will happen in its own transaction. <em>How slow?</em></p>
<blockquote>
<p>
Imported 864913 records in 9933.61 seconds
</p>
</blockquote>
<p>Yikes! 2 hours and 45 minutes! That’s only <strong>85 inserts per second.</strong></p>
<h5>
Using a Transaction
</h2>
<p>By default, SQLite will evaluate every INSERT / UPDATE statement within a unique transaction. If performing a large number of inserts, it’s advisable to wrap your operation in a transaction:</p>
<div class="sourceCode" id="cb531"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb531-1"><a href="#cb531-1" aria-hidden="true"></a>sqlite3_exec(db, <span class="st">&quot;BEGIN TRANSACTION&quot;</span>, NULL, NULL, &amp;sErrMsg);</span>
<span id="cb531-2"><a href="#cb531-2" aria-hidden="true"></a></span>
<span id="cb531-3"><a href="#cb531-3" aria-hidden="true"></a>pFile = fopen (INPUTDATA,<span class="st">&quot;r&quot;</span>);</span>
<span id="cb531-4"><a href="#cb531-4" aria-hidden="true"></a><span class="cf">while</span> (!feof(pFile)) {</span>
<span id="cb531-5"><a href="#cb531-5" aria-hidden="true"></a></span>
<span id="cb531-6"><a href="#cb531-6" aria-hidden="true"></a>    ...</span>
<span id="cb531-7"><a href="#cb531-7" aria-hidden="true"></a></span>
<span id="cb531-8"><a href="#cb531-8" aria-hidden="true"></a>}</span>
<span id="cb531-9"><a href="#cb531-9" aria-hidden="true"></a>fclose (pFile);</span>
<span id="cb531-10"><a href="#cb531-10" aria-hidden="true"></a></span>
<span id="cb531-11"><a href="#cb531-11" aria-hidden="true"></a>sqlite3_exec(db, <span class="st">&quot;END TRANSACTION&quot;</span>, NULL, NULL, &amp;sErrMsg);</span></code></pre></div>
<blockquote>
<p>
Imported 864913 records in 38.03 seconds
</p>
</blockquote>
<p>That’s better. Simply wrapping all of our inserts in a single transaction improved our performance to <strong>23,000 inserts per second.</strong></p>
<h5>
Using a Prepared Statement
</h2>
<p>Using a transaction was a huge improvement, but recompiling the SQL statement for every insert doesn’t make sense if we using the same SQL over-and-over. Let’s use <code>sqlite3_prepare_v2</code> to compile our SQL statement once and then bind our parameters to that statement using <code>sqlite3_bind_text</code>:</p>
<div class="sourceCode" id="cb532"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb532-1"><a href="#cb532-1" aria-hidden="true"></a><span class="co">/* Open input file and import into the database */</span></span>
<span id="cb532-2"><a href="#cb532-2" aria-hidden="true"></a>cStartClock = clock();</span>
<span id="cb532-3"><a href="#cb532-3" aria-hidden="true"></a></span>
<span id="cb532-4"><a href="#cb532-4" aria-hidden="true"></a>sprintf(sSQL, <span class="st">&quot;INSERT INTO TTC VALUES (NULL, @RT, @BR, @VR, @ST, @VI, @DT, @TM)&quot;</span>);</span>
<span id="cb532-5"><a href="#cb532-5" aria-hidden="true"></a>sqlite3_prepare_v2(db,  sSQL, BUFFER_SIZE, &amp;stmt, &amp;tail);</span>
<span id="cb532-6"><a href="#cb532-6" aria-hidden="true"></a></span>
<span id="cb532-7"><a href="#cb532-7" aria-hidden="true"></a>sqlite3_exec(db, <span class="st">&quot;BEGIN TRANSACTION&quot;</span>, NULL, NULL, &amp;sErrMsg);</span>
<span id="cb532-8"><a href="#cb532-8" aria-hidden="true"></a></span>
<span id="cb532-9"><a href="#cb532-9" aria-hidden="true"></a>pFile = fopen (INPUTDATA,<span class="st">&quot;r&quot;</span>);</span>
<span id="cb532-10"><a href="#cb532-10" aria-hidden="true"></a><span class="cf">while</span> (!feof(pFile)) {</span>
<span id="cb532-11"><a href="#cb532-11" aria-hidden="true"></a></span>
<span id="cb532-12"><a href="#cb532-12" aria-hidden="true"></a>    fgets (sInputBuf, BUFFER_SIZE, pFile);</span>
<span id="cb532-13"><a href="#cb532-13" aria-hidden="true"></a></span>
<span id="cb532-14"><a href="#cb532-14" aria-hidden="true"></a>    sRT = strtok (sInputBuf, <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>);   <span class="co">/* Get Route */</span></span>
<span id="cb532-15"><a href="#cb532-15" aria-hidden="true"></a>    sBR = strtok (NULL, <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>);        <span class="co">/* Get Branch */</span></span>
<span id="cb532-16"><a href="#cb532-16" aria-hidden="true"></a>    sVR = strtok (NULL, <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>);        <span class="co">/* Get Version */</span></span>
<span id="cb532-17"><a href="#cb532-17" aria-hidden="true"></a>    sST = strtok (NULL, <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>);        <span class="co">/* Get Stop Number */</span></span>
<span id="cb532-18"><a href="#cb532-18" aria-hidden="true"></a>    sVI = strtok (NULL, <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>);        <span class="co">/* Get Vehicle */</span></span>
<span id="cb532-19"><a href="#cb532-19" aria-hidden="true"></a>    sDT = strtok (NULL, <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>);        <span class="co">/* Get Date */</span></span>
<span id="cb532-20"><a href="#cb532-20" aria-hidden="true"></a>    sTM = strtok (NULL, <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>);        <span class="co">/* Get Time */</span></span>
<span id="cb532-21"><a href="#cb532-21" aria-hidden="true"></a></span>
<span id="cb532-22"><a href="#cb532-22" aria-hidden="true"></a>    sqlite3_bind_text(stmt, <span class="dv">1</span>, sRT, -<span class="dv">1</span>, SQLITE_TRANSIENT);</span>
<span id="cb532-23"><a href="#cb532-23" aria-hidden="true"></a>    sqlite3_bind_text(stmt, <span class="dv">2</span>, sBR, -<span class="dv">1</span>, SQLITE_TRANSIENT);</span>
<span id="cb532-24"><a href="#cb532-24" aria-hidden="true"></a>    sqlite3_bind_text(stmt, <span class="dv">3</span>, sVR, -<span class="dv">1</span>, SQLITE_TRANSIENT);</span>
<span id="cb532-25"><a href="#cb532-25" aria-hidden="true"></a>    sqlite3_bind_text(stmt, <span class="dv">4</span>, sST, -<span class="dv">1</span>, SQLITE_TRANSIENT);</span>
<span id="cb532-26"><a href="#cb532-26" aria-hidden="true"></a>    sqlite3_bind_text(stmt, <span class="dv">5</span>, sVI, -<span class="dv">1</span>, SQLITE_TRANSIENT);</span>
<span id="cb532-27"><a href="#cb532-27" aria-hidden="true"></a>    sqlite3_bind_text(stmt, <span class="dv">6</span>, sDT, -<span class="dv">1</span>, SQLITE_TRANSIENT);</span>
<span id="cb532-28"><a href="#cb532-28" aria-hidden="true"></a>    sqlite3_bind_text(stmt, <span class="dv">7</span>, sTM, -<span class="dv">1</span>, SQLITE_TRANSIENT);</span>
<span id="cb532-29"><a href="#cb532-29" aria-hidden="true"></a></span>
<span id="cb532-30"><a href="#cb532-30" aria-hidden="true"></a>    sqlite3_step(stmt);</span>
<span id="cb532-31"><a href="#cb532-31" aria-hidden="true"></a></span>
<span id="cb532-32"><a href="#cb532-32" aria-hidden="true"></a>    sqlite3_clear_bindings(stmt);</span>
<span id="cb532-33"><a href="#cb532-33" aria-hidden="true"></a>    sqlite3_reset(stmt);</span>
<span id="cb532-34"><a href="#cb532-34" aria-hidden="true"></a></span>
<span id="cb532-35"><a href="#cb532-35" aria-hidden="true"></a>    n++;</span>
<span id="cb532-36"><a href="#cb532-36" aria-hidden="true"></a>}</span>
<span id="cb532-37"><a href="#cb532-37" aria-hidden="true"></a>fclose (pFile);</span>
<span id="cb532-38"><a href="#cb532-38" aria-hidden="true"></a></span>
<span id="cb532-39"><a href="#cb532-39" aria-hidden="true"></a>sqlite3_exec(db, <span class="st">&quot;END TRANSACTION&quot;</span>, NULL, NULL, &amp;sErrMsg);</span>
<span id="cb532-40"><a href="#cb532-40" aria-hidden="true"></a></span>
<span id="cb532-41"><a href="#cb532-41" aria-hidden="true"></a>printf(<span class="st">&quot;Imported %d records in %4.2f seconds</span><span class="sc">\n</span><span class="st">&quot;</span>, n, (clock() - cStartClock) / (<span class="dt">double</span>)CLOCKS_PER_SEC);</span>
<span id="cb532-42"><a href="#cb532-42" aria-hidden="true"></a></span>
<span id="cb532-43"><a href="#cb532-43" aria-hidden="true"></a>sqlite3_finalize(stmt);</span>
<span id="cb532-44"><a href="#cb532-44" aria-hidden="true"></a>sqlite3_close(db);</span>
<span id="cb532-45"><a href="#cb532-45" aria-hidden="true"></a></span>
<span id="cb532-46"><a href="#cb532-46" aria-hidden="true"></a><span class="cf">return</span> <span class="dv">0</span>;</span></code></pre></div>
<blockquote>
<p>
Imported 864913 records in 16.27 seconds
</p>
</blockquote>
<p>Nice! There’s a little bit more code (don’t forget to call <code>sqlite3_clear_bindings</code> and <code>sqlite3_reset</code>), but we’ve more than doubled our performance to <strong>53,000 inserts per second.</strong></p>
<h5>
PRAGMA synchronous = OFF
</h2>
<p>By default, SQLite will pause after issuing a OS-level write command. This guarantees that the data is written to the disk. By setting <code>synchronous = OFF</code>, we are instructing SQLite to simply hand-off the data to the OS for writing and then continue. There’s a chance that the database file may become corrupted if the computer suffers a catastrophic crash (or power failure) before the data is written to the platter:</p>
<div class="sourceCode" id="cb533"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb533-1"><a href="#cb533-1" aria-hidden="true"></a><span class="co">/* Open the database and create the schema */</span></span>
<span id="cb533-2"><a href="#cb533-2" aria-hidden="true"></a>sqlite3_open(DATABASE, &amp;db);</span>
<span id="cb533-3"><a href="#cb533-3" aria-hidden="true"></a>sqlite3_exec(db, TABLE, NULL, NULL, &amp;sErrMsg);</span>
<span id="cb533-4"><a href="#cb533-4" aria-hidden="true"></a>sqlite3_exec(db, <span class="st">&quot;PRAGMA synchronous = OFF&quot;</span>, NULL, NULL, &amp;sErrMsg);</span></code></pre></div>
<blockquote>
<p>
Imported 864913 records in 12.41 seconds
</p>
</blockquote>
<p>The improvements are now smaller, but we’re up to <strong>69,600 inserts per second.</strong></p>
<h5>
PRAGMA journal_mode = MEMORY
</h2>
<p>Consider storing the rollback journal in memory by evaluating <code>PRAGMA journal_mode = MEMORY</code>. Your transaction will be faster, but if you lose power or your program crashes during a transaction you database could be left in a corrupt state with a partially-completed transaction:</p>
<div class="sourceCode" id="cb534"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb534-1"><a href="#cb534-1" aria-hidden="true"></a><span class="co">/* Open the database and create the schema */</span></span>
<span id="cb534-2"><a href="#cb534-2" aria-hidden="true"></a>sqlite3_open(DATABASE, &amp;db);</span>
<span id="cb534-3"><a href="#cb534-3" aria-hidden="true"></a>sqlite3_exec(db, TABLE, NULL, NULL, &amp;sErrMsg);</span>
<span id="cb534-4"><a href="#cb534-4" aria-hidden="true"></a>sqlite3_exec(db, <span class="st">&quot;PRAGMA journal_mode = MEMORY&quot;</span>, NULL, NULL, &amp;sErrMsg);</span></code></pre></div>
<blockquote>
<p>
Imported 864913 records in 13.50 seconds
</p>
</blockquote>
<p>A little slower than the previous optimization at <strong>64,000 inserts per second.</strong></p>
<h5>
PRAGMA synchronous = OFF <em>and</em> PRAGMA journal_mode = MEMORY
</h2>
<p>Let’s combine the previous two optimizations. It’s a little more risky (in case of a crash), but we’re just importing data (not running a bank):</p>
<div class="sourceCode" id="cb535"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb535-1"><a href="#cb535-1" aria-hidden="true"></a><span class="co">/* Open the database and create the schema */</span></span>
<span id="cb535-2"><a href="#cb535-2" aria-hidden="true"></a>sqlite3_open(DATABASE, &amp;db);</span>
<span id="cb535-3"><a href="#cb535-3" aria-hidden="true"></a>sqlite3_exec(db, TABLE, NULL, NULL, &amp;sErrMsg);</span>
<span id="cb535-4"><a href="#cb535-4" aria-hidden="true"></a>sqlite3_exec(db, <span class="st">&quot;PRAGMA synchronous = OFF&quot;</span>, NULL, NULL, &amp;sErrMsg);</span>
<span id="cb535-5"><a href="#cb535-5" aria-hidden="true"></a>sqlite3_exec(db, <span class="st">&quot;PRAGMA journal_mode = MEMORY&quot;</span>, NULL, NULL, &amp;sErrMsg);</span></code></pre></div>
<blockquote>
<p>
Imported 864913 records in 12.00 seconds
</p>
</blockquote>
<p>Fantastic! We’re able to do <strong>72,000 inserts per second.</strong></p>
<h5>
Using an In-Memory Database
</h2>
<p>Just for kicks, let’s build upon all of the previous optimizations and redefine the database filename so we’re working entirely in RAM:</p>
<div class="sourceCode" id="cb536"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb536-1"><a href="#cb536-1" aria-hidden="true"></a></span>
<span id="cb536-2"><a href="#cb536-2" aria-hidden="true"></a><span class="pp">#define DATABASE &quot;:memory:&quot;</span></span></code></pre></div>
<blockquote>
<p>
Imported 864913 records in 10.94 seconds
</p>
</blockquote>
<p>It’s not super-practical to store our database in RAM, but it’s impressive that we can perform <strong>79,000 inserts per second.</strong></p>
<h5>
Refactoring C Code
</h2>
<p>Although not specifically an SQLite improvement, I don’t like the extra <code>char*</code> assignment operations in the <code>while</code> loop. Let’s quickly refactor that code to pass the output of <code>strtok()</code> directly into <code>sqlite3_bind_text()</code>, and let the compiler try to speed things up for us:</p>
<div class="sourceCode" id="cb537"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb537-1"><a href="#cb537-1" aria-hidden="true"></a>pFile = fopen (INPUTDATA,<span class="st">&quot;r&quot;</span>);</span>
<span id="cb537-2"><a href="#cb537-2" aria-hidden="true"></a><span class="cf">while</span> (!feof(pFile)) {</span>
<span id="cb537-3"><a href="#cb537-3" aria-hidden="true"></a></span>
<span id="cb537-4"><a href="#cb537-4" aria-hidden="true"></a>    fgets (sInputBuf, BUFFER_SIZE, pFile);</span>
<span id="cb537-5"><a href="#cb537-5" aria-hidden="true"></a></span>
<span id="cb537-6"><a href="#cb537-6" aria-hidden="true"></a>    sqlite3_bind_text(stmt, <span class="dv">1</span>, strtok (sInputBuf, <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>), -<span class="dv">1</span>, SQLITE_TRANSIENT); <span class="co">/* Get Route */</span></span>
<span id="cb537-7"><a href="#cb537-7" aria-hidden="true"></a>    sqlite3_bind_text(stmt, <span class="dv">2</span>, strtok (NULL, <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>), -<span class="dv">1</span>, SQLITE_TRANSIENT);    <span class="co">/* Get Branch */</span></span>
<span id="cb537-8"><a href="#cb537-8" aria-hidden="true"></a>    sqlite3_bind_text(stmt, <span class="dv">3</span>, strtok (NULL, <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>), -<span class="dv">1</span>, SQLITE_TRANSIENT);    <span class="co">/* Get Version */</span></span>
<span id="cb537-9"><a href="#cb537-9" aria-hidden="true"></a>    sqlite3_bind_text(stmt, <span class="dv">4</span>, strtok (NULL, <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>), -<span class="dv">1</span>, SQLITE_TRANSIENT);    <span class="co">/* Get Stop Number */</span></span>
<span id="cb537-10"><a href="#cb537-10" aria-hidden="true"></a>    sqlite3_bind_text(stmt, <span class="dv">5</span>, strtok (NULL, <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>), -<span class="dv">1</span>, SQLITE_TRANSIENT);    <span class="co">/* Get Vehicle */</span></span>
<span id="cb537-11"><a href="#cb537-11" aria-hidden="true"></a>    sqlite3_bind_text(stmt, <span class="dv">6</span>, strtok (NULL, <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>), -<span class="dv">1</span>, SQLITE_TRANSIENT);    <span class="co">/* Get Date */</span></span>
<span id="cb537-12"><a href="#cb537-12" aria-hidden="true"></a>    sqlite3_bind_text(stmt, <span class="dv">7</span>, strtok (NULL, <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>), -<span class="dv">1</span>, SQLITE_TRANSIENT);    <span class="co">/* Get Time */</span></span>
<span id="cb537-13"><a href="#cb537-13" aria-hidden="true"></a></span>
<span id="cb537-14"><a href="#cb537-14" aria-hidden="true"></a>    sqlite3_step(stmt);        <span class="co">/* Execute the SQL Statement */</span></span>
<span id="cb537-15"><a href="#cb537-15" aria-hidden="true"></a>    sqlite3_clear_bindings(stmt);    <span class="co">/* Clear bindings */</span></span>
<span id="cb537-16"><a href="#cb537-16" aria-hidden="true"></a>    sqlite3_reset(stmt);        <span class="co">/* Reset VDBE */</span></span>
<span id="cb537-17"><a href="#cb537-17" aria-hidden="true"></a></span>
<span id="cb537-18"><a href="#cb537-18" aria-hidden="true"></a>    n++;</span>
<span id="cb537-19"><a href="#cb537-19" aria-hidden="true"></a>}</span>
<span id="cb537-20"><a href="#cb537-20" aria-hidden="true"></a>fclose (pFile);</span></code></pre></div>
<p><strong>Note: We are back to using a real database file. In-memory databases are fast, but not necessarily practical</strong></p>
<blockquote>
<p>
Imported 864913 records in 8.94 seconds
</p>
</blockquote>
<p>A slight refactoring to the string processing code used in our parameter binding has allowed us to perform <strong>96,700 inserts per second.</strong> I think it’s safe to say that this is <em>plenty fast</em>. As we start to tweak other variables (i.e. page size, index creation, etc.) this will be our benchmark.</p>
<hr>
<h5>
Summary (so far)
</h2>
<p><em>I hope you’re still with me!</em> The reason we started down this road is that bulk-insert performance varies so wildly with SQLite, and it’s not always obvious what changes need to be made to speed-up our operation. Using the same compiler (and compiler options), the same version of SQLite and the same data we’ve optimized our code and our usage of SQLite to go <strong>from a worst-case scenario of 85 inserts per second to over 96,000 inserts per second!</strong></p>
<hr>
<h5>
CREATE INDEX then INSERT vs. INSERT then CREATE INDEX
</h2>
<p>Before we start measuring <code>SELECT</code> performance, we know that we’ll be creating indices. It’s been suggested in one of the answers below that when doing bulk inserts, it is faster to create the index after the data has been inserted (as opposed to creating the index first then inserting the data). Let’s try:</p>
<p><strong>Create Index then Insert Data</strong></p>
<div class="sourceCode" id="cb538"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb538-1"><a href="#cb538-1" aria-hidden="true"></a>sqlite3_exec(db, <span class="st">&quot;CREATE  INDEX &#39;TTC_Stop_Index&#39; ON &#39;TTC&#39; (&#39;Stop&#39;)&quot;</span>, NULL, NULL, &amp;sErrMsg);</span>
<span id="cb538-2"><a href="#cb538-2" aria-hidden="true"></a>sqlite3_exec(db, <span class="st">&quot;BEGIN TRANSACTION&quot;</span>, NULL, NULL, &amp;sErrMsg);</span>
<span id="cb538-3"><a href="#cb538-3" aria-hidden="true"></a>...</span></code></pre></div>
<blockquote>
<p>
Imported 864913 records in 18.13 seconds
</p>
</blockquote>
<p><strong>Insert Data then Create Index</strong></p>
<div class="sourceCode" id="cb539"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb539-1"><a href="#cb539-1" aria-hidden="true"></a>...</span>
<span id="cb539-2"><a href="#cb539-2" aria-hidden="true"></a>sqlite3_exec(db, <span class="st">&quot;END TRANSACTION&quot;</span>, NULL, NULL, &amp;sErrMsg);</span>
<span id="cb539-3"><a href="#cb539-3" aria-hidden="true"></a>sqlite3_exec(db, <span class="st">&quot;CREATE  INDEX &#39;TTC_Stop_Index&#39; ON &#39;TTC&#39; (&#39;Stop&#39;)&quot;</span>, NULL, NULL, &amp;sErrMsg);</span></code></pre></div>
<blockquote>
<p>
Imported 864913 records in 13.66 seconds
</p>
</blockquote>
<p>As expected, bulk-inserts are slower if one column is indexed, but it does make a difference if the index is created after the data is inserted. Our no-index baseline is 96,000 inserts per second. <strong>Creating the index first then inserting data gives us 47,700 inserts per second, whereas inserting the data first then creating the index gives us 63,300 inserts per second.</strong></p>
<hr>
<p>I’d gladly take suggestions for other scenarios to try… And will be compiling similar data for SELECT queries soon.</p>
</section>
<section id="answer-accepted-score-746" class="level4">
<h4>Answer accepted (score 746)</h4>
<p>Several tips:</p>
<ol>
<li>
Put inserts/updates in a transaction.
</li>
<li>
For older versions of SQLite - Consider a less paranoid journal mode (<code>pragma journal_mode</code>). There is <code>NORMAL</code>, and then there is <code>OFF</code>, which can significantly increase insert speed if you’re not too worried about the database possibly getting corrupted if the OS crashes. If your application crashes the data should be fine. Note that in newer versions, the <code>OFF/MEMORY</code> settings are not safe for application level crashes.
</li>
<li>
Playing with page sizes makes a difference as well (<code>PRAGMA page_size</code>). Having larger page sizes can make reads and writes go a bit faster as larger pages are held in memory. Note that more memory will be used for your database.
</li>
<li>
If you have indices, consider calling <code>CREATE INDEX</code> after doing all your inserts. This is significantly faster than creating the index and then doing your inserts.
</li>
<li>
You have to be quite careful if you have concurrent access to SQLite, as the whole database is locked when writes are done, and although multiple readers are possible, writes will be locked out. This has been improved somewhat with the addition of a WAL in newer SQLite versions.
</li>
<li>
Take advantage of saving space…smaller databases go faster. For instance, if you have key value pairs, try making the key an <code>INTEGER PRIMARY KEY</code> if possible, which will replace the implied unique row number column in the table.
</li>
<li>
If you are using multiple threads, you can try using the <a href="http://sqlite.org/c3ref/enable_shared_cache.html" rel="noreferrer">shared page cache</a>, which will allow loaded pages to be shared between threads, which can avoid expensive I/O calls.
</li>
<li>
<a href="https://stackoverflow.com/q/5431941/6850771">Don’t use <code>!feof(file)</code>!</a>
</li>
</ol>
<p>I’ve also asked similar questions <a href="https://stackoverflow.com/questions/784173/what-are-the-performance-characteristics-of-sqlite-with-very-large-database-files">here</a> and <a href="https://stackoverflow.com/questions/768708/are-there-known-issues-with-using-sqlite-and-file-locking-on-different-platforms">here</a>.</p>
</section>
<section id="answer-2-score-129" class="level4">
<h4>Answer 2 (score 129)</h4>
<p>Try using <code>SQLITE_STATIC</code> instead of <code>SQLITE_TRANSIENT</code> for those inserts.</p>
<p><code>SQLITE_TRANSIENT</code> will cause SQLite to copy the string data before returning.</p>
<p><code>SQLITE_STATIC</code> tells it that the memory address you gave it will be valid until the query has been performed (which in this loop is always the case). This will save you several allocate, copy and deallocate operations per loop. Possibly a large improvement.</p>
</section>
<section id="answer-3-score-97-1" class="level4">
<h4>Answer 3 (score 97)</h4>
<p><strong>Avoid <a href="https://www.sqlite.org/c3ref/clear_bindings.html" rel="nofollow noreferrer"><code>sqlite3_clear_bindings(stmt)</code></a>.</strong></p>
<p>The code in the test sets the bindings every time through which should be enough.</p>
<p>The <a href="https://www.sqlite.org/cintro.html" rel="nofollow noreferrer">C API intro</a> from the SQLite docs says:</p>
<blockquote>
<p>
Prior to calling <a href="https://www.sqlite.org/c3ref/step.html" rel="nofollow noreferrer">sqlite3_step()</a> for the first time or immediately after <a href="https://www.sqlite.org/c3ref/reset.html" rel="nofollow noreferrer">sqlite3_reset()</a>, the application can invoke the <a href="https://www.sqlite.org/c3ref/bind_blob.html" rel="nofollow noreferrer">sqlite3_bind()</a> interfaces to attach values to the parameters. Each call to <a href="https://www.sqlite.org/c3ref/bind_blob.html" rel="nofollow noreferrer">sqlite3_bind()</a> overrides prior bindings on the same parameter
</p>
</blockquote>
<p>There is nothing in the docs for <a href="https://www.sqlite.org/c3ref/clear_bindings.html" rel="nofollow noreferrer"><code>sqlite3_clear_bindings</code></a> saying you must call it in addition to simply setting the bindings.</p>
<p>More detail: <a href="http://www.hoogli.com/blogs/micro/index.html
#Avoid_sqlite3_clear_bindings%28%29" rel="nofollow noreferrer">Avoid_sqlite3_clear_bindings()</a></p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="strdup---what-does-it-do-in-c-score-379908-in-2013" class="level3">
<h3>87: strdup() - what does it do in C? (score <a href="https://stackoverflow.com/q/252782.html">379908</a> in 2013)</h3>
<section id="question-85" class="level4">
<h4>Question</h4>
<p>What is the purpose of the <code>strdup()</code> function in C?</p>
</section>
<section id="answer-accepted-score-356" class="level4">
<h4>Answer accepted (score 356)</h4>
<p>Exactly what it sounds like, assuming you’re used to the abbreviated way in which C and UNIX assigns words, it <strong><em>duplicates strings</em></strong> :-)</p>
<p>Keeping in mind it’s actually not part of the ISO C standard itself<sup>(a)</sup> (it’s a POSIX thing), it’s effectively doing the same as the following code:</p>
<div class="sourceCode" id="cb540"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb540-1"><a href="#cb540-1" aria-hidden="true"></a><span class="dt">char</span> *strdup(<span class="dt">const</span> <span class="dt">char</span> *src) {</span>
<span id="cb540-2"><a href="#cb540-2" aria-hidden="true"></a>    <span class="dt">char</span> *dst = malloc(strlen (src) + <span class="dv">1</span>);  <span class="co">// Space for length plus nul</span></span>
<span id="cb540-3"><a href="#cb540-3" aria-hidden="true"></a>    <span class="cf">if</span> (dst == NULL) <span class="cf">return</span> NULL;          <span class="co">// No memory</span></span>
<span id="cb540-4"><a href="#cb540-4" aria-hidden="true"></a>    strcpy(dst, src);                      <span class="co">// Copy the characters</span></span>
<span id="cb540-5"><a href="#cb540-5" aria-hidden="true"></a>    <span class="cf">return</span> dst;                            <span class="co">// Return the new string</span></span>
<span id="cb540-6"><a href="#cb540-6" aria-hidden="true"></a>}</span></code></pre></div>
<p>In other words:</p>
<ol>
<li>
<p>
It tries to allocate enough memory to hold the old string (plus a ‘\0’ character to mark the end of the string).
</p>
</li>
<li>
<p>
If the allocation failed, it sets <code>errno</code> to <code>ENOMEM</code> and returns <code>NULL</code> immediately. Setting of <code>errno</code> to <code>ENOMEM</code> is something <code>malloc</code> does in POSIX so we don’t need to explicitly do it in our <code>strdup</code>. If you’re <em>not</em> POSIX compliant, ISO C doesn’t actually mandate the existence of <code>ENOMEM</code> so I haven’t included that here<sup>(b)</sup>.
</p>
</li>
<li>
<p>
Otherwise the allocation worked so we copy the old string to the new string<sup>(c)</sup> and return the new address (which the caller is responsible for freeing at some point).
</p>
</li>
</ol>
<p>Keep in mind that’s the conceptual definition. Any library writer worth their salary may have provided heavily optimised code targeting the particular processor being used.</p>
<hr>
<p><sup>(a)</sup> However, functions starting with <code>str</code> and a lower case letter are reserved by the standard for future directions. From <code>C11 7.1.3 Reserved identifiers</code>:</p>
<blockquote>
Each header declares or defines all identifiers listed in its associated sub-clause, and *optionally declares or defines identifiers listed in its associated future library directions sub-clause.**
</blockquote>
<p>The future directions for <code>string.h</code> can be found in <code>C11 7.31.13 String handling &amp;lt;string.h&amp;gt;</code>:</p>
<blockquote>
Function names that begin with <code>str</code>, <code>mem</code>, or <code>wcs</code> and a lowercase letter may be added to the declarations in the <code>&amp;lt;string.h&amp;gt;</code> header.
</blockquote>
<p>So you should probably call it something else if you want to be safe.</p>
<hr>
<p><sup>(b)</sup> The change would basically be replacing <code>if (d == NULL) return NULL;</code> with:</p>
<div class="sourceCode" id="cb541"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb541-1"><a href="#cb541-1" aria-hidden="true"></a><span class="cf">if</span> (d == NULL) {</span>
<span id="cb541-2"><a href="#cb541-2" aria-hidden="true"></a>    errno = ENOMEM;</span>
<span id="cb541-3"><a href="#cb541-3" aria-hidden="true"></a>    <span class="cf">return</span> NULL;</span>
<span id="cb541-4"><a href="#cb541-4" aria-hidden="true"></a>}</span></code></pre></div>
<hr>
<p><sup>(c)</sup> Note that I use <code>strcpy</code> for that since that clearly shows the intent. In some implementations, it may be faster (since you already know the length) to use <code>memcpy</code>, as they may allow for transferring the data in larger chunks, or in parallel. Or it may not :-) Optimisation mantra #1: “measure, don’t guess”.</p>
<p>In any case, should you decide to go that route, you would do something like:</p>
<div class="sourceCode" id="cb542"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb542-1"><a href="#cb542-1" aria-hidden="true"></a><span class="dt">char</span> *strdup(<span class="dt">const</span> <span class="dt">char</span> *src) {</span>
<span id="cb542-2"><a href="#cb542-2" aria-hidden="true"></a>    <span class="dt">size_t</span> len = strlen(src) + <span class="dv">1</span>;       <span class="co">// String plus &#39;\0&#39;</span></span>
<span id="cb542-3"><a href="#cb542-3" aria-hidden="true"></a>    <span class="dt">char</span> *dst = malloc(len);            <span class="co">// Allocate space</span></span>
<span id="cb542-4"><a href="#cb542-4" aria-hidden="true"></a>    <span class="cf">if</span> (dst == NULL) <span class="cf">return</span> NULL;       <span class="co">// No memory</span></span>
<span id="cb542-5"><a href="#cb542-5" aria-hidden="true"></a>    memcpy (dst, src, len);             <span class="co">// Copy the block</span></span>
<span id="cb542-6"><a href="#cb542-6" aria-hidden="true"></a>    <span class="cf">return</span> dst;                         <span class="co">// Return the new string</span></span>
<span id="cb542-7"><a href="#cb542-7" aria-hidden="true"></a>}</span></code></pre></div>
</section>
<section id="answer-2-score-85" class="level4">
<h4>Answer 2 (score 85)</h4>
<div class="sourceCode" id="cb543"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb543-1"><a href="#cb543-1" aria-hidden="true"></a><span class="dt">char</span> * strdup(<span class="dt">const</span> <span class="dt">char</span> * s)</span>
<span id="cb543-2"><a href="#cb543-2" aria-hidden="true"></a>{</span>
<span id="cb543-3"><a href="#cb543-3" aria-hidden="true"></a>  <span class="dt">size_t</span> len = <span class="dv">1</span>+strlen(s);</span>
<span id="cb543-4"><a href="#cb543-4" aria-hidden="true"></a>  <span class="dt">char</span> *p = malloc(len);</span>
<span id="cb543-5"><a href="#cb543-5" aria-hidden="true"></a></span>
<span id="cb543-6"><a href="#cb543-6" aria-hidden="true"></a>  <span class="cf">return</span> p ? memcpy(p, s, len) : NULL;</span>
<span id="cb543-7"><a href="#cb543-7" aria-hidden="true"></a>}</span></code></pre></div>
<p>Maybe the code is a bit faster than with <code>strcpy()</code> as the <code>\0</code> char doesn’t need to be searched again (It already was with <code>strlen()</code>).</p>
</section>
<section id="answer-3-score-51-3" class="level4">
<h4>Answer 3 (score 51)</h4>
<p>No point repeating the other answers, but please note that <code>strdup()</code> can do anything it wants from a C perspective, since it is not part of any C standard. It is however defined by POSIX.1-2001.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="c-printf-a-float-value-score-379409-in-2012" class="level3">
<h3>88: C: printf a float value (score <a href="https://stackoverflow.com/q/8345581.html">379409</a> in 2012)</h3>
<section id="question-86" class="level4">
<h4>Question</h4>
<p>I want to print a float value which has 2 integer digits and 6 decimal digits after the comma. If I just use <code>printf("%f", myFloat)</code> I’m getting a truncated value.</p>
<p>I don’t know if this always happens in C, or it’s just because I’m using C for microcontrollers (CCS to be exact), but at the reference it tells that <code>%f</code> get just that: a truncated float.</p>
<p>If my float is <code>44.556677</code>, I’m printing out <code>"44.55"</code>, only the first two decimal digits.</p>
<p>So the question is… how can I print my 6 digits (and just the six of them, just in case I’m having zeros after that or something)?</p>
</section>
<section id="answer-accepted-score-113" class="level4">
<h4>Answer accepted (score 113)</h4>
<p>You can do it like this:</p>
<div class="sourceCode" id="cb544"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb544-1"><a href="#cb544-1" aria-hidden="true"></a>printf(<span class="st">&quot;%.6f&quot;</span>, myFloat);</span></code></pre></div>
<p>6 represents the number of digits after the dot.</p>
<p>P.S. Thanks <strong><span class="citation" data-cites="caf">@caf</span></strong> for correcting me.</p>
</section>
<section id="answer-2-score-15" class="level4">
<h4>Answer 2 (score 15)</h4>
<p><code>printf("%9.6f", myFloat)</code> specifies a format with 9 total characters: 2 digits before the dot, the dot itself, and six digits after the dot.</p>
</section>
<section id="answer-3-score-6-2" class="level4">
<h4>Answer 3 (score 6)</h4>
<div class="sourceCode" id="cb545"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb545-1"><a href="#cb545-1" aria-hidden="true"></a>printf(<span class="st">&quot;%.&lt;number&gt;f&quot;</span>, myFloat) <span class="co">//where &lt;number&gt; - digit after comma</span></span></code></pre></div>
<p><a href="http://www.cplusplus.com/reference/clibrary/cstdio/printf/" rel="nofollow noreferrer">http://www.cplusplus.com/reference/clibrary/cstdio/printf/</a></p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="unit-testing-c-code-score-375093-in-2019" class="level3">
<h3>89: Unit Testing C Code (score <a href="https://stackoverflow.com/q/65820.html">375093</a> in 2019)</h3>
<section id="question-87" class="level4">
<h4>Question</h4>
<p>I worked on an embedded system this summer written in straight C. It was an existing project that the company I work for had taken over. I have become quite accustomed to writing unit tests in Java using JUnit but was at a loss as to the best way to write unit tests for existing code (which needed refactoring) as well as new code added to the system.</p>
<p>Are there any projects out there that make unit testing plain C code as easy as unit testing Java code with JUnit? Any insight that would apply specifically to embedded development (cross-compiling to arm-linux platform) would be greatly appreciated.</p>
</section>
<section id="answer-accepted-score-479-1" class="level4">
<h4>Answer accepted (score 479)</h4>
<p>One unit testing framework in C is <a href="https://libcheck.github.io/check/" rel="noreferrer">Check</a>; a list of unit testing frameworks in C can be found <a href="http://check.sourceforge.net/doc/check_html/check_2.html
#SEC3" rel="noreferrer">here</a> and is reproduced below. Depending on how many standard library functions your runtime has, you may or not be able to use one of those.</p>
<blockquote>
<h5>
AceUnit
</h3>
<p>AceUnit (Advanced C and Embedded Unit) bills itself as a comfortable C code unit test framework. It tries to mimick JUnit 4.x and includes reflection-like capabilities. AceUnit can be used in resource constraint environments, e.g. embedded software development, and importantly it runs fine in environments where you cannot include a single standard header file and cannot invoke a single standard C function from the ANSI / ISO C libraries. It also has a Windows port. It does not use forks to trap signals, although the authors have expressed interest in adding such a feature. See the <a href="http://aceunit.sourceforge.net/" rel="noreferrer">AceUnit homepage</a>.</p>
<h5>
GNU Autounit
</h3>
<p>Much along the same lines as Check, including forking to run unit tests in a separate address space (in fact, the original author of Check borrowed the idea from GNU Autounit). GNU Autounit uses GLib extensively, which means that linking and such need special options, but this may not be a big problem to you, especially if you are already using GTK or GLib. See the <a href="http://autounit.tigris.org/" rel="noreferrer">GNU Autounit homepage</a>.</p>
<h5>
cUnit
</h3>
<p>Also uses GLib, but does not fork to protect the address space of unit tests.</p>
<h5>
CUnit
</h3>
<p>Standard C, with plans for a Win32 GUI implementation. Does not currently fork or otherwise protect the address space of unit tests. In early development. See the <a href="http://cunit.sourceforge.net/" rel="noreferrer">CUnit homepage</a>.</p>
<h5>
CuTest
</h3>
<p>A simple framework with just one .c and one .h file that you drop into your source tree. See the <a href="http://cutest.sourceforge.net/" rel="noreferrer">CuTest homepage</a>.</p>
<h5>
CppUnit
</h3>
<p>The premier unit testing framework for C++; you can also use it to test C code. It is stable, actively developed, and has a GUI interface. The primary reasons not to use CppUnit for C are first that it is quite big, and second you have to write your tests in C++, which means you need a C++ compiler. If these don’t sound like concerns, it is definitely worth considering, along with other C++ unit testing frameworks. See the <a href="http://cppunit.sourceforge.net/doc/cvs/index.html" rel="noreferrer">CppUnit homepage</a>.</p>
<h5>
embUnit
</h3>
<p>embUnit (Embedded Unit) is another unit test framework for embedded systems. This one appears to be superseded by AceUnit. <a href="http://sourceforge.net/projects/embunit/" rel="noreferrer">Embedded Unit homepage</a>.</p>
<h5>
MinUnit
</h3>
<p>A minimal set of macros and that’s it! The point is to show how easy it is to unit test your code. See the <a href="http://www.jera.com/techinfo/jtns/jtn002.html" rel="noreferrer">MinUnit homepage</a>.</p>
<h5>
CUnit for Mr. Ando
</h3>
<p>A CUnit implementation that is fairly new, and apparently still in early development. See the <a href="http://park.ruru.ne.jp/ando/work/CUnitForAndo/html/" rel="noreferrer">CUnit for Mr. Ando homepage</a>.</p>
<em>This list was last updated in March 2008.</em><br />

</blockquote>
<h5>
More frameworks:
</h2>
<h5>
CMocka
</h3>
<p>CMocka is a test framework for C with support for mock objects. It’s easy to use and setup.</p>
<p>See <a href="https://cmocka.org/" rel="noreferrer">the CMocka homepage</a>.</p>
<h5>
Criterion
</h3>
<p>Criterion is a cross-platform C unit testing framework supporting automatic test registration, parameterized tests, theories, and that can output to multiple formats, including TAP and JUnit XML. Each test is run in its own process, so signals and crashes can be reported or tested if needed.</p>
<p>See the <a href="https://github.com/Snaipe/Criterion" rel="noreferrer">Criterion homepage</a> for more information.</p>
<h5>
HWUT
</h3>
<p>HWUT is a general Unit Test tool with great support for C. It can help to create Makefiles, generate massive test cases coded in minimal ‘iteration tables’, walk along state machines, generate C-stubs and more. The general approach is pretty unique: Verdicts are based on ‘good stdout/bad stdout’. The comparison function, though, is flexible. Thus, any type of script may be used for checking. It may be applied to any language that can produce standard output.</p>
<p>See <a href="http://hwut.sourceforge.net/" rel="noreferrer">the HWUT homepage</a>.</p>
<h5>
CGreen
</h3>
<p>A modern, portable, cross-language unit testing and mocking framework for C and C++. It offers an optional BDD notation, a mocking library, the ability to run it in a single process (to make debugging easier). A test runner which discover automatically the test functions is available. But you can create your own programmatically.</p>
<p>All those features (and more) are explained in <a href="https://cgreen-devs.github.io/" rel="noreferrer">the CGreen manual</a>.</p>
<p>Wikipedia gives a detailed list of C unit testing frameworks under <a href="https://en.wikipedia.org/wiki/List_of_unit_testing_frameworks
#C" rel="noreferrer">List of unit testing frameworks: C</a></p>
</section>
<section id="answer-2-score-158" class="level4">
<h4>Answer 2 (score 158)</h4>
<p>Personally I like the <a href="http://code.google.com/p/googletest/" rel="noreferrer">Google Test framework</a>.</p>
<p>The real difficulty in testing C code is breaking the dependencies on external modules so you can isolate code in units. This can be especially problematic when you are trying to get tests around legacy code. In this case I often find myself using the linker to use stubs functions in tests.</p>
<p>This is what people are referring to when they talk about “<strong>seams</strong>”. In C your only option really is to use the pre-processor or the linker to mock out your dependencies.</p>
<p>A typical test suite in one of my C projects might look like this:</p>
<div class="sourceCode" id="cb546"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb546-1"><a href="#cb546-1" aria-hidden="true"></a></span>
<span id="cb546-2"><a href="#cb546-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&quot;myimplementationfile.c&quot;</span></span>
<span id="cb546-3"><a href="#cb546-3" aria-hidden="true"></a></span>
<span id="cb546-4"><a href="#cb546-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;gtest/gtest.h&gt;</span></span>
<span id="cb546-5"><a href="#cb546-5" aria-hidden="true"></a></span>
<span id="cb546-6"><a href="#cb546-6" aria-hidden="true"></a><span class="co">// Mock out external dependency on mylogger.o</span></span>
<span id="cb546-7"><a href="#cb546-7" aria-hidden="true"></a><span class="dt">void</span> Logger_log(...){}</span>
<span id="cb546-8"><a href="#cb546-8" aria-hidden="true"></a></span>
<span id="cb546-9"><a href="#cb546-9" aria-hidden="true"></a>TEST(FactorialTest, Zero) {</span>
<span id="cb546-10"><a href="#cb546-10" aria-hidden="true"></a>    EXPECT_EQ(<span class="dv">1</span>, Factorial(<span class="dv">0</span>));</span>
<span id="cb546-11"><a href="#cb546-11" aria-hidden="true"></a>}</span></code></pre></div>
<p><strong>Note that you are actually including the C file and not the header file</strong>. This gives the advantage of access to all the static data members. Here I mock out my logger (which might be in logger.o and give an empty implementation. This means that the test file compiles and links independently from the rest of the code base and executes in isolation.</p>
<p>As for cross-compiling the code, for this to work you need good facilities on the target. I have done this with googletest cross compiled to Linux on a PowerPC architecture. This makes sense because there you have a full shell and os to gather your results. For less rich environments (which I classify as anything without a full OS) you should just build and run on the host. You should do this anyway so you can run the tests automatically as part of the build.</p>
<p>I find testing C++ code is generally much easier due to the fact that OO code is in general much less coupled than procedural (of course this depends a lot on coding style). Also in C++ you can use tricks like dependency injection and method overriding to get seams into code that is otherwise encapsulated.</p>
<p>Michael Feathers has an <a href="https://rads.stackoverflow.com/amzn/click/com/0131177052" rel="noreferrer" rel="nofollow noreferrer">excellent book about testing legacy code</a>. In one chapter he covers techniques for dealing with non-OO code which I highly recommend.</p>
<p><strong>Edit</strong>: I’ve written a <a href="http://meekrosoft.wordpress.com/2009/11/09/unit-testing-c-code-with-the-googletest-framework/" rel="noreferrer">blog post</a> about unit testing procedural code, with <a href="http://github.com/meekrosoft/helloc" rel="noreferrer">source available on GitHub</a>.</p>
<p><strong>Edit</strong>: There is a <a href="http://pragprog.com/titles/jgade/test-driven-development-for-embedded-c" rel="noreferrer">new book coming out from the Pragmatic Programmers</a> that specifically addresses unit testing C code which <a href="http://meekrosoft.wordpress.com/2011/03/25/book-review-test-driven-development-for-embedded-c-beta/" rel="noreferrer">I highly recommend</a>.</p>
</section>
<section id="answer-3-score-130" class="level4">
<h4>Answer 3 (score 130)</h4>
<p>
<a href="http://www.jera.com/techinfo/jtns/jtn002.html" rel="noreferrer">Minunit</a> is an incredibly simple unit testing framework. I’m using it to unit test c microcontroller code for avr.
</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="typedef-function-pointer-score-373780-in-2019" class="level3">
<h3>90: Typedef function pointer? (score <a href="https://stackoverflow.com/q/4295432.html">373780</a> in 2019)</h3>
<section id="question-88" class="level4">
<h4>Question</h4>
<p>I’m learning how to dynamically load DLL’s but what I don’t understand is this line</p>
<div class="sourceCode" id="cb547"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb547-1"><a href="#cb547-1" aria-hidden="true"></a><span class="kw">typedef</span> <span class="dt">void</span> (*FunctionFunc)();</span></code></pre></div>
<p>I have a few questions. If someone is able to answer them I would be grateful.</p>
<ol>
<li>
Why is <code>typedef</code> used?
</li>
<li>
The syntax looks odd; after <code>void</code> should there not be a function name or something? It looks like an anonymous function.
</li>
<li>
Is a function pointer created to store the memory address of a function?
</li>
</ol>
<p>So I’m confused at the moment; can you clarify things for me?</p>
</section>
<section id="answer-accepted-score-432-1" class="level4">
<h4>Answer accepted (score 432)</h4>
<p>
<code>typedef</code> is a language construct that associates a name to a type.<br/> You use it the same way you would use the original type, for instance
</p>
<div class="sourceCode" id="cb548"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb548-1"><a href="#cb548-1" aria-hidden="true"></a>  <span class="kw">typedef</span> <span class="dt">int</span> myinteger;</span>
<span id="cb548-2"><a href="#cb548-2" aria-hidden="true"></a>  <span class="kw">typedef</span> <span class="dt">char</span> *mystring;</span>
<span id="cb548-3"><a href="#cb548-3" aria-hidden="true"></a>  <span class="kw">typedef</span> <span class="dt">void</span> (*myfunc)();</span></code></pre></div>
<p>using them like</p>
<div class="sourceCode" id="cb549"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb549-1"><a href="#cb549-1" aria-hidden="true"></a>  myinteger i;   <span class="co">// is equivalent to    int i;</span></span>
<span id="cb549-2"><a href="#cb549-2" aria-hidden="true"></a>  mystring s;    <span class="co">// is the same as      char *s;</span></span>
<span id="cb549-3"><a href="#cb549-3" aria-hidden="true"></a>  myfunc f;      <span class="co">// compile equally as  void (*f)();</span></span></code></pre></div>
<p>As you can see, you could just replace the <em>typedefed</em> name with its definition given above.<br/></p>
<p>The difficulty lies in the pointer to functions syntax and readability in C and C++, and the <code>typedef</code> can improve the readability of such declarations. However, the syntax is appropriate, since functions - unlike other simpler types - may have a return value and parameters, thus the sometimes lengthy and complex declaration of a pointer to function.</p>
<p>The readability may start to be really tricky with pointers to functions arrays, and some other even more indirect flavors.</p>
<p>To answer your three questions</p>
<ul>
<li>
<p>
<strong>Why is typedef used?</strong> To ease the reading of the code - especially for pointers to functions, or structure names.
</p>
</li>
<li>
<p>
<strong>The syntax looks odd (in the pointer to function declaration)</strong> That syntax is not obvious to read, at least when beginning. Using a <code>typedef</code> declaration instead eases the reading
</p>
</li>
<li>
<p>
<strong>Is a function pointer created to store the memory address of a function?</strong> Yes, a function pointer stores the address of a function. This has nothing to do with the <code>typedef</code> construct which only ease the writing/reading of a program ; the compiler just expands the typedef definition before compiling the actual code.
</p>
</li>
</ul>
<p>Example:</p>
<div class="sourceCode" id="cb550"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb550-1"><a href="#cb550-1" aria-hidden="true"></a><span class="kw">typedef</span> <span class="dt">int</span> (*t_somefunc)(<span class="dt">int</span>,<span class="dt">int</span>);</span>
<span id="cb550-2"><a href="#cb550-2" aria-hidden="true"></a></span>
<span id="cb550-3"><a href="#cb550-3" aria-hidden="true"></a><span class="dt">int</span> product(<span class="dt">int</span> u, <span class="dt">int</span> v) {</span>
<span id="cb550-4"><a href="#cb550-4" aria-hidden="true"></a>  <span class="cf">return</span> u*v;</span>
<span id="cb550-5"><a href="#cb550-5" aria-hidden="true"></a>}</span>
<span id="cb550-6"><a href="#cb550-6" aria-hidden="true"></a></span>
<span id="cb550-7"><a href="#cb550-7" aria-hidden="true"></a>t_somefunc afunc = &amp;product;</span>
<span id="cb550-8"><a href="#cb550-8" aria-hidden="true"></a>...</span>
<span id="cb550-9"><a href="#cb550-9" aria-hidden="true"></a><span class="dt">int</span> x2 = (*afunc)(<span class="dv">123</span>, <span class="dv">456</span>); <span class="co">// call product() to calculate 123*456</span></span></code></pre></div>
</section>
<section id="answer-2-score-178" class="level4">
<h4>Answer 2 (score 178)</h4>
<ol>
<li>
<p>
<code>typedef</code> is used to alias types; in this case you’re aliasing <code>FunctionFunc</code> to <code>void(*)()</code>.
</p>
</li>
<li>
<p>
Indeed the syntax does look odd, have a look at this:
</p>
<div class="sourceCode" id="cb551"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb551-1"><a href="#cb551-1" aria-hidden="true"></a><span class="kw">typedef</span>   <span class="dt">void</span>      (*FunctionFunc)  ( );</span>
<span id="cb551-2"><a href="#cb551-2" aria-hidden="true"></a><span class="co">//         ^                ^         ^</span></span>
<span id="cb551-3"><a href="#cb551-3" aria-hidden="true"></a><span class="co">//     return type      type name  arguments</span></span>
<span id="cb551-4"><a href="#cb551-4" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb551-5"><a href="#cb551-5" aria-hidden="true"></a>&lt;li&gt;&lt;p&gt;No, this simply tells the compiler that the `FunctionFunc` type will be a function pointer, it doesn&#39;t &lt;em&gt;define&lt;/em&gt; one, like this:&lt;/p&gt;</span>
<span id="cb551-6"><a href="#cb551-6" aria-hidden="true"></a></span>
<span id="cb551-7"><a href="#cb551-7" aria-hidden="true"></a>```c</span>
<span id="cb551-8"><a href="#cb551-8" aria-hidden="true"></a>FunctionFunc x;</span>
<span id="cb551-9"><a href="#cb551-9" aria-hidden="true"></a><span class="dt">void</span> doSomething() { printf(<span class="st">&quot;Hello there</span><span class="sc">\n</span><span class="st">&quot;</span>); }</span>
<span id="cb551-10"><a href="#cb551-10" aria-hidden="true"></a>x = &amp;doSomething;</span>
<span id="cb551-11"><a href="#cb551-11" aria-hidden="true"></a></span>
<span id="cb551-12"><a href="#cb551-12" aria-hidden="true"></a>x(); <span class="co">//prints &quot;Hello there&quot;</span></span>
<span id="cb551-13"><a href="#cb551-13" aria-hidden="true"></a>```&lt;/li&gt;</span>
<span id="cb551-14"><a href="#cb551-14" aria-hidden="true"></a>&lt;/ol&gt;</span>
<span id="cb551-15"><a href="#cb551-15" aria-hidden="true"></a></span>
<span id="cb551-16"><a href="#cb551-16" aria-hidden="true"></a></span>
<span id="cb551-17"><a href="#cb551-17" aria-hidden="true"></a><span class="er">#### Answer 3 (score 31)</span></span>
<span id="cb551-18"><a href="#cb551-18" aria-hidden="true"></a>Without the `typedef` word, in C++ the declaration would declare a variable `FunctionFunc` of type pointer to function of no arguments, returning `void`.  </span>
<span id="cb551-19"><a href="#cb551-19" aria-hidden="true"></a></span>
<span id="cb551-20"><a href="#cb551-20" aria-hidden="true"></a>With the `typedef` it instead defines `FunctionFunc` as a name <span class="cf">for</span> that type.  </span>
<span id="cb551-21"><a href="#cb551-21" aria-hidden="true"></a></span>
<span id="cb551-22"><a href="#cb551-22" aria-hidden="true"></a>&lt;/b&gt; &lt;/em&gt; &lt;/i&gt; &lt;/small&gt; &lt;/strong&gt; &lt;/sub&gt; &lt;/sup&gt;</span>
<span id="cb551-23"><a href="#cb551-23" aria-hidden="true"></a></span>
<span id="cb551-24"><a href="#cb551-24" aria-hidden="true"></a></span>
<span id="cb551-25"><a href="#cb551-25" aria-hidden="true"></a><span class="er">### 91: How to copy a char array in C? (score [372836](https://stackoverflow.com/q/16645583.html) in 2017)</span></span>
<span id="cb551-26"><a href="#cb551-26" aria-hidden="true"></a></span>
<span id="cb551-27"><a href="#cb551-27" aria-hidden="true"></a></span>
<span id="cb551-28"><a href="#cb551-28" aria-hidden="true"></a><span class="er">#### Question</span></span>
<span id="cb551-29"><a href="#cb551-29" aria-hidden="true"></a>In C, I have two <span class="dt">char</span> arrays:  </span>
<span id="cb551-30"><a href="#cb551-30" aria-hidden="true"></a></span>
<span id="cb551-31"><a href="#cb551-31" aria-hidden="true"></a>```c</span>
<span id="cb551-32"><a href="#cb551-32" aria-hidden="true"></a><span class="dt">char</span> array1[<span class="dv">18</span>] = <span class="st">&quot;abcdefg&quot;</span>;</span>
<span id="cb551-33"><a href="#cb551-33" aria-hidden="true"></a><span class="dt">char</span> array2[<span class="dv">18</span>];</span></code></pre></div>
<p>How to copy the value of <code>array1</code> to <code>array2</code> ? Can I just do this: <code>array2 = array1</code>?</p>
</section>
<section id="answer-accepted-score-77" class="level4">
<h4>Answer accepted (score 77)</h4>
<p>You can’t directly do <code>array2 = array1</code>, because in this case you would manipulate the addresses (<code>char *</code>) of the arrays and not their values.</p>
<p>For this kind of situation, it is recommended to use <a href="http://www.cplusplus.com/reference/cstring/strncpy/?kw=strncpy" rel="noreferrer"><code>strncpy</code></a> to avoid a <a href="http://en.wikipedia.org/wiki/Buffer_overflow" rel="noreferrer">buffer overflow</a>, especially if <code>array1</code> is filled from user input (keyboard, network, etc.). Like so:</p>
<div class="sourceCode" id="cb552"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb552-1"><a href="#cb552-1" aria-hidden="true"></a><span class="co">// Will copy 18 characters from array1 to array2</span></span>
<span id="cb552-2"><a href="#cb552-2" aria-hidden="true"></a>strncpy(array2, array1, <span class="dv">18</span>);</span></code></pre></div>
<p>As <span class="citation" data-cites="Prof">@Prof</span>. Falken mentioned in a comment, <code>strncpy</code> <a href="http://blogs.msdn.com/b/michael_howard/archive/2004/11/02/251296.aspx" rel="noreferrer">can be evil</a>. Make sure your target buffer is big enough to contain the source buffer (including the <code>\0</code> at the end of the string).</p>
</section>
<section id="answer-2-score-26-1" class="level4">
<h4>Answer 2 (score 26)</h4>
<p>
If your arrays are not string arrays, use: <code>memcpy(array2, array1, sizeof(array2));</code>
</p>
</section>
<section id="answer-3-score-24-2" class="level4">
<h4>Answer 3 (score 24)</h4>
<p>If you want to guard against non-terminated strings, which can cause all sorts of problems, copy your string like this:</p>
<div class="sourceCode" id="cb553"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb553-1"><a href="#cb553-1" aria-hidden="true"></a><span class="dt">char</span> array1[<span class="dv">18</span>] = {<span class="st">&quot;abcdefg&quot;</span>};</span>
<span id="cb553-2"><a href="#cb553-2" aria-hidden="true"></a><span class="dt">char</span> array2[<span class="dv">18</span>];</span>
<span id="cb553-3"><a href="#cb553-3" aria-hidden="true"></a></span>
<span id="cb553-4"><a href="#cb553-4" aria-hidden="true"></a><span class="dt">size_t</span> destination_size = <span class="kw">sizeof</span> (array2);</span>
<span id="cb553-5"><a href="#cb553-5" aria-hidden="true"></a></span>
<span id="cb553-6"><a href="#cb553-6" aria-hidden="true"></a>strncpy(array2, array1, destination_size);</span>
<span id="cb553-7"><a href="#cb553-7" aria-hidden="true"></a>array2[destination_size - <span class="dv">1</span>] = <span class="ch">&#39;\0&#39;</span>;</span></code></pre></div>
<p>That last line is actually important, because <code>strncpy()</code> does not always <a href="https://www.securecoding.cert.org/confluence/display/seccode/STR32-C.+Null-terminate+byte+strings+as+required" rel="noreferrer">null terminate</a> strings. (If the destination buffer is too small to contain the whole source string, sntrcpy() will not null terminate the destination string.)</p>
<p>The manpage for strncpy() even states <em>“Warning: If there is no null byte among the first n bytes of src, the string placed in dest will not be null-terminated.”</em></p>
<p>The reason strncpy() behaves this somewhat odd way, is because it was not actually originally intended as a safe way to copy strings.</p>
<p>Another way is to use snprintf() as a safe replacement for strcpy():</p>
<div class="sourceCode" id="cb554"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb554-1"><a href="#cb554-1" aria-hidden="true"></a>snprintf(array2, destination_size, <span class="st">&quot;%s&quot;</span>, array1);</span></code></pre></div>
<p><sub>(Thanks <a href="https://stackoverflow.com/users/315052/jxh">jxh</a> for the tip.)</sub></p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="printing-prime-numbers-from-1-through-100-score-366862-in-2011" class="level3">
<h3>92: Printing prime numbers from 1 through 100 (score <a href="https://stackoverflow.com/q/5200879.html">366862</a> in 2011)</h3>
<section id="question-89" class="level4">
<h4>Question</h4>
<p>This c++ code prints out the following prime numbers: <strong>3 5 7 11 13 17 19 23 29 31 37 41 43 47 53 59 61 67 71 73 79 83 89 97.</strong></p>
<p>But I don’t think that’s the way my book wants it to be written. It mentions something about square root of a number. So I did try changing my 2nd loop to <code>for (int j=2; j&amp;lt;sqrt(i); j++)</code> but it did not give me the result I needed.</p>
<p>How would I need to change this code to the way my book wants it to be?</p>
<div class="sourceCode" id="cb555"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb555-1"><a href="#cb555-1" aria-hidden="true"></a><span class="dt">int</span> main () </span>
<span id="cb555-2"><a href="#cb555-2" aria-hidden="true"></a>{</span>
<span id="cb555-3"><a href="#cb555-3" aria-hidden="true"></a>    <span class="cf">for</span> (<span class="dt">int</span> i=<span class="dv">2</span>; i&lt;<span class="dv">100</span>; i++) </span>
<span id="cb555-4"><a href="#cb555-4" aria-hidden="true"></a>        <span class="cf">for</span> (<span class="dt">int</span> j=<span class="dv">2</span>; j&lt;i; j++)</span>
<span id="cb555-5"><a href="#cb555-5" aria-hidden="true"></a>        {</span>
<span id="cb555-6"><a href="#cb555-6" aria-hidden="true"></a>            <span class="cf">if</span> (i % j == <span class="dv">0</span>) </span>
<span id="cb555-7"><a href="#cb555-7" aria-hidden="true"></a>                <span class="cf">break</span>;</span>
<span id="cb555-8"><a href="#cb555-8" aria-hidden="true"></a>            <span class="cf">else</span> <span class="cf">if</span> (i == j+<span class="dv">1</span>)</span>
<span id="cb555-9"><a href="#cb555-9" aria-hidden="true"></a>                cout &lt;&lt; i &lt;&lt; <span class="st">&quot; &quot;</span>;</span>
<span id="cb555-10"><a href="#cb555-10" aria-hidden="true"></a></span>
<span id="cb555-11"><a href="#cb555-11" aria-hidden="true"></a>        }   </span>
<span id="cb555-12"><a href="#cb555-12" aria-hidden="true"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb555-13"><a href="#cb555-13" aria-hidden="true"></a>}</span></code></pre></div>
<blockquote>
<p>
A prime integer number is one that has exactly two different divisors, namely 1 and the number itself. Write, run, and test a C++ program that finds and prints all the prime numbers less than 100. (Hint: 1 is a prime number. For each number from 2 to 100, find Remainder = Number % n, where n ranges from 2 to sqrt(number).  If n is greater than sqrt(number), the number is not equally divisible by n.  Why? If any Remainder equals 0, the number is no a prime number.)
</p>
</blockquote>
</section>
<section id="answer-accepted-score-28" class="level4">
<h4>Answer accepted (score 28)</h4>
<p>Three ways:</p>
<ol type="1">
<li></li>
</ol>
<div class="sourceCode" id="cb556"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb556-1"><a href="#cb556-1" aria-hidden="true"></a><span class="dt">int</span> main () </span>
<span id="cb556-2"><a href="#cb556-2" aria-hidden="true"></a>{</span>
<span id="cb556-3"><a href="#cb556-3" aria-hidden="true"></a>    <span class="cf">for</span> (<span class="dt">int</span> i=<span class="dv">2</span>; i&lt;<span class="dv">100</span>; i++) </span>
<span id="cb556-4"><a href="#cb556-4" aria-hidden="true"></a>        <span class="cf">for</span> (<span class="dt">int</span> j=<span class="dv">2</span>; j*j&lt;=i; j++)</span>
<span id="cb556-5"><a href="#cb556-5" aria-hidden="true"></a>        {</span>
<span id="cb556-6"><a href="#cb556-6" aria-hidden="true"></a>            <span class="cf">if</span> (i % j == <span class="dv">0</span>) </span>
<span id="cb556-7"><a href="#cb556-7" aria-hidden="true"></a>                <span class="cf">break</span>;</span>
<span id="cb556-8"><a href="#cb556-8" aria-hidden="true"></a>            <span class="cf">else</span> <span class="cf">if</span> (j+<span class="dv">1</span> &gt; sqrt(i)) {</span>
<span id="cb556-9"><a href="#cb556-9" aria-hidden="true"></a>                cout &lt;&lt; i &lt;&lt; <span class="st">&quot; &quot;</span>;</span>
<span id="cb556-10"><a href="#cb556-10" aria-hidden="true"></a></span>
<span id="cb556-11"><a href="#cb556-11" aria-hidden="true"></a>            }</span>
<span id="cb556-12"><a href="#cb556-12" aria-hidden="true"></a></span>
<span id="cb556-13"><a href="#cb556-13" aria-hidden="true"></a>        }   </span>
<span id="cb556-14"><a href="#cb556-14" aria-hidden="true"></a></span>
<span id="cb556-15"><a href="#cb556-15" aria-hidden="true"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb556-16"><a href="#cb556-16" aria-hidden="true"></a>}</span></code></pre></div>
<ol start="2" type="1">
<li></li>
</ol>
<div class="sourceCode" id="cb557"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb557-1"><a href="#cb557-1" aria-hidden="true"></a><span class="dt">int</span> main () </span>
<span id="cb557-2"><a href="#cb557-2" aria-hidden="true"></a>{</span>
<span id="cb557-3"><a href="#cb557-3" aria-hidden="true"></a>    <span class="cf">for</span> (<span class="dt">int</span> i=<span class="dv">2</span>; i&lt;<span class="dv">100</span>; i++) </span>
<span id="cb557-4"><a href="#cb557-4" aria-hidden="true"></a>    {</span>
<span id="cb557-5"><a href="#cb557-5" aria-hidden="true"></a>        <span class="dt">bool</span> prime=true;</span>
<span id="cb557-6"><a href="#cb557-6" aria-hidden="true"></a>        <span class="cf">for</span> (<span class="dt">int</span> j=<span class="dv">2</span>; j*j&lt;=i; j++)</span>
<span id="cb557-7"><a href="#cb557-7" aria-hidden="true"></a>        {</span>
<span id="cb557-8"><a href="#cb557-8" aria-hidden="true"></a>            <span class="cf">if</span> (i % j == <span class="dv">0</span>) </span>
<span id="cb557-9"><a href="#cb557-9" aria-hidden="true"></a>            {</span>
<span id="cb557-10"><a href="#cb557-10" aria-hidden="true"></a>                prime=false;</span>
<span id="cb557-11"><a href="#cb557-11" aria-hidden="true"></a>                <span class="cf">break</span>;    </span>
<span id="cb557-12"><a href="#cb557-12" aria-hidden="true"></a>            }</span>
<span id="cb557-13"><a href="#cb557-13" aria-hidden="true"></a>        }   </span>
<span id="cb557-14"><a href="#cb557-14" aria-hidden="true"></a>        <span class="cf">if</span>(prime) cout &lt;&lt; i &lt;&lt; <span class="st">&quot; &quot;</span>;</span>
<span id="cb557-15"><a href="#cb557-15" aria-hidden="true"></a>    }</span>
<span id="cb557-16"><a href="#cb557-16" aria-hidden="true"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb557-17"><a href="#cb557-17" aria-hidden="true"></a>}</span></code></pre></div>
<ol start="3" type="1">
<li></li>
</ol>
<div class="sourceCode" id="cb558"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb558-1"><a href="#cb558-1" aria-hidden="true"></a></span>
<span id="cb558-2"><a href="#cb558-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;vector&gt;</span></span>
<span id="cb558-3"><a href="#cb558-3" aria-hidden="true"></a><span class="dt">int</span> main()</span>
<span id="cb558-4"><a href="#cb558-4" aria-hidden="true"></a>{</span>
<span id="cb558-5"><a href="#cb558-5" aria-hidden="true"></a>    std::vector&lt;<span class="dt">int</span>&gt; primes;</span>
<span id="cb558-6"><a href="#cb558-6" aria-hidden="true"></a>    primes.push_back(<span class="dv">2</span>);</span>
<span id="cb558-7"><a href="#cb558-7" aria-hidden="true"></a>    <span class="cf">for</span>(<span class="dt">int</span> i=<span class="dv">3</span>; i &lt; <span class="dv">100</span>; i++)</span>
<span id="cb558-8"><a href="#cb558-8" aria-hidden="true"></a>    {</span>
<span id="cb558-9"><a href="#cb558-9" aria-hidden="true"></a>        <span class="dt">bool</span> prime=true;</span>
<span id="cb558-10"><a href="#cb558-10" aria-hidden="true"></a>        <span class="cf">for</span>(<span class="dt">int</span> j=<span class="dv">0</span>;j&lt;primes.size() &amp;&amp; primes[j]*primes[j] &lt;= i;j++)</span>
<span id="cb558-11"><a href="#cb558-11" aria-hidden="true"></a>        {</span>
<span id="cb558-12"><a href="#cb558-12" aria-hidden="true"></a>            <span class="cf">if</span>(i % primes[j] == <span class="dv">0</span>)</span>
<span id="cb558-13"><a href="#cb558-13" aria-hidden="true"></a>            {</span>
<span id="cb558-14"><a href="#cb558-14" aria-hidden="true"></a>                prime=false;</span>
<span id="cb558-15"><a href="#cb558-15" aria-hidden="true"></a>                <span class="cf">break</span>;</span>
<span id="cb558-16"><a href="#cb558-16" aria-hidden="true"></a>            }</span>
<span id="cb558-17"><a href="#cb558-17" aria-hidden="true"></a>        }</span>
<span id="cb558-18"><a href="#cb558-18" aria-hidden="true"></a>        <span class="cf">if</span>(prime) </span>
<span id="cb558-19"><a href="#cb558-19" aria-hidden="true"></a>        {</span>
<span id="cb558-20"><a href="#cb558-20" aria-hidden="true"></a>            primes.push_back(i);</span>
<span id="cb558-21"><a href="#cb558-21" aria-hidden="true"></a>            cout &lt;&lt; i &lt;&lt; <span class="st">&quot; &quot;</span>;</span>
<span id="cb558-22"><a href="#cb558-22" aria-hidden="true"></a>        }</span>
<span id="cb558-23"><a href="#cb558-23" aria-hidden="true"></a>    }</span>
<span id="cb558-24"><a href="#cb558-24" aria-hidden="true"></a></span>
<span id="cb558-25"><a href="#cb558-25" aria-hidden="true"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb558-26"><a href="#cb558-26" aria-hidden="true"></a>}</span></code></pre></div>
<p>Edit: In the third example, we keep track of all of our previously calculated primes. If a number is divisible by a non-prime number, there is also some prime &lt;= that divisor which it is also divisble by. This reduces computation by a factor of primes_in_range/total_range.</p>
</section>
<section id="answer-2-score-16-1" class="level4">
<h4>Answer 2 (score 16)</h4>
<p>If <code>j</code> is <em>equal</em> to <code>sqrt(i)</code> it might also be a valid factor, not only if it’s <em>smaller</em>.</p>
<p>To iterate up to and including <code>sqrt(i)</code> in your inner loop, you could write:</p>
<div class="sourceCode" id="cb559"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb559-1"><a href="#cb559-1" aria-hidden="true"></a><span class="cf">for</span> (<span class="dt">int</span> j=<span class="dv">2</span>; j*j&lt;=i; j++)</span></code></pre></div>
<p>(Compared to using <code>sqrt(i)</code> this has the advantage to not need conversion to floating point numbers.)</p>
</section>
<section id="answer-3-score-12-1" class="level4">
<h4>Answer 3 (score 12)</h4>
<p>If a number has divisors, at least one of them must be less than or equal to the square root of the number. When you check divisors, you only need to check up to the square root, not all the way up to the number being tested.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-to-print-a-int64_t-type-in-c-score-365851-in-2013" class="level3">
<h3>93: How to print a int64_t type in C (score <a href="https://stackoverflow.com/q/9225567.html">365851</a> in 2013)</h3>
<section id="question-90" class="level4">
<h4>Question</h4>
<p>C99 standard has integer types with bytes size like int64_t. I am using the following code:</p>
<div class="sourceCode" id="cb560"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb560-1"><a href="#cb560-1" aria-hidden="true"></a></span>
<span id="cb560-2"><a href="#cb560-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb560-3"><a href="#cb560-3" aria-hidden="true"></a></span>
<span id="cb560-4"><a href="#cb560-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdint.h&gt;</span></span>
<span id="cb560-5"><a href="#cb560-5" aria-hidden="true"></a><span class="dt">int64_t</span> my_int = <span class="dv">999999999999999999</span>;</span>
<span id="cb560-6"><a href="#cb560-6" aria-hidden="true"></a>printf(<span class="st">&quot;This is my_int: %I64d</span><span class="sc">\n</span><span class="st">&quot;</span>, my_int);</span></code></pre></div>
<p>and I get this compiler warning:</p>
<div class="sourceCode" id="cb561"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb561-1"><a href="#cb561-1" aria-hidden="true"></a>warning: format ‘%I64d’ expects type ‘int’, but argument <span class="dv">2</span> has type ‘int64_t’</span></code></pre></div>
<p>I tried with:</p>
<div class="sourceCode" id="cb562"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb562-1"><a href="#cb562-1" aria-hidden="true"></a>printf(<span class="st">&quot;This is my_int: %lld</span><span class="sc">\n</span><span class="st">&quot;</span>, my_int); <span class="co">// long long decimal</span></span></code></pre></div>
<p>But I get the same warning. I am using this compiler:</p>
<div class="sourceCode" id="cb563"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb563-1"><a href="#cb563-1" aria-hidden="true"></a>~/dev/c$ cc -v</span>
<span id="cb563-2"><a href="#cb563-2" aria-hidden="true"></a>Using built-in specs.</span>
<span id="cb563-3"><a href="#cb563-3" aria-hidden="true"></a>Target: i686-apple-darwin10</span>
<span id="cb563-4"><a href="#cb563-4" aria-hidden="true"></a>Configured with: /var/tmp/gcc/gcc-<span class="dv">5664</span>~<span class="dv">89</span>/src/configure --disable-checking --enable-werror --prefix=/usr --mandir=/share/man --enable-languages=c,objc,c++,obj-c++ --program-transform-name=/^[cg][^.-]*$/s/$/-<span class="fl">4.2</span>/ --with-slibdir=/usr/lib --build=i686-apple-darwin10 --program-prefix=i686-apple-darwin10- --host=x86_64-apple-darwin10 --target=i686-apple-darwin10 --with-gxx-include-dir=/include/c++/<span class="fl">4.2</span><span class="er">.1</span></span>
<span id="cb563-5"><a href="#cb563-5" aria-hidden="true"></a>Thread model: posix</span>
<span id="cb563-6"><a href="#cb563-6" aria-hidden="true"></a>gcc version <span class="fl">4.2</span><span class="er">.1</span> (Apple Inc. build <span class="dv">5664</span>)</span></code></pre></div>
<p>Which format should I use to print my_int variable without having a warning?</p>
</section>
<section id="answer-accepted-score-389" class="level4">
<h4>Answer accepted (score 389)</h4>
<p>For <code>int64_t</code> type:</p>
<div class="sourceCode" id="cb564"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb564-1"><a href="#cb564-1" aria-hidden="true"></a></span>
<span id="cb564-2"><a href="#cb564-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;inttypes.h&gt;</span></span>
<span id="cb564-3"><a href="#cb564-3" aria-hidden="true"></a><span class="dt">int64_t</span> t;</span>
<span id="cb564-4"><a href="#cb564-4" aria-hidden="true"></a>printf(<span class="st">&quot;%&quot;</span> PRId64 <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>, t);</span></code></pre></div>
<p>for <code>uint64_t</code> type:</p>
<div class="sourceCode" id="cb565"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb565-1"><a href="#cb565-1" aria-hidden="true"></a></span>
<span id="cb565-2"><a href="#cb565-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;inttypes.h&gt;</span></span>
<span id="cb565-3"><a href="#cb565-3" aria-hidden="true"></a><span class="dt">uint64_t</span> t;</span>
<span id="cb565-4"><a href="#cb565-4" aria-hidden="true"></a>printf(<span class="st">&quot;%&quot;</span> PRIu64 <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>, t);</span></code></pre></div>
<p>you can also use <code>PRIx64</code> to print in hexadecimal.</p>
<p><a href="http://en.cppreference.com/w/cpp/types/integer" rel="noreferrer">cppreference.com has a full listing</a> of available macros for all types including <code>intptr_t</code> (<code>PRIxPTR</code>). There are separate macros for scanf, like <code>SCNd64</code>.</p>
<hr>
<p>A typical definition of PRIu16 would be <code>"hu"</code>, so implicit string-constant concatenation happens at compile time.</p>
<p>For your code to be fully portable, you must use <code>PRId32</code> and so on for printing <code>int32_t</code>, and <code>"%d"</code> or similar for printing <code>int</code>.</p>
</section>
<section id="answer-2-score-60" class="level4">
<h4>Answer 2 (score 60)</h4>
<p>The C99 way is</p>
<div class="sourceCode" id="cb566"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb566-1"><a href="#cb566-1" aria-hidden="true"></a></span>
<span id="cb566-2"><a href="#cb566-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;inttypes.h&gt;</span></span>
<span id="cb566-3"><a href="#cb566-3" aria-hidden="true"></a><span class="dt">int64_t</span> my_int = <span class="dv">999999999999999999</span>;</span>
<span id="cb566-4"><a href="#cb566-4" aria-hidden="true"></a>printf(<span class="st">&quot;%&quot;</span> PRId64 <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>, my_int);</span></code></pre></div>
<p>Or you could cast!</p>
<div class="sourceCode" id="cb567"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb567-1"><a href="#cb567-1" aria-hidden="true"></a>printf(<span class="st">&quot;%ld&quot;</span>, (<span class="dt">long</span>)my_int);</span>
<span id="cb567-2"><a href="#cb567-2" aria-hidden="true"></a>printf(<span class="st">&quot;%lld&quot;</span>, (<span class="dt">long</span> <span class="dt">long</span>)my_int); <span class="co">/* C89 didn&#39;t define `long long` */</span></span>
<span id="cb567-3"><a href="#cb567-3" aria-hidden="true"></a>printf(<span class="st">&quot;%f&quot;</span>, (<span class="dt">double</span>)my_int);</span></code></pre></div>
<p>If you’re stuck with a C89 implementation (notably Visual Studio) you can perhaps use an open source <code>&amp;lt;inttypes.h&amp;gt;</code> (and <code>&amp;lt;stdint.h&amp;gt;</code>): <a href="http://code.google.com/p/msinttypes/" rel="noreferrer">http://code.google.com/p/msinttypes/</a></p>
</section>
<section id="answer-3-score-14-1" class="level4">
<h4>Answer 3 (score 14)</h4>
<p>With C99 the <code>%j</code> length modifier can also be used with the printf family of functions to print values of type <code>int64_t</code> and <code>uint64_t</code>:</p>
<div class="sourceCode" id="cb568"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb568-1"><a href="#cb568-1" aria-hidden="true"></a></span>
<span id="cb568-2"><a href="#cb568-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb568-3"><a href="#cb568-3" aria-hidden="true"></a></span>
<span id="cb568-4"><a href="#cb568-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdint.h&gt;</span></span>
<span id="cb568-5"><a href="#cb568-5" aria-hidden="true"></a></span>
<span id="cb568-6"><a href="#cb568-6" aria-hidden="true"></a><span class="dt">int</span> main(<span class="dt">int</span> argc, <span class="dt">char</span> *argv[])</span>
<span id="cb568-7"><a href="#cb568-7" aria-hidden="true"></a>{</span>
<span id="cb568-8"><a href="#cb568-8" aria-hidden="true"></a>    <span class="dt">int64_t</span>  a = <span class="dv">1</span><span class="bu">LL</span> &lt;&lt; <span class="dv">63</span>;</span>
<span id="cb568-9"><a href="#cb568-9" aria-hidden="true"></a>    <span class="dt">uint64_t</span> b = <span class="dv">1</span><span class="bu">ULL</span> &lt;&lt; <span class="dv">63</span>;</span>
<span id="cb568-10"><a href="#cb568-10" aria-hidden="true"></a></span>
<span id="cb568-11"><a href="#cb568-11" aria-hidden="true"></a>    printf(<span class="st">&quot;a=%jd (0x%jx)</span><span class="sc">\n</span><span class="st">&quot;</span>, a, a);</span>
<span id="cb568-12"><a href="#cb568-12" aria-hidden="true"></a>    printf(<span class="st">&quot;b=%ju (0x%jx)</span><span class="sc">\n</span><span class="st">&quot;</span>, b, b);</span>
<span id="cb568-13"><a href="#cb568-13" aria-hidden="true"></a></span>
<span id="cb568-14"><a href="#cb568-14" aria-hidden="true"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb568-15"><a href="#cb568-15" aria-hidden="true"></a>}</span></code></pre></div>
<p>Compiling this code with <code>gcc -Wall -pedantic -std=c99</code> produces no warnings, and the program prints the expected output:</p>
<div class="sourceCode" id="cb569"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb569-1"><a href="#cb569-1" aria-hidden="true"></a>a=-<span class="dv">9223372036854775808</span> (<span class="bn">0x8000000000000000</span>)</span>
<span id="cb569-2"><a href="#cb569-2" aria-hidden="true"></a>b=<span class="dv">9223372036854775808</span> (<span class="bn">0x8000000000000000</span>)</span></code></pre></div>
<p>This is according to <code>printf(3)</code> on my Linux system (the man page specifically says that <code>j</code> is used to indicate a conversion to an <code>intmax_t</code> or <code>uintmax_t</code>; in my stdint.h, both <code>int64_t</code> and <code>intmax_t</code> are typedef’d in exactly the same way, and similarly for <code>uint64_t</code>). I’m not sure if this is perfectly portable to other systems.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="clearing-a-char-array-c-score-364411-in-2012" class="level3">
<h3>94: clearing a char array c (score <a href="https://stackoverflow.com/q/632846.html">364411</a> in 2012)</h3>
<section id="question-91" class="level4">
<h4>Question</h4>
<p>I thought by setting the first element to a null would clear the entire contents of a char array.</p>
<div class="sourceCode" id="cb570"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb570-1"><a href="#cb570-1" aria-hidden="true"></a><span class="dt">char</span> my_custom_data[<span class="dv">40</span>] = <span class="st">&quot;Hello!&quot;</span>;</span>
<span id="cb570-2"><a href="#cb570-2" aria-hidden="true"></a>my_custom_data[<span class="dv">0</span>] = <span class="ch">&#39;\0&#39;</span>;</span></code></pre></div>
<p>However, this only sets the first element to null.</p>
<p>or</p>
<div class="sourceCode" id="cb571"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb571-1"><a href="#cb571-1" aria-hidden="true"></a>my_custom_data[<span class="dv">0</span>] = <span class="dv">0</span>; </span></code></pre></div>
<p>rather than use <code>memset</code>, I thought the 2 examples above should clear all the data.</p>
</section>
<section id="answer-accepted-score-110" class="level4">
<h4>Answer accepted (score 110)</h4>
<p>It depends on how you want to view the array. If you are viewing the array as a series of chars, then the only way to clear out the data is to touch every entry. <code>memset</code> is probably the most effective way to achieve this.</p>
<p>On the other hand, if you are choosing to view this as a C/C++ null terminated string, setting the first byte to 0 will effectively clear the string.</p>
</section>
<section id="answer-2-score-69" class="level4">
<h4>Answer 2 (score 69)</h4>
<p>An array in C is just a memory location, so indeed, your <code>my_custom_data[0] = '\0';</code> assignment simply sets the first element to zero and leaves the other elements intact.</p>
<p>If you want to clear all the elements of the array, you’ll have to visit each element. That is what <code>memset</code> is for:</p>
<div class="sourceCode" id="cb572"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb572-1"><a href="#cb572-1" aria-hidden="true"></a>memset(&amp;arr[<span class="dv">0</span>], <span class="dv">0</span>, <span class="kw">sizeof</span>(arr));</span></code></pre></div>
<p>This is generally the fastest way to take care of this. If you can use C++, consider std::fill instead:</p>
<div class="sourceCode" id="cb573"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb573-1"><a href="#cb573-1" aria-hidden="true"></a><span class="dt">char</span> *begin = &amp;arr;</span>
<span id="cb573-2"><a href="#cb573-2" aria-hidden="true"></a><span class="dt">char</span> *end = begin + <span class="kw">sizeof</span>(arr);</span>
<span id="cb573-3"><a href="#cb573-3" aria-hidden="true"></a>std::fill(begin, end, <span class="dv">0</span>);</span></code></pre></div>
</section>
<section id="answer-3-score-22-2" class="level4">
<h4>Answer 3 (score 22)</h4>
<p>
Why would you think setting a single element would clear the entire array? In C, especially, little ever happens without the programmer explicitly programming it. If you set the first element to zero (or any value), then you have done exactly that, and nothing more.
</p>
<p>When initializing you can set an array to zero:</p>
<div class="sourceCode" id="cb574"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb574-1"><a href="#cb574-1" aria-hidden="true"></a><span class="dt">char</span> mcd[<span class="dv">40</span>] = {<span class="dv">0</span>}; <span class="co">/* sets the whole array */</span></span></code></pre></div>
<p>Otherwise, I don’t know any technique other than memset, or something similar.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-to-open-read-and-write-from-serial-port-in-c-score-364263-in-2018" class="level3">
<h3>95: How to open, read, and write from serial port in C? (score <a href="https://stackoverflow.com/q/6947413.html">364263</a> in 2018)</h3>
<section id="question-92" class="level4">
<h4>Question</h4>
<p>I am a little bit confused about reading and writing to a serial port. I have a USB device in Linux that uses the FTDI USB serial device converter driver. When I plug it in, it creates: /dev/ttyUSB1.</p>
<p>I thought itd be simple to open and read/write from it in C. I know the baud rate and parity information, but it seems like there is no standard for this?</p>
<p>Am I missing something, or can someone point me in the right direction?</p>
</section>
<section id="answer-accepted-score-234" class="level4">
<h4>Answer accepted (score 234)</h4>
<p>I wrote this a long time ago (<a href="https://stackoverflow.com/questions/25996171/linux-blocking-vs-non-blocking-serial-read/26006680
#comment70743914_26006680">from years 1985-1992, with just a few tweaks since then</a>), and just copy and paste the bits needed into each project.</p>
<div class="sourceCode" id="cb575"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb575-1"><a href="#cb575-1" aria-hidden="true"></a></span>
<span id="cb575-2"><a href="#cb575-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;errno.h&gt;</span></span>
<span id="cb575-3"><a href="#cb575-3" aria-hidden="true"></a></span>
<span id="cb575-4"><a href="#cb575-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;fcntl.h&gt;</span><span class="pp"> </span></span>
<span id="cb575-5"><a href="#cb575-5" aria-hidden="true"></a></span>
<span id="cb575-6"><a href="#cb575-6" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;string.h&gt;</span></span>
<span id="cb575-7"><a href="#cb575-7" aria-hidden="true"></a></span>
<span id="cb575-8"><a href="#cb575-8" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;termios.h&gt;</span></span>
<span id="cb575-9"><a href="#cb575-9" aria-hidden="true"></a></span>
<span id="cb575-10"><a href="#cb575-10" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;unistd.h&gt;</span></span>
<span id="cb575-11"><a href="#cb575-11" aria-hidden="true"></a></span>
<span id="cb575-12"><a href="#cb575-12" aria-hidden="true"></a><span class="dt">int</span></span>
<span id="cb575-13"><a href="#cb575-13" aria-hidden="true"></a>set_interface_attribs (<span class="dt">int</span> fd, <span class="dt">int</span> speed, <span class="dt">int</span> parity)</span>
<span id="cb575-14"><a href="#cb575-14" aria-hidden="true"></a>{</span>
<span id="cb575-15"><a href="#cb575-15" aria-hidden="true"></a>        <span class="kw">struct</span> termios tty;</span>
<span id="cb575-16"><a href="#cb575-16" aria-hidden="true"></a>        memset (&amp;tty, <span class="dv">0</span>, <span class="kw">sizeof</span> tty);</span>
<span id="cb575-17"><a href="#cb575-17" aria-hidden="true"></a>        <span class="cf">if</span> (tcgetattr (fd, &amp;tty) != <span class="dv">0</span>)</span>
<span id="cb575-18"><a href="#cb575-18" aria-hidden="true"></a>        {</span>
<span id="cb575-19"><a href="#cb575-19" aria-hidden="true"></a>                error_message (<span class="st">&quot;error %d from tcgetattr&quot;</span>, errno);</span>
<span id="cb575-20"><a href="#cb575-20" aria-hidden="true"></a>                <span class="cf">return</span> -<span class="dv">1</span>;</span>
<span id="cb575-21"><a href="#cb575-21" aria-hidden="true"></a>        }</span>
<span id="cb575-22"><a href="#cb575-22" aria-hidden="true"></a></span>
<span id="cb575-23"><a href="#cb575-23" aria-hidden="true"></a>        cfsetospeed (&amp;tty, speed);</span>
<span id="cb575-24"><a href="#cb575-24" aria-hidden="true"></a>        cfsetispeed (&amp;tty, speed);</span>
<span id="cb575-25"><a href="#cb575-25" aria-hidden="true"></a></span>
<span id="cb575-26"><a href="#cb575-26" aria-hidden="true"></a>        tty.c_cflag = (tty.c_cflag &amp; ~CSIZE) | CS8;     <span class="co">// 8-bit chars</span></span>
<span id="cb575-27"><a href="#cb575-27" aria-hidden="true"></a>        <span class="co">// disable IGNBRK for mismatched speed tests; otherwise receive break</span></span>
<span id="cb575-28"><a href="#cb575-28" aria-hidden="true"></a>        <span class="co">// as \000 chars</span></span>
<span id="cb575-29"><a href="#cb575-29" aria-hidden="true"></a>        tty.c_iflag &amp;= ~IGNBRK;         <span class="co">// disable break processing</span></span>
<span id="cb575-30"><a href="#cb575-30" aria-hidden="true"></a>        tty.c_lflag = <span class="dv">0</span>;                <span class="co">// no signaling chars, no echo,</span></span>
<span id="cb575-31"><a href="#cb575-31" aria-hidden="true"></a>                                        <span class="co">// no canonical processing</span></span>
<span id="cb575-32"><a href="#cb575-32" aria-hidden="true"></a>        tty.c_oflag = <span class="dv">0</span>;                <span class="co">// no remapping, no delays</span></span>
<span id="cb575-33"><a href="#cb575-33" aria-hidden="true"></a>        tty.c_cc[VMIN]  = <span class="dv">0</span>;            <span class="co">// read doesn&#39;t block</span></span>
<span id="cb575-34"><a href="#cb575-34" aria-hidden="true"></a>        tty.c_cc[VTIME] = <span class="dv">5</span>;            <span class="co">// 0.5 seconds read timeout</span></span>
<span id="cb575-35"><a href="#cb575-35" aria-hidden="true"></a></span>
<span id="cb575-36"><a href="#cb575-36" aria-hidden="true"></a>        tty.c_iflag &amp;= ~(IXON | IXOFF | IXANY); <span class="co">// shut off xon/xoff ctrl</span></span>
<span id="cb575-37"><a href="#cb575-37" aria-hidden="true"></a></span>
<span id="cb575-38"><a href="#cb575-38" aria-hidden="true"></a>        tty.c_cflag |= (CLOCAL | CREAD);<span class="co">// ignore modem controls,</span></span>
<span id="cb575-39"><a href="#cb575-39" aria-hidden="true"></a>                                        <span class="co">// enable reading</span></span>
<span id="cb575-40"><a href="#cb575-40" aria-hidden="true"></a>        tty.c_cflag &amp;= ~(PARENB | PARODD);      <span class="co">// shut off parity</span></span>
<span id="cb575-41"><a href="#cb575-41" aria-hidden="true"></a>        tty.c_cflag |= parity;</span>
<span id="cb575-42"><a href="#cb575-42" aria-hidden="true"></a>        tty.c_cflag &amp;= ~CSTOPB;</span>
<span id="cb575-43"><a href="#cb575-43" aria-hidden="true"></a>        tty.c_cflag &amp;= ~CRTSCTS;</span>
<span id="cb575-44"><a href="#cb575-44" aria-hidden="true"></a></span>
<span id="cb575-45"><a href="#cb575-45" aria-hidden="true"></a>        <span class="cf">if</span> (tcsetattr (fd, TCSANOW, &amp;tty) != <span class="dv">0</span>)</span>
<span id="cb575-46"><a href="#cb575-46" aria-hidden="true"></a>        {</span>
<span id="cb575-47"><a href="#cb575-47" aria-hidden="true"></a>                error_message (<span class="st">&quot;error %d from tcsetattr&quot;</span>, errno);</span>
<span id="cb575-48"><a href="#cb575-48" aria-hidden="true"></a>                <span class="cf">return</span> -<span class="dv">1</span>;</span>
<span id="cb575-49"><a href="#cb575-49" aria-hidden="true"></a>        }</span>
<span id="cb575-50"><a href="#cb575-50" aria-hidden="true"></a>        <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb575-51"><a href="#cb575-51" aria-hidden="true"></a>}</span>
<span id="cb575-52"><a href="#cb575-52" aria-hidden="true"></a></span>
<span id="cb575-53"><a href="#cb575-53" aria-hidden="true"></a><span class="dt">void</span></span>
<span id="cb575-54"><a href="#cb575-54" aria-hidden="true"></a>set_blocking (<span class="dt">int</span> fd, <span class="dt">int</span> should_block)</span>
<span id="cb575-55"><a href="#cb575-55" aria-hidden="true"></a>{</span>
<span id="cb575-56"><a href="#cb575-56" aria-hidden="true"></a>        <span class="kw">struct</span> termios tty;</span>
<span id="cb575-57"><a href="#cb575-57" aria-hidden="true"></a>        memset (&amp;tty, <span class="dv">0</span>, <span class="kw">sizeof</span> tty);</span>
<span id="cb575-58"><a href="#cb575-58" aria-hidden="true"></a>        <span class="cf">if</span> (tcgetattr (fd, &amp;tty) != <span class="dv">0</span>)</span>
<span id="cb575-59"><a href="#cb575-59" aria-hidden="true"></a>        {</span>
<span id="cb575-60"><a href="#cb575-60" aria-hidden="true"></a>                error_message (<span class="st">&quot;error %d from tggetattr&quot;</span>, errno);</span>
<span id="cb575-61"><a href="#cb575-61" aria-hidden="true"></a>                <span class="cf">return</span>;</span>
<span id="cb575-62"><a href="#cb575-62" aria-hidden="true"></a>        }</span>
<span id="cb575-63"><a href="#cb575-63" aria-hidden="true"></a></span>
<span id="cb575-64"><a href="#cb575-64" aria-hidden="true"></a>        tty.c_cc[VMIN]  = should_block ? <span class="dv">1</span> : <span class="dv">0</span>;</span>
<span id="cb575-65"><a href="#cb575-65" aria-hidden="true"></a>        tty.c_cc[VTIME] = <span class="dv">5</span>;            <span class="co">// 0.5 seconds read timeout</span></span>
<span id="cb575-66"><a href="#cb575-66" aria-hidden="true"></a></span>
<span id="cb575-67"><a href="#cb575-67" aria-hidden="true"></a>        <span class="cf">if</span> (tcsetattr (fd, TCSANOW, &amp;tty) != <span class="dv">0</span>)</span>
<span id="cb575-68"><a href="#cb575-68" aria-hidden="true"></a>                error_message (<span class="st">&quot;error %d setting term attributes&quot;</span>, errno);</span>
<span id="cb575-69"><a href="#cb575-69" aria-hidden="true"></a>}</span>
<span id="cb575-70"><a href="#cb575-70" aria-hidden="true"></a></span>
<span id="cb575-71"><a href="#cb575-71" aria-hidden="true"></a></span>
<span id="cb575-72"><a href="#cb575-72" aria-hidden="true"></a>...</span>
<span id="cb575-73"><a href="#cb575-73" aria-hidden="true"></a><span class="dt">char</span> *portname = <span class="st">&quot;/dev/ttyUSB1&quot;</span></span>
<span id="cb575-74"><a href="#cb575-74" aria-hidden="true"></a> ...</span>
<span id="cb575-75"><a href="#cb575-75" aria-hidden="true"></a><span class="dt">int</span> fd = open (portname, O_RDWR | O_NOCTTY | O_SYNC);</span>
<span id="cb575-76"><a href="#cb575-76" aria-hidden="true"></a><span class="cf">if</span> (fd &lt; <span class="dv">0</span>)</span>
<span id="cb575-77"><a href="#cb575-77" aria-hidden="true"></a>{</span>
<span id="cb575-78"><a href="#cb575-78" aria-hidden="true"></a>        error_message (<span class="st">&quot;error %d opening %s: %s&quot;</span>, errno, portname, strerror (errno));</span>
<span id="cb575-79"><a href="#cb575-79" aria-hidden="true"></a>        <span class="cf">return</span>;</span>
<span id="cb575-80"><a href="#cb575-80" aria-hidden="true"></a>}</span>
<span id="cb575-81"><a href="#cb575-81" aria-hidden="true"></a></span>
<span id="cb575-82"><a href="#cb575-82" aria-hidden="true"></a>set_interface_attribs (fd, B115200, <span class="dv">0</span>);  <span class="co">// set speed to 115,200 bps, 8n1 (no parity)</span></span>
<span id="cb575-83"><a href="#cb575-83" aria-hidden="true"></a>set_blocking (fd, <span class="dv">0</span>);                <span class="co">// set no blocking</span></span>
<span id="cb575-84"><a href="#cb575-84" aria-hidden="true"></a></span>
<span id="cb575-85"><a href="#cb575-85" aria-hidden="true"></a>write (fd, <span class="st">&quot;hello!</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="dv">7</span>);           <span class="co">// send 7 character greeting</span></span>
<span id="cb575-86"><a href="#cb575-86" aria-hidden="true"></a></span>
<span id="cb575-87"><a href="#cb575-87" aria-hidden="true"></a>usleep ((<span class="dv">7</span> + <span class="dv">25</span>) * <span class="dv">100</span>);             <span class="co">// sleep enough to transmit the 7 plus</span></span>
<span id="cb575-88"><a href="#cb575-88" aria-hidden="true"></a>                                     <span class="co">// receive 25:  approx 100 uS per char transmit</span></span>
<span id="cb575-89"><a href="#cb575-89" aria-hidden="true"></a><span class="dt">char</span> buf [<span class="dv">100</span>];</span>
<span id="cb575-90"><a href="#cb575-90" aria-hidden="true"></a><span class="dt">int</span> n = read (fd, buf, <span class="kw">sizeof</span> buf);  <span class="co">// read up to 100 characters if ready to read</span></span></code></pre></div>
<p>The values for speed are <code>B115200</code>, <code>B230400</code>, <code>B9600</code>, <code>B19200</code>, <code>B38400</code>, <code>B57600</code>, <code>B1200</code>, <code>B2400</code>, <code>B4800</code>, etc. The values for parity are <code>0</code> (meaning no parity), <code>PARENB|PARODD</code> (enable parity and use odd), <code>PARENB</code> (enable parity and use even), <code>PARENB|PARODD|CMSPAR</code> (mark parity), and <code>PARENB|CMSPAR</code> (space parity).</p>
<p>“Blocking” sets whether a <code>read()</code> on the port waits for the specified number of characters to arrive. Setting <em>no blocking</em> means that a <code>read()</code> returns however many characters are available without waiting for more, up to the buffer limit.</p>
<hr>
<p>Addendum:</p>
<p><code>CMSPAR</code> is needed only for choosing mark and space parity, which is uncommon. For most applications, it can be omitted. My header file <code>/usr/include/bits/termios.h</code> enables definition of <code>CMSPAR</code> only if the preprocessor symbol <code>__USE_MISC</code> is defined. That definition occurs (in <code>features.h</code>) with</p>
<div class="sourceCode" id="cb576"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb576-1"><a href="#cb576-1" aria-hidden="true"></a></span>
<span id="cb576-2"><a href="#cb576-2" aria-hidden="true"></a><span class="pp">#if defined _BSD_SOURCE || defined _SVID_SOURCE</span></span>
<span id="cb576-3"><a href="#cb576-3" aria-hidden="true"></a></span>
<span id="cb576-4"><a href="#cb576-4" aria-hidden="true"></a><span class="pp">#define __USE_MISC     1</span></span>
<span id="cb576-5"><a href="#cb576-5" aria-hidden="true"></a></span>
<span id="cb576-6"><a href="#cb576-6" aria-hidden="true"></a><span class="pp">#endif</span></span></code></pre></div>
<p>The introductory comments of <code>&amp;lt;features.h&amp;gt;</code> says:</p>
<div class="sourceCode" id="cb577"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb577-1"><a href="#cb577-1" aria-hidden="true"></a><span class="co">/* These are defined by the user (or the compiler)</span></span>
<span id="cb577-2"><a href="#cb577-2" aria-hidden="true"></a><span class="co">   to specify the desired environment:</span></span>
<span id="cb577-3"><a href="#cb577-3" aria-hidden="true"></a></span>
<span id="cb577-4"><a href="#cb577-4" aria-hidden="true"></a><span class="co">...</span></span>
<span id="cb577-5"><a href="#cb577-5" aria-hidden="true"></a><span class="co">   _BSD_SOURCE          ISO C, POSIX, and 4.3BSD things.</span></span>
<span id="cb577-6"><a href="#cb577-6" aria-hidden="true"></a><span class="co">   _SVID_SOURCE         ISO C, POSIX, and SVID things.</span></span>
<span id="cb577-7"><a href="#cb577-7" aria-hidden="true"></a><span class="co">...</span></span>
<span id="cb577-8"><a href="#cb577-8" aria-hidden="true"></a><span class="co"> */</span></span></code></pre></div>
</section>
<section id="answer-2-score-43" class="level4">
<h4>Answer 2 (score 43)</h4>
<p>
For demo code that conforms to POSIX standard as described in <a href="http://www.chemie.fu-berlin.de/chemnet/use/info/libc/libc_12.html
#SEC237" rel="nofollow noreferrer">Setting Terminal Modes Properly</a> and <a href="http://www.cmrr.umn.edu/~strupp/serial.html" rel="nofollow noreferrer">Serial Programming Guide for POSIX Operating Systems</a>, the following is offered.<br> It’s essentially derived from the other answer, but inaccurate and misleading comments have been corrected.
</p>
<div class="sourceCode" id="cb578"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb578-1"><a href="#cb578-1" aria-hidden="true"></a></span>
<span id="cb578-2"><a href="#cb578-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;errno.h&gt;</span></span>
<span id="cb578-3"><a href="#cb578-3" aria-hidden="true"></a></span>
<span id="cb578-4"><a href="#cb578-4" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;fcntl.h&gt;</span><span class="pp"> </span></span>
<span id="cb578-5"><a href="#cb578-5" aria-hidden="true"></a></span>
<span id="cb578-6"><a href="#cb578-6" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb578-7"><a href="#cb578-7" aria-hidden="true"></a></span>
<span id="cb578-8"><a href="#cb578-8" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdlib.h&gt;</span></span>
<span id="cb578-9"><a href="#cb578-9" aria-hidden="true"></a></span>
<span id="cb578-10"><a href="#cb578-10" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;string.h&gt;</span></span>
<span id="cb578-11"><a href="#cb578-11" aria-hidden="true"></a></span>
<span id="cb578-12"><a href="#cb578-12" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;termios.h&gt;</span></span>
<span id="cb578-13"><a href="#cb578-13" aria-hidden="true"></a></span>
<span id="cb578-14"><a href="#cb578-14" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;unistd.h&gt;</span></span>
<span id="cb578-15"><a href="#cb578-15" aria-hidden="true"></a></span>
<span id="cb578-16"><a href="#cb578-16" aria-hidden="true"></a><span class="dt">int</span> set_interface_attribs(<span class="dt">int</span> fd, <span class="dt">int</span> speed)</span>
<span id="cb578-17"><a href="#cb578-17" aria-hidden="true"></a>{</span>
<span id="cb578-18"><a href="#cb578-18" aria-hidden="true"></a>    <span class="kw">struct</span> termios tty;</span>
<span id="cb578-19"><a href="#cb578-19" aria-hidden="true"></a></span>
<span id="cb578-20"><a href="#cb578-20" aria-hidden="true"></a>    <span class="cf">if</span> (tcgetattr(fd, &amp;tty) &lt; <span class="dv">0</span>) {</span>
<span id="cb578-21"><a href="#cb578-21" aria-hidden="true"></a>        printf(<span class="st">&quot;Error from tcgetattr: %s</span><span class="sc">\n</span><span class="st">&quot;</span>, strerror(errno));</span>
<span id="cb578-22"><a href="#cb578-22" aria-hidden="true"></a>        <span class="cf">return</span> -<span class="dv">1</span>;</span>
<span id="cb578-23"><a href="#cb578-23" aria-hidden="true"></a>    }</span>
<span id="cb578-24"><a href="#cb578-24" aria-hidden="true"></a></span>
<span id="cb578-25"><a href="#cb578-25" aria-hidden="true"></a>    cfsetospeed(&amp;tty, (speed_t)speed);</span>
<span id="cb578-26"><a href="#cb578-26" aria-hidden="true"></a>    cfsetispeed(&amp;tty, (speed_t)speed);</span>
<span id="cb578-27"><a href="#cb578-27" aria-hidden="true"></a></span>
<span id="cb578-28"><a href="#cb578-28" aria-hidden="true"></a>    tty.c_cflag |= (CLOCAL | CREAD);    <span class="co">/* ignore modem controls */</span></span>
<span id="cb578-29"><a href="#cb578-29" aria-hidden="true"></a>    tty.c_cflag &amp;= ~CSIZE;</span>
<span id="cb578-30"><a href="#cb578-30" aria-hidden="true"></a>    tty.c_cflag |= CS8;         <span class="co">/* 8-bit characters */</span></span>
<span id="cb578-31"><a href="#cb578-31" aria-hidden="true"></a>    tty.c_cflag &amp;= ~PARENB;     <span class="co">/* no parity bit */</span></span>
<span id="cb578-32"><a href="#cb578-32" aria-hidden="true"></a>    tty.c_cflag &amp;= ~CSTOPB;     <span class="co">/* only need 1 stop bit */</span></span>
<span id="cb578-33"><a href="#cb578-33" aria-hidden="true"></a>    tty.c_cflag &amp;= ~CRTSCTS;    <span class="co">/* no hardware flowcontrol */</span></span>
<span id="cb578-34"><a href="#cb578-34" aria-hidden="true"></a></span>
<span id="cb578-35"><a href="#cb578-35" aria-hidden="true"></a>    <span class="co">/* setup for non-canonical mode */</span></span>
<span id="cb578-36"><a href="#cb578-36" aria-hidden="true"></a>    tty.c_iflag &amp;= ~(IGNBRK | BRKINT | PARMRK | ISTRIP | INLCR | IGNCR | ICRNL | IXON);</span>
<span id="cb578-37"><a href="#cb578-37" aria-hidden="true"></a>    tty.c_lflag &amp;= ~(ECHO | ECHONL | ICANON | ISIG | IEXTEN);</span>
<span id="cb578-38"><a href="#cb578-38" aria-hidden="true"></a>    tty.c_oflag &amp;= ~OPOST;</span>
<span id="cb578-39"><a href="#cb578-39" aria-hidden="true"></a></span>
<span id="cb578-40"><a href="#cb578-40" aria-hidden="true"></a>    <span class="co">/* fetch bytes as they become available */</span></span>
<span id="cb578-41"><a href="#cb578-41" aria-hidden="true"></a>    tty.c_cc[VMIN] = <span class="dv">1</span>;</span>
<span id="cb578-42"><a href="#cb578-42" aria-hidden="true"></a>    tty.c_cc[VTIME] = <span class="dv">1</span>;</span>
<span id="cb578-43"><a href="#cb578-43" aria-hidden="true"></a></span>
<span id="cb578-44"><a href="#cb578-44" aria-hidden="true"></a>    <span class="cf">if</span> (tcsetattr(fd, TCSANOW, &amp;tty) != <span class="dv">0</span>) {</span>
<span id="cb578-45"><a href="#cb578-45" aria-hidden="true"></a>        printf(<span class="st">&quot;Error from tcsetattr: %s</span><span class="sc">\n</span><span class="st">&quot;</span>, strerror(errno));</span>
<span id="cb578-46"><a href="#cb578-46" aria-hidden="true"></a>        <span class="cf">return</span> -<span class="dv">1</span>;</span>
<span id="cb578-47"><a href="#cb578-47" aria-hidden="true"></a>    }</span>
<span id="cb578-48"><a href="#cb578-48" aria-hidden="true"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb578-49"><a href="#cb578-49" aria-hidden="true"></a>}</span>
<span id="cb578-50"><a href="#cb578-50" aria-hidden="true"></a></span>
<span id="cb578-51"><a href="#cb578-51" aria-hidden="true"></a><span class="dt">void</span> set_mincount(<span class="dt">int</span> fd, <span class="dt">int</span> mcount)</span>
<span id="cb578-52"><a href="#cb578-52" aria-hidden="true"></a>{</span>
<span id="cb578-53"><a href="#cb578-53" aria-hidden="true"></a>    <span class="kw">struct</span> termios tty;</span>
<span id="cb578-54"><a href="#cb578-54" aria-hidden="true"></a></span>
<span id="cb578-55"><a href="#cb578-55" aria-hidden="true"></a>    <span class="cf">if</span> (tcgetattr(fd, &amp;tty) &lt; <span class="dv">0</span>) {</span>
<span id="cb578-56"><a href="#cb578-56" aria-hidden="true"></a>        printf(<span class="st">&quot;Error tcgetattr: %s</span><span class="sc">\n</span><span class="st">&quot;</span>, strerror(errno));</span>
<span id="cb578-57"><a href="#cb578-57" aria-hidden="true"></a>        <span class="cf">return</span>;</span>
<span id="cb578-58"><a href="#cb578-58" aria-hidden="true"></a>    }</span>
<span id="cb578-59"><a href="#cb578-59" aria-hidden="true"></a></span>
<span id="cb578-60"><a href="#cb578-60" aria-hidden="true"></a>    tty.c_cc[VMIN] = mcount ? <span class="dv">1</span> : <span class="dv">0</span>;</span>
<span id="cb578-61"><a href="#cb578-61" aria-hidden="true"></a>    tty.c_cc[VTIME] = <span class="dv">5</span>;        <span class="co">/* half second timer */</span></span>
<span id="cb578-62"><a href="#cb578-62" aria-hidden="true"></a></span>
<span id="cb578-63"><a href="#cb578-63" aria-hidden="true"></a>    <span class="cf">if</span> (tcsetattr(fd, TCSANOW, &amp;tty) &lt; <span class="dv">0</span>)</span>
<span id="cb578-64"><a href="#cb578-64" aria-hidden="true"></a>        printf(<span class="st">&quot;Error tcsetattr: %s</span><span class="sc">\n</span><span class="st">&quot;</span>, strerror(errno));</span>
<span id="cb578-65"><a href="#cb578-65" aria-hidden="true"></a>}</span>
<span id="cb578-66"><a href="#cb578-66" aria-hidden="true"></a></span>
<span id="cb578-67"><a href="#cb578-67" aria-hidden="true"></a></span>
<span id="cb578-68"><a href="#cb578-68" aria-hidden="true"></a><span class="dt">int</span> main()</span>
<span id="cb578-69"><a href="#cb578-69" aria-hidden="true"></a>{</span>
<span id="cb578-70"><a href="#cb578-70" aria-hidden="true"></a>    <span class="dt">char</span> *portname = <span class="st">&quot;/dev/ttyUSB0&quot;</span>;</span>
<span id="cb578-71"><a href="#cb578-71" aria-hidden="true"></a>    <span class="dt">int</span> fd;</span>
<span id="cb578-72"><a href="#cb578-72" aria-hidden="true"></a>    <span class="dt">int</span> wlen;</span>
<span id="cb578-73"><a href="#cb578-73" aria-hidden="true"></a></span>
<span id="cb578-74"><a href="#cb578-74" aria-hidden="true"></a>    fd = open(portname, O_RDWR | O_NOCTTY | O_SYNC);</span>
<span id="cb578-75"><a href="#cb578-75" aria-hidden="true"></a>    <span class="cf">if</span> (fd &lt; <span class="dv">0</span>) {</span>
<span id="cb578-76"><a href="#cb578-76" aria-hidden="true"></a>        printf(<span class="st">&quot;Error opening %s: %s</span><span class="sc">\n</span><span class="st">&quot;</span>, portname, strerror(errno));</span>
<span id="cb578-77"><a href="#cb578-77" aria-hidden="true"></a>        <span class="cf">return</span> -<span class="dv">1</span>;</span>
<span id="cb578-78"><a href="#cb578-78" aria-hidden="true"></a>    }</span>
<span id="cb578-79"><a href="#cb578-79" aria-hidden="true"></a>    <span class="co">/*baudrate 115200, 8 bits, no parity, 1 stop bit */</span></span>
<span id="cb578-80"><a href="#cb578-80" aria-hidden="true"></a>    set_interface_attribs(fd, B115200);</span>
<span id="cb578-81"><a href="#cb578-81" aria-hidden="true"></a>    <span class="co">//set_mincount(fd, 0);                /* set to pure timed read */</span></span>
<span id="cb578-82"><a href="#cb578-82" aria-hidden="true"></a></span>
<span id="cb578-83"><a href="#cb578-83" aria-hidden="true"></a>    <span class="co">/* simple output */</span></span>
<span id="cb578-84"><a href="#cb578-84" aria-hidden="true"></a>    wlen = write(fd, <span class="st">&quot;Hello!</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="dv">7</span>);</span>
<span id="cb578-85"><a href="#cb578-85" aria-hidden="true"></a>    <span class="cf">if</span> (wlen != <span class="dv">7</span>) {</span>
<span id="cb578-86"><a href="#cb578-86" aria-hidden="true"></a>        printf(<span class="st">&quot;Error from write: %d, %d</span><span class="sc">\n</span><span class="st">&quot;</span>, wlen, errno);</span>
<span id="cb578-87"><a href="#cb578-87" aria-hidden="true"></a>    }</span>
<span id="cb578-88"><a href="#cb578-88" aria-hidden="true"></a>    tcdrain(fd);    <span class="co">/* delay for output */</span></span>
<span id="cb578-89"><a href="#cb578-89" aria-hidden="true"></a></span>
<span id="cb578-90"><a href="#cb578-90" aria-hidden="true"></a></span>
<span id="cb578-91"><a href="#cb578-91" aria-hidden="true"></a>    <span class="co">/* simple noncanonical input */</span></span>
<span id="cb578-92"><a href="#cb578-92" aria-hidden="true"></a>    <span class="cf">do</span> {</span>
<span id="cb578-93"><a href="#cb578-93" aria-hidden="true"></a>        <span class="dt">unsigned</span> <span class="dt">char</span> buf[<span class="dv">80</span>];</span>
<span id="cb578-94"><a href="#cb578-94" aria-hidden="true"></a>        <span class="dt">int</span> rdlen;</span>
<span id="cb578-95"><a href="#cb578-95" aria-hidden="true"></a></span>
<span id="cb578-96"><a href="#cb578-96" aria-hidden="true"></a>        rdlen = read(fd, buf, <span class="kw">sizeof</span>(buf) - <span class="dv">1</span>);</span>
<span id="cb578-97"><a href="#cb578-97" aria-hidden="true"></a>        <span class="cf">if</span> (rdlen &gt; <span class="dv">0</span>) {</span>
<span id="cb578-98"><a href="#cb578-98" aria-hidden="true"></a></span>
<span id="cb578-99"><a href="#cb578-99" aria-hidden="true"></a><span class="pp">#ifdef DISPLAY_STRING</span></span>
<span id="cb578-100"><a href="#cb578-100" aria-hidden="true"></a>            buf[rdlen] = <span class="dv">0</span>;</span>
<span id="cb578-101"><a href="#cb578-101" aria-hidden="true"></a>            printf(<span class="st">&quot;Read %d: </span><span class="sc">\&quot;</span><span class="st">%s</span><span class="sc">\&quot;\n</span><span class="st">&quot;</span>, rdlen, buf);</span>
<span id="cb578-102"><a href="#cb578-102" aria-hidden="true"></a></span>
<span id="cb578-103"><a href="#cb578-103" aria-hidden="true"></a><span class="pp">#else </span><span class="co">/* display hex */</span></span>
<span id="cb578-104"><a href="#cb578-104" aria-hidden="true"></a>            <span class="dt">unsigned</span> <span class="dt">char</span>   *p;</span>
<span id="cb578-105"><a href="#cb578-105" aria-hidden="true"></a>            printf(<span class="st">&quot;Read %d:&quot;</span>, rdlen);</span>
<span id="cb578-106"><a href="#cb578-106" aria-hidden="true"></a>            <span class="cf">for</span> (p = buf; rdlen-- &gt; <span class="dv">0</span>; p++)</span>
<span id="cb578-107"><a href="#cb578-107" aria-hidden="true"></a>                printf(<span class="st">&quot; 0x%x&quot;</span>, *p);</span>
<span id="cb578-108"><a href="#cb578-108" aria-hidden="true"></a>            printf(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>);</span>
<span id="cb578-109"><a href="#cb578-109" aria-hidden="true"></a></span>
<span id="cb578-110"><a href="#cb578-110" aria-hidden="true"></a><span class="pp">#endif</span></span>
<span id="cb578-111"><a href="#cb578-111" aria-hidden="true"></a>        } <span class="cf">else</span> <span class="cf">if</span> (rdlen &lt; <span class="dv">0</span>) {</span>
<span id="cb578-112"><a href="#cb578-112" aria-hidden="true"></a>            printf(<span class="st">&quot;Error from read: %d: %s</span><span class="sc">\n</span><span class="st">&quot;</span>, rdlen, strerror(errno));</span>
<span id="cb578-113"><a href="#cb578-113" aria-hidden="true"></a>        } <span class="cf">else</span> {  <span class="co">/* rdlen == 0 */</span></span>
<span id="cb578-114"><a href="#cb578-114" aria-hidden="true"></a>            printf(<span class="st">&quot;Timeout from read</span><span class="sc">\n</span><span class="st">&quot;</span>);</span>
<span id="cb578-115"><a href="#cb578-115" aria-hidden="true"></a>        }               </span>
<span id="cb578-116"><a href="#cb578-116" aria-hidden="true"></a>        <span class="co">/* repeat read to get full message */</span></span>
<span id="cb578-117"><a href="#cb578-117" aria-hidden="true"></a>    } <span class="cf">while</span> (<span class="dv">1</span>);</span>
<span id="cb578-118"><a href="#cb578-118" aria-hidden="true"></a>}</span></code></pre></div>
<p>To make the program treat the received data as ASCII codes, compile the program with the symbol DISPLAY_STRING, e.g. </p>
<div class="sourceCode" id="cb579"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb579-1"><a href="#cb579-1" aria-hidden="true"></a> cc -DDISPLAY_STRING demo.c</span></code></pre></div>
<hr>
<p>If the received data is ASCII text (rather than binary data) and you want to read it as lines terminated by the newline character, then see <a href="https://stackoverflow.com/questions/57152937/canonical-mode-linux-serial-port/57155531
#57155531">this answer</a> for a sample program.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="what-does-void-mean-in-c-c-and-c-score-360403-in-2018" class="level3">
<h3>96: What does void mean in C, C++, and C#? (score <a href="https://stackoverflow.com/q/1043034.html">360403</a> in 2018)</h3>
<section id="question-93" class="level4">
<h4>Question</h4>
<p>Looking to get the fundamentals on where the term “<em>void</em>” comes from, and why it is called void. The intention of the question is to assist someone who has no C experience, and is suddenly looking at a C-based codebase.</p>
</section>
<section id="answer-accepted-score-217" class="level4">
<h4>Answer accepted (score 217)</h4>
<p>Basically it means “nothing” or “no type”</p>
<p>There are 3 basic ways that void is used:</p>
<ol>
<li>
<p>
Function argument: <code>int myFunc(void)</code> – the function takes nothing.
</p>
</li>
<li>
<p>
Function return value: <code>void myFunc(int)</code> – the function returns nothing
</p>
</li>
<li>
<p>
Generic data pointer: <code>void* data</code> – ‘data’ is a pointer to data of unknown type, and cannot be dereferenced
</p>
</li>
</ol>
<p>Note: the <code>void</code> in a function argument is optional in C++, so <code>int myFunc()</code> is exactly the same as <code>int myFunc(void)</code>, and it is left out completely in C #. It is always required for a return value.</p>
</section>
<section id="answer-2-score-31-2" class="level4">
<h4>Answer 2 (score 31)</h4>
<p>I have always taken it to mean <em>absent</em>. Here are four cases in the C language that matches to this use of <em>absent</em></p>
<ul>
<li>
<code>R f(void)</code> - Function parameters are <em>absent</em>
</li>
<li>
<code>void f(P)</code> - Return value is <em>absent</em>
</li>
<li>
<code>void *p</code> - Type of what is pointed to is <em>absent</em>
</li>
<li>
<code>(void) p</code> - Usage of value is <em>absent</em>
</li>
</ul>
<p>Other C descendants use it for other things. The <code>D</code> programming language uses it for cases where an initializer is <em>absent</em></p>
<ul>
<li>
<code>T t = void;</code> - initializing value is <em>absent</em>
</li>
</ul>
</section>
<section id="answer-3-score-13-1" class="level4">
<h4>Answer 3 (score 13)</h4>
<p>There are two ways to use void:</p>
<div class="sourceCode" id="cb580"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb580-1"><a href="#cb580-1" aria-hidden="true"></a><span class="dt">void</span> foo(<span class="dt">void</span>);</span></code></pre></div>
<p>or</p>
<div class="sourceCode" id="cb581"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb581-1"><a href="#cb581-1" aria-hidden="true"></a><span class="dt">void</span> *bar(<span class="dt">void</span>*);</span></code></pre></div>
<p>The first indicates that no argument is being passed or that no argument is being returned.</p>
<p>The second tells the compiler that there is no type associated with the data effectively meaning that the you can’t make use of the data pointed to until it is cast to a known type.</p>
<p>For example you will see <code>void*</code> used a lot when you have an interface which calls a function whose parameters can’t be known ahead of time.</p>
<p>For example, in the Linux Kernel when deferring work you will setup a function to be run at a latter time by giving it a pointer to the function to be run and a pointer to the data to be passed to the function:</p>
<div class="sourceCode" id="cb582"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb582-1"><a href="#cb582-1" aria-hidden="true"></a><span class="kw">struct</span> _deferred_work {</span>
<span id="cb582-2"><a href="#cb582-2" aria-hidden="true"></a>sruct list_head mylist;</span>
<span id="cb582-3"><a href="#cb582-3" aria-hidden="true"></a>.worker_func = bar;</span>
<span id="cb582-4"><a href="#cb582-4" aria-hidden="true"></a>.data        = somedata;</span>
<span id="cb582-5"><a href="#cb582-5" aria-hidden="true"></a>} deferred_work;</span></code></pre></div>
<p>Then a kernel thread goes over a list of deferred work and when it get’s to this node it effectively executes:</p>
<div class="sourceCode" id="cb583"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb583-1"><a href="#cb583-1" aria-hidden="true"></a>bar(somedata);</span></code></pre></div>
<p>Then in bar you have:</p>
<div class="sourceCode" id="cb584"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb584-1"><a href="#cb584-1" aria-hidden="true"></a><span class="dt">void</span> bar(<span class="dt">void</span>* mydata) {</span>
<span id="cb584-2"><a href="#cb584-2" aria-hidden="true"></a>    <span class="dt">int</span> *data = mydata;</span>
<span id="cb584-3"><a href="#cb584-3" aria-hidden="true"></a>    <span class="co">/* do something with data */</span>;</span>
<span id="cb584-4"><a href="#cb584-4" aria-hidden="true"></a>}</span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="stack-smashing-detected-score-356971-in-2012" class="level3">
<h3>97: Stack smashing detected (score <a href="https://stackoverflow.com/q/1345670.html">356971</a> in 2012)</h3>
<section id="question-94" class="level4">
<h4>Question</h4>
<p>I am executing my a.out file. After execution the program runs for some time then exits with the message:</p>
<div class="sourceCode" id="cb585"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb585-1"><a href="#cb585-1" aria-hidden="true"></a>**** stack smashing detected ***: ./a.out terminated*</span>
<span id="cb585-2"><a href="#cb585-2" aria-hidden="true"></a>*======= Backtrace: =========*</span>
<span id="cb585-3"><a href="#cb585-3" aria-hidden="true"></a>*/lib/tls/i686/cmov/libc.so<span class="fl">.6</span>(__fortify_fail+<span class="bn">0x48</span>)Aborted*</span></code></pre></div>
<p>What could be the possible reasons for this and how do I rectify it?</p>
</section>
<section id="answer-accepted-score-309" class="level4">
<h4>Answer accepted (score 309)</h4>
<p>Stack Smashing here is actually caused due to a protection mechanism used by gcc to detect buffer overflow errors. For example in the following snippet:</p>
<div class="sourceCode" id="cb586"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb586-1"><a href="#cb586-1" aria-hidden="true"></a></span>
<span id="cb586-2"><a href="#cb586-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb586-3"><a href="#cb586-3" aria-hidden="true"></a></span>
<span id="cb586-4"><a href="#cb586-4" aria-hidden="true"></a><span class="dt">void</span> func()</span>
<span id="cb586-5"><a href="#cb586-5" aria-hidden="true"></a>{</span>
<span id="cb586-6"><a href="#cb586-6" aria-hidden="true"></a>    <span class="dt">char</span> array[<span class="dv">10</span>];</span>
<span id="cb586-7"><a href="#cb586-7" aria-hidden="true"></a>    gets(array);</span>
<span id="cb586-8"><a href="#cb586-8" aria-hidden="true"></a>}</span>
<span id="cb586-9"><a href="#cb586-9" aria-hidden="true"></a></span>
<span id="cb586-10"><a href="#cb586-10" aria-hidden="true"></a><span class="dt">int</span> main(<span class="dt">int</span> argc, <span class="dt">char</span> **argv)</span>
<span id="cb586-11"><a href="#cb586-11" aria-hidden="true"></a>{</span>
<span id="cb586-12"><a href="#cb586-12" aria-hidden="true"></a>    func();</span>
<span id="cb586-13"><a href="#cb586-13" aria-hidden="true"></a>}</span></code></pre></div>
<p>The compiler, (in this case gcc) adds protection variables (called canaries) which have known values. An input string of size greater than 10 causes corruption of this variable resulting in SIGABRT to terminate the program.</p>
<p>To get some insight, you can try disabling this protection of gcc using option <code>-fno-stack-protector</code> while compiling. In that case you will get a different error, most likely a segmentation fault as you are trying to access an illegal memory location. Note that <code>-fstack-protector</code> should always be turned on for release builds as it is a security feature.</p>
<p>You can get some information about the point of overflow by running the program with a debugger. Valgrind doesn’t work well with stack-related errors, but like a debugger, it may help you pin-point the location and reason for the crash.</p>
</section>
<section id="answer-2-score-24-1" class="level4">
<h4>Answer 2 (score 24)</h4>
<p><strong>Minimal reproduction example with disassembly analysis</strong></p>
<p>main.c</p>
<div class="sourceCode" id="cb587"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb587-1"><a href="#cb587-1" aria-hidden="true"></a><span class="dt">void</span> myfunc(<span class="dt">char</span> *<span class="dt">const</span> src, <span class="dt">int</span> len) {</span>
<span id="cb587-2"><a href="#cb587-2" aria-hidden="true"></a>    <span class="dt">int</span> i;</span>
<span id="cb587-3"><a href="#cb587-3" aria-hidden="true"></a>    <span class="cf">for</span> (i = <span class="dv">0</span>; i &lt; len; ++i) {</span>
<span id="cb587-4"><a href="#cb587-4" aria-hidden="true"></a>        src[i] = <span class="dv">42</span>;</span>
<span id="cb587-5"><a href="#cb587-5" aria-hidden="true"></a>    }</span>
<span id="cb587-6"><a href="#cb587-6" aria-hidden="true"></a>}</span>
<span id="cb587-7"><a href="#cb587-7" aria-hidden="true"></a></span>
<span id="cb587-8"><a href="#cb587-8" aria-hidden="true"></a><span class="dt">int</span> main(<span class="dt">void</span>) {</span>
<span id="cb587-9"><a href="#cb587-9" aria-hidden="true"></a>    <span class="dt">char</span> arr[] = {<span class="ch">&#39;a&#39;</span>, <span class="ch">&#39;b&#39;</span>, <span class="ch">&#39;c&#39;</span>, <span class="ch">&#39;d&#39;</span>};</span>
<span id="cb587-10"><a href="#cb587-10" aria-hidden="true"></a>    <span class="dt">int</span> len = <span class="kw">sizeof</span>(arr);</span>
<span id="cb587-11"><a href="#cb587-11" aria-hidden="true"></a>    myfunc(arr, len + <span class="dv">1</span>);</span>
<span id="cb587-12"><a href="#cb587-12" aria-hidden="true"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb587-13"><a href="#cb587-13" aria-hidden="true"></a>}</span></code></pre></div>
<p><a href="https://github.com/cirosantilli/linux-kernel-module-cheat/blob/e0fb39c92ae071a444cb92fbb2d0c1977fa7af51/userland/c/smash_stack.c" rel="nofollow noreferrer">GitHub upstream</a>.</p>
<p>Compile and run:</p>
<div class="sourceCode" id="cb588"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb588-1"><a href="#cb588-1" aria-hidden="true"></a>gcc -fstack-protector -g -O0 -std=c99 main.c</span>
<span id="cb588-2"><a href="#cb588-2" aria-hidden="true"></a>ulimit -c unlimited &amp;&amp; rm -f core</span>
<span id="cb588-3"><a href="#cb588-3" aria-hidden="true"></a>./a.out</span></code></pre></div>
<p>fails as desired:</p>
<div class="sourceCode" id="cb589"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb589-1"><a href="#cb589-1" aria-hidden="true"></a>*** stack smashing detected ***: ./a.out terminated</span>
<span id="cb589-2"><a href="#cb589-2" aria-hidden="true"></a>Aborted (core dumped)</span></code></pre></div>
<p>Tested on Ubuntu 16.04, GCC 6.4.0.</p>
<p><strong>Disassembly</strong></p>
<p>Now we look at the disassembly:</p>
<div class="sourceCode" id="cb590"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb590-1"><a href="#cb590-1" aria-hidden="true"></a>objdump -D a.out</span></code></pre></div>
<p>which contains:</p>
<div class="sourceCode" id="cb591"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb591-1"><a href="#cb591-1" aria-hidden="true"></a><span class="dt">int</span> main (<span class="dt">void</span>){</span>
<span id="cb591-2"><a href="#cb591-2" aria-hidden="true"></a>  <span class="dv">400579</span>:       <span class="dv">55</span>                      push   %rbp</span>
<span id="cb591-3"><a href="#cb591-3" aria-hidden="true"></a>  <span class="dv">40057</span><span class="er">a</span>:       <span class="dv">48</span> <span class="dv">89</span> e5                mov    %rsp,%rbp</span>
<span id="cb591-4"><a href="#cb591-4" aria-hidden="true"></a></span>
<span id="cb591-5"><a href="#cb591-5" aria-hidden="true"></a></span>
<span id="cb591-6"><a href="#cb591-6" aria-hidden="true"></a><span class="er"># Allocate 0x10 of stack space.</span></span>
<span id="cb591-7"><a href="#cb591-7" aria-hidden="true"></a>  <span class="dv">40057</span><span class="er">d</span>:       <span class="dv">48</span> <span class="dv">83</span> ec <span class="dv">10</span>             sub    $<span class="bn">0x10</span>,%rsp</span>
<span id="cb591-8"><a href="#cb591-8" aria-hidden="true"></a></span>
<span id="cb591-9"><a href="#cb591-9" aria-hidden="true"></a></span>
<span id="cb591-10"><a href="#cb591-10" aria-hidden="true"></a><span class="er"># Put the 8 byte canary from %fs:0x28 to -0x8(%rbp),</span></span>
<span id="cb591-11"><a href="#cb591-11" aria-hidden="true"></a></span>
<span id="cb591-12"><a href="#cb591-12" aria-hidden="true"></a><span class="er"># which is right at the bottom of the stack.</span></span>
<span id="cb591-13"><a href="#cb591-13" aria-hidden="true"></a>  <span class="dv">400581</span>:       <span class="dv">64</span> <span class="dv">48</span> <span class="dv">8</span><span class="er">b</span> <span class="bn">04</span> <span class="dv">25</span> <span class="dv">28</span> <span class="bn">00</span>    mov    %fs:<span class="bn">0x28</span>,%rax</span>
<span id="cb591-14"><a href="#cb591-14" aria-hidden="true"></a>  <span class="dv">400588</span>:       <span class="bn">00</span> <span class="bn">00</span> </span>
<span id="cb591-15"><a href="#cb591-15" aria-hidden="true"></a>  <span class="dv">40058</span><span class="er">a</span>:       <span class="dv">48</span> <span class="dv">89</span> <span class="dv">45</span> f8             mov    %rax,-<span class="bn">0x8</span>(%rbp)</span>
<span id="cb591-16"><a href="#cb591-16" aria-hidden="true"></a></span>
<span id="cb591-17"><a href="#cb591-17" aria-hidden="true"></a>  <span class="dv">40058</span><span class="er">e</span>:       <span class="dv">31</span> c0                   xor    %eax,%eax</span>
<span id="cb591-18"><a href="#cb591-18" aria-hidden="true"></a>    <span class="dt">char</span> arr[] = {<span class="ch">&#39;a&#39;</span>, <span class="ch">&#39;b&#39;</span>, <span class="ch">&#39;c&#39;</span>, <span class="ch">&#39;d&#39;</span>};</span>
<span id="cb591-19"><a href="#cb591-19" aria-hidden="true"></a>  <span class="dv">400590</span>:       c6 <span class="dv">45</span> f4 <span class="dv">61</span>             movb   $<span class="bn">0x61</span>,-<span class="bn">0xc</span>(%rbp)</span>
<span id="cb591-20"><a href="#cb591-20" aria-hidden="true"></a>  <span class="dv">400594</span>:       c6 <span class="dv">45</span> f5 <span class="dv">62</span>             movb   $<span class="bn">0x62</span>,-<span class="bn">0xb</span>(%rbp)</span>
<span id="cb591-21"><a href="#cb591-21" aria-hidden="true"></a>  <span class="dv">400598</span>:       c6 <span class="dv">45</span> f6 <span class="dv">63</span>             movb   $<span class="bn">0x63</span>,-<span class="bn">0xa</span>(%rbp)</span>
<span id="cb591-22"><a href="#cb591-22" aria-hidden="true"></a>  <span class="dv">40059</span><span class="er">c</span>:       c6 <span class="dv">45</span> f7 <span class="dv">64</span>             movb   $<span class="bn">0x64</span>,-<span class="bn">0x9</span>(%rbp)</span>
<span id="cb591-23"><a href="#cb591-23" aria-hidden="true"></a>    <span class="dt">int</span> len = <span class="kw">sizeof</span>(arr);</span>
<span id="cb591-24"><a href="#cb591-24" aria-hidden="true"></a>  <span class="dv">4005</span><span class="er">a0</span>:       c7 <span class="dv">45</span> f0 <span class="bn">04</span> <span class="bn">00</span> <span class="bn">00</span> <span class="bn">00</span>    movl   $<span class="bn">0x4</span>,-<span class="bn">0x10</span>(%rbp)</span>
<span id="cb591-25"><a href="#cb591-25" aria-hidden="true"></a>    myfunc(arr, len + <span class="dv">1</span>);</span>
<span id="cb591-26"><a href="#cb591-26" aria-hidden="true"></a>  <span class="dv">4005</span><span class="er">a7</span>:       <span class="dv">8</span><span class="er">b</span> <span class="dv">45</span> f0                mov    -<span class="bn">0x10</span>(%rbp),%eax</span>
<span id="cb591-27"><a href="#cb591-27" aria-hidden="true"></a>  <span class="dv">4005</span><span class="er">aa</span>:       <span class="dv">8</span><span class="er">d</span> <span class="dv">50</span> <span class="bn">01</span>                lea    <span class="bn">0x1</span>(%rax),%edx</span>
<span id="cb591-28"><a href="#cb591-28" aria-hidden="true"></a>  <span class="dv">4005</span><span class="er">ad</span>:       <span class="dv">48</span> <span class="dv">8</span><span class="er">d</span> <span class="dv">45</span> f4             lea    -<span class="bn">0xc</span>(%rbp),%rax</span>
<span id="cb591-29"><a href="#cb591-29" aria-hidden="true"></a>  <span class="dv">4005</span><span class="er">b1</span>:       <span class="dv">89</span> d6                   mov    %edx,%esi</span>
<span id="cb591-30"><a href="#cb591-30" aria-hidden="true"></a>  <span class="dv">4005</span><span class="er">b3</span>:       <span class="dv">48</span> <span class="dv">89</span> c7                mov    %rax,%rdi</span>
<span id="cb591-31"><a href="#cb591-31" aria-hidden="true"></a>  <span class="dv">4005</span><span class="er">b6</span>:       e8 <span class="dv">8</span><span class="er">b</span> ff ff ff          callq  <span class="dv">400546</span> &lt;myfunc&gt;</span>
<span id="cb591-32"><a href="#cb591-32" aria-hidden="true"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb591-33"><a href="#cb591-33" aria-hidden="true"></a>  <span class="dv">4005</span><span class="er">bb</span>:       b8 <span class="bn">00</span> <span class="bn">00</span> <span class="bn">00</span> <span class="bn">00</span>          mov    $<span class="bn">0x0</span>,%eax</span>
<span id="cb591-34"><a href="#cb591-34" aria-hidden="true"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb592"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb592-1"><a href="#cb592-1" aria-hidden="true"></a></span>
<span id="cb592-2"><a href="#cb592-2" aria-hidden="true"></a><span class="er"># Check that the canary at -0x8(%rbp) hasn&#39;t changed after calling myfunc.</span></span>
<span id="cb592-3"><a href="#cb592-3" aria-hidden="true"></a></span>
<span id="cb592-4"><a href="#cb592-4" aria-hidden="true"></a><span class="pp"># If it has, jump to the failure point __stack_chk_fail.</span></span>
<span id="cb592-5"><a href="#cb592-5" aria-hidden="true"></a>  <span class="dv">4005</span><span class="er">c0</span>:       <span class="dv">48</span> <span class="dv">8</span><span class="er">b</span> <span class="dv">4</span><span class="er">d</span> f8             mov    -<span class="bn">0x8</span>(%rbp),%rcx</span>
<span id="cb592-6"><a href="#cb592-6" aria-hidden="true"></a>  <span class="dv">4005</span><span class="er">c4</span>:       <span class="dv">64</span> <span class="dv">48</span> <span class="dv">33</span> <span class="dv">0</span><span class="er">c</span> <span class="dv">25</span> <span class="dv">28</span> <span class="bn">00</span>    xor    %fs:<span class="bn">0x28</span>,%rcx</span>
<span id="cb592-7"><a href="#cb592-7" aria-hidden="true"></a>  <span class="dv">4005</span><span class="er">cb</span>:       <span class="bn">00</span> <span class="bn">00</span> </span>
<span id="cb592-8"><a href="#cb592-8" aria-hidden="true"></a>  <span class="dv">4005</span><span class="er">cd</span>:       <span class="dv">74</span> <span class="bn">05</span>                   je     <span class="dv">4005</span><span class="er">d4</span> &lt;main+<span class="bn">0x5b</span>&gt;</span>
<span id="cb592-9"><a href="#cb592-9" aria-hidden="true"></a>  <span class="dv">4005</span><span class="er">cf</span>:       e8 <span class="dv">4</span><span class="er">c</span> fe ff ff          callq  <span class="dv">400420</span> &lt;__stack_chk_fail@plt&gt;</span>
<span id="cb592-10"><a href="#cb592-10" aria-hidden="true"></a></span>
<span id="cb592-11"><a href="#cb592-11" aria-hidden="true"></a></span>
<span id="cb592-12"><a href="#cb592-12" aria-hidden="true"></a><span class="er"># Otherwise, exit normally.</span></span>
<span id="cb592-13"><a href="#cb592-13" aria-hidden="true"></a>  <span class="dv">4005</span><span class="er">d4</span>:       c9                      leaveq </span>
<span id="cb592-14"><a href="#cb592-14" aria-hidden="true"></a>  <span class="dv">4005</span><span class="er">d5</span>:       c3                      retq   </span>
<span id="cb592-15"><a href="#cb592-15" aria-hidden="true"></a>  <span class="dv">4005</span><span class="er">d6</span>:       <span class="dv">66</span> <span class="dv">2</span><span class="er">e</span> <span class="dv">0</span><span class="er">f</span> <span class="dv">1</span><span class="er">f</span> <span class="dv">84</span> <span class="bn">00</span> <span class="bn">00</span>    nopw   %cs:<span class="bn">0x0</span>(%rax,%rax,<span class="dv">1</span>)</span>
<span id="cb592-16"><a href="#cb592-16" aria-hidden="true"></a>  <span class="dv">4005</span><span class="er">dd</span>:       <span class="bn">00</span> <span class="bn">00</span> <span class="bn">00</span> </span></code></pre></div>
<p>Notice the handy comments automatically added by <code>objdump</code>’s <a href="https://en.wikipedia.org/wiki/Joke" rel="nofollow noreferrer">artificial intelligence module</a>.</p>
<p>If you run this program multiple times through GDB, you will see that:</p>
<ul>
<li>
the canary gets a different random value every time
</li>
<li>
the last loop of <code>myfunc</code> is exactly what modifies the address of the canary
</li>
</ul>
<p>The canary randomized by setting it with <code>%fs:0x28</code>, which contains a random value as explained at:</p>
<ul>
<li>
<a href="https://unix.stackexchange.com/questions/453749/what-sets-fs0x28-stack-canary">https://unix.stackexchange.com/questions/453749/what-sets-fs0x28-stack-canary</a>
</li>
<li>
<a href="https://stackoverflow.com/questions/10325713/why-does-this-memory-address-fs0x28-fs0x28-have-a-random-value">Why does this memory address %fs:0x28 ( fs[0x28] ) have a random value?</a>
</li>
</ul>
<p><strong>Debug attempts</strong></p>
<p>From now on, we modify the code:</p>
<div class="sourceCode" id="cb593"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb593-1"><a href="#cb593-1" aria-hidden="true"></a>    myfunc(arr, len + <span class="dv">1</span>);</span></code></pre></div>
<p>to be instead:</p>
<div class="sourceCode" id="cb594"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb594-1"><a href="#cb594-1" aria-hidden="true"></a>    myfunc(arr, len);</span>
<span id="cb594-2"><a href="#cb594-2" aria-hidden="true"></a>    myfunc(arr, len + <span class="dv">1</span>); <span class="co">/* line 12 */</span></span>
<span id="cb594-3"><a href="#cb594-3" aria-hidden="true"></a>    myfunc(arr, len);</span></code></pre></div>
<p>to be more interesting.</p>
<p>We will then try to see if we can pinpoint the culprit <code>+ 1</code> call with a method more automated than just reading and understanding the entire source code.</p>
<p><strong><code>gcc -fsanitize=address</code> to enable Google’s Address Sanitizer (ASan)</strong></p>
<p>If you recompile with this flag and run the program, it outputs:</p>
<div class="sourceCode" id="cb595"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb595-1"><a href="#cb595-1" aria-hidden="true"></a></span>
<span id="cb595-2"><a href="#cb595-2" aria-hidden="true"></a><span class="er">#0 0x4008bf in myfunc /home/ciro/test/main.c:4</span></span>
<span id="cb595-3"><a href="#cb595-3" aria-hidden="true"></a></span>
<span id="cb595-4"><a href="#cb595-4" aria-hidden="true"></a><span class="er">#1 0x40099b in main /home/ciro/test/main.c:12</span></span>
<span id="cb595-5"><a href="#cb595-5" aria-hidden="true"></a></span>
<span id="cb595-6"><a href="#cb595-6" aria-hidden="true"></a><span class="er">#2 0x7fcd2e13d82f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)</span></span>
<span id="cb595-7"><a href="#cb595-7" aria-hidden="true"></a></span>
<span id="cb595-8"><a href="#cb595-8" aria-hidden="true"></a><span class="er">#3 0x400798 in _start (/home/ciro/test/a.out+0x40079</span></span></code></pre></div>
<p>followed by some more colored output.</p>
<p>This clearly pinpoints the problematic line 12.</p>
<p>The source code for this is at: <a href="https://github.com/google/sanitizers" rel="nofollow noreferrer">https://github.com/google/sanitizers</a> but as we saw from the example it is already upstreamed into GCC.</p>
<p>ASan can also detect other memory problems such as memory leaks: <a href="https://stackoverflow.com/questions/6261201/how-to-find-memory-leak-in-a-c-code-project/57877190
#57877190">How to find memory leak in a C++ code/project?</a></p>
<p><strong>Valgrind SGCheck</strong></p>
<p>As <a href="https://stackoverflow.com/a/1345689/895245">mentioned by others</a>, Valgrind is not good at solving this kind of problem.</p>
<p>It does have an experimental tool <a href="http://valgrind.org/docs/manual/sg-manual.html" rel="nofollow noreferrer">called SGCheck</a>:</p>
<blockquote>
SGCheck is a tool for finding overruns of stack and global arrays. It works by using a heuristic approach derived from an observation about the likely forms of stack and global array accesses.
</blockquote>
<p>So I was not very surprised when it did not find the error:</p>
<div class="sourceCode" id="cb596"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb596-1"><a href="#cb596-1" aria-hidden="true"></a>valgrind --tool=exp-sgcheck ./a.out</span></code></pre></div>
<p>The error message should look like this apparently: <a href="https://stackoverflow.com/questions/36997537/valgrind-missing-error/36997685
#36997685">Valgrind missing error</a></p>
<p><strong>GDB</strong></p>
<p>An important observation is that if you run the program through GDB, or examine the <code>core</code> file after the fact:</p>
<div class="sourceCode" id="cb597"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb597-1"><a href="#cb597-1" aria-hidden="true"></a>gdb -nh -q a.out core</span></code></pre></div>
<p>then, as we saw on the assembly, GDB should point you to the end of the function that did the canary check:</p>
<div class="sourceCode" id="cb598"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb598-1"><a href="#cb598-1" aria-hidden="true"></a>(gdb) bt</span>
<span id="cb598-2"><a href="#cb598-2" aria-hidden="true"></a></span>
<span id="cb598-3"><a href="#cb598-3" aria-hidden="true"></a><span class="er">#0  0x00007f0f66e20428 in __GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:54</span></span>
<span id="cb598-4"><a href="#cb598-4" aria-hidden="true"></a></span>
<span id="cb598-5"><a href="#cb598-5" aria-hidden="true"></a><span class="er">#1  0x00007f0f66e2202a in __GI_abort () at abort.c:89</span></span>
<span id="cb598-6"><a href="#cb598-6" aria-hidden="true"></a></span>
<span id="cb598-7"><a href="#cb598-7" aria-hidden="true"></a><span class="er">#2  0x00007f0f66e627ea in __libc_message (do_abort=do_abort@entry=1, fmt=fmt@entry=0x7f0f66f7a49f &quot;*** %s ***: %s terminated\n&quot;) at ../sysdeps/posix/libc_fatal.c:175</span></span>
<span id="cb598-8"><a href="#cb598-8" aria-hidden="true"></a></span>
<span id="cb598-9"><a href="#cb598-9" aria-hidden="true"></a><span class="er">#3  0x00007f0f66f0415c in __GI___fortify_fail (msg=&lt;optimized out&gt;, msg@entry=0x7f0f66f7a481 &quot;stack smashing detected&quot;) at fortify_fail.c:37</span></span>
<span id="cb598-10"><a href="#cb598-10" aria-hidden="true"></a></span>
<span id="cb598-11"><a href="#cb598-11" aria-hidden="true"></a><span class="er">#4  0x00007f0f66f04100 in __stack_chk_fail () at stack_chk_fail.c:28</span></span>
<span id="cb598-12"><a href="#cb598-12" aria-hidden="true"></a></span>
<span id="cb598-13"><a href="#cb598-13" aria-hidden="true"></a><span class="er">#5  0x00000000004005f6 in main () at main.c:15</span></span>
<span id="cb598-14"><a href="#cb598-14" aria-hidden="true"></a>(gdb) f <span class="dv">5</span></span>
<span id="cb598-15"><a href="#cb598-15" aria-hidden="true"></a></span>
<span id="cb598-16"><a href="#cb598-16" aria-hidden="true"></a><span class="er">#5  0x00000000004005f6 in main () at main.c:15</span></span>
<span id="cb598-17"><a href="#cb598-17" aria-hidden="true"></a><span class="dv">15</span>      }</span>
<span id="cb598-18"><a href="#cb598-18" aria-hidden="true"></a>(gdb)</span></code></pre></div>
<p>And therefore the problem is likely in one of the calls that this function made.</p>
<p>Next we try to pinpoint the exact failing call by first single stepping up just after the canary is set:</p>
<div class="sourceCode" id="cb599"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb599-1"><a href="#cb599-1" aria-hidden="true"></a>  <span class="dv">400581</span>:       <span class="dv">64</span> <span class="dv">48</span> <span class="dv">8</span><span class="er">b</span> <span class="bn">04</span> <span class="dv">25</span> <span class="dv">28</span> <span class="bn">00</span>    mov    %fs:<span class="bn">0x28</span>,%rax</span>
<span id="cb599-2"><a href="#cb599-2" aria-hidden="true"></a>  <span class="dv">400588</span>:       <span class="bn">00</span> <span class="bn">00</span> </span>
<span id="cb599-3"><a href="#cb599-3" aria-hidden="true"></a>  <span class="dv">40058</span><span class="er">a</span>:       <span class="dv">48</span> <span class="dv">89</span> <span class="dv">45</span> f8             mov    %rax,-<span class="bn">0x8</span>(%rbp)</span></code></pre></div>
<p>and watching the address:</p>
<div class="sourceCode" id="cb600"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb600-1"><a href="#cb600-1" aria-hidden="true"></a>(gdb) p $rbp - <span class="bn">0x8</span></span>
<span id="cb600-2"><a href="#cb600-2" aria-hidden="true"></a>$<span class="dv">1</span> = (<span class="dt">void</span> *) <span class="bn">0x7fffffffcf18</span></span>
<span id="cb600-3"><a href="#cb600-3" aria-hidden="true"></a>(gdb) watch <span class="bn">0x7fffffffcf18</span></span>
<span id="cb600-4"><a href="#cb600-4" aria-hidden="true"></a>Hardware watchpoint <span class="dv">2</span>: *<span class="bn">0x7fffffffcf18</span></span>
<span id="cb600-5"><a href="#cb600-5" aria-hidden="true"></a>(gdb) c</span>
<span id="cb600-6"><a href="#cb600-6" aria-hidden="true"></a>Continuing.</span>
<span id="cb600-7"><a href="#cb600-7" aria-hidden="true"></a></span>
<span id="cb600-8"><a href="#cb600-8" aria-hidden="true"></a>Hardware watchpoint <span class="dv">2</span>: *<span class="bn">0x7fffffffcf18</span></span>
<span id="cb600-9"><a href="#cb600-9" aria-hidden="true"></a></span>
<span id="cb600-10"><a href="#cb600-10" aria-hidden="true"></a>Old value = <span class="dv">1800814336</span></span>
<span id="cb600-11"><a href="#cb600-11" aria-hidden="true"></a>New value = <span class="dv">1800814378</span></span>
<span id="cb600-12"><a href="#cb600-12" aria-hidden="true"></a>myfunc (src=<span class="bn">0x7fffffffcf14</span> <span class="st">&quot;*****?Vk\266&quot;</span>, &lt;incomplete sequence \<span class="dv">355</span>\<span class="dv">216</span>&gt;, len=<span class="dv">5</span>) at main.c:<span class="dv">3</span></span>
<span id="cb600-13"><a href="#cb600-13" aria-hidden="true"></a><span class="dv">3</span>           <span class="cf">for</span> (i = <span class="dv">0</span>; i &lt; len; ++i) {</span>
<span id="cb600-14"><a href="#cb600-14" aria-hidden="true"></a>(gdb) p len</span>
<span id="cb600-15"><a href="#cb600-15" aria-hidden="true"></a>$<span class="dv">2</span> = <span class="dv">5</span></span>
<span id="cb600-16"><a href="#cb600-16" aria-hidden="true"></a>(gdb) p i</span>
<span id="cb600-17"><a href="#cb600-17" aria-hidden="true"></a>$<span class="dv">3</span> = <span class="dv">4</span></span>
<span id="cb600-18"><a href="#cb600-18" aria-hidden="true"></a>(gdb) bt</span>
<span id="cb600-19"><a href="#cb600-19" aria-hidden="true"></a></span>
<span id="cb600-20"><a href="#cb600-20" aria-hidden="true"></a><span class="er">#0  myfunc (src=0x7fffffffcf14 &quot;*****?Vk\266&quot;, &lt;incomplete sequence \355\216&gt;, len=5) at main.c:3</span></span>
<span id="cb600-21"><a href="#cb600-21" aria-hidden="true"></a></span>
<span id="cb600-22"><a href="#cb600-22" aria-hidden="true"></a><span class="er">#1  0x00000000004005cc in main () at main.c:12</span></span></code></pre></div>
<p>Now, this does leaves us at the right offending instruction: <code>len = 5</code> and <code>i = 4</code>, and in this particular case, did point us to the culprit line 12.</p>
<p>However, the backtrace is corrupted, and contains some trash. A correct backtrace would look like:</p>
<div class="sourceCode" id="cb601"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb601-1"><a href="#cb601-1" aria-hidden="true"></a></span>
<span id="cb601-2"><a href="#cb601-2" aria-hidden="true"></a><span class="er">#0  myfunc (src=0x7fffffffcf14 &quot;abcd&quot;, len=4) at main.c:3</span></span>
<span id="cb601-3"><a href="#cb601-3" aria-hidden="true"></a></span>
<span id="cb601-4"><a href="#cb601-4" aria-hidden="true"></a><span class="er">#1  0x00000000004005b8 in main () at main.c:11</span></span></code></pre></div>
<p>so maybe this could corrupt the stack and prevent you from seeing the trace.</p>
<p>Also, this method requires knowing what is the last call of the canary checking function otherwise you will have false positives, which will not always be feasible, unless you <a href="https://stackoverflow.com/questions/1206872/how-to-go-to-the-previous-line-in-gdb/46996380
#46996380">use reverse debugging</a>.</p>
</section>
<section id="answer-3-score-16-1" class="level4">
<h4>Answer 3 (score 16)</h4>
<p>Please look at the following situation:</p>
<div class="sourceCode" id="cb602"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb602-1"><a href="#cb602-1" aria-hidden="true"></a>ab@cd-x:$ cat test_overflow.c </span>
<span id="cb602-2"><a href="#cb602-2" aria-hidden="true"></a></span>
<span id="cb602-3"><a href="#cb602-3" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb602-4"><a href="#cb602-4" aria-hidden="true"></a></span>
<span id="cb602-5"><a href="#cb602-5" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;string.h&gt;</span></span>
<span id="cb602-6"><a href="#cb602-6" aria-hidden="true"></a></span>
<span id="cb602-7"><a href="#cb602-7" aria-hidden="true"></a><span class="dt">int</span> check_password(<span class="dt">char</span> *password){</span>
<span id="cb602-8"><a href="#cb602-8" aria-hidden="true"></a>    <span class="dt">int</span> flag = <span class="dv">0</span>;</span>
<span id="cb602-9"><a href="#cb602-9" aria-hidden="true"></a>    <span class="dt">char</span> buffer[<span class="dv">20</span>];</span>
<span id="cb602-10"><a href="#cb602-10" aria-hidden="true"></a>    strcpy(buffer, password);</span>
<span id="cb602-11"><a href="#cb602-11" aria-hidden="true"></a></span>
<span id="cb602-12"><a href="#cb602-12" aria-hidden="true"></a>    <span class="cf">if</span>(strcmp(buffer, <span class="st">&quot;mypass&quot;</span>) == <span class="dv">0</span>){</span>
<span id="cb602-13"><a href="#cb602-13" aria-hidden="true"></a>        flag = <span class="dv">1</span>;</span>
<span id="cb602-14"><a href="#cb602-14" aria-hidden="true"></a>    }</span>
<span id="cb602-15"><a href="#cb602-15" aria-hidden="true"></a>    <span class="cf">if</span>(strcmp(buffer, <span class="st">&quot;yourpass&quot;</span>) == <span class="dv">0</span>){</span>
<span id="cb602-16"><a href="#cb602-16" aria-hidden="true"></a>        flag = <span class="dv">1</span>;</span>
<span id="cb602-17"><a href="#cb602-17" aria-hidden="true"></a>    }</span>
<span id="cb602-18"><a href="#cb602-18" aria-hidden="true"></a>    <span class="cf">return</span> flag;</span>
<span id="cb602-19"><a href="#cb602-19" aria-hidden="true"></a>}</span>
<span id="cb602-20"><a href="#cb602-20" aria-hidden="true"></a></span>
<span id="cb602-21"><a href="#cb602-21" aria-hidden="true"></a><span class="dt">int</span> main(<span class="dt">int</span> argc, <span class="dt">char</span> *argv[]){</span>
<span id="cb602-22"><a href="#cb602-22" aria-hidden="true"></a>    <span class="cf">if</span>(argc &gt;= <span class="dv">2</span>){</span>
<span id="cb602-23"><a href="#cb602-23" aria-hidden="true"></a>        <span class="cf">if</span>(check_password(argv[<span class="dv">1</span>])){</span>
<span id="cb602-24"><a href="#cb602-24" aria-hidden="true"></a>            printf(<span class="st">&quot;%s&quot;</span>, <span class="st">&quot;Access granted</span><span class="sc">\n</span><span class="st">&quot;</span>);</span>
<span id="cb602-25"><a href="#cb602-25" aria-hidden="true"></a>        }<span class="cf">else</span>{</span>
<span id="cb602-26"><a href="#cb602-26" aria-hidden="true"></a>            printf(<span class="st">&quot;%s&quot;</span>, <span class="st">&quot;Access denied</span><span class="sc">\n</span><span class="st">&quot;</span>);</span>
<span id="cb602-27"><a href="#cb602-27" aria-hidden="true"></a>        }</span>
<span id="cb602-28"><a href="#cb602-28" aria-hidden="true"></a>    }<span class="cf">else</span>{</span>
<span id="cb602-29"><a href="#cb602-29" aria-hidden="true"></a>        printf(<span class="st">&quot;%s&quot;</span>, <span class="st">&quot;Please enter password!</span><span class="sc">\n</span><span class="st">&quot;</span>);</span>
<span id="cb602-30"><a href="#cb602-30" aria-hidden="true"></a>    }</span>
<span id="cb602-31"><a href="#cb602-31" aria-hidden="true"></a>}</span>
<span id="cb602-32"><a href="#cb602-32" aria-hidden="true"></a>ab@cd-x:$ gcc -g -fno-stack-protector test_overflow.c </span>
<span id="cb602-33"><a href="#cb602-33" aria-hidden="true"></a>ab@cd-x:$ ./a.out mypass</span>
<span id="cb602-34"><a href="#cb602-34" aria-hidden="true"></a>Access granted</span>
<span id="cb602-35"><a href="#cb602-35" aria-hidden="true"></a>ab@cd-x:$ ./a.out yourpass</span>
<span id="cb602-36"><a href="#cb602-36" aria-hidden="true"></a>Access granted</span>
<span id="cb602-37"><a href="#cb602-37" aria-hidden="true"></a>ab@cd-x:$ ./a.out wepass</span>
<span id="cb602-38"><a href="#cb602-38" aria-hidden="true"></a>Access denied</span>
<span id="cb602-39"><a href="#cb602-39" aria-hidden="true"></a>ab@cd-x:$ ./a.out wepassssssssssssssssss</span>
<span id="cb602-40"><a href="#cb602-40" aria-hidden="true"></a>Access granted</span>
<span id="cb602-41"><a href="#cb602-41" aria-hidden="true"></a></span>
<span id="cb602-42"><a href="#cb602-42" aria-hidden="true"></a>ab@cd-x:$ gcc -g -fstack-protector test_overflow.c </span>
<span id="cb602-43"><a href="#cb602-43" aria-hidden="true"></a>ab@cd-x:$ ./a.out wepass</span>
<span id="cb602-44"><a href="#cb602-44" aria-hidden="true"></a>Access denied</span>
<span id="cb602-45"><a href="#cb602-45" aria-hidden="true"></a>ab@cd-x:$ ./a.out mypass</span>
<span id="cb602-46"><a href="#cb602-46" aria-hidden="true"></a>Access granted</span>
<span id="cb602-47"><a href="#cb602-47" aria-hidden="true"></a>ab@cd-x:$ ./a.out yourpass</span>
<span id="cb602-48"><a href="#cb602-48" aria-hidden="true"></a>Access granted</span>
<span id="cb602-49"><a href="#cb602-49" aria-hidden="true"></a>ab@cd-x:$ ./a.out wepassssssssssssssssss</span>
<span id="cb602-50"><a href="#cb602-50" aria-hidden="true"></a>*** stack smashing detected ***: ./a.out terminated</span>
<span id="cb602-51"><a href="#cb602-51" aria-hidden="true"></a>======= Backtrace: =========</span>
<span id="cb602-52"><a href="#cb602-52" aria-hidden="true"></a>/lib/tls/i686/cmov/libc.so<span class="fl">.6</span>(__fortify_fail+<span class="bn">0x48</span>)[<span class="bn">0xce0ed8</span>]</span>
<span id="cb602-53"><a href="#cb602-53" aria-hidden="true"></a>/lib/tls/i686/cmov/libc.so<span class="fl">.6</span>(__fortify_fail+<span class="bn">0x0</span>)[<span class="bn">0xce0e90</span>]</span>
<span id="cb602-54"><a href="#cb602-54" aria-hidden="true"></a>./a.out[<span class="bn">0x8048524</span>]</span>
<span id="cb602-55"><a href="#cb602-55" aria-hidden="true"></a>./a.out[<span class="bn">0x8048545</span>]</span>
<span id="cb602-56"><a href="#cb602-56" aria-hidden="true"></a>/lib/tls/i686/cmov/libc.so<span class="fl">.6</span>(__libc_start_main+<span class="bn">0xe6</span>)[<span class="bn">0xc16b56</span>]</span>
<span id="cb602-57"><a href="#cb602-57" aria-hidden="true"></a>./a.out[<span class="bn">0x8048411</span>]</span>
<span id="cb602-58"><a href="#cb602-58" aria-hidden="true"></a>======= Memory map: ========</span>
<span id="cb602-59"><a href="#cb602-59" aria-hidden="true"></a><span class="bn">007</span><span class="er">d9000</span>-<span class="bn">007</span><span class="er">f5000</span> r-xp <span class="bn">00000000</span> <span class="er">08</span>:<span class="bn">06</span> <span class="dv">5776</span>       /lib/libgcc_s.so<span class="fl">.1</span></span>
<span id="cb602-60"><a href="#cb602-60" aria-hidden="true"></a><span class="bn">007</span><span class="er">f5000</span>-<span class="bn">007</span><span class="er">f6000</span> r--p <span class="bn">0001</span><span class="er">b000</span> <span class="er">08</span>:<span class="bn">06</span> <span class="dv">5776</span>       /lib/libgcc_s.so<span class="fl">.1</span></span>
<span id="cb602-61"><a href="#cb602-61" aria-hidden="true"></a><span class="bn">007</span><span class="er">f6000</span>-<span class="bn">007</span><span class="er">f7000</span> rw-p <span class="bn">0001</span><span class="er">c000</span> <span class="er">08</span>:<span class="bn">06</span> <span class="dv">5776</span>       /lib/libgcc_s.so<span class="fl">.1</span></span>
<span id="cb602-62"><a href="#cb602-62" aria-hidden="true"></a><span class="bn">00</span><span class="er">90a000</span>-<span class="bn">00</span><span class="er">90b000</span> r-xp <span class="bn">00000000</span> <span class="bn">00</span>:<span class="bn">00</span> <span class="dv">0</span>          [vdso]</span>
<span id="cb602-63"><a href="#cb602-63" aria-hidden="true"></a><span class="bn">00</span><span class="er">c00000</span>-<span class="bn">00</span><span class="er">d3e000</span> r-xp <span class="bn">00000000</span> <span class="er">08</span>:<span class="bn">06</span> <span class="dv">1183</span>       /lib/tls/i686/cmov/libc-<span class="fl">2.10</span><span class="er">.1</span>.so</span>
<span id="cb602-64"><a href="#cb602-64" aria-hidden="true"></a><span class="bn">00</span><span class="er">d3e000</span>-<span class="bn">00</span><span class="er">d3f000</span> ---p <span class="fl">0013e000</span> <span class="er">08</span>:<span class="bn">06</span> <span class="dv">1183</span>       /lib/tls/i686/cmov/libc-<span class="fl">2.10</span><span class="er">.1</span>.so</span>
<span id="cb602-65"><a href="#cb602-65" aria-hidden="true"></a><span class="bn">00</span><span class="er">d3f000</span>-<span class="bn">00</span><span class="er">d41000</span> r--p <span class="fl">0013e000</span> <span class="er">08</span>:<span class="bn">06</span> <span class="dv">1183</span>       /lib/tls/i686/cmov/libc-<span class="fl">2.10</span><span class="er">.1</span>.so</span>
<span id="cb602-66"><a href="#cb602-66" aria-hidden="true"></a><span class="bn">00</span><span class="er">d41000</span>-<span class="bn">00</span><span class="er">d42000</span> rw-p <span class="bn">00140000</span> <span class="er">08</span>:<span class="bn">06</span> <span class="dv">1183</span>       /lib/tls/i686/cmov/libc-<span class="fl">2.10</span><span class="er">.1</span>.so</span>
<span id="cb602-67"><a href="#cb602-67" aria-hidden="true"></a><span class="bn">00</span><span class="er">d42000</span>-<span class="bn">00</span><span class="er">d45000</span> rw-p <span class="bn">00000000</span> <span class="bn">00</span>:<span class="bn">00</span> <span class="dv">0</span> </span>
<span id="cb602-68"><a href="#cb602-68" aria-hidden="true"></a><span class="fl">00e0</span><span class="er">c000</span>-<span class="fl">00e27000</span> r-xp <span class="bn">00000000</span> <span class="er">08</span>:<span class="bn">06</span> <span class="dv">4213</span>       /lib/ld-<span class="fl">2.10</span><span class="er">.1</span>.so</span>
<span id="cb602-69"><a href="#cb602-69" aria-hidden="true"></a><span class="fl">00e27000</span>-<span class="fl">00e28000</span> r--p <span class="bn">0001</span><span class="er">a000</span> <span class="er">08</span>:<span class="bn">06</span> <span class="dv">4213</span>       /lib/ld-<span class="fl">2.10</span><span class="er">.1</span>.so</span>
<span id="cb602-70"><a href="#cb602-70" aria-hidden="true"></a><span class="fl">00e28000</span>-<span class="fl">00e29000</span> rw-p <span class="bn">0001</span><span class="er">b000</span> <span class="er">08</span>:<span class="bn">06</span> <span class="dv">4213</span>       /lib/ld-<span class="fl">2.10</span><span class="er">.1</span>.so</span>
<span id="cb602-71"><a href="#cb602-71" aria-hidden="true"></a><span class="er">08048000</span>-<span class="er">08049000</span> r-xp <span class="bn">00000000</span> <span class="er">08</span>:<span class="bn">05</span> <span class="dv">1056811</span>    /dos/hacking/test/a.out</span>
<span id="cb602-72"><a href="#cb602-72" aria-hidden="true"></a><span class="er">08049000</span>-<span class="er">0804a000</span> r--p <span class="bn">00000000</span> <span class="er">08</span>:<span class="bn">05</span> <span class="dv">1056811</span>    /dos/hacking/test/a.out</span>
<span id="cb602-73"><a href="#cb602-73" aria-hidden="true"></a><span class="er">0804a000</span>-<span class="er">0804b000</span> rw-p <span class="bn">00001000</span> <span class="er">08</span>:<span class="bn">05</span> <span class="dv">1056811</span>    /dos/hacking/test/a.out</span>
<span id="cb602-74"><a href="#cb602-74" aria-hidden="true"></a><span class="er">08675000</span>-<span class="er">08696000</span> rw-p <span class="bn">00000000</span> <span class="bn">00</span>:<span class="bn">00</span> <span class="dv">0</span>          [heap]</span>
<span id="cb602-75"><a href="#cb602-75" aria-hidden="true"></a>b76fe000-b76ff000 rw-p <span class="bn">00000000</span> <span class="bn">00</span>:<span class="bn">00</span> <span class="dv">0</span> </span>
<span id="cb602-76"><a href="#cb602-76" aria-hidden="true"></a>b7717000-b7719000 rw-p <span class="bn">00000000</span> <span class="bn">00</span>:<span class="bn">00</span> <span class="dv">0</span> </span>
<span id="cb602-77"><a href="#cb602-77" aria-hidden="true"></a>bfc1c000-bfc31000 rw-p <span class="bn">00000000</span> <span class="bn">00</span>:<span class="bn">00</span> <span class="dv">0</span>          [stack]</span>
<span id="cb602-78"><a href="#cb602-78" aria-hidden="true"></a>Aborted</span>
<span id="cb602-79"><a href="#cb602-79" aria-hidden="true"></a>ab@cd-x:$ </span></code></pre></div>
<p>When I disabled the stack smashing protector no errors were detected, which should have happened when I used “./a.out wepassssssssssssssssss” <br/></p>
<p>So to answer your question above, the message “** stack smashing detected : xxx” was displayed because your stack smashing protector was active and found that there is stack overflow in your program.</p>
<p>Just find out where that occurs, and fix it.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-to-do-scanf-for-single-char-in-c-score-356225-in-2014" class="level3">
<h3>98: How to do scanf for single char in C (score <a href="https://stackoverflow.com/q/13542055.html">356225</a> in 2014)</h3>
<section id="question-95" class="level4">
<h4>Question</h4>
<p>
In C: I’m trying to get char from the user with <code>scanf</code> and when I run it the program don’t wait for the user to type anything…
</p>
<p>This is the code:</p>
<div class="sourceCode" id="cb603"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb603-1"><a href="#cb603-1" aria-hidden="true"></a><span class="dt">char</span> ch;</span>
<span id="cb603-2"><a href="#cb603-2" aria-hidden="true"></a>printf(<span class="st">&quot;Enter one char&quot;</span>);</span>
<span id="cb603-3"><a href="#cb603-3" aria-hidden="true"></a>scanf(<span class="st">&quot;%c&quot;</span>, &amp;ch);</span>
<span id="cb603-4"><a href="#cb603-4" aria-hidden="true"></a>printf(<span class="st">&quot;%c</span><span class="sc">\n</span><span class="st">&quot;</span>,ch);</span></code></pre></div>
<p>Why is not working?</p>
</section>
<section id="answer-2-score-209" class="level4">
<h4>Answer 2 (score 209)</h4>
<p>The <code>%c</code> conversion specifier won’t automatically skip any leading whitespace, so if there’s a stray newline in the input stream (from a previous entry, for example) the <code>scanf</code> call will consume it immediately.</p>
<p>One way around the problem is to put a blank space before the conversion specifier in the format string:</p>
<div class="sourceCode" id="cb604"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb604-1"><a href="#cb604-1" aria-hidden="true"></a>scanf(<span class="st">&quot; %c&quot;</span>, &amp;c);</span></code></pre></div>
<p>The blank in the format string tells <code>scanf</code> to skip leading whitespace, and the first non-whitespace character will be read with the <code>%c</code> conversion specifier.</p>
</section>
<section id="answer-3-score-14-2" class="level4">
<h4>Answer 3 (score 14)</h4>
<p>First of all, avoid <code>scanf()</code>. Using it is not worth the pain.</p>
<p>See: <a href="http://c-faq.com/stdio/scanfprobs.html" rel="noreferrer">Why does everyone say not to use scanf? What should I use instead?</a></p>
<p>Using a whitespace character in <code>scanf()</code> would ignore any number of whitespace characters left in the input stream, what if you need to read more inputs? Consider:</p>
<div class="sourceCode" id="cb605"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb605-1"><a href="#cb605-1" aria-hidden="true"></a></span>
<span id="cb605-2"><a href="#cb605-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb605-3"><a href="#cb605-3" aria-hidden="true"></a></span>
<span id="cb605-4"><a href="#cb605-4" aria-hidden="true"></a><span class="dt">int</span> main(<span class="dt">void</span>)</span>
<span id="cb605-5"><a href="#cb605-5" aria-hidden="true"></a>{</span>
<span id="cb605-6"><a href="#cb605-6" aria-hidden="true"></a>   <span class="dt">char</span> ch1, ch2;</span>
<span id="cb605-7"><a href="#cb605-7" aria-hidden="true"></a></span>
<span id="cb605-8"><a href="#cb605-8" aria-hidden="true"></a>   scanf(<span class="st">&quot;%c&quot;</span>, &amp;ch1);  <span class="co">/* Leaves the newline in the input */</span></span>
<span id="cb605-9"><a href="#cb605-9" aria-hidden="true"></a>   scanf(<span class="st">&quot; %c&quot;</span>, &amp;ch2); <span class="co">/* The leading whitespace ensures it&#39;s the</span></span>
<span id="cb605-10"><a href="#cb605-10" aria-hidden="true"></a><span class="co">                          previous newline is ignored */</span></span>
<span id="cb605-11"><a href="#cb605-11" aria-hidden="true"></a>   printf(<span class="st">&quot;ch1: %c, ch2: %c</span><span class="sc">\n</span><span class="st">&quot;</span>, ch1, ch2);</span>
<span id="cb605-12"><a href="#cb605-12" aria-hidden="true"></a></span>
<span id="cb605-13"><a href="#cb605-13" aria-hidden="true"></a>   <span class="co">/* All good so far */</span></span>
<span id="cb605-14"><a href="#cb605-14" aria-hidden="true"></a></span>
<span id="cb605-15"><a href="#cb605-15" aria-hidden="true"></a>   <span class="dt">char</span> ch3;</span>
<span id="cb605-16"><a href="#cb605-16" aria-hidden="true"></a>   scanf(<span class="st">&quot;%c&quot;</span>, &amp;ch3); <span class="co">/* Doesn&#39;t read input due to the same problem */</span></span>
<span id="cb605-17"><a href="#cb605-17" aria-hidden="true"></a>   printf(<span class="st">&quot;ch3: %c</span><span class="sc">\n</span><span class="st">&quot;</span>, ch3);</span>
<span id="cb605-18"><a href="#cb605-18" aria-hidden="true"></a></span>
<span id="cb605-19"><a href="#cb605-19" aria-hidden="true"></a>   <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb605-20"><a href="#cb605-20" aria-hidden="true"></a>}</span></code></pre></div>
<p>
While the 3rd scanf() can be fixed in the same way using a leading whitespace, it’s not always going to that simple as above. Another major problem is, <code>scanf()</code> will not discard any input in the input stream if it doesn’t match the format. For example, if you input <code>abc</code> for an <code>int</code> such as: <code>scanf("%d", &amp;amp;int_var);</code> then <code>abc</code> will have to read and discarded. Consider:
</p>
<div class="sourceCode" id="cb606"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb606-1"><a href="#cb606-1" aria-hidden="true"></a></span>
<span id="cb606-2"><a href="#cb606-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb606-3"><a href="#cb606-3" aria-hidden="true"></a></span>
<span id="cb606-4"><a href="#cb606-4" aria-hidden="true"></a><span class="dt">int</span> main(<span class="dt">void</span>)</span>
<span id="cb606-5"><a href="#cb606-5" aria-hidden="true"></a>{</span>
<span id="cb606-6"><a href="#cb606-6" aria-hidden="true"></a>    <span class="dt">int</span> i;</span>
<span id="cb606-7"><a href="#cb606-7" aria-hidden="true"></a></span>
<span id="cb606-8"><a href="#cb606-8" aria-hidden="true"></a>    <span class="cf">while</span>(<span class="dv">1</span>) {</span>
<span id="cb606-9"><a href="#cb606-9" aria-hidden="true"></a>        <span class="cf">if</span> (scanf(<span class="st">&quot;%d&quot;</span>, &amp;i) != <span class="dv">1</span>) { <span class="co">/* Input &quot;abc&quot; */</span></span>
<span id="cb606-10"><a href="#cb606-10" aria-hidden="true"></a>            printf(<span class="st">&quot;Invalid input. Try again</span><span class="sc">\n</span><span class="st">&quot;</span>);</span>
<span id="cb606-11"><a href="#cb606-11" aria-hidden="true"></a>        } <span class="cf">else</span> {</span>
<span id="cb606-12"><a href="#cb606-12" aria-hidden="true"></a>            <span class="cf">break</span>;</span>
<span id="cb606-13"><a href="#cb606-13" aria-hidden="true"></a>        }</span>
<span id="cb606-14"><a href="#cb606-14" aria-hidden="true"></a>    }</span>
<span id="cb606-15"><a href="#cb606-15" aria-hidden="true"></a></span>
<span id="cb606-16"><a href="#cb606-16" aria-hidden="true"></a>    printf(<span class="st">&quot;Int read: %d</span><span class="sc">\n</span><span class="st">&quot;</span>, i);</span>
<span id="cb606-17"><a href="#cb606-17" aria-hidden="true"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb606-18"><a href="#cb606-18" aria-hidden="true"></a>}</span></code></pre></div>
<p>Another common problem is mixing <code>scanf()</code> and <code>fgets()</code>. Consider:</p>
<div class="sourceCode" id="cb607"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb607-1"><a href="#cb607-1" aria-hidden="true"></a></span>
<span id="cb607-2"><a href="#cb607-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb607-3"><a href="#cb607-3" aria-hidden="true"></a></span>
<span id="cb607-4"><a href="#cb607-4" aria-hidden="true"></a><span class="dt">int</span> main(<span class="dt">void</span>)</span>
<span id="cb607-5"><a href="#cb607-5" aria-hidden="true"></a>{</span>
<span id="cb607-6"><a href="#cb607-6" aria-hidden="true"></a>    <span class="dt">int</span> age;</span>
<span id="cb607-7"><a href="#cb607-7" aria-hidden="true"></a>    <span class="dt">char</span> name[<span class="dv">256</span>];</span>
<span id="cb607-8"><a href="#cb607-8" aria-hidden="true"></a>    printf(<span class="st">&quot;Input your age:&quot;</span>);</span>
<span id="cb607-9"><a href="#cb607-9" aria-hidden="true"></a>    scanf(<span class="st">&quot;%d&quot;</span>, &amp;age); <span class="co">/* Input 10 */</span></span>
<span id="cb607-10"><a href="#cb607-10" aria-hidden="true"></a>    printf(<span class="st">&quot;Input your full name [firstname lastname]&quot;</span>);</span>
<span id="cb607-11"><a href="#cb607-11" aria-hidden="true"></a>    fgets(name, <span class="kw">sizeof</span> name, stdin); <span class="co">/* Doesn&#39;t read! */</span></span>
<span id="cb607-12"><a href="#cb607-12" aria-hidden="true"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb607-13"><a href="#cb607-13" aria-hidden="true"></a>}</span></code></pre></div>
<p>The call to <code>fgets()</code> doesn’t wait for input because the newline left by the previous scanf() call is read and fgets() terminates input reading when it encounters a newline.</p>
<p>There are many other similar problems associated with <code>scanf()</code>. That’s why it’s generally recommended to avoid it.</p>
<p>So, what’s the alternative? Use <a href="http://man7.org/linux/man-pages/man3/fgetc.3.html" rel="noreferrer"><code>fgets()</code></a> function instead in the following fashion to read a single character:</p>
<div class="sourceCode" id="cb608"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb608-1"><a href="#cb608-1" aria-hidden="true"></a></span>
<span id="cb608-2"><a href="#cb608-2" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb608-3"><a href="#cb608-3" aria-hidden="true"></a></span>
<span id="cb608-4"><a href="#cb608-4" aria-hidden="true"></a><span class="dt">int</span> main(<span class="dt">void</span>)</span>
<span id="cb608-5"><a href="#cb608-5" aria-hidden="true"></a>{</span>
<span id="cb608-6"><a href="#cb608-6" aria-hidden="true"></a>    <span class="dt">char</span> line[<span class="dv">256</span>];</span>
<span id="cb608-7"><a href="#cb608-7" aria-hidden="true"></a>    <span class="dt">char</span> ch;</span>
<span id="cb608-8"><a href="#cb608-8" aria-hidden="true"></a></span>
<span id="cb608-9"><a href="#cb608-9" aria-hidden="true"></a>    <span class="cf">if</span> (fgets(line, <span class="kw">sizeof</span> line, stdin) == NULL) {</span>
<span id="cb608-10"><a href="#cb608-10" aria-hidden="true"></a>        printf(<span class="st">&quot;Input error.</span><span class="sc">\n</span><span class="st">&quot;</span>);</span>
<span id="cb608-11"><a href="#cb608-11" aria-hidden="true"></a>        exit(<span class="dv">1</span>);</span>
<span id="cb608-12"><a href="#cb608-12" aria-hidden="true"></a>    }</span>
<span id="cb608-13"><a href="#cb608-13" aria-hidden="true"></a></span>
<span id="cb608-14"><a href="#cb608-14" aria-hidden="true"></a>    ch = line[<span class="dv">0</span>];</span>
<span id="cb608-15"><a href="#cb608-15" aria-hidden="true"></a>    printf(<span class="st">&quot;Character read: %c</span><span class="sc">\n</span><span class="st">&quot;</span>, ch);</span>
<span id="cb608-16"><a href="#cb608-16" aria-hidden="true"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb608-17"><a href="#cb608-17" aria-hidden="true"></a>}</span></code></pre></div>
<p>One detail to be aware of when using <code>fgets()</code> will read in the newline character if there’s enough room in the inut buffer. If it’s not desirable then you can remove it:</p>
<div class="sourceCode" id="cb609"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb609-1"><a href="#cb609-1" aria-hidden="true"></a><span class="dt">char</span> line[<span class="dv">256</span>];</span>
<span id="cb609-2"><a href="#cb609-2" aria-hidden="true"></a></span>
<span id="cb609-3"><a href="#cb609-3" aria-hidden="true"></a><span class="cf">if</span> (fgets(line, <span class="kw">sizeof</span> line, stdin) == NULL) {</span>
<span id="cb609-4"><a href="#cb609-4" aria-hidden="true"></a>    printf(<span class="st">&quot;Input error.</span><span class="sc">\n</span><span class="st">&quot;</span>);</span>
<span id="cb609-5"><a href="#cb609-5" aria-hidden="true"></a>    exit(<span class="dv">1</span>);</span>
<span id="cb609-6"><a href="#cb609-6" aria-hidden="true"></a>}</span>
<span id="cb609-7"><a href="#cb609-7" aria-hidden="true"></a></span>
<span id="cb609-8"><a href="#cb609-8" aria-hidden="true"></a>line[strcpsn(line, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)] = <span class="dv">0</span>; <span class="co">/* removes the trailing newline, if present */</span></span></code></pre></div>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="how-do-i-check-if-an-integer-is-even-or-odd-score-355377-in-2015" class="level3">
<h3>99: How do I check if an integer is even or odd? (score <a href="https://stackoverflow.com/q/160930.html">355377</a> in 2015)</h3>
<section id="question-96" class="level4">
<h4>Question</h4>
<p>How can I check if a given number is even or odd in C?</p>
</section>
<section id="answer-accepted-score-449" class="level4">
<h4>Answer accepted (score 449)</h4>
<p>Use the modulo (%) operator to check if there’s a remainder when dividing by 2:</p>
<div class="sourceCode" id="cb610"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb610-1"><a href="#cb610-1" aria-hidden="true"></a><span class="cf">if</span> (x % <span class="dv">2</span>) { <span class="co">/* x is odd */</span> }</span></code></pre></div>
<p>A few people have criticized my answer above stating that using x &amp; 1 is “faster” or “more efficient”. I do not believe this to be the case.</p>
<p>Out of curiosity, I created two trivial test case programs:</p>
<div class="sourceCode" id="cb611"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb611-1"><a href="#cb611-1" aria-hidden="true"></a><span class="co">/* modulo.c */</span></span>
<span id="cb611-2"><a href="#cb611-2" aria-hidden="true"></a></span>
<span id="cb611-3"><a href="#cb611-3" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb611-4"><a href="#cb611-4" aria-hidden="true"></a></span>
<span id="cb611-5"><a href="#cb611-5" aria-hidden="true"></a><span class="dt">int</span> main(<span class="dt">void</span>)</span>
<span id="cb611-6"><a href="#cb611-6" aria-hidden="true"></a>{</span>
<span id="cb611-7"><a href="#cb611-7" aria-hidden="true"></a>    <span class="dt">int</span> x;</span>
<span id="cb611-8"><a href="#cb611-8" aria-hidden="true"></a>    <span class="cf">for</span> (x = <span class="dv">0</span>; x &lt; <span class="dv">10</span>; x++)</span>
<span id="cb611-9"><a href="#cb611-9" aria-hidden="true"></a>        <span class="cf">if</span> (x % <span class="dv">2</span>)</span>
<span id="cb611-10"><a href="#cb611-10" aria-hidden="true"></a>            printf(<span class="st">&quot;%d is odd</span><span class="sc">\n</span><span class="st">&quot;</span>, x);</span>
<span id="cb611-11"><a href="#cb611-11" aria-hidden="true"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb611-12"><a href="#cb611-12" aria-hidden="true"></a>}</span>
<span id="cb611-13"><a href="#cb611-13" aria-hidden="true"></a></span>
<span id="cb611-14"><a href="#cb611-14" aria-hidden="true"></a><span class="co">/* and.c */</span></span>
<span id="cb611-15"><a href="#cb611-15" aria-hidden="true"></a></span>
<span id="cb611-16"><a href="#cb611-16" aria-hidden="true"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb611-17"><a href="#cb611-17" aria-hidden="true"></a></span>
<span id="cb611-18"><a href="#cb611-18" aria-hidden="true"></a><span class="dt">int</span> main(<span class="dt">void</span>)</span>
<span id="cb611-19"><a href="#cb611-19" aria-hidden="true"></a>{</span>
<span id="cb611-20"><a href="#cb611-20" aria-hidden="true"></a>    <span class="dt">int</span> x;</span>
<span id="cb611-21"><a href="#cb611-21" aria-hidden="true"></a>    <span class="cf">for</span> (x = <span class="dv">0</span>; x &lt; <span class="dv">10</span>; x++)</span>
<span id="cb611-22"><a href="#cb611-22" aria-hidden="true"></a>        <span class="cf">if</span> (x &amp; <span class="dv">1</span>)</span>
<span id="cb611-23"><a href="#cb611-23" aria-hidden="true"></a>            printf(<span class="st">&quot;%d is odd</span><span class="sc">\n</span><span class="st">&quot;</span>, x);</span>
<span id="cb611-24"><a href="#cb611-24" aria-hidden="true"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb611-25"><a href="#cb611-25" aria-hidden="true"></a>}</span></code></pre></div>
<p>I then compiled these with gcc 4.1.3 on one of my machines 5 different times:</p>
<ul>
<li>
With no optimization flags.
</li>
<li>
With -O
</li>
<li>
With -Os
</li>
<li>
With -O2
</li>
<li>
With -O3
</li>
</ul>
<p>I examined the assembly output of each compile (using gcc -S) and found that in each case, the output for and.c and modulo.c were identical (they both used the andl $1, %eax instruction). I doubt this is a “new” feature, and I suspect it dates back to ancient versions. I also doubt any modern (made in the past 20 years) non-arcane compiler, commercial or open source, lacks such optimization. I would test on other compilers, but I don’t have any available at the moment.</p>
<p>If anyone else would care to test other compilers and/or platform targets, and gets a different result, I’d be very interested to know.</p>
<p>Finally, the modulo version is <strong>guaranteed</strong> by the standard to work whether the integer is positive, negative or zero, regardless of the implementation’s representation of signed integers. The bitwise-and version is not. Yes, I realise two’s complement is somewhat ubiquitous, so this is not really an issue.</p>
</section>
<section id="answer-2-score-208" class="level4">
<h4>Answer 2 (score 208)</h4>
<p>You guys are waaaaaaaay too efficient. What you really want is:</p>
<div class="sourceCode" id="cb612"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb612-1"><a href="#cb612-1" aria-hidden="true"></a>public boolean isOdd(<span class="dt">int</span> num) {</span>
<span id="cb612-2"><a href="#cb612-2" aria-hidden="true"></a>  <span class="dt">int</span> i = <span class="dv">0</span>;</span>
<span id="cb612-3"><a href="#cb612-3" aria-hidden="true"></a>  boolean odd = false;</span>
<span id="cb612-4"><a href="#cb612-4" aria-hidden="true"></a></span>
<span id="cb612-5"><a href="#cb612-5" aria-hidden="true"></a>  <span class="cf">while</span> (i != num) {</span>
<span id="cb612-6"><a href="#cb612-6" aria-hidden="true"></a>    odd = !odd;</span>
<span id="cb612-7"><a href="#cb612-7" aria-hidden="true"></a>    i = i + <span class="dv">1</span>;</span>
<span id="cb612-8"><a href="#cb612-8" aria-hidden="true"></a>  }</span>
<span id="cb612-9"><a href="#cb612-9" aria-hidden="true"></a></span>
<span id="cb612-10"><a href="#cb612-10" aria-hidden="true"></a>  <span class="cf">return</span> odd;</span>
<span id="cb612-11"><a href="#cb612-11" aria-hidden="true"></a>}</span></code></pre></div>
<p>Repeat for <code>isEven</code>.</p>
<p>Of course, that doesn’t work for negative numbers. But with brilliance comes sacrifice…</p>
</section>
<section id="answer-3-score-97-2" class="level4">
<h4>Answer 3 (score 97)</h4>
<p>Use bit arithmetic:</p>
<div class="sourceCode" id="cb613"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb613-1"><a href="#cb613-1" aria-hidden="true"></a><span class="cf">if</span>((x &amp; <span class="dv">1</span>) == <span class="dv">0</span>)</span>
<span id="cb613-2"><a href="#cb613-2" aria-hidden="true"></a>    printf(<span class="st">&quot;EVEN!</span><span class="sc">\n</span><span class="st">&quot;</span>);</span>
<span id="cb613-3"><a href="#cb613-3" aria-hidden="true"></a><span class="cf">else</span></span>
<span id="cb613-4"><a href="#cb613-4" aria-hidden="true"></a>    printf(<span class="st">&quot;ODD!</span><span class="sc">\n</span><span class="st">&quot;</span>);</span></code></pre></div>
<p>This is faster than using division or modulus.</p>
<p></b> </em> </i> </small> </strong> </sub> </sup></p>
</section>
</section>
<section id="difference-between-while-loop-and-do-while-loop-score-349762-in-2010" class="level3">
<h3>100: Difference between “while” loop and “do while” loop (score <a href="https://stackoverflow.com/q/3625759.html">349762</a> in 2010)</h3>
<section id="question-97" class="level4">
<h4>Question</h4>
<p>What is the difference between while loop and do while loop. I used to think both are completely same.Then I came across following piece of code :</p>
<div class="sourceCode" id="cb614"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb614-1"><a href="#cb614-1" aria-hidden="true"></a><span class="cf">do</span> {</span>
<span id="cb614-2"><a href="#cb614-2" aria-hidden="true"></a>        printf(<span class="st">&quot;Word length... &quot;</span>);</span>
<span id="cb614-3"><a href="#cb614-3" aria-hidden="true"></a>        scanf(<span class="st">&quot;%d&quot;</span>, &amp;wdlen);</span>
<span id="cb614-4"><a href="#cb614-4" aria-hidden="true"></a>    } <span class="cf">while</span>(wdlen&lt;<span class="dv">2</span>);</span></code></pre></div>
<p>This code works perfectly. It prints word length and tascans the input. But when I changed it to</p>
<div class="sourceCode" id="cb615"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb615-1"><a href="#cb615-1" aria-hidden="true"></a><span class="cf">while</span>(wdlen&lt;<span class="dv">2</span>){</span>
<span id="cb615-2"><a href="#cb615-2" aria-hidden="true"></a>        printf(<span class="st">&quot;Word length... &quot;</span>);</span>
<span id="cb615-3"><a href="#cb615-3" aria-hidden="true"></a>        scanf(<span class="st">&quot;%d&quot;</span>, &amp;wdlen);</span>
<span id="cb615-4"><a href="#cb615-4" aria-hidden="true"></a>    } </span></code></pre></div>
<p>It gives a blank screen. It do not work. So there is some functional difference between both loops. Can anybody explain it? Thanks in advance.</p>
<p>EDIT : Is there any other difference in these two ?</p>
</section>
<section id="answer-accepted-score-57" class="level4">
<h4>Answer accepted (score 57)</h4>
<p>The <strong>do while</strong> loop executes the content of the loop once before checking the condition of the while.</p>
<p>Whereas a <strong>while</strong> loop will check the condition first before executing the content.</p>
<p>In this case you are waiting for user input with scanf(), which will never execute in the <strong>while</strong> loop as wdlen is not initialized and may just contain a garbage value which may be greater than 2.</p>
</section>
<section id="answer-2-score-18" class="level4">
<h4>Answer 2 (score 18)</h4>
<p><strong>While</strong> : your condition is at the begin of the loop block, and makes possible <em>to never enter the loop</em>.</p>
<p><strong>Do While</strong> : your condition is at the end of the loop block, and makes obligatory <em>to enter the loop at least one time</em>.</p>
</section>
<section id="answer-3-score-3-1" class="level4">
<h4>Answer 3 (score 3)</h4>
<div class="sourceCode" id="cb616"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb616-1"><a href="#cb616-1" aria-hidden="true"></a><span class="cf">do</span> {</span>
<span id="cb616-2"><a href="#cb616-2" aria-hidden="true"></a>    printf(<span class="st">&quot;Word length... &quot;</span>);</span>
<span id="cb616-3"><a href="#cb616-3" aria-hidden="true"></a>    scanf(<span class="st">&quot;%d&quot;</span>, &amp;wdlen);</span>
<span id="cb616-4"><a href="#cb616-4" aria-hidden="true"></a>} <span class="cf">while</span>(wdlen&lt;<span class="dv">2</span>);</span></code></pre></div>
<p>A <code>do-while</code> loop guarantees the execution of the loop at least once because it checks the loop condition AFTER the loop iteration. Therefore it’ll print the string and call scanf, thus updating the wdlen variable.</p>
<div class="sourceCode" id="cb617"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb617-1"><a href="#cb617-1" aria-hidden="true"></a><span class="cf">while</span>(wdlen&lt;<span class="dv">2</span>){</span>
<span id="cb617-2"><a href="#cb617-2" aria-hidden="true"></a>    printf(<span class="st">&quot;Word length... &quot;</span>);</span>
<span id="cb617-3"><a href="#cb617-3" aria-hidden="true"></a>    scanf(<span class="st">&quot;%d&quot;</span>, &amp;wdlen);</span>
<span id="cb617-4"><a href="#cb617-4" aria-hidden="true"></a>} </span></code></pre></div>
As for the <code>while</code> loop, it evaluates the loop condition BEFORE the loop body is executed. <code>wdlen</code> probably starts off as more than 2 in your code that’s why you never reach the loop body.<br />

</section>
</section>
</section>
</body>
</html>
